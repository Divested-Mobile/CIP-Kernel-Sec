description: "\n The Network Address Translation (NAT) capability for Netfilter (\"\
  iptables\") \n 1.2.6a and earlier leaks translated IP addresses in ICMP error messages."
references:
- BUGTRAQ:20020508 [CARTSA-20020402] Linux Netfilter NAT/ICMP code information leak
- REDHAT:RHSA-2002:086
- MANDRAKE:MDKSA-2002:030
- HP:HPSBTL0205-039
- 'XF: linux-netfilter-information-leak(9043)'
- BID:4699
comments:
  debian: |-
    There's a patch here:
    http://www.securityfocus.com/bid/4699
    But it doesn't appear to have gone upstream.  It doesn't look like RedHat
    or Mandrake fixed it either; instead, they suggest a workaround:
    http://rhn.redhat.com/errata/RHSA-2002-086.html
    http://archives.mandrivalinux.com/security-announce/2002-02/msg00025.html
    .
  debian/dannf: We plan to "fix" this by recommending the workaround as well.
  debian/horms: "I believe that this problem was fixed as part of the following\n\
    patch that was incuded in 2.6.11\nhttp://www.kernel.org/git/?p=linux/kernel/git/tglx/history.git;a=commitdiff;h=1e69ba3fa29b13fe5229d6e325aee91ae5abe298\n\
    However I believe a related bug was introduced by the following \npatch, also\
    \ included in 2.6.11\nhttp://www.kernel.org/git/?p=linux/kernel/git/tglx/history.git;a=commitdiff;h=8d5f3377d48c74df38990688f09e773887ba4eb5\n\
    This new bugs allows discloser of the IP address of intermedate \nhops between\
    \ the NATing box and the NAT'd box.\nThis is easily demonstrated using tcptraceroute\n\
    1  10.0.1.7  61.524 ms  93.081 ms  22.982 ms\n2  192.168.1.254  72.099 ms  66.899\
    \ ms  67.599 ms \n3  10.0.1.7 [open]  67.188 ms  105.974 ms  104.873 ms\nI also\
    \ believe that pretty much all kernels disclose\nenough information to work out\
    \ if DNAT is in use or not.\nI wrote a long mail about this to netfilter-devel\
    \ and will\nput a link here when it shows up\nIn the mean time: (Message-ID: <20060202113824.GA4399@verge.net.au>)\n\
    Given this seems to be an ongoing suite of problems, with little\nhope of a final\
    \ solution, I'm marking it as ignore for all\nwoody and sarge kernels, many of\
    \ which i have reproduced the\nproblem on allong with upstream's 2.4 (~2.4.33-pre1)"
