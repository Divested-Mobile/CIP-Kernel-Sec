description: |2-

   A race condition in the way env_start and env_end pointers are
   initialized in the execve system call and used in fs/proc/base.c
   on Linux 2.4 allows local users to cause a denial of service
   (crash).
references:
- REDHAT:RHSA-2003:198
- URL:http://www.redhat.com/support/errata/RHSA-2003-198.html
- REDHAT:RHSA-2003:238
- URL:http://www.redhat.com/support/errata/RHSA-2003-238.html
- DEBIAN:DSA-358
- URL:http://www.debian.org/security/2004/dsa-358
- DEBIAN:DSA-423
- URL:http://www.debian.org/security/2004/dsa-423
- OVAL:OVAL309
- URL:http://oval.mitre.org/oval/definitions/data/oval309.html
comments:
  debian: |-
    The fix for 2.4 went into a larger patch:
    http://linux.bkbits.net:8080/linux-2.4/cset@41c68e9bogrpceA9rUJa-xHwBd-P6g?nav=index.html|src/|src/fs|src/fs/proc|related/fs/proc/base.c
    However, the patch for 2.6 is much simpler:
    http://linux.bkbits.net:8080/linux-2.6/cset@3ff1101fZfOZMtqtcvKc_s-agJpLrQ?nav=index.html|src/|src/fs|src/fs/proc|related/fs/proc/base.c
    Unfortunately, it doesn't apply cleanly to 2.4.  It looks like
    the fix included in 2.4.18-10 just re-typed len in
    proc_pid_environ; while in 2.6 len was also retyped in
    proc_pid_cmdline.  Only the former deals with evn_end/env_start
    pointers and the latter doesn't apply cleanly to 2.4, so I'm
    just making the proc_pid_environ change.
    .
    hrm.. maybe there was an earlier patch to 2.4; the above 2.4
    patch didn't go in till 2.4.29, yet it looks like this was
    already fixed in our 2.4.27 .orig.tar.gz
    .
  debian/jmm: |-
    I assume this was fixed upstream in 2.4.22-pre10?
    o Fix /proc/self security issue
