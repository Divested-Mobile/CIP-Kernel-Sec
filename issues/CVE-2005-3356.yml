description: |2-

   [PATCH] Fix double decrement of mqueue_mnt->mnt_count in sys_mq_open
   .
   Fixed the refcounting on failure exits in sys_mq_open() and
   cleaned the logics up.  Rules are actually pretty simple - dentry_open()
   expects vfsmount and dentry to be pinned down and it either transfers
   them into created struct file or drops them.  Old code had been very
   confused in that area - if dentry_open() had failed either in do_open()
   or do_create(), we ended up dentry and mqueue_mnt dropped twice, once
   by dentry_open() cleanup and then by sys_mq_open().
   .
   Fix consists of making the rules for do_create() and do_open()
   same as for dentry_open() and updating the sys_mq_open() accordingly;
   that actually leads to more straightforward code and less work on
   normal path.
   .
   Signed-off-by: Al Viro <aviro@redhat.com>
   Signed-off-by: Linus Torvalds <torvalds@osdl.org>
references:
- http://kernel.org/git/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commitdiff_plain;h=7c7dce9209161eb260cdf9e9172f72c3a02379e6h+p=12dbf3fc4d06d2c0c4c44dc0612df04248b3cfd3
comments:
  debian/jmm: Discovered by Doug Chapman
