description: |2-

   When calling vfs_unlink() on the lower dentry, d_delete() turns the
   dentry into a negative dentry when the d_count is 1.  This eventually
   caused a NULL pointer deref when a read() or write() was done and the
   negative dentry's d_inode was dereferenced in
   ecryptfs_read_update_atime() or ecryptfs_getxattr().
references:
- http://www.openwall.com/lists/oss-security/2009/10/06/1
- http://git.kernel.org/?p=linux/kernel/git/stable/linux-2.6.31.y.git;a=commit;h=afc2b6932f48f200736d3e36ad66fee0ec733136
- https://bugzilla.redhat.com/show_bug.cgi?id=527534
comments:
  debian/jmm: Introduced in 2.6.19
fixed-by:
  mainline: [afc2b6932f48f200736d3e36ad66fee0ec733136, 9c2d2056647790c5034d722bd24e9d913ebca73c]
