description: 'net: Negative socket receive buffer size permitted'
comments:
  debian/bwh: |-
    Prior to commit 82981930125a "net: cleanups in sock_setsockopt()":
    - The comparison with SOCK_MIN_SNDBUF used type int, so it
    rejected negative values
    - The comparison with SOCK_MIN_RCVBUF used type size_t, so it did
    *not* reject negative values
    - The comparisons of val with sysctl_wmem_max used type u32, so
    they rejected negative values *unless* sysctl_wmem_max >=
    1 << 30 (and why would you set it that high?!)
    So it was possible to set a negative value for sock::sk_rcvbuf
    through SO_RCVBUFFORCE (escalation from CAP_NET_ADMIN to kernel)
    or through SO_RCVBUF (escalation from user to kernel) iff
    sysctl_wmem_max was large enough.
fixed-by:
  debian/buster-security: &id001 ['version:debian/3.8.11-1']
  debian/stretch-security: *id001
  mainline: [82981930125abfd39d7c8378a9cfdf5e1be2002b]
