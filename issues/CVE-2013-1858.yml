description: 'userns: Don''t allow CLONE_NEWUSER | CLONE_FS'
references:
- http://stealth.openwall.net/xSports/clown-newuser.c
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1858
- http://www.openwall.com/lists/oss-security/2013/03/14
- https://launchpad.net/bugs/1156778
comments:
  debian: |-
    Prior to 3.8, CLONE_NEWUSER required CAP_SYS_ADMIN && CAP_SETUID &&
    CAP_SETGID, so no privilege escalation is possible.
  ubuntu/jdstrand: |-
    this became privilege esclation when
     5eaf563e53294d6696e651466697eb9d491f3946 removed the checks for
     CAP_SYS_ADMIN, CAP_SETUID and CAP_SETGID
  ubuntu/mdeslaur: |-
    reproducer:
    http://stealth.openwall.net/xSports/clown-newuser.c
introduced-by:
  mainline: [5eaf563e53294d6696e651466697eb9d491f3946]
fixed-by:
  mainline: [e66eded8309ebf679d3d3c1f5820d1f2ca332c71]
