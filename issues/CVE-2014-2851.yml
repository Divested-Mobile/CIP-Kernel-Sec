description: memory leak in ping
references:
- https://lkml.org/lkml/2014/4/10/736
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2851
- https://git.kernel.org/cgit/linux/kernel/git/davem/net.git/commit/?id=b04c46190219a4f845e46a459e3102137b7f6cac
- http://www.openwall.com/lists/oss-security/2014/04/11/4
- https://bugzilla.redhat.com/show_bug.cgi?id=1086730
- https://usn.ubuntu.com/usn/usn-2221-1
- https://usn.ubuntu.com/usn/usn-2223-1
- https://usn.ubuntu.com/usn/usn-2224-1
- https://usn.ubuntu.com/usn/usn-2225-1
- https://usn.ubuntu.com/usn/usn-2226-1
- https://usn.ubuntu.com/usn/usn-2227-1
- https://usn.ubuntu.com/usn/usn-2228-1
- https://usn.ubuntu.com/usn/usn-2260-1
- https://launchpad.net/bugs/1312994
comments:
  debian: 'raphael: Appears to have been introduced with the support for IPPROTO_ICMP
    in 3.0-rc1'
  debian/bwh: |-
    Bug is in permission checks for creating ping sockets, so is exploitable
    even though the default permissions prevent them being created.
  ubuntu/jdstrand: |-
    android kernels (goldfish, grouper, maguro, mako and manta) are not
     supported on the Ubuntu Touch 13.10 preview kernels
  ubuntu/tyhicks: |-
    android init writes a valid group range to
     /proc/sys/net/ipv4/ping_group_range which results in all unprivileged users
     being allowed to open restricted ICMP sockets and trigger this bug
introduced-by:
  mainline: [c319b4d76b9e583a5d88d6bf190e079c4e43213d]
fixed-by:
  debian/buster-security: &id001 ['patch:debian/3.14.4-1:bugfix/all/net-ipv4-current-group_info-should-be-put-after-usin.patch']
  debian/stretch-security: *id001
  mainline: [b04c46190219a4f845e46a459e3102137b7f6cac]
  stable/3.10: [8dbc8dc8e84b998ca8a7394ae22614f3a58d4c38]
  stable/3.4: [67c6fc9e79121c69134efdd03a6d35aa6adf6c92]
