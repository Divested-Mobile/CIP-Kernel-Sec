description: Kernel memory protection bypass on s390
comments:
  debian/bwh: |-
    Martin Schwidefsky says this was introduced by commit fa968ee215c0
    ("s390/signal: set correct address space control").  It added the
    ASC (Address Space Control) processor status bits to those that
    must be restored on return from signals, but as a result they can
    also be set arbitrarily by ptrace.  This opens a vulnerability if
    the kernel parameter user_mode=primary is used.  Commit e258d719ff28
    ("s390/uaccess: always run the kernel in home space") made that
    the default (I think).
fixed-by:
  debian/buster-security: &id001 ['patch:debian/3.14.13-2:bugfix/s390/s390-ptrace-fix-PSW-mask-check.patch']
  debian/stretch-security: *id001
  mainline: [dab6cf55f81a6e16b8147aed9a843e1691dcd318]
  stable/3.10: [a940d7b23bc073c774f3733c79f82102ffccff4e]
  stable/3.4: [883ea134ae75eb03c9f08553a81957a808cee96b]
