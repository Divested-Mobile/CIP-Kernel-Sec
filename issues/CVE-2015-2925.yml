description: Escape from sub-tree of bind-mounts
references:
- http://thread.gmane.org/gmane.linux.kernel.containers/28939/
- https://marc.info/?l=oss-security&m=142805871412239&w=2
comments:
  debian/bwh: |-
    This is usually dependent on having CAP_SYS_ADMIN in a user namespace
    (to change mounts), so not exploitable in older kernel versions.
    However, Eric Biederman says that some systems set up user sessions
    using chroots that are descendants of the user's home.  This bug
    allows escaping from such a chroot.
    Finally fixed upstream in a somewhat simpler way.
  debian/jmm: |-
    Split from CVE-2014-9717:
    http://www.spinics.net/lists/linux-containers/msg30804.html (16/19)
    http://www.spinics.net/lists/linux-containers/msg30798.html (17/19)
    http://www.spinics.net/lists/linux-containers/msg30797.html (18/19)
    http://www.spinics.net/lists/linux-containers/msg30802.html (19/19)
fixed-by:
  aosp/3.18: [27f5c615afb5303eb902a1f2535903e0fd1d7517, 7f61fd99a60195578215f46ed870b5c118cfbfc0]
  debian/buster-security: &id001 ['patch:debian/4.2.1-1:bugfix/all/dcache-handle-escaped-paths-in-prepend_path.patch',
    'patch:debian/4.2.1-1:bugfix/all/vfs-test-for-and-handle-paths-that-are-unreachable-f.patch']
  debian/stretch-security: *id001
  mainline: [cde93be45a8a90d8c264c776fab63487b5038a65, 397d425dc26da728396e66d392d5dcb8dac30c37]
  stable/3.10: [91397d567646df4ede8619beb678252e82fafb2a, fa6ef735862a25daff2a3ee3aba1e32f278f21c5]
  stable/3.18: [27f5c615afb5303eb902a1f2535903e0fd1d7517, 7f61fd99a60195578215f46ed870b5c118cfbfc0]
  stable/3.4: [652b4f2f20702cbb6cb7846a39af99d182c59764, 4a69710b414cd12081da97ec35971c9b22833992]
