description: Privilege escalation by triggering nested NMI on x86_64
references:
- https://marc.info/?l=oss-security&m=143758877425647&w=2
- https://ubuntu.com/security/notices/USN-2687-1
- https://ubuntu.com/security/notices/USN-2688-1
- https://ubuntu.com/security/notices/USN-2689-1
- https://ubuntu.com/security/notices/USN-2690-1
- https://ubuntu.com/security/notices/USN-2691-1
- https://ubuntu.com/security/notices/USN-2700-1
- https://ubuntu.com/security/notices/USN-2701-1
- http://www.openwall.com/lists/oss-security/2015/07/22/7
- https://www.cve.org/CVERecord?id=CVE-2015-3290
- https://launchpad.net/bugs/1477026
comments:
  debian: |-
    Seems to have been introduced by espfix64 in 3.16, but only in combination
    with commit 3f3c8b8c4b2a ("x86: Add workaround to NMI iret woes", 3.3)
    and commit e00b12e64be9 ("perf/x86: Further optimize copy_from_user_nmi()",
    3.13).  espfix64 was backported to 3.2 but the others weren't.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/kamal: |-
    precise_linux 3.2-based kernels set to "not-affected (code not present)" per
     oss-security post
  ubuntu/tyhicks: Per oss-security, affects 3.13 and newer
fixed-by:
  aosp/3.18: [b1dc7a725e553dc0cc11facb9e2aba60255cd01f, 20c593d25ee47f0fc56a292d5ea1684ccb1ca4ef,
    057e3a8787b53052e4f5d92a3da6a0b9f5113bea]
  debian/buster-security: &id001 ['version:debian/4.0.8-2']
  debian/stretch-security: *id001
  mainline: [9d05041679904b12c12421cbcf9cb5f4860a8d7b, 0e181bb58143cb4a2e8f01c281b0816cd0e4798e,
    9b6e6a8334d56354853f9c255d1395c2ba570e0a]
  stable/3.18: [b1dc7a725e553dc0cc11facb9e2aba60255cd01f, 20c593d25ee47f0fc56a292d5ea1684ccb1ca4ef,
    057e3a8787b53052e4f5d92a3da6a0b9f5113bea]
