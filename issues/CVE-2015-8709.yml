description: privileged process entering userns can be ptraced by userns owner
references:
- https://bugs.launchpad.net/ubuntu/+source/lxd/+bug/1527374
- https://lkml.org/lkml/2015/12/25/71
comments:
  Debian-bwh: |-
    CVE requested at http://www.openwall.com/lists/oss-security/2015/12/17/12
    This was initially rejected as an upstream kernel bug, but I believe it
    was eventually fixed upstream as noted below.
    Dependencies:
    3dfb7d8cdbc7 security: let security modules use PTRACE_MODE_* with bitmasks
    caaee6234d05 ptrace: use fsuid, fsgid, effective creds for fs access checks
    Related:
    64b875f7ac8a ptrace: Capture the ptracer's creds not PT_PTRACE_CAP
    84d77d3f06e7 ptrace: Don't allow accessing an undumpable mm
    f84df2a6f268 exec: Ensure mm->user_ns contains the execed files
    613cc2b6f272 fs: exec: apply CLOEXEC before changing dumpable task flags
fixed-by:
  linux-4.9.y: [694a95fa6dae4991f16cda333d897ea063021fed]
  mainline: [bfedb589252c01fa505ac9f6f2a3d5d68d707ef4]
