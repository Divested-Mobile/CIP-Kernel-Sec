description: The mbcache feature in the ext2 and ext4 filesystem implementations in
  the Linux kernel before 4.6 mishandles xattr block caching, which allows local users
  to cause a denial of service (soft lockup) via filesystem operations in environments
  that use many attributes, as demonstrated by Ceph and Samba.
references:
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=82939d7999dfc1f1998c4b1c12e2f19edbdff272
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=be0726d33cb8f411945884664924bed3cb8c70ee
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f9a61eb4e2471c56a63cd804c7474128138c38ac
- http://www.openwall.com/lists/oss-security/2016/08/22/2
- http://www.openwall.com/lists/oss-security/2016/08/25/4
- https://bugzilla.kernel.org/show_bug.cgi?id=107301
- https://bugzilla.redhat.com/show_bug.cgi?id=1360968
- https://github.com/torvalds/linux/commit/82939d7999dfc1f1998c4b1c12e2f19edbdff272
- https://github.com/torvalds/linux/commit/be0726d33cb8f411945884664924bed3cb8c70ee
- https://github.com/torvalds/linux/commit/f9a61eb4e2471c56a63cd804c7474128138c38ac
- https://lwn.net/Articles/668718/
- https://usn.ubuntu.com/3582-1/
- https://usn.ubuntu.com/3582-2/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8952
- http://seclists.org/oss-sec/2016/q3/378
- https://ubuntu.com/security/notices/USN-3582-1
- https://ubuntu.com/security/notices/USN-3582-2
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2015-8952
- https://www.cve.org/CVERecord?id=CVE-2015-8952
comments:
  debian/bwh: |-
    The upstream fix (rewrite of mbcache) is too intrusive to backport.
    We will mitigate this with cond_resched() as suggested in comment 1
    on the bz.k.o bug report.  I didn't want to add the no_mbcache mount
    option as in comment 12 because it's a uAPI extension, but it has
    now been added upstream (commit cdb7ee4c6327) so I think it would be
    reasonable to add it to supported stable releases.
    The problem seems to have been introduced (or exacerbated) by commit
    1f3e55fe02d1 in 3.15, which added a retry loop in mb_cache_entry_alloc().
reporters:
- Laurent Guerby
fixed-by:
  debian/buster-security: ['version:debian/4.6.1-1']
  debian/stretch-security: ['version:debian/4.6.1-1']
  mainline: [f9a61eb4e2471c56a63cd804c7474128138c38ac, 82939d7999dfc1f1998c4b1c12e2f19edbdff272,
    be0726d33cb8f411945884664924bed3cb8c70ee]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/xenial: [eddecb99e5a20637712f8de900e3bc142056e1d4, bcb397e4fd2c6fccd81bbb52d581e9d35416bd13,
    4e032990173f7f92ca141a3e045240ab5fb3c7ab, 1bcae5db01c4e5b0688982fc65b9096d3adce2ac,
    238b224c618334b7a5f6114705f11de138bebde7, 40cebcabdbcaf3925c521761a6963c35103becb7,
    202d555aef2a16f4d998651598552bcfae4a6ff6, b876cd149a257534a69ef16d83a322c471701728,
    1cf1f661cc948e0e7ed88dae5f0153e08add256a, ad60cf6a8db63bc533e5cdc86e7c0d0aed788f56,
    63cf10be365a3cad25b457089d8e3cba9fc6d6e4]
