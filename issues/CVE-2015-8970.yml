description: 'crypto: GPF in lrw_crypt caused by null-deref'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8970
- https://groups.google.com/forum/#!msg/syzkaller/frb2XrB5aWk/xCXzkIBcDAAJ
- https://bugzilla.redhat.com/show_bug.cgi?id=1386286
- http://www.openwall.com/lists/oss-security/2016/11/03/6
comments:
  debian/carnil: |-
    dd504589577d8e8e70f51f997ad487a4cb6c026f is the initial patch
    followed by a set of related patches. Possibly related:
    dd504589577d8e8e70f51f997ad487a4cb6c026f crypto: algif_skcipher - Require setkey before accept(2)
    c840ac6af3f8713a71b4d2363419145760bd6044 crypto: af_alg - Disallow bind/setkey/... after accept(2)
    a383292c86663bbc31ac62cc0c04fc77504636a6 crypto: af_alg - Fix socket double-free when accept fails
    37766586c965d63758ad542325a96d5384f4a8c9 crypto: af_alg - Add nokey compatibility path
    a0fa2d037129a9849918a92d91b79ed6c7bd2818 crypto: algif_skcipher - Add nokey compatibility path
    a5596d6332787fd383b3b5427b41f94254430827 crypto: hash - Add crypto_ahash_has_setkey
    6de62f15b581f920ade22d758f4c338311c2f0d4 crypto: algif_hash - Require setkey before accept(2)
    a1383cd86a062fc798899ab20f0ec2116cce39cb crypto: skcipher - Add crypto_skcipher_has_setkey
    6e8d8ecf438792ecf7a3207488fb4eebc4edb040 crypto: algif_skcipher - Add key check exception for cipher_null
reporters:
- Igor Redko
- Vasily Averin
- Dmitry Vyukov
fixed-by:
  cip/4.4: [b238717c0bb4606e2e36fc0de745306b0c900d83]
  cip/4.4-rt: [b238717c0bb4606e2e36fc0de745306b0c900d83]
  debian/buster-security: &id001 ['version:debian/4.4.2-1']
  debian/stretch-security: *id001
  mainline: [dd504589577d8e8e70f51f997ad487a4cb6c026f]
  stable/3.10: [b886719145be12b36048dffbca07332500c39cf6]
  stable/4.4: [b238717c0bb4606e2e36fc0de745306b0c900d83]
