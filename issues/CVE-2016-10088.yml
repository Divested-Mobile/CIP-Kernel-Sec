description: |-
  The sg implementation in the Linux kernel through 4.9 does not properly
  restrict write operations in situations where the KERNEL_DS option is set,
  which allows local users to read or write to arbitrary kernel memory
  locations or cause a denial of service (use-after-free) by leveraging
  access to a /dev/sg device, related to block/bsg.c and drivers/scsi/sg.c.
  NOTE: this vulnerability exists because of an incomplete fix for
  CVE-2016-9576.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10088
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=128394eff343fc6d2f32172f03e24829539c5835
- http://www.openwall.com/lists/oss-security/2016/12/30/1
- https://github.com/torvalds/linux/commit/128394eff343fc6d2f32172f03e24829539c5835
- http://www.ubuntu.com/usn/usn-3208-1
- http://www.ubuntu.com/usn/usn-3208-2
- http://www.ubuntu.com/usn/usn-3209-1
- https://marc.info/?l=linux-scsi&m=148010092224801&w=2
- https://gist.githubusercontent.com/dvyukov/80cd94b4e4c288f16ee4c787d404118b/raw/10536069562444da51b758bb39655b514ff93b45/gistfile1.txt
comments:
  Debian-bwh: This is the vulnerabilbility left after fixing CVE-2016-9576.
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  Ubuntu-sbeattie: attack requires access to /dev/sg or other block scsi devices.
fixed-by:
  linux-4.9.y: [3f3a6bbe6f9f5e895d8945494173594ee51632da]
  mainline: [128394eff343fc6d2f32172f03e24829539c5835]
