description: Race in l2tp binding can lead to use-after-free
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10200
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=32c231164b762dddefa13af5a0101032c70b50ef
- http://source.android.com/security/bulletin/2017-03-01.html
- http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.8.14
- https://github.com/torvalds/linux/commit/32c231164b762dddefa13af5a0101032c70b50ef
- http://www.ubuntu.com/usn/usn-3422-1
- http://www.ubuntu.com/usn/usn-3422-2
- https://usn.ubuntu.com/usn/usn-3422-1
- https://usn.ubuntu.com/usn/usn-3422-2
- https://ubuntu.com/security/notices/USN-3422-1
- https://ubuntu.com/security/notices/USN-3422-2
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/seth-arnold: |-
    The commit message includes "The same issue exists with
     l2tp_ip_bind() and l2tp_ip_bind_table" but the patch appears to fix
     only l2tp_ip_bind() and l2tp_ip6_bind.
reporters:
- Baozeng Ding
- Andrey Konovalov
introduced-by:
  aosp/3.0: [3dc6bc132f2afce8da98e0f047c4cc8ae569d6cb]
  aosp/3.4: [ea1ae37f4a2c41ea684f2e725332147eb6496026]
  mainline: [c51ce49735c183ef2592db70f918ee698716276b]
  stable/3.0: [3dc6bc132f2afce8da98e0f047c4cc8ae569d6cb]
  stable/3.2: [dc999edca1654eff8494d9eadf2ec8e951a655fe]
  stable/3.4: [ea1ae37f4a2c41ea684f2e725332147eb6496026]
fixed-by:
  aosp/3.10: [61748a926df04f68e6bcb4440a2b5ddbf1988960]
  aosp/3.18: [1e0f226a1eed143d4d815d19614111cfa11e1778]
  cip/4.4: [56366fa0ad46a59abe2460b8acb775f7f84fbf16]
  cip/4.4-rt: [56366fa0ad46a59abe2460b8acb775f7f84fbf16]
  cip/4.4-st: [56366fa0ad46a59abe2460b8acb775f7f84fbf16]
  debian/buster-security: ['version:debian/4.8.15-1']
  debian/jessie-security: ['patch:debian/3.16.43-1:bugfix/all/l2tp-fix-racy-sock_zapped-flag-check-in-l2tp_ip-6-_b.patch']
  debian/stretch-security: ['version:debian/4.8.15-1']
  mainline: [32c231164b762dddefa13af5a0101032c70b50ef]
  stable/3.12: [c20932ae0d412f1aabf3514891cdd6ae6a08ae01]
  stable/3.16: [7c3ad0d86f80618c00a5d6a267080238185038f6]
  stable/3.18: [dc57f1e18b8f484d013fd21bc89b7a5b88c3d460]
  stable/3.2: [2147a17048314f069838aace1d08b8c719448b50]
  stable/4.4: [56366fa0ad46a59abe2460b8acb775f7f84fbf16]
  stable/4.8: [84df56749f48aed274bbfd2db6b6fb9dd540ff6b]
  ubuntu/xenial: [ff5ce835f09dacaf104bb34dda50d67e20a36a44]
