description: |-
  The overlayfs implementation in the Linux kernel through 4.5.2 does not
  properly maintain POSIX ACL xattr data, which allows local users to gain
  privileges by leveraging a group-writable setgid directory.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1575
- http://www.halfdog.net/Security/2016/UserNamespaceOverlayfsXattrSetgidPrivilegeEscalation/
- http://www.ubuntu.com/usn/usn-2910-1
- http://www.ubuntu.com/usn/usn-2908-3
- http://www.ubuntu.com/usn/usn-2908-1
- http://www.ubuntu.com/usn/usn-2907-1
- http://www.ubuntu.com/usn/usn-2909-1
- http://www.ubuntu.com/usn/usn-2907-2
- http://www.ubuntu.com/usn/usn-2908-2
- https://launchpad.net/bugs/1534961
comments:
  Debian-bwh: |-
    The exploit depends on unprivileged users being able to create user
    namespaces (disallowed by default in Debian) and being able to mount
    overlayfs within a user namespace (only allowed in Ubuntu).  But it's
    possible that an administrator might accidentally set up a
    configuration that is exploitable.
    jessie is affected by a similar issue with aufs substituting for
    overlayfs.
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  Ubuntu-sbeattie: |-
    precise does not allow unprivileged user namespaces,
     which is what lets an unprivileged user exploit this vulnerability;
     however, the issue of copying up setuid attributes still exists in
     the overlayfs codebase here, but it is a much lower priority to fix
     (needs root/CAP_SYS_ADMIN to exploit).
  bwh: |-
    This appears to have been addressed in mainline by:
      3fe6e52f062643676eb4518d68cee3bc1272091b
      39a25b2b37629f65e5a1eba1b353d0b47687c2ca
      c0ca3d70e8d3cf81e2255a217f7ca402f5ed0862
      1175b6b8d96331676f1d436b089b965807f23b4a
    but it was never really vulnerable because overlayfs does not have
    the FS_USERNS_MOUNT flag.
reporters:
- halfdog
introduced-by:
  mainline: never
fixed-by:
  mainline: never
