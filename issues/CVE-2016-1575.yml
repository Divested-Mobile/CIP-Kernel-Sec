description: |-
  The overlayfs implementation in the Linux kernel through 4.5.2 does not
  properly maintain POSIX ACL xattr data, which allows local users to gain
  privileges by leveraging a group-writable setgid directory.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1575
- http://www.halfdog.net/Security/2016/UserNamespaceOverlayfsXattrSetgidPrivilegeEscalation/
- http://www.ubuntu.com/usn/usn-2910-1
- http://www.ubuntu.com/usn/usn-2908-3
- http://www.ubuntu.com/usn/usn-2908-1
- http://www.ubuntu.com/usn/usn-2907-1
- http://www.ubuntu.com/usn/usn-2909-1
- http://www.ubuntu.com/usn/usn-2907-2
- http://www.ubuntu.com/usn/usn-2908-2
- https://launchpad.net/bugs/1534961
comments:
  Debian-bwh: |-
    The exploit depends on unprivileged users being able to create user
    namespaces (disallowed by default in Debian) and being able to mount
    overlayfs within a user namespace (only allowed in Ubuntu).  But it's
    possible that an administrator might accidentally set up a
    configuration that is exploitable.
    jessie is affected by a similar issue with aufs substituting for
    overlayfs.
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  Ubuntu-sbeattie: |-
    precise does not allow unprivileged user namespaces,
     which is what lets an unprivileged user exploit this vulnerability;
     however, the issue of copying up setuid attributes still exists in
     the overlayfs codebase here, but it is a much lower priority to fix
     (needs root/CAP_SYS_ADMIN to exploit).
reporters:
- halfdog
fixed-by:
  mainline: [e9f57ebcba563e0cd532926cab83c92bb4d79360]
