description: |-
  The overlayfs implementation in the Linux kernel through 4.5.2 does not
  properly restrict the mount namespace, which allows local users to gain
  privileges by mounting an overlayfs filesystem on top of a FUSE filesystem,
  and then executing a crafted setuid program.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1576
- http://www.halfdog.net/Security/2016/OverlayfsOverFusePrivilegeEscalation/
- http://www.ubuntu.com/usn/usn-2910-1
- http://www.ubuntu.com/usn/usn-2908-3
- http://www.ubuntu.com/usn/usn-2908-1
- http://www.ubuntu.com/usn/usn-2907-1
- http://www.ubuntu.com/usn/usn-2909-1
- http://www.ubuntu.com/usn/usn-2907-2
- http://www.ubuntu.com/usn/usn-2908-2
- https://launchpad.net/bugs/1535150
- https://usn.ubuntu.com/usn/usn-2910-1
- https://usn.ubuntu.com/usn/usn-2908-3
- https://usn.ubuntu.com/usn/usn-2908-1
- https://usn.ubuntu.com/usn/usn-2907-1
- https://usn.ubuntu.com/usn/usn-2909-1
- https://usn.ubuntu.com/usn/usn-2907-2
- https://usn.ubuntu.com/usn/usn-2908-2
- https://ubuntu.com/security/notices/USN-2910-1
- https://ubuntu.com/security/notices/USN-2908-3
- https://ubuntu.com/security/notices/USN-2908-1
- https://ubuntu.com/security/notices/USN-2907-1
- https://ubuntu.com/security/notices/USN-2909-1
- https://ubuntu.com/security/notices/USN-2907-2
- https://ubuntu.com/security/notices/USN-2908-2
- https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/trusty/commit/?id=ce550fb847b34553e63ee95386de59a1096fbfc4
- https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/trusty/commit/?id=d77014a9527a4544797b9f1f2026b8e9fe032355
comments:
  bwh: |-
    Although FUSE and overlayfs can't be mounted by unprivileged users
    in mainline, it's plausible that a system might be configured to
    mount overlayfs over an untrusted lower filesystem, with the
    nosuid option set for both but not for the upper directory.  This
    can still be exploited to create a setuid-root executable in the
    upper directory.
  debian/bwh: |-
    The exploit depends on unprivileged users being able to create user
    namespaces (disallowed by default in Debian) and being able to mount
    overlayfs and FUSE within a user namespace (only allowed in Ubuntu).
    But it's possible that an administrator might accidentally set up a
    configuration that is exploitable.
    jessie is affected by a similar issue with aufs substituting for
    overlayfs.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/sbeattie: |-
    precise does not allow unprivileged user namespaces, which is
      what lets an unprivileged user exploit this vulnerability; however,
      the issue of copying up setuid attributes still exists in the
      overlayfs codebase here, but it is a much lower priority to fix
      (needs root/CAP_SYS_ADMIN to exploit).
reporters:
- halfdog
introduced-by:
  mainline: [e9be9d5e76e34872f0c37d72e25bc27fe9e2c54c]
fixed-by:
  cip/4.4: [8373f6590f6b371bff2c5f2c0581548eb0192014]
  cip/4.4-rt: [8373f6590f6b371bff2c5f2c0581548eb0192014]
  debian/buster-security: ['version:debian/4.5.1-1']
  debian/stretch-security: ['version:debian/4.5.1-1']
  mainline: [cf9a6784f7c1b5ee2b9159a1246e327c331c5697]
  stable/4.4: [8373f6590f6b371bff2c5f2c0581548eb0192014]
  ubuntu/xenial: [8373f6590f6b371bff2c5f2c0581548eb0192014]
ignore:
  cip/4.19-rt: No member enables overlayfs
  cip/4.4-rt: No member enables overlayfs
tests:
- CVE-2016-1576
