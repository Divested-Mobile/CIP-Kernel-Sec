description: |-
  The netfilter subsystem in the Linux kernel through 4.5.2 does not validate
  certain offset fields, which allows local users to gain privileges or cause
  a denial of service (heap memory corruption) via an IPT_SO_SET_REPLACE
  setsockopt call.
references:
- https://code.google.com/p/google-security-research/issues/detail?id=758
- http://marc.info/?l=netfilter-devel&m=145757134822741&w=2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3134
- http://www.openwall.com/lists/oss-security/2016/03/14/1
- http://www.ubuntu.com/usn/usn-2931-1
- http://www.ubuntu.com/usn/usn-2932-1
- http://www.ubuntu.com/usn/usn-2930-1
- http://www.ubuntu.com/usn/usn-2930-2
- http://www.ubuntu.com/usn/usn-2929-2
- http://www.ubuntu.com/usn/usn-2929-1
- http://www.ubuntu.com/usn/usn-2930-3
- http://www.ubuntu.com/usn/usn-3049-1
- http://www.ubuntu.com/usn/usn-3050-1
- https://launchpad.net/bugs/1555338
- https://patchwork.ozlabs.org/patch/595575/
- https://patchwork.ozlabs.org/patch/599721/
- https://git.kernel.org/cgit/linux/kernel/git/davem/net.git/commit?id=bdf533de6968e9686df777dc178486f600c6e617
- https://git.kernel.org/cgit/linux/kernel/git/davem/net.git/commit?id=6e94e0cfb0887e4013b3b930fa6ab1fe6bb6ba91
comments:
  Debian-bwh: The upstream fixes (in davem/net.git) are the last two listed above
  Debian-carnil: |-
    Can be triggered by an unprivileged user on PF_INET sockets when
    unprivileged user namespaces are available (CONFIG_USER_NS=y)
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Ben Hawkes
fixed-by:
  mainline: [bdf533de6968e9686df777dc178486f600c6e617, 6e94e0cfb0887e4013b3b930fa6ab1fe6bb6ba91]
