description: |-
  The netfilter subsystem in the Linux kernel through 4.5.2 does not validate
  certain offset fields, which allows local users to gain privileges or cause
  a denial of service (heap memory corruption) via an IPT_SO_SET_REPLACE
  setsockopt call.
references:
- https://code.google.com/p/google-security-research/issues/detail?id=758
- http://marc.info/?l=netfilter-devel&m=145757134822741&w=2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3134
- http://www.openwall.com/lists/oss-security/2016/03/14/1
- http://www.ubuntu.com/usn/usn-2931-1
- http://www.ubuntu.com/usn/usn-2932-1
- http://www.ubuntu.com/usn/usn-2930-1
- http://www.ubuntu.com/usn/usn-2930-2
- http://www.ubuntu.com/usn/usn-2929-2
- http://www.ubuntu.com/usn/usn-2929-1
- http://www.ubuntu.com/usn/usn-2930-3
- http://www.ubuntu.com/usn/usn-3049-1
- http://www.ubuntu.com/usn/usn-3050-1
- https://launchpad.net/bugs/1555338
- https://patchwork.ozlabs.org/patch/595575/
- https://patchwork.ozlabs.org/patch/599721/
- https://git.kernel.org/cgit/linux/kernel/git/davem/net.git/commit?id=bdf533de6968e9686df777dc178486f600c6e617
- https://git.kernel.org/cgit/linux/kernel/git/davem/net.git/commit?id=6e94e0cfb0887e4013b3b930fa6ab1fe6bb6ba91
- https://usn.ubuntu.com/usn/usn-2931-1
- https://usn.ubuntu.com/usn/usn-2932-1
- https://usn.ubuntu.com/usn/usn-2930-1
- https://usn.ubuntu.com/usn/usn-2930-2
- https://usn.ubuntu.com/usn/usn-2929-2
- https://usn.ubuntu.com/usn/usn-2929-1
- https://usn.ubuntu.com/usn/usn-2930-3
- https://usn.ubuntu.com/usn/usn-3049-1
- https://usn.ubuntu.com/usn/usn-3050-1
- https://ubuntu.com/security/notices/USN-2931-1
- https://ubuntu.com/security/notices/USN-2932-1
- https://ubuntu.com/security/notices/USN-2930-1
- https://ubuntu.com/security/notices/USN-2930-2
- https://ubuntu.com/security/notices/USN-2929-2
- https://ubuntu.com/security/notices/USN-2929-1
- https://ubuntu.com/security/notices/USN-2930-3
- https://ubuntu.com/security/notices/USN-3049-1
- https://ubuntu.com/security/notices/USN-3050-1
- https://www.cve.org/CVERecord?id=CVE-2016-3134
comments:
  debian/bwh: The upstream fixes (in davem/net.git) are the last two listed above
  debian/carnil: |-
    Can be triggered by an unprivileged user on PF_INET sockets when
    unprivileged user namespaces are available (CONFIG_USER_NS=y)
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Ben Hawkes
fixed-by:
  aosp/3.18: [6a401cf3a41e2248469b1fdcee629445e824ca5b, 66b7376b20058801e027cc269090e555433383ac]
  cip/4.4: [59ff9f9b38b39afeb167fdc16c52976587b2c45a, 868fe2536f8741ebf807ed717734e6c321c478e9]
  cip/4.4-rt: [59ff9f9b38b39afeb167fdc16c52976587b2c45a, 868fe2536f8741ebf807ed717734e6c321c478e9]
  cip/4.4-st: [59ff9f9b38b39afeb167fdc16c52976587b2c45a, 868fe2536f8741ebf807ed717734e6c321c478e9]
  debian/buster-security: ['patch:debian/4.5.1-1:bugfix/all/netfilter-x_tables-validate-e-target_offset-early.patch',
    'patch:debian/4.5.1-1:bugfix/all/netfilter-x_tables-make-sure-e-next_offset-covers-re.patch']
  debian/jessie-security: ['patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-validate-e-target_offset-early.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-make-sure-e-next_offset-covers-remaining-blob.patch']
  debian/stretch-security: ['patch:debian/4.5.1-1:bugfix/all/netfilter-x_tables-validate-e-target_offset-early.patch',
    'patch:debian/4.5.1-1:bugfix/all/netfilter-x_tables-make-sure-e-next_offset-covers-re.patch']
  mainline: [bdf533de6968e9686df777dc178486f600c6e617, 6e94e0cfb0887e4013b3b930fa6ab1fe6bb6ba91]
  stable/3.10: [0608074c2c1fd874b10117c07b2751d2477bec14, 74afad874aaeef7ef5b500366a0e271fb5b265c3]
  stable/3.12: [099f87c4f3dae7c3816feb32a754fd9cf8cd4298, 8bdb7e5ec74fd7314be5f8dd919fbd738fb8b431]
  stable/3.14: [411c8508d4d0cb1e75343da53aaf26764bf4b9fe, e0b84cd87763c3bd442a06942ca90a60a7e152e7]
  stable/3.16: [dc385be2ea9842289d27ac3e187a51b6f3d28559, 113ec64467f005e175f3de2cec1d581e8c7b69ef]
  stable/3.18: [6a401cf3a41e2248469b1fdcee629445e824ca5b, 66b7376b20058801e027cc269090e555433383ac]
  stable/3.2: [2fcf67674aeafe62db7b17091050b811883524fe, b8cea33c6279e43cf0a222f3709f54e7d7c5a9be]
  stable/4.1: [780daa25f811f1aeefb9da76ef93c32b17a5f102, a1c49d8cf9aa2be958c34fae1f84b1e3006f0c67]
  stable/4.4: [59ff9f9b38b39afeb167fdc16c52976587b2c45a, 868fe2536f8741ebf807ed717734e6c321c478e9]
  ubuntu/xenial: [c80600e63a82dc948954a7583bd2ffd43cca9486, 386e7d8b331c9cfdd8e994f49a08db667199b0b1,
    426cebe4f7bf8f98649fdee7759d29ff5de47f50]
