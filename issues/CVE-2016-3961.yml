description: |-
  Xen and the Linux kernel through 4.5.x do not properly suppress hugetlbfs
  support in x86 PV guests, which allows local PV guest OS users to cause a
  denial of service (guest OS crash) by attempting to access a hugetlbfs
  mapped area.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-3961
- http://xenbits.xen.org/xsa/advisory-174.html
- http://www.ubuntu.com/usn/usn-3001-1
- http://www.ubuntu.com/usn/usn-3002-1
- http://www.ubuntu.com/usn/usn-3003-1
- http://www.ubuntu.com/usn/usn-3004-1
- http://www.ubuntu.com/usn/usn-3005-1
- http://www.ubuntu.com/usn/usn-3006-1
- http://www.ubuntu.com/usn/usn-3007-1
- http://www.ubuntu.com/usn/usn-3049-1
- http://www.ubuntu.com/usn/usn-3050-1
- http://www.ubuntu.com/usn/usn-3127-1
- http://www.ubuntu.com/usn/usn-3127-2
- https://launchpad.net/bugs/1571020
- https://usn.ubuntu.com/usn/usn-3001-1
- https://usn.ubuntu.com/usn/usn-3002-1
- https://usn.ubuntu.com/usn/usn-3003-1
- https://usn.ubuntu.com/usn/usn-3004-1
- https://usn.ubuntu.com/usn/usn-3005-1
- https://usn.ubuntu.com/usn/usn-3006-1
- https://usn.ubuntu.com/usn/usn-3007-1
- https://usn.ubuntu.com/usn/usn-3049-1
- https://usn.ubuntu.com/usn/usn-3050-1
- https://usn.ubuntu.com/usn/usn-3127-1
- https://usn.ubuntu.com/usn/usn-3127-2
- https://ubuntu.com/security/notices/USN-3001-1
- https://ubuntu.com/security/notices/USN-3002-1
- https://ubuntu.com/security/notices/USN-3003-1
- https://ubuntu.com/security/notices/USN-3004-1
- https://ubuntu.com/security/notices/USN-3005-1
- https://ubuntu.com/security/notices/USN-3006-1
- https://ubuntu.com/security/notices/USN-3007-1
- https://ubuntu.com/security/notices/USN-3049-1
- https://ubuntu.com/security/notices/USN-3050-1
- https://ubuntu.com/security/notices/USN-3127-1
- https://ubuntu.com/security/notices/USN-3127-2
- https://www.cve.org/CVERecord?id=CVE-2016-3961
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Vitaly Kuznetsov
fixed-by:
  aosp/3.18: [24b769352bd519d6d932ea070e295e8b13f43af8]
  cip/4.4: [27b3cc048a5275c53e26c15ffcab3fcf9a03cda0]
  cip/4.4-rt: [27b3cc048a5275c53e26c15ffcab3fcf9a03cda0]
  cip/4.4-st: [27b3cc048a5275c53e26c15ffcab3fcf9a03cda0]
  debian/buster-security: ['patch:debian/4.5.2-1:bugfix/x86/x86-xen-suppress-hugetlbfs-in-PV-guests.patch']
  debian/jessie-security: ['patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/mm-hugetlb-allow-hugepages_supported-to-be-architect.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/x86/x86-mm-xen-Suppress-hugetlbfs-in-PV-guests.patch']
  debian/stretch-security: ['patch:debian/4.5.2-1:bugfix/x86/x86-xen-suppress-hugetlbfs-in-PV-guests.patch']
  mainline: [103f6112f253017d7062cd74d17f4a514ed4485c]
  stable/3.10: [0679df0fff349dd7e8d3d7fb3e162bdf6949c873]
  stable/3.12: [b0363263e57199808d17e597df74cbdb28abbe55]
  stable/3.16: [27c03f880236b5e3c48af4d8848916bea8a5d88a]
  stable/3.18: [24b769352bd519d6d932ea070e295e8b13f43af8]
  stable/3.2: [2ecc8cfb833a45c8df005209fbd6e0382cf3c0b1]
  stable/4.1: [936d0871135e41fba0dc15095319ca106f55a584]
  stable/4.4: [27b3cc048a5275c53e26c15ffcab3fcf9a03cda0]
  stable/4.5: [d5e81d34ceadad4174a61c9bf910b89a32509581]
  ubuntu/xenial: [131e847f351f748150bcf1be875376fa41295390]
