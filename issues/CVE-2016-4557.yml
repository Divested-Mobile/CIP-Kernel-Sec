description: UAF via double-fdput() in bpf(BPF_PROG_LOAD) error path
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=808
comments:
  debian: |-
    Introduced by: https://git.kernel.org/linus/0246e64d9a5fcd4805198de59b9b5cf1f974eb41 (v3.18-rc1)
    Exploitable since: https://git.kernel.org/linus/1be7f75d1668d6296b80bf35dcf6762393530afc (v4.4-rc1)
fixed-by:
  aosp/3.18: [79670803a0f8a18cac93556767750ead132d318c]
  cip/4.4: [608d2c3c7a046c222cae2e857cf648a9f89e772b]
  cip/4.4-rt: [608d2c3c7a046c222cae2e857cf648a9f89e772b]
  debian/buster-security: &id001 ['patch:debian/4.5.3-1:bugfix/all/bpf-fix-double-fdput-in-replace_map_fd_with_map_ptr.patch']
  debian/stretch-security: *id001
  mainline: [8358b02bf67d3a5d8a825070e1aa73f25fb2e4c7]
  stable/3.18: [79670803a0f8a18cac93556767750ead132d318c]
  stable/4.4: [608d2c3c7a046c222cae2e857cf648a9f89e772b]
