description: Use-after-free in pcpu_extend_area_map, triggered by bpf()
references:
- 'Reproducer: http://www.openwall.com/lists/oss-security/2016/05/12/6'
- http://thread.gmane.org/gmane.linux.network/408459/
- http://article.gmane.org/gmane.linux.kernel/2227891
- http://article.gmane.org/gmane.linux.kernel/2227892
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4794
- https://usn.ubuntu.com/usn/usn-3053-1
- https://usn.ubuntu.com/usn/usn-3054-1
- https://usn.ubuntu.com/usn/usn-3055-1
- https://usn.ubuntu.com/usn/usn-3056-1
- https://usn.ubuntu.com/usn/usn-3057-1
- https://launchpad.net/bugs/1581871
comments:
  debian/bwh: |-
    It's not clear whether this is specific to bpf() or an existing bug
    that's now easier to hit (and exploit).
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Sasha Levin
fixed-by:
  debian/buster-security: &id001 ['patch:debian/4.6.2-2:bugfix/all/percpu-fix-synchronization-between-chunk-map_extend_.patch',
    'patch:debian/4.6.2-2:bugfix/all/percpu-fix-synchronization-between-synchronous-map-e.patch']
  debian/stretch-security: *id001
  mainline: [4f996e234dad488e5d9ba0858bc1bae12eff82c3, 6710e594f71ccaad8101bc64321152af7cd9ea28]
