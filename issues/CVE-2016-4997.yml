description: |-
  The compat IPT_SO_SET_REPLACE and IP6T_SO_SET_REPLACE setsockopt
  implementations in the netfilter subsystem in the Linux kernel before 4.6.3
  allow local users to gain privileges or cause a denial of service (memory
  corruption) by leveraging in-container root access to provide a crafted
  offset value that triggers an unintended decrement.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4997
- https://marc.info/?l=oss-security&m=146679591706851&w=2
- http://www.ubuntu.com/usn/usn-3016-1
- http://www.ubuntu.com/usn/usn-3016-2
- http://www.ubuntu.com/usn/usn-3017-1
- http://www.ubuntu.com/usn/usn-3017-3
- http://www.ubuntu.com/usn/usn-3016-3
- http://www.ubuntu.com/usn/usn-3016-4
- http://www.ubuntu.com/usn/usn-3017-2
- http://www.ubuntu.com/usn/usn-3020-1
- http://www.ubuntu.com/usn/usn-3018-2
- http://www.ubuntu.com/usn/usn-3018-1
- http://www.ubuntu.com/usn/usn-3019-1
- http://www.ubuntu.com/usn/usn-3338-1
- https://usn.ubuntu.com/usn/usn-3016-1
- https://usn.ubuntu.com/usn/usn-3016-2
- https://usn.ubuntu.com/usn/usn-3017-1
- https://usn.ubuntu.com/usn/usn-3017-3
- https://usn.ubuntu.com/usn/usn-3016-3
- https://usn.ubuntu.com/usn/usn-3016-4
- https://usn.ubuntu.com/usn/usn-3017-2
- https://usn.ubuntu.com/usn/usn-3020-1
- https://usn.ubuntu.com/usn/usn-3018-2
- https://usn.ubuntu.com/usn/usn-3018-1
- https://usn.ubuntu.com/usn/usn-3019-1
- https://usn.ubuntu.com/usn/usn-3338-1
- https://ubuntu.com/security/notices/USN-3016-1
- https://ubuntu.com/security/notices/USN-3016-2
- https://ubuntu.com/security/notices/USN-3017-1
- https://ubuntu.com/security/notices/USN-3017-3
- https://ubuntu.com/security/notices/USN-3016-3
- https://ubuntu.com/security/notices/USN-3016-4
- https://ubuntu.com/security/notices/USN-3017-2
- https://ubuntu.com/security/notices/USN-3020-1
- https://ubuntu.com/security/notices/USN-3018-2
- https://ubuntu.com/security/notices/USN-3018-1
- https://ubuntu.com/security/notices/USN-3019-1
- https://ubuntu.com/security/notices/USN-3338-1
- https://www.cve.org/CVERecord?id=CVE-2016-4997
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/sbeattie: |-
    priority is negligible on precise's 3.2 kernels, as user
      namespaces are a privileged operation there.
    For xenial and linux-lts-xenial on trusty, this can be
      mitigated against by setting the kernel.unprivileged_userns_clone
      sysctl to 0 to disable userns support. When we fix the netfilter issue
      we will also add this sysctl to all other supported kernels to allow
      disabling unprivileged user namespaces. Disabling user namespace may
      impact chromium-browser, lxc, lxd, docker, and other tools.
reporters:
- Jesse Hertz
- Tim Newsham
fixed-by:
  aosp/3.18: [7ef13f496d3bc0db5ce42451a6036c504cf6a7d6, 7ba6a7dfbf7c37aa1984db170a015dded04adc81]
  cip/4.4: [2985d199e713c05eec2eaffeeeac40682aa2e5cc, 8a865621540c7bc7f03665a2b7029cb444a9593a]
  cip/4.4-rt: [2985d199e713c05eec2eaffeeeac40682aa2e5cc, 8a865621540c7bc7f03665a2b7029cb444a9593a]
  cip/4.4-st: [2985d199e713c05eec2eaffeeeac40682aa2e5cc, 8a865621540c7bc7f03665a2b7029cb444a9593a]
  debian/buster-security: ['patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-add-compat-version-of-xt_check_en.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-check-for-bogus-target-offset.patch']
  debian/jessie-security: ['patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-add-compat-version-of-xt_check_en.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-check-for-bogus-target-offset.patch']
  debian/stretch-security: ['patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-add-compat-version-of-xt_check_en.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-check-for-bogus-target-offset.patch']
  mainline: [fc1221b3a163d1386d1052184202d5dc50d302d1, ce683e5f9d045e5d67d1312a42b359cb2ab2a13c]
  stable/3.10: [305323325e044e78afe63dfd4444a21b21ecb804, 71f72bbf29981206b98845c7ac8b8d1d7d44fa55]
  stable/3.12: [45c465bb1b42bb6869ffaf023432b23a889fd6f5, 1812c704ac70a37c06f239d7c06fd4331a25c779]
  stable/3.14: [726ee5ed2d8b2ae00e21b4b261f6311215683aff, f216289025f02e99628d6783f251f3a9d1966cad]
  stable/3.16: [76db4db16a83b74db2bf8136305a73dd23d5cbd0, 35ea6762cc084057963af3833c77cf2906461b75]
  stable/3.18: [7ef13f496d3bc0db5ce42451a6036c504cf6a7d6, 7ba6a7dfbf7c37aa1984db170a015dded04adc81]
  stable/4.1: [acbcf85306bd563910a2afe07f07d30381b031b0, 451e4403bc4abc51539376d4314baa739ab9e996]
  stable/4.4: [2985d199e713c05eec2eaffeeeac40682aa2e5cc, 8a865621540c7bc7f03665a2b7029cb444a9593a]
  stable/4.6: [0406d64a5de5676fb0c29e3f32cb0450fceab683, 98e02ab689f15b088f8d0baade85280ab21867b5]
  ubuntu/xenial: [ec8ef5fb46af2ffb61ccc12d1b44875d1c5a5503, 69a95dd918e1445fb8a71df094116dee6d14fd3e]
ignore:
  stable/3.2: too many changes required, and netfilter is not exposed to unprivileged
    users
