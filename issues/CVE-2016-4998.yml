description: |-
  The IPT_SO_SET_REPLACE setsockopt implementation in the netfilter subsystem
  in the Linux kernel before 4.6 allows local users to cause a denial of
  service (out-of-bounds read) or possibly obtain sensitive information from
  kernel heap memory by leveraging in-container root access to provide a
  crafted offset value that leads to crossing a ruleset blob boundary.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4998
- https://marc.info/?l=oss-security&m=146679591706851&w=2
- http://www.ubuntu.com/usn/usn-3016-1
- http://www.ubuntu.com/usn/usn-3016-2
- http://www.ubuntu.com/usn/usn-3017-1
- http://www.ubuntu.com/usn/usn-3017-3
- http://www.ubuntu.com/usn/usn-3016-3
- http://www.ubuntu.com/usn/usn-3016-4
- http://www.ubuntu.com/usn/usn-3017-2
- http://www.ubuntu.com/usn/usn-3020-1
- http://www.ubuntu.com/usn/usn-3018-2
- http://www.ubuntu.com/usn/usn-3018-1
- http://www.ubuntu.com/usn/usn-3019-1
- https://usn.ubuntu.com/usn/usn-3016-1
- https://usn.ubuntu.com/usn/usn-3016-2
- https://usn.ubuntu.com/usn/usn-3017-1
- https://usn.ubuntu.com/usn/usn-3017-3
- https://usn.ubuntu.com/usn/usn-3016-3
- https://usn.ubuntu.com/usn/usn-3016-4
- https://usn.ubuntu.com/usn/usn-3017-2
- https://usn.ubuntu.com/usn/usn-3020-1
- https://usn.ubuntu.com/usn/usn-3018-2
- https://usn.ubuntu.com/usn/usn-3018-1
- https://usn.ubuntu.com/usn/usn-3019-1
- https://ubuntu.com/security/notices/USN-3016-1
- https://ubuntu.com/security/notices/USN-3016-2
- https://ubuntu.com/security/notices/USN-3017-1
- https://ubuntu.com/security/notices/USN-3017-3
- https://ubuntu.com/security/notices/USN-3016-3
- https://ubuntu.com/security/notices/USN-3016-4
- https://ubuntu.com/security/notices/USN-3017-2
- https://ubuntu.com/security/notices/USN-3020-1
- https://ubuntu.com/security/notices/USN-3018-2
- https://ubuntu.com/security/notices/USN-3018-1
- https://ubuntu.com/security/notices/USN-3019-1
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/seth-arnold: Can be mitigated against by a sysctl to disable userns support
reporters:
- Jesse Hertz
- Tim Newsham
fixed-by:
  aosp/3.18: [62e6fd2010f76a52adcf0cf016b5d7c402ec17aa, 37a6fed6bcd018561cf18ddef42f6f6e106b220e,
    c1380ecb022aacfc852426e182aa285420d18c9f, 3b94ada46f61938d9c49aa198fe560b1f8faea79]
  cip/4.4: [cfdca13028ff3aa8c5f4b63ba5abf878cd55ced5, ed30e07de077354993122c5d88e535cbe0a03754,
    2066499780e1455c43833b5b34858124047331ff, caa39a1e709c3cf89c0a4d600e98f9863085e3d5]
  cip/4.4-rt: [cfdca13028ff3aa8c5f4b63ba5abf878cd55ced5, ed30e07de077354993122c5d88e535cbe0a03754,
    2066499780e1455c43833b5b34858124047331ff, caa39a1e709c3cf89c0a4d600e98f9863085e3d5]
  cip/4.4-st: [cfdca13028ff3aa8c5f4b63ba5abf878cd55ced5, ed30e07de077354993122c5d88e535cbe0a03754,
    2066499780e1455c43833b5b34858124047331ff, caa39a1e709c3cf89c0a4d600e98f9863085e3d5]
  debian/buster-security: ['patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-add-and-use-xt_check_entry_offset.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-assert-minimum-target-size.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-check-standard-target-size-too.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-validate-all-offsets-and-sizes-in.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-don-t-reject-valid-target-size-on.patch']
  debian/jessie-security: ['patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-add-and-use-xt_check_entry_offset.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-assert-minimum-target-size.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-check-standard-target-size-too.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-validate-all-offsets-and-sizes-in.patch',
    'patch:debian/3.16.7-ckt25-2+deb8u1:bugfix/all/netfilter-x_tables-don-t-reject-valid-target-size-on.patch']
  debian/stretch-security: ['patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-add-and-use-xt_check_entry_offset.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-assert-minimum-target-size.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-check-standard-target-size-too.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-validate-all-offsets-and-sizes-in.patch',
    'patch:debian/4.6.2-2:bugfix/all/netfilter-x_tables-don-t-reject-valid-target-size-on.patch']
  mainline: [7d35812c3214afa5b37a675113555259cfd67b98, a08e4e190b866579896c09af59b3bdca821da2cd,
    7ed2abddd20cf8f6bd27f65bd218f26fa5bf7f44, 13631bfc604161a9d69cd68991dff8603edd66f9]
  stable/3.10: [ff9be2063c1c029e9ee4951882fb64387fa21ede, 6b9f8b74d347c956239e4538b1c3427cc5ea3ede,
    5366deb60a8c3673af8cce77cd137cd96eadf3a6, 1b507b9259b31b83303a1787bb88473ebee04402]
  stable/3.12: [d1b53f828e25976196e2a3f0397c98ebe7fc330c, d5056b9bfd3427c962b3493301fa92a0a901acc7,
    caa0e0bfbda8c8e38dec7a907b6365014e0e5659, e86abb821430e92339a50aaf1f5dd8685f19b184]
  stable/3.14: [d05223d69cd7587086c8780721cd58fae9ab2c7b, 412f0324bf5f7d719ee0cf8d9610745b1a11cb7b,
    4a3285cb417e2a55899efd6a87214c71b7e78f68, 0e709dd7cc938ae1f4d783e9e389c13df152a657]
  stable/3.16: [b39be8f1537f6a136f711ab637ffee5d866cd9c0, b58ceab2ddb76114c22da82003567a146aa02412,
    523e5f8924172c7b2f3217e832137076aebc20ee, 592d29f29d4b6f38879a51d8428bb61c7d430e44]
  stable/3.18: [62e6fd2010f76a52adcf0cf016b5d7c402ec17aa, 37a6fed6bcd018561cf18ddef42f6f6e106b220e,
    c1380ecb022aacfc852426e182aa285420d18c9f, 3b94ada46f61938d9c49aa198fe560b1f8faea79]
  stable/4.1: [a471ac817cf0e0d6e87779ca1fee216ba849e613, aae91919c9d6d1aa6d6390826979e6d2c89a7ba4,
    73bfda1c492bef7038a87adfa887b7e6b7cd6679, a605e7476c66a13312189026e6977bad6ed3050d]
  stable/4.4: [cfdca13028ff3aa8c5f4b63ba5abf878cd55ced5, ed30e07de077354993122c5d88e535cbe0a03754,
    2066499780e1455c43833b5b34858124047331ff, caa39a1e709c3cf89c0a4d600e98f9863085e3d5]
  stable/4.6: [c164b34eaaa38fd49383996a6af4d65183bf289c, 3902b6dcc704a07dbf79df7ba3cab990b808b6de,
    71437bbb15d0ab06e344e8642895f59d18758ca7, 04704bca3eef35f8874221750e11fad72b0764a3]
  ubuntu/xenial: [62016e963e830566c0090c9b9bf8f08726e2df3c, 010b2bfe85b48a5d7968fbf687e9a2377b34c7cc,
    1022a072f5bb95d5344c5e6063e1ff6dbb9b6e7a, 4b342e28d9ea5019551b84402b8dab1e2d78b884]
ignore:
  stable/3.2: too many changes required, and netfilter is not exposed to unprivileged
    users
