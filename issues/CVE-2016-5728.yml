description: Race condition in the vop_ioctl function in drivers/misc/mic/vop/vop_vringh.c
  in the MIC VOP driver in the Linux kernel before 4.6.1 allows local users to obtain
  sensitive information from kernel memory or cause a denial of service (memory corruption
  and system crash) by changing a certain header, aka a "double fetch" vulnerability.
references:
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=9bf292bfca94694a721449e3fd752493856710f6
- http://www.debian.org/security/2016/dsa-3616
- http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.6.1
- http://www.securityfocus.com/archive/1/538802/30/0/threaded
- http://www.ubuntu.com/usn/USN-3070-1
- http://www.ubuntu.com/usn/USN-3070-2
- http://www.ubuntu.com/usn/USN-3070-3
- http://www.ubuntu.com/usn/USN-3070-4
- http://www.ubuntu.com/usn/USN-3071-1
- http://www.ubuntu.com/usn/USN-3071-2
- https://bugzilla.kernel.org/show_bug.cgi?id=116651
- https://github.com/torvalds/linux/commit/9bf292bfca94694a721449e3fd752493856710f6
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5728
- https://ubuntu.com/security/notices/USN-3070-1
- https://ubuntu.com/security/notices/USN-3071-2
- https://ubuntu.com/security/notices/USN-3071-1
- https://ubuntu.com/security/notices/USN-3070-4
- https://ubuntu.com/security/notices/USN-3070-3
- https://ubuntu.com/security/notices/USN-3070-2
- https://www.cve.org/CVERecord?id=CVE-2016-5728
comments:
  debian: |-
    From Red Hat Bugzilla: The VOP driver is "new" in the 4.6 kernel only
    in that the functionality was moved out of the host MIC driver into a
    new driver entirely with commit
    61e9c905df78c253752971e200f0ac6d8667dda6.  Prior to that, the
    functionality was in the drivers/misc/mic/host/mic_virtio.c host driver,
    which was introduced with commit f69bcbf3b4c4 (v3.13).
    .
    If you look at versions of the kernel prior to 4.6, you will see the
    code sequence that is fixed by the mentioned upstream patch is still in
    the host driver in the mic_copy_dp_entry function.  That needs to be
    patched with a similar fix.
    .
    Introduced in 3.13-rc1 with f69bcbf3b4c4b333dcd7a48eaf868bf0c88edab5
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Pengfei Wang
introduced-by:
  mainline: [f69bcbf3b4c4b333dcd7a48eaf868bf0c88edab5]
fixed-by:
  debian/buster-security: ['patch:debian/4.6.1-1:2a9369456a384d84c521c8ebb48d247e8738f84f']
  debian/stretch-security: ['patch:debian/4.6.1-1:2a9369456a384d84c521c8ebb48d247e8738f84f']
  mainline: [9bf292bfca94694a721449e3fd752493856710f6]
  ubuntu/xenial: [7913b43902841ea41118d3ecd3cd2914321e9068]
