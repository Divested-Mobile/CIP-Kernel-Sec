description: |-
  fs/overlayfs/dir.c in the OverlayFS filesystem implementation in the Linux
  kernel before 4.6 does not properly verify the upper dentry before
  proceeding with unlink and rename system-call processing, which allows
  local users to cause a denial of service (system crash) via a rename system
  call that specifies a self-hardlink.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6197
- http://openwall.com/lists/oss-security/2016/07/11/7
- https://github.com/linux-test-project/ltp/blob/master/testcases/kernel/syscalls/rename/rename13.c
- http://www.ubuntu.com/usn/usn-3070-1
- http://www.ubuntu.com/usn/usn-3070-4
- http://www.ubuntu.com/usn/usn-3070-3
- http://www.ubuntu.com/usn/usn-3070-2
- https://usn.ubuntu.com/usn/usn-3070-1
- https://usn.ubuntu.com/usn/usn-3070-4
- https://usn.ubuntu.com/usn/usn-3070-3
- https://usn.ubuntu.com/usn/usn-3070-2
- https://ubuntu.com/security/notices/USN-3070-1
- https://ubuntu.com/security/notices/USN-3070-4
- https://ubuntu.com/security/notices/USN-3070-3
- https://ubuntu.com/security/notices/USN-3070-2
comments:
  debian: OverlayFS introduced in 3.18-rc2
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
introduced-by:
  mainline: [e9be9d5e76e34872f0c37d72e25bc27fe9e2c54c]
fixed-by:
  aosp/3.18: [664c0d5765af3d2f8b36293310297c5e00ef304c]
  cip/4.4: [dbf72a4d4531e7e5fb28e76d902d66f05c1bfe12]
  cip/4.4-rt: [dbf72a4d4531e7e5fb28e76d902d66f05c1bfe12]
  debian/buster-security: ['version:debian/4.6.1-1']
  debian/stretch-security: ['version:debian/4.6.1-1']
  mainline: [11f3710417d026ea2f4fcf362d866342c5274185]
  stable/4.1: [6412c3ae6b415ca83264a2c11e24bfb63cd74629]
  stable/4.4: [dbf72a4d4531e7e5fb28e76d902d66f05c1bfe12]
  ubuntu/xenial: [a4452ab01db4780937d4e19861d3b841c373c3b5]
