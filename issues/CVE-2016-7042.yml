description: |-
  The proc_keys_show function in security/keys/proc.c in the Linux kernel
  through 4.8.2, when the GNU Compiler Collection (gcc) stack protector is
  enabled, uses an incorrect buffer size for certain timeout data, which
  allows local users to cause a denial of service (stack memory corruption
  and panic) by reading the /proc/keys file.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7042
- https://bugzilla.redhat.com/show_bug.cgi?id=1373966
- https://bugzilla.redhat.com/show_bug.cgi?id=1373499
- http://www.openwall.com/lists/oss-security/2016/10/13/5
- http://www.ubuntu.com/usn/usn-3127-1
- http://www.ubuntu.com/usn/usn-3127-2
- http://www.ubuntu.com/usn/usn-3126-1
- http://www.ubuntu.com/usn/usn-3126-2
- http://www.ubuntu.com/usn/usn-3128-1
- http://www.ubuntu.com/usn/usn-3128-2
- http://www.ubuntu.com/usn/usn-3128-3
- http://www.ubuntu.com/usn/usn-3129-1
- http://www.ubuntu.com/usn/usn-3129-2
- http://www.ubuntu.com/usn/usn-3161-3
- https://bugzilla.redhat.com/show_bug.cgi?id=1373499 (reproducer, patch)
- https://usn.ubuntu.com/usn/usn-3127-1
- https://usn.ubuntu.com/usn/usn-3127-2
- https://usn.ubuntu.com/usn/usn-3126-1
- https://usn.ubuntu.com/usn/usn-3126-2
- https://usn.ubuntu.com/usn/usn-3128-1
- https://usn.ubuntu.com/usn/usn-3128-2
- https://usn.ubuntu.com/usn/usn-3128-3
- https://usn.ubuntu.com/usn/usn-3129-1
- https://usn.ubuntu.com/usn/usn-3129-2
- https://usn.ubuntu.com/usn/usn-3161-3
- https://ubuntu.com/security/notices/USN-3127-1
- https://ubuntu.com/security/notices/USN-3127-2
- https://ubuntu.com/security/notices/USN-3126-1
- https://ubuntu.com/security/notices/USN-3126-2
- https://ubuntu.com/security/notices/USN-3128-1
- https://ubuntu.com/security/notices/USN-3128-2
- https://ubuntu.com/security/notices/USN-3128-3
- https://ubuntu.com/security/notices/USN-3129-1
- https://ubuntu.com/security/notices/USN-3129-2
- https://ubuntu.com/security/notices/USN-3161-3
- https://www.cve.org/CVERecord?id=CVE-2016-7042
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/sbeattie: fix is commit 03dab869b7b239c4e013ec82aea22e181e441cfc
reporters:
- Ondrej Kozina
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  aosp/3.18: [abe571f80e33d3df7741d15cd03a8b95a93f659f]
  cip/4.4: [940d7ecbc57c94d6cd174d9d3247e07fd1b1467d]
  cip/4.4-rt: [940d7ecbc57c94d6cd174d9d3247e07fd1b1467d]
  cip/4.4-st: [940d7ecbc57c94d6cd174d9d3247e07fd1b1467d]
  debian/buster-security: ['patch:debian/4.7.8-1:bugfix/all/KEYS-Fix-short-sprintf-buffer-in-proc-keys-show-func.patch']
  debian/jessie-security: ['patch:debian/3.16.36-1+deb8u2:bugfix/all/KEYS-Fix-short-sprintf-buffer-in-proc-keys-show-func.patch']
  debian/stretch-security: ['patch:debian/4.7.8-1:bugfix/all/KEYS-Fix-short-sprintf-buffer-in-proc-keys-show-func.patch']
  mainline: [03dab869b7b239c4e013ec82aea22e181e441cfc]
  stable/3.10: [b9eabdf01038d11a75b9361f71e86b857faaf404]
  stable/3.12: [cd93b7f830c1fa1cb35146c701ce8eecb2b19c44]
  stable/3.16: [dbc969a232a97c001f6c5f7b4b5e0de4dca4fe84]
  stable/3.18: [abe571f80e33d3df7741d15cd03a8b95a93f659f]
  stable/3.2: [b70315cfd846c29a85c7348c4ff948fa54252d3a]
  stable/4.1: [3dc8f1f0decb5f022b3be2cc98c7163a376556c9]
  stable/4.4: [940d7ecbc57c94d6cd174d9d3247e07fd1b1467d]
  stable/4.8: [5daa841d04370f5234aab2a6b63702584c1be608]
  ubuntu/xenial: [a23a1fb0109473ec3f3af0403a8cc143d6fd8d3c]
