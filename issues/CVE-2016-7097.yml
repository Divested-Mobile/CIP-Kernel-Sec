description: |-
  The filesystem implementation in the Linux kernel through 4.8.2 preserves
  the setgid bit during a setxattr call, which allows local users to gain
  group privileges by leveraging the existence of a setgid program with
  restrictions on execute permissions.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-7097
- http://www.spinics.net/lists/linux-fsdevel/msg98328.html
- http://www.spinics.net/lists/linux-fsdevel/msg101138.html
- http://marc.info/?l=linux-fsdevel&m=147162313630259&w=2
- https://bugzilla.redhat.com/show_bug.cgi?id=1368938
- http://seclists.org/oss-sec/2016/q3/380
- http://www.ubuntu.com/usn/usn-3146-1
- http://www.ubuntu.com/usn/usn-3146-2
- http://www.ubuntu.com/usn/usn-3147-1
- http://www.ubuntu.com/usn/usn-3161-3
- http://www.ubuntu.com/usn/usn-3161-4
- http://www.ubuntu.com/usn/usn-3162-2
- http://www.ubuntu.com/usn/usn-3422-1
- http://www.ubuntu.com/usn/usn-3422-2
- https://usn.ubuntu.com/usn/usn-3146-1
- https://usn.ubuntu.com/usn/usn-3146-2
- https://usn.ubuntu.com/usn/usn-3147-1
- https://usn.ubuntu.com/usn/usn-3161-3
- https://usn.ubuntu.com/usn/usn-3161-4
- https://usn.ubuntu.com/usn/usn-3162-2
- https://usn.ubuntu.com/usn/usn-3422-1
- https://usn.ubuntu.com/usn/usn-3422-2
- https://ubuntu.com/security/notices/USN-3146-1
- https://ubuntu.com/security/notices/USN-3146-2
- https://ubuntu.com/security/notices/USN-3147-1
- https://ubuntu.com/security/notices/USN-3161-3
- https://ubuntu.com/security/notices/USN-3161-4
- https://ubuntu.com/security/notices/USN-3162-2
- https://ubuntu.com/security/notices/USN-3422-1
- https://ubuntu.com/security/notices/USN-3422-2
- https://www.cve.org/CVERecord?id=CVE-2016-7097
comments:
  debian/carnil: |-
    The fix for CVE-2016-7097 seem to have introduced a regresssion
    as claimed in https://savannah.nongnu.org/bugs/?51818#comment1
    and addressed via https://patchwork.ozlabs.org/patch/799154/
    Released in 4.13-rc4 [a3bb2d5587521eea6dab2d05326abb0afb460abd]
    and is CC'ed to stable@vger.kernel.org
    Fixed as well in 4.12.6 [0965d89ebda3d71338ab2573c1a4d784c1e79611]
    More filesystems fixed already earlier, found commits:
    a3bb2d558752 ext4: Don't clear SGID when inheriting ACLs
    9bcf66c72d72 jfs: Don't clear SGID when inheriting ACLs
    84969465ddc4 hfsplus: Don't clear SGID when inheriting ACLs
    a992f2d38e4c ext2: Don't clear SGID when inheriting ACLs
    6883cd7f6824 reiserfs: Don't clear SGID when inheriting ACLs
    c925dc162f77 f2fs: Don't clear SGID when inheriting ACLs
    b7f8a09f8097 btrfs: Don't clear SGID when inheriting ACLs
    8ba358756aa0 xfs: Don't clear SGID when inheriting ACLs
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Andreas Gruenbacher
- Jan Kara
fixed-by:
  aosp/3.18: [d8333c045f045385a914013a220cd1ed54c88d48]
  cip/4.4: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  cip/4.4-rt: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  cip/4.4-st: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  debian/buster-security: ['patch:debian/4.7.8-1:bugfix/all/posix_acl-clear-sgid-bit-when-setting-file-permissio.patch']
  debian/jessie-security: ['version:debian/3.16.39-1']
  debian/stretch-security: ['patch:debian/4.7.8-1:bugfix/all/posix_acl-clear-sgid-bit-when-setting-file-permissio.patch']
  mainline: [073931017b49d9458aa351605b43a7e34598caef]
  stable/3.10: [dd2421b5edbadc5404e1cbc8fdc552f1558cc541]
  stable/3.12: [a88a2be387d1d8a5843826e12009c79e32fb46c8]
  stable/3.16: [f2ba3e2310b3967720b83126db8684c69ce41894]
  stable/3.18: [d8333c045f045385a914013a220cd1ed54c88d48]
  stable/3.2: [a06d3be52bce98746341cfb290203603fd028290]
  stable/4.1: [62fa696b7b435e93ed114dd6a23aa0881d7f81b9]
  stable/4.4: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  stable/4.8: [ea288a690cc4e53a528ae6a1d37cd6e14320ed27]
  ubuntu/xenial: [a665e1b4b94d6c9f6f73447231b90515a73adc1d]
