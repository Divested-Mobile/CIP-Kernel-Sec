description: |-
  Race condition in net/packet/af_packet.c in the Linux kernel through 4.8.12
  allows local users to gain privileges or cause a denial of service
  (use-after-free) by leveraging the CAP_NET_RAW capability to change a
  socket version, related to the packet_set_ring and packet_setsockopt
  functions.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8655
- http://marc.info/?l=linux-netdev&m=148054660230570&w=2
- http://www.ubuntu.com/usn/usn-3151-3
- http://www.ubuntu.com/usn/usn-3151-2
- http://www.ubuntu.com/usn/usn-3151-1
- http://www.ubuntu.com/usn/usn-3151-4
- http://www.ubuntu.com/usn/usn-3149-1
- http://www.ubuntu.com/usn/usn-3149-2
- http://www.ubuntu.com/usn/usn-3150-2
- http://www.ubuntu.com/usn/usn-3150-1
- http://www.ubuntu.com/usn/usn-3152-1
- http://www.ubuntu.com/usn/usn-3152-2
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1646318
- http://www.openwall.com/lists/oss-security/2016/12/06/1
comments:
  Debian-bwh: |-
    But AF_PACKET is only usable with CAP_NET_RAW, so is not so serious a
    vulnerability without unprivileged user namespaces enabled.
  Debian-carnil: Introduced in 3.2-rc1 with f6fb8f100b807378fda19e83e5ac6828b638603a
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Philip Pettersson
introduced-by:
  mainline: [f6fb8f100b807378fda19e83e5ac6828b638603a]
fixed-by:
  linux-3.12.y: [c80480c4ad5208431a7fb003472bd576bbe6ebb7]
  linux-3.16.y: [943e7299c0fec28de9df8985953f45633b071690]
  linux-3.18.y: [5c120b79dd6601a987eb33214f2686e5b75f3c3e]
  linux-3.2.y: [a9aaf8204feb497bb47aab977f04f5cea69b174e]
  linux-4.1.y: [e29fdf045048addaea61c837b60e3c4d2ec43614]
  linux-4.4.y: [5a01eaf19858278cc22525be118fe9c6a3c86e83]
  linux-4.8.y: [cef222d40f2e22e5938bac009bb5d8b526cc44ef]
  mainline: [84ac7260236a49c79eede91617700174c2c19b0c]
