description: |-
  Race condition in net/packet/af_packet.c in the Linux kernel through 4.8.12
  allows local users to gain privileges or cause a denial of service
  (use-after-free) by leveraging the CAP_NET_RAW capability to change a
  socket version, related to the packet_set_ring and packet_setsockopt
  functions.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8655
- http://marc.info/?l=linux-netdev&m=148054660230570&w=2
- http://www.ubuntu.com/usn/usn-3151-3
- http://www.ubuntu.com/usn/usn-3151-2
- http://www.ubuntu.com/usn/usn-3151-1
- http://www.ubuntu.com/usn/usn-3151-4
- http://www.ubuntu.com/usn/usn-3149-1
- http://www.ubuntu.com/usn/usn-3149-2
- http://www.ubuntu.com/usn/usn-3150-2
- http://www.ubuntu.com/usn/usn-3150-1
- http://www.ubuntu.com/usn/usn-3152-1
- http://www.ubuntu.com/usn/usn-3152-2
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1646318
- http://www.openwall.com/lists/oss-security/2016/12/06/1
- https://usn.ubuntu.com/usn/usn-3151-3
- https://usn.ubuntu.com/usn/usn-3151-2
- https://usn.ubuntu.com/usn/usn-3151-1
- https://usn.ubuntu.com/usn/usn-3151-4
- https://usn.ubuntu.com/usn/usn-3149-1
- https://usn.ubuntu.com/usn/usn-3149-2
- https://usn.ubuntu.com/usn/usn-3150-2
- https://usn.ubuntu.com/usn/usn-3150-1
- https://usn.ubuntu.com/usn/usn-3152-1
- https://usn.ubuntu.com/usn/usn-3152-2
- https://ubuntu.com/security/notices/USN-3151-3
- https://ubuntu.com/security/notices/USN-3151-2
- https://ubuntu.com/security/notices/USN-3151-1
- https://ubuntu.com/security/notices/USN-3151-4
- https://ubuntu.com/security/notices/USN-3149-1
- https://ubuntu.com/security/notices/USN-3149-2
- https://ubuntu.com/security/notices/USN-3150-2
- https://ubuntu.com/security/notices/USN-3150-1
- https://ubuntu.com/security/notices/USN-3152-1
- https://ubuntu.com/security/notices/USN-3152-2
- https://www.cve.org/CVERecord?id=CVE-2016-8655
comments:
  debian/bwh: |-
    But AF_PACKET is only usable with CAP_NET_RAW, so is not so serious a
    vulnerability without unprivileged user namespaces enabled.
  debian/carnil: Introduced in 3.2-rc1 with f6fb8f100b807378fda19e83e5ac6828b638603a
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Philip Pettersson
introduced-by:
  mainline: [f6fb8f100b807378fda19e83e5ac6828b638603a]
fixed-by:
  aosp/3.10: [edc081f50ff17bd1110a5958bc21246fcdbdc543]
  aosp/3.18: [5c120b79dd6601a987eb33214f2686e5b75f3c3e]
  cip/4.4: [5a01eaf19858278cc22525be118fe9c6a3c86e83]
  cip/4.4-rt: [5a01eaf19858278cc22525be118fe9c6a3c86e83]
  cip/4.4-st: [5a01eaf19858278cc22525be118fe9c6a3c86e83]
  debian/buster-security: ['version:debian/4.8.15-1']
  debian/jessie-security: ['patch:debian/3.16.39-1:bugfix/all/packet-fix-race-condition-in-packet_set_ring.patch']
  debian/stretch-security: ['version:debian/4.8.15-1']
  mainline: [84ac7260236a49c79eede91617700174c2c19b0c]
  stable/3.10: [4bfb6dd77e79a9b70bb574bb4b9192a17c3351c1]
  stable/3.12: [c80480c4ad5208431a7fb003472bd576bbe6ebb7]
  stable/3.16: [943e7299c0fec28de9df8985953f45633b071690]
  stable/3.18: [5c120b79dd6601a987eb33214f2686e5b75f3c3e]
  stable/3.2: [a9aaf8204feb497bb47aab977f04f5cea69b174e]
  stable/4.1: [e29fdf045048addaea61c837b60e3c4d2ec43614]
  stable/4.4: [5a01eaf19858278cc22525be118fe9c6a3c86e83]
  stable/4.8: [cef222d40f2e22e5938bac009bb5d8b526cc44ef]
  ubuntu/xenial: [26cf5a68aa51cf9aa1c466c102426fcdcc99f806]
