description: |-
  The blk_rq_map_user_iov function in block/blk-map.c in the Linux kernel
  before 4.8.14 does not properly restrict the type of iterator, which allows
  local users to read or write to arbitrary kernel memory locations or cause
  a denial of service (use-after-free) by leveraging access to a /dev/sg
  device.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9576
- https://marc.info/?l=linux-scsi&m=148010092224801&w=2
- https://gist.githubusercontent.com/dvyukov/80cd94b4e4c288f16ee4c787d404118b/raw/10536069562444da51b758bb39655b514ff93b45/gistfile1.txt
- http://www.openwall.com/lists/oss-security/2016/12/08/19
- https://github.com/torvalds/linux/commit/86db1e29772372155db08ff48a9ceb76e11a2ad1
comments:
  debian/bwh: |-
    This CVE is for the vulnerability fixed by commit a0ac402cfcdc
    "Don't feed anything but regular iovec's to blk_rq_map_user_iov",
    but that only addresses half the problem.  The remaining issue is
    covered by CVE-2016-10088, and commit 128394eff343 "sg_write()/
    bsg_write() is not fit to be called under KERNEL_DS" is a
    complete fix for both CVEs.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/sbeattie: |-
    requires access to /dev/sg*, which unprivileged users
      normally do not have access to.
reporters:
- Dmitry Vyukov
introduced-by:
  mainline: [16ae16c6e5616c084168740990fc508bda6655d4, 86db1e29772372155db08ff48a9ceb76e11a2ad1]
fixed-by:
  cip/4.4: [d41fb2fbb28d3a1085960edada6c046becd1fafd]
  cip/4.4-rt: [d41fb2fbb28d3a1085960edada6c046becd1fafd]
  cip/4.4-st: [d41fb2fbb28d3a1085960edada6c046becd1fafd]
  debian/buster-security: ['version:debian/4.8.15-1']
  debian/jessie-security: ['patch:debian/3.16.39-1:bugfix/all/sg_write-bsg_write-is-not-fit-to-be-called-under-ker.patch']
  debian/stretch-security: ['version:debian/4.8.15-1']
  mainline: [a0ac402cfcdc904f9772e1762b3fda112dcc56a0]
  stable/3.10: [823a2a0330f25ccea8ef64ee4a378e37ca51361c]
  stable/3.12: [7eb9e6472cbdd8e2df774ae91531c8959e21dbbc]
  stable/3.16: [249741c2c0d7a905da66efc6d1292d3915aef1fc]
  stable/3.18: [a861b9212ab44dc9483259b1f9376e74bae2ad37]
  stable/3.2: [e30250c95b840896da4cb71e84bead5803ee1ff6]
  stable/4.1: [3e3267311e3b6557206f293eeb9205b41e090625]
  stable/4.4: [d41fb2fbb28d3a1085960edada6c046becd1fafd]
  stable/4.8: [22d94c3266601ac14ff70c76e14ea05d2263b914]
  stable/4.9: [3f3a6bbe6f9f5e895d8945494173594ee51632da]
  ubuntu/xenial: [03e893f448bb197af029a51865edefa477a694e2]
