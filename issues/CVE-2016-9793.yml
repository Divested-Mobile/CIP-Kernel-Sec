description: |-
  The sock_setsockopt function in net/core/sock.c in the Linux kernel before
  4.8.14 mishandles negative values of sk_sndbuf and sk_rcvbuf, which allows
  local users to cause a denial of service (memory corruption and system
  crash) or possibly have unspecified other impact by leveraging the
  CAP_NET_ADMIN capability for a crafted setsockopt system call with the (1)
  SO_SNDBUFFORCE or (2) SO_RCVBUFFORCE option.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9793
- http://www.openwall.com/lists/oss-security/2016/12/02
- https://github.com/torvalds/linux/commit/b98b0bc8c431e3ceb4b26b0dfc8db509518fb290
- http://www.ubuntu.com/usn/usn-3168-1
- http://www.ubuntu.com/usn/usn-3168-2
- http://www.ubuntu.com/usn/usn-3169-1
- http://www.ubuntu.com/usn/usn-3169-2
- http://www.ubuntu.com/usn/usn-3169-3
- http://www.ubuntu.com/usn/usn-3169-4
- http://www.ubuntu.com/usn/usn-3170-1
- http://www.ubuntu.com/usn/usn-3170-2
- https://usn.ubuntu.com/usn/usn-3168-1
- https://usn.ubuntu.com/usn/usn-3168-2
- https://usn.ubuntu.com/usn/usn-3169-1
- https://usn.ubuntu.com/usn/usn-3169-2
- https://usn.ubuntu.com/usn/usn-3169-3
- https://usn.ubuntu.com/usn/usn-3169-4
- https://usn.ubuntu.com/usn/usn-3170-1
- https://usn.ubuntu.com/usn/usn-3170-2
- https://ubuntu.com/security/notices/USN-3168-1
- https://ubuntu.com/security/notices/USN-3168-2
- https://ubuntu.com/security/notices/USN-3169-1
- https://ubuntu.com/security/notices/USN-3169-2
- https://ubuntu.com/security/notices/USN-3169-3
- https://ubuntu.com/security/notices/USN-3169-4
- https://ubuntu.com/security/notices/USN-3170-1
- https://ubuntu.com/security/notices/USN-3170-2
- https://www.cve.org/CVERecord?id=CVE-2016-9793
comments:
  debian/bwh: |-
    Introduced in 3.5 by commit 82981930125a "net: cleanups in
    sock_setsockopt()".  But that should be applied to the 3.2 branches
    to fix CVE-2012-6704, so this will be needed on those branches too.
  ubuntu/sbeattie: |-
    the overflows exist for SO_{SND|RCV}BUFFORCE, so it's
      possible for a process with CAP_NET_ADMIN to do this. However,
      the check for CAP_NET_ADMIN is via capable() *not* ns_capable(),
      so the process attempting this has to have CAP_NET_ADMIN in the
      init_ns; having it in a new user namespace (i.e. via unshare()) is
      not sufficient. Thus, this cannot be exploited by an unprivileged
      user dropping into an unprivileged user namespace. Hence the
      low priority.
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [82981930125abfd39d7c8378a9cfdf5e1be2002b]
  stable/3.2: [3e21b29fc335c07161b01459a4123721da2e4642]
fixed-by:
  aosp/3.10: [15a81770e85cf31ef6aad63252cfa91837fdf067]
  aosp/3.18: [93c9172fa03dc55adaf907a5165a4e39b74be36a]
  cip/4.4: [77125815f058d587cac9217ac2c468038a7285c4]
  cip/4.4-rt: [77125815f058d587cac9217ac2c468038a7285c4]
  cip/4.4-st: [77125815f058d587cac9217ac2c468038a7285c4]
  debian/buster-security: ['version:debian/4.8.15-1']
  debian/jessie-security: ['patch:debian/3.16.39-1:bugfix/all/net-avoid-signed-overflows-for-so_-snd-rcv-bufforce.patch']
  debian/stretch-security: ['version:debian/4.8.15-1']
  mainline: [b98b0bc8c431e3ceb4b26b0dfc8db509518fb290]
  stable/3.12: [40c753f1714416931dc093b960aa3fcac4a545c5]
  stable/3.16: [756826fd4e4a25589a2e77a7ceb791314c73cf48]
  stable/3.18: [29fc5d17f274ccab37404882875f9045be10f6bd]
  stable/3.2: [c516724814d826ae1a90849e24e386c2ad81a845]
  stable/4.1: [f99fb439e6aff4e9f8b91a80d48b2a2d97aa2248]
  stable/4.4: [77125815f058d587cac9217ac2c468038a7285c4]
  stable/4.8: [f818e5d86aef49c067296d29f1e277c7ee1713e8]
  ubuntu/xenial: [6d5e78cc191242994d0d16aaf8f60672cd09f329]
