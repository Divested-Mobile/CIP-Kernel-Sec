description: 'trace: resolve stack corruption due to string copy'
references:
- https://source.android.com/security/bulletin/2017-05-01
- https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=2161ae9a70b12cf18ac8e5952a20161ffbccb477
- https://git.kernel.org/pub/scm/linux/kernel/git/rostedt/linux-trace.git/commit?id=e09e28671cda63e6308b31798b997639120e2a21
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0605
- https://www.spinics.net/lists/stable/msg169855.html
- http://www.ubuntu.com/usn/usn-3313-1
- http://www.ubuntu.com/usn/usn-3313-2
- http://www.ubuntu.com/usn/usn-3314-1
- http://www.ubuntu.com/usn/usn-3312-1
- http://www.ubuntu.com/usn/usn-3312-2
- http://www.ubuntu.com/usn/usn-3343-1
- http://www.ubuntu.com/usn/usn-3343-2
- https://usn.ubuntu.com/usn/usn-3313-1
- https://usn.ubuntu.com/usn/usn-3313-2
- https://usn.ubuntu.com/usn/usn-3314-1
- https://usn.ubuntu.com/usn/usn-3312-1
- https://usn.ubuntu.com/usn/usn-3312-2
- https://usn.ubuntu.com/usn/usn-3343-1
- https://usn.ubuntu.com/usn/usn-3343-2
- https://ubuntu.com/security/notices/USN-3313-1
- https://ubuntu.com/security/notices/USN-3313-2
- https://ubuntu.com/security/notices/USN-3314-1
- https://ubuntu.com/security/notices/USN-3312-1
- https://ubuntu.com/security/notices/USN-3312-2
- https://ubuntu.com/security/notices/USN-3343-1
- https://ubuntu.com/security/notices/USN-3343-2
comments:
  debian/bwh: |-
    trace_find_cmdline() copies a command name out of the cache
    (saved_cmdlines) that was first copied from task_struct::comm.
    That first copy is done without holding the task lock, which can
    result in reading a garbled name.  However, it is also done with
    memcpy(), so it always includes the last byte which is always
    written as 0.  So this seems like a theoretical issue, but maybe
    I'm missing something.  Also, the fix sets a maximum length 1
    byte too short.
    The upstream commit message seems to agree with this.
  debian/carnil: |-
    The CVE has been REJECTED, cf.
    https://marc.info/?l=oss-security&m=150703005326252&w=2
    keeping the entry in 'retired' in case we need to reevaluate/prove
    status.
  debian/jmm: From Android security bulletin, not sure if it's also an issue with
    mainline
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/sbeattie: as of 2017-05-02, unfixed upstream
introduced-by:
  mainline: [50d88758a3f9787cbdbdbc030560b815721eab4b]
fixed-by:
  aosp/3.18: [2d85ab9ecbdf32baf9e263d62c677d36889855b3]
  cip/4.4: [150381302389fa01425396489a21dc7c53383a5b]
  cip/4.4-rt: [150381302389fa01425396489a21dc7c53383a5b]
  cip/4.4-st: [150381302389fa01425396489a21dc7c53383a5b]
  debian/buster-security: ['patch:debian/4.9.30-1:bugfix/all/tracing-Use-strlcpy-instead-of-strcpy-in-__trace_fin.patch']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u1:bugfix/all/tracing-Use-strlcpy-instead-of-strcpy-in-__trace_fin.patch']
  debian/stretch-security: ['patch:debian/4.9.30-1:bugfix/all/tracing-Use-strlcpy-instead-of-strcpy-in-__trace_fin.patch']
  mainline: [e09e28671cda63e6308b31798b997639120e2a21]
  stable/3.16: [a1141b19b23a0605d46f3fab63fd2d76207096c4]
  stable/3.2: [e39e64193a8a611d11d4c62579a7246c1af70d1c]
  stable/4.4: [150381302389fa01425396489a21dc7c53383a5b]
  stable/4.9: [27b1e95a936e23a9328e1f318c199d3946352531]
  ubuntu/xenial: [f03cc1dfb722eae177b27f6048589affad198ec5]
ignore:
  all: Not a security issue
