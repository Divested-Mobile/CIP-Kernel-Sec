description: |-
  Linux kernel: heap out-of-bounds in AF_PACKET sockets. This new issue is
  analogous to previously disclosed CVE-2016-8655. In both cases, a socket
  option that changes socket state may race with safety checks in
  packet_set_ring. Previously with PACKET_VERSION. This time with
  PACKET_RESERVE. The solution is similar: lock the socket for the update.
  This issue may be exploitable, we did not investigate further. As this
  issue affects PF_PACKET sockets, it requires CAP_NET_RAW in the process
  namespace. But note that with user namespaces enabled, any process can
  create a namespace in which it has CAP_NET_RAW.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000111
- https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=c27927e372f0785f3303e8fad94b85945e2c97b7
- http://www.ubuntu.com/usn/usn-3384-1
- http://www.ubuntu.com/usn/usn-3384-2
- http://www.ubuntu.com/usn/usn-3385-1
- http://www.ubuntu.com/usn/usn-3385-2
- http://www.ubuntu.com/usn/usn-3386-1
- http://www.ubuntu.com/usn/usn-3386-2
- https://usn.ubuntu.com/usn/usn-3384-1
- https://usn.ubuntu.com/usn/usn-3384-2
- https://usn.ubuntu.com/usn/usn-3385-1
- https://usn.ubuntu.com/usn/usn-3385-2
- https://usn.ubuntu.com/usn/usn-3386-1
- https://usn.ubuntu.com/usn/usn-3386-2
- https://ubuntu.com/security/notices/USN-3384-1
- https://ubuntu.com/security/notices/USN-3384-2
- https://ubuntu.com/security/notices/USN-3385-1
- https://ubuntu.com/security/notices/USN-3385-2
- https://ubuntu.com/security/notices/USN-3386-1
- https://ubuntu.com/security/notices/USN-3386-2
- https://www.cve.org/CVERecord?id=CVE-2017-1000111
comments:
  debian/carnil: Introduced by 8913336a7e8d56e984109a3137d6c0e3362596a4 (2.6.27-rc1)
  ubuntu/sbeattie: |-
    fix subject "net-packet: fix race in packet_set_ring on
      PACKET_RESERVE"
  ubuntu/smb: |-
    While working on the embargoed CVE we decided that Precise cannot be
    exploited due to the missing user namespace support.
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [8913336a7e8d56e984109a3137d6c0e3362596a4]
fixed-by:
  aosp/3.10: [36735f30c65a22238d462d8d19029cabaf089437]
  aosp/3.18: [f2ce502f866556d24ebfae84673c9ef211b79906]
  cip/4.4: [63364a508d24944abb0975bd823cb11367c56283]
  cip/4.4-rt: [63364a508d24944abb0975bd823cb11367c56283]
  cip/4.4-st: [63364a508d24944abb0975bd823cb11367c56283]
  debian/buster-security: ['patch:debian/4.12.6-1:bugfix/all/packet-fix-tp_reserve-race-in-packet_set_ring.patch']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u4:bugfix/all/packet-fix-tp_reserve-race-in-packet_set_ring.patch']
  debian/stretch-security: ['patch:debian/4.9.30-2+deb9u4:bugfix/all/packet-fix-tp_reserve-race-in-packet_set_ring.patch']
  mainline: [c27927e372f0785f3303e8fad94b85945e2c97b7]
  stable/3.10: [fe1fd359c1dbde1c1561802f62a16ddc67c9ac07]
  stable/3.16: [ec26c86f4d9fe22ceb9b997aa9134f684b756282]
  stable/3.18: [f2ce502f866556d24ebfae84673c9ef211b79906]
  stable/3.2: [8f716035da0ad35d5a65668eb3c10aad6c439d7b]
  stable/4.1: [b7761b0cd80d832e40a46ec0078ab02596dbc350]
  stable/4.12: [91b2b39b49c25a0a76e3ef5302e848e6c9e60cfd]
  stable/4.4: [63364a508d24944abb0975bd823cb11367c56283]
  stable/4.9: [e5841355061332f8b326e098949490345dba776b]
  ubuntu/xenial: [37109b3f6afea53575a41fe6bfbd23d1814e4801]
