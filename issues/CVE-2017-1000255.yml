description: |-
  On Linux running on PowerPC hardware (Power8 or later) a user
  process can craft a signal frame and then do a sigreturn so that
  the kernel will take an exception (interrupt), and use the r1 value
  *from the signal frame* as the kernel stack pointer. As part of the
  exception entry the content of the signal frame is written to the
  kernel stack, allowing an attacker to overwrite arbitrary locations
  with arbitrary values. The exception handling does produce an oops,
  and a panic if panic_on_oops=1, but only after kernel memory has
  been over written. This flaw was introduced in commit: "5d176f751ee3
  (powerpc: tm: Enable transactional memory (TM) lazily for userspace)"
  which was merged upstream into v4.9-rc1. Please note that kernels
  built with CONFIG_PPC_TRANSACTIONAL_MEM=n are not vulnerable.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000255
- http://www.ubuntu.com/usn/usn-3443-1
- http://www.ubuntu.com/usn/usn-3443-2
- https://bugs.launchpad.net/bugs/1721842
- https://usn.ubuntu.com/usn/usn-3443-1
- https://usn.ubuntu.com/usn/usn-3443-2
- https://usn.ubuntu.com/usn/usn-3487-1
- https://ubuntu.com/security/notices/USN-3443-1
- https://ubuntu.com/security/notices/USN-3443-2
- https://ubuntu.com/security/notices/USN-3487-1
- https://www.cve.org/CVERecord?id=CVE-2017-1000255
comments:
  debian/carnil: |-
    Introduced in 4.9-rc1 with 5d176f751ee3c6eededd984ad409bff201f436a7
    Kernels built with CONFIG_PPC_TRANSACTIONAL_MEM=n are not vulnerable.
    Fix will require two patches:
    "powerpc/64s: Use emergency stack for kernel TM Bad Thing program checks"
    and
    "powerpc/tm: Fix illegal TM state in signal handler"
    044215d145a7a8a60ffa8fdc859d110a795fa6ea is needed as well.
  ubuntu/sbeattie: introduced in v4.9 cycle, PPC on power8 only
introduced-by:
  mainline: [5d176f751ee3c6eededd984ad409bff201f436a7]
fixed-by:
  debian/buster-security: ['patch:debian/4.13.4-2:bugfix/all/powerpc-64s-Use-emergency-stack-for-kernel-TM-Bad-Th.patch']
  debian/stretch-security: ['version:debian/4.9.65-1']
  mainline: [265e60a170d0a0ecfc2d20490134ed2c48dd45ab]
  stable/4.13: [c654b8387692160ced6e4dcbb3eed888d6ce10cd]
  stable/4.9: [afebf5ef60da6d15e75398e41ea2817c7a2bb283]
