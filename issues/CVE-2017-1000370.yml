description: a local-root exploit against ld.so and most SUID-root binaries
references:
- https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000370
- http://cybersecurity.upv.es/attacks/offset2lib/offset2lib.html
- https://www.cve.org/CVERecord?id=CVE-2017-1000370
comments:
  debian/nsl: |-
    Looks to be introduced upstream with commit d1fd836dcf00
    "mm: split ET_DYN ASLR from mmap ASLR" in 4.1-rc1. This was seemly
    added to jessie with patch mm-split-et_dyn-aslr-from-mmap-aslr.patch
  ubuntu/tyhicks: |-
    The original offset2lib issue was not assigned a CVE and the fix is
     only in 15.04 (Vivid) and newer kernels.
introduced-by:
  mainline: [d1fd836dcf00d2028c700c7e44d2c23404062c90]
fixed-by:
  cip/4.4: [7eb968cd04d404e6c73cd82c1122f6e06ad2d1e8]
  cip/4.4-rt: [7eb968cd04d404e6c73cd82c1122f6e06ad2d1e8]
  cip/4.4-st: [7eb968cd04d404e6c73cd82c1122f6e06ad2d1e8]
  debian/buster-security: ['patch:debian/4.11.11-1:bugfix/all/binfmt_elf-use-elf_et_dyn_base-only-for-pie.patch']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u4:bugfix/all/pie-aslr/binfmt_elf-use-elf_et_dyn_base-only-for-pie.patch']
  debian/stretch-security: ['patch:debian/4.9.30-2+deb9u4:bugfix/all/binfmt_elf-use-elf_et_dyn_base-only-for-pie.patch']
  mainline: [eab09532d40090698b05a07c1c87f39fdbc5fab5]
  stable/4.1: [5bb3ce649f8b42185922d90de13874d23f7ff37f]
  stable/4.11: [9b1bbf6ea9b2b596ba271bec23b93c48181ad896]
  stable/4.12: [0c9fd20c4ca8fb97f40ea66a2db39f1f9c85797d]
  stable/4.4: [7eb968cd04d404e6c73cd82c1122f6e06ad2d1e8]
  stable/4.9: [63c2f8f8c41bf80af068f0b2aef4c0e2bdc32c4a]
  ubuntu/xenial: [1cc9ab1a9cfdd1061f1f6b0454872354d3eca90b]
