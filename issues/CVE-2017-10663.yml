description: |-
  The sanity_check_ckpt function in fs/f2fs/super.c in the Linux kernel
  before 4.12.4 does not validate the blkoff and segno arrays, which allows
  local users to gain privileges via unspecified vectors.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10663
- http://blog.trendmicro.com/trendlabs-security-intelligence/vulnerability-f2fs-file-system-leads-memory-corruption-android-linux/
- http://www.ubuntu.com/usn/usn-3420-1
- http://www.ubuntu.com/usn/usn-3420-2
- https://source.android.com/security/bulletin/2017-08-01
- https://sourceforge.net/p/linux-f2fs/mailman/message/35835945/
- http://www.ubuntu.com/usn/usn-3468-1
- http://www.ubuntu.com/usn/usn-3468-2
- http://www.ubuntu.com/usn/usn-3468-3
- http://www.ubuntu.com/usn/usn-3470-1
- http://www.ubuntu.com/usn/usn-3470-2
- https://usn.ubuntu.com/usn/usn-3420-1
- https://usn.ubuntu.com/usn/usn-3420-2
- https://usn.ubuntu.com/usn/usn-3468-1
- https://usn.ubuntu.com/usn/usn-3468-2
- https://usn.ubuntu.com/usn/usn-3468-3
- https://usn.ubuntu.com/usn/usn-3470-1
- https://usn.ubuntu.com/usn/usn-3470-2
comments:
  Debian-bwh: |-
    Vulnerable code added in 3.8 by commit 127e670abfa7 "f2fs: add checkpoint
    operations".
introduced-by:
  mainline: [aff063e266cbf4754021d8e5d16ee418560906fd]
fixed-by:
  linux-3.18.y: [64133595b549c1036ffe8598f4c53aa355d9e3f1]
  linux-4.1.y: [604b43bbfe3bfd023d4cc6a4f9e8760f03346459]
  linux-4.12.y: [55df2e68c21714444fc3056c5636531ee9d1bc58]
  linux-4.4.y: [76517ed2a7fe059840c1984165984e69cb488568]
  linux-4.4.y-cip: [76517ed2a7fe059840c1984165984e69cb488568]
  linux-4.4.y-cip-rt: [76517ed2a7fe059840c1984165984e69cb488568]
  linux-4.9.y: [0f442c5b2e4ac0b65027ed3374462f1c38675f7e]
  mainline: [15d3042a937c13f5d9244241c7a9c8416ff6e82a]
ignore:
  linux-3.16.y: Hard to backport and low priority outside of Android
