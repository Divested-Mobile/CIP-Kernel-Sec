description: |-
  net/xfrm/xfrm_policy.c in the Linux kernel through 4.12.3, when
  CONFIG_XFRM_MIGRATE is enabled, does not ensure that the dir value of
  xfrm_userpolicy_id is XFRM_POLICY_MAX or less, which allows local users to
  cause a denial of service (out-of-bounds access) or possibly have
  unspecified other impact via an XFRM_MSG_MIGRATE xfrm Netlink message.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11600
- http://seclists.org/bugtraq/2017/Jul/30
- https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/net/xfrm/xfrm_policy.c?id=7bab09631c2a303f87a7eb7e3d69e888673b9b7e
- http://marc.info/?t=150169629800003&r=1&w=2
- http://marc.info/?l=linux-netdev&m=150169627919528&w=2
comments:
  Debian-bwh: |-
    Introduced by commit 5c79de6e79cd "[XFRM]: User interface for handling
    XFRM_MSG_MIGRATE" in 2.6.21.
  Debian-carnil: 'proposed upstream patch: https://git.kernel.org/pub/scm/linux/kernel/git/klassert/ipsec.git/commit/?id=7bab09631c2a303f87a7eb7e3d69e888673b9b7e'
  Ubuntu-sbeattie: |-
    queued in davem's net tree
    only affects kernels with CONFIG_XFRM_MIGRATE enabled
reporters:
- Bo Zhang
introduced-by:
  mainline: [80c9abaabf4283f7cf4a0b3597cd302506635b7f]
fixed-by:
  linux-3.16.y: [60166dc935e2af97cae9432c0247856e2deb0b3f]
  linux-3.18.y: [0d400015a32c703273b90601574956a4452a9311]
  linux-3.2.y: [31f11713f7bb0a4cb90466331832658c0b9c9e80]
  linux-4.1.y: [ded415d815a17597d6de4555524f89ed7ea08923]
  linux-4.12.y: [6c5b60edd786fe18b7be96b26ca980aa2bef0428]
  linux-4.4.y: [9b3dcc98d8df16913d260c8dae64ad6e5bfcb953]
  linux-4.9.y: [12a70ccaa6868163487f9a5ad97e1a91a397b453]
  mainline: [7bab09631c2a303f87a7eb7e3d69e888673b9b7e]
