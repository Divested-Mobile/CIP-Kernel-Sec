description: |-
  net/xfrm/xfrm_policy.c in the Linux kernel through 4.12.3, when
  CONFIG_XFRM_MIGRATE is enabled, does not ensure that the dir value of
  xfrm_userpolicy_id is XFRM_POLICY_MAX or less, which allows local users to
  cause a denial of service (out-of-bounds access) or possibly have
  unspecified other impact via an XFRM_MSG_MIGRATE xfrm Netlink message.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11600
- http://seclists.org/bugtraq/2017/Jul/30
- https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/net/xfrm/xfrm_policy.c?id=7bab09631c2a303f87a7eb7e3d69e888673b9b7e
- http://marc.info/?t=150169629800003&r=1&w=2
- http://marc.info/?l=linux-netdev&m=150169627919528&w=2
comments:
  debian/bwh: |-
    Introduced by commit 5c79de6e79cd "[XFRM]: User interface for handling
    XFRM_MSG_MIGRATE" in 2.6.21.
  debian/carnil: 'proposed upstream patch: https://git.kernel.org/pub/scm/linux/kernel/git/klassert/ipsec.git/commit/?id=7bab09631c2a303f87a7eb7e3d69e888673b9b7e'
  ubuntu/sbeattie: |-
    queued in davem's net tree
    only affects kernels with CONFIG_XFRM_MIGRATE enabled
reporters:
- Bo Zhang
introduced-by:
  mainline: [80c9abaabf4283f7cf4a0b3597cd302506635b7f]
fixed-by:
  cip/4.4: [9b3dcc98d8df16913d260c8dae64ad6e5bfcb953]
  cip/4.4-rt: [9b3dcc98d8df16913d260c8dae64ad6e5bfcb953]
  debian/buster-security: ['patch:debian/4.12.6-1:bugfix/all/xfrm-policy-check-policy-direction-value.patch']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u4:bugfix/all/xfrm-policy-check-policy-direction-value.patch']
  debian/stretch-security: ['patch:debian/4.9.30-2+deb9u4:bugfix/all/xfrm-policy-check-policy-direction-value.patch']
  mainline: [7bab09631c2a303f87a7eb7e3d69e888673b9b7e]
  stable/3.10: [7571b7478bc9cfecb7894d909bda5cbd0f4aae04]
  stable/3.16: [60166dc935e2af97cae9432c0247856e2deb0b3f]
  stable/3.18: [0d400015a32c703273b90601574956a4452a9311]
  stable/3.2: [31f11713f7bb0a4cb90466331832658c0b9c9e80]
  stable/4.1: [ded415d815a17597d6de4555524f89ed7ea08923]
  stable/4.12: [6c5b60edd786fe18b7be96b26ca980aa2bef0428]
  stable/4.4: [9b3dcc98d8df16913d260c8dae64ad6e5bfcb953]
  stable/4.9: [12a70ccaa6868163487f9a5ad97e1a91a397b453]
  ubuntu/xenial: [387361952efec4c4bdbb3f0b8bfa19f38d8a9d3e]
