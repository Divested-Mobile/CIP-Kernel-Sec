description: |-
  A security flaw was discovered in the nl80211_set_rekey_data() function in
  net/wireless/nl80211.c in the Linux kernel through 4.13.3. This function
  does not check whether the required attributes are present in a Netlink
  request. This request can be issued by a user with the CAP_NET_ADMIN
  capability and may result in a NULL pointer dereference and system crash.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12153
- https://marc.info/?t=150525503100001&r=1&w=2
- https://marc.info/?l=linux-wireless&m=150525493517953&w=2
- https://git.kernel.org/pub/scm/linux/kernel/git/jberg/mac80211.git/commit/?id=e785fa0a164aa11001cba931367c7f94ffaff888
- https://bugzilla.redhat.com/show_bug.cgi?id=1491046
- http://www.ubuntu.com/usn/usn-3469-1
- http://www.ubuntu.com/usn/usn-3469-2
- https://usn.ubuntu.com/usn/usn-3469-1
- https://usn.ubuntu.com/usn/usn-3469-2
- https://usn.ubuntu.com/usn/usn-3487-1
- https://usn.ubuntu.com/usn/usn-3583-1
- https://usn.ubuntu.com/usn/usn-3583-2
- https://ubuntu.com/security/notices/USN-3469-1
- https://ubuntu.com/security/notices/USN-3469-2
- https://ubuntu.com/security/notices/USN-3487-1
- https://ubuntu.com/security/notices/USN-3583-1
- https://ubuntu.com/security/notices/USN-3583-2
- https://www.cve.org/CVERecord?id=CVE-2017-12153
comments:
  debian/bwh: |-
    Said to be introduced in 3.1 by commit e5497d766ad ("cfg80211/nl80211:
    support GTK rekey offload").
  ubuntu/sbeattie: |-
    attacker needs CAP_NET_ADMIN either at system level or in a
      namespace that also has had a WiFi interface moved into it.
reporters:
- Bo Zhang
introduced-by:
  mainline: [e5497d766adb92bcbd1fa4a147e188f84f34b20a]
fixed-by:
  aosp/3.18: [65e3664fc6087d2941e940e38beb39920e9ae032]
  cip/4.4: [9d74367d1a35e87f46e5e0c2e8dd9f5d21f701b0]
  cip/4.4-rt: [9d74367d1a35e87f46e5e0c2e8dd9f5d21f701b0]
  cip/4.4-st: [9d74367d1a35e87f46e5e0c2e8dd9f5d21f701b0]
  debian/buster-security: ['patch:debian/4.12.13-1:bugfix/all/nl80211-check-for-the-required-netlink-attributes-presence.patch']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u4:bugfix/all/nl80211-check-for-the-required-netlink-attributes-presence.patch']
  debian/stretch-security: ['patch:debian/4.9.30-2+deb9u4:bugfix/all/nl80211-check-for-the-required-netlink-attributes-presence.patch']
  mainline: [e785fa0a164aa11001cba931367c7f94ffaff888]
  stable/3.10: [44ec968933c5d5041fbdff2e93a2f769435f9607]
  stable/3.16: [ed2305f2eba403d41dc4213746f60d47273980f6]
  stable/3.18: [65e3664fc6087d2941e940e38beb39920e9ae032]
  stable/3.2: [082d8a6a55d2b6583d9e93ac9796efdf4c412658]
  stable/4.1: [621e000d660bfe0311ab38c8d2b1a778dee45ae3]
  stable/4.13: [f0e85f56f70f172ada0d06b26baff47823695629]
  stable/4.4: [9d74367d1a35e87f46e5e0c2e8dd9f5d21f701b0]
  stable/4.9: [c820441a7a52e3626aede8df94069a50a9e4efdb]
  ubuntu/xenial: [1e82abc154c00e7cc56ef67250c6430b397b0930]
