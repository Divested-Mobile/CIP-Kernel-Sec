description: |-
  arch/x86/kvm/mmu.c in the Linux kernel through 4.13.5, when nested
  virtualisation is used, does not properly traverse guest pagetable entries
  to resolve a guest virtual address, which allows L1 guest OS users to
  execute arbitrary code on the host OS or cause a denial of service
  (incorrect index during page walking, and host OS crash), aka an "MMU
  potential stack buffer overrun."
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-12188
- https://bugzilla.redhat.com/show_bug.cgi?id=1500380
- https://patchwork.kernel.org/patch/9996579/
- https://patchwork.kernel.org/patch/9996587/
- https://www.spinics.net/lists/kvm/msg156651.html
- https://usn.ubuntu.com/usn/usn-3484-1
- https://usn.ubuntu.com/usn/usn-3484-2
- https://usn.ubuntu.com/usn/usn-3488-1
- https://usn.ubuntu.com/usn/usn-3487-1
- https://usn.ubuntu.com/usn/usn-3484-3
comments:
  Debian-bwh: Let's trust Paolo on this
  Debian-carnil: |-
    According to Paolo Bonzini, only
    https://www.spinics.net/lists/kvm/msg156650.html
    is needed to fix CVE-2017-12188
    Issue might thus only affect kernels starting from 4.6-rc1
    but I'm not 100% certain on the last claim or if we should
    adress the issue as well for kernels later than 3.12-rc1
  Ubuntu-sbeattie: |-
    fd19d3b45164466a4adce7cbff448ba9189e1427 might not be
      strictly necessary
introduced-by:
  mainline: [6bb69c9b69c315200ddc2bc79aee14c0184cf5b2]
fixed-by:
  linux-4.13.y: [a75ac6b475ae817f4006b511b8eb2d1fbe6a5713, 1679d0db1d3996321792e258c89394a1e5e3fa5c]
  linux-4.9.y: [28955b03fac36829831e185e3ec2793f8eb18689, 3610c4a7838df867d1b9d83a38c87042859ff896]
  mainline: [fd19d3b45164466a4adce7cbff448ba9189e1427, 829ee279aed43faa5cb1e4d65c0cad52f2426c53]
