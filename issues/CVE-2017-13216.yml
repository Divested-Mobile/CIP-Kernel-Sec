description: escalation of privileges (EoP) in ashmem_ioctl function in drivers/staging/android/ashmen.c
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1535199
- https://source.android.com/security/bulletin/2018-01-01#asterisk
- https://www.exploit-db.com/exploits/43464/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-13216
- http://www.securitytracker.com/id/1040106
- https://source.android.com/security/bulletin/2018-01-01
- https://www.cve.org/CVERecord?id=CVE-2017-13216
comments:
  debian/carnil: |-
    not 100% certain I got the right commit, but that seems to be the
    relevant change.
    ashmem driver source-wise introduced in 3.3-rc1 with
    11980c2ac4ccfad21a5f8ee9e12059f1e687bb40
  debian/jmm: Only present in drivers/staging/android/ashmem.c
  ubuntu/sbeattie: |-
    in ashmem driver, which is only available under
      CONFIG_ANDROID, which ubuntu kernels do not enable
introduced-by:
  mainline: [11980c2ac4ccfad21a5f8ee9e12059f1e687bb40]
fixed-by:
  aosp/3.18: [6dc42f889217a0a077bc75c6fa5239ade762fff4]
  cip/4.4: [b4106c55b574fe37900b02ddf89cbe4b9d971392]
  cip/4.4-rt: [b4106c55b574fe37900b02ddf89cbe4b9d971392]
  cip/4.4-st: [b4106c55b574fe37900b02ddf89cbe4b9d971392]
  debian/buster-security: ['version:debian/4.14.17-1']
  debian/jessie-security: ['version:debian/3.16.56-1']
  debian/stretch-security: ['version:debian/4.9.80-1']
  mainline: [443064cb0b1fb4569fe0a71209da7625129fb760]
  stable/3.16: [63aa20e4f4760249339c7771bd7e4a01d82a95ad]
  stable/3.18: [6dc42f889217a0a077bc75c6fa5239ade762fff4]
  stable/4.1: [700dbec6cafafbe5e018a90e8e92a4762c19884d]
  stable/4.14: [242e20a5b3cc2b99ace977546d3cffc6a2a35991]
  stable/4.4: [b4106c55b574fe37900b02ddf89cbe4b9d971392]
  stable/4.9: [c51d23dffc2e9ca05d611c86c440f9055541c62d]
  ubuntu/xenial: [bf152a4153c85003605f962dc31c716cbcd66477]
ignore:
  stable/3.16: ''
