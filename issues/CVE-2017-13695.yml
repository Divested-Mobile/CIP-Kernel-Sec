description: |-
  The acpi_ns_evaluate() function in drivers/acpi/acpica/nseval.c in the
  Linux kernel through 4.12.9 does not flush the operand cache and causes a
  kernel stack dump, which allows local users to obtain sensitive information
  from kernel memory and bypass the KASLR protection mechanism (in the kernel
  through 4.9) via a crafted ACPI table.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-13695
- https://patchwork.kernel.org/patch/9850567/
- https://github.com/acpica/acpica/pull/296/commits/37f2c716f2c6ab14c3ba557a539c3ee3224931b5
- https://usn.ubuntu.com/usn/usn-3696-1
- https://usn.ubuntu.com/usn/usn-3696-2
- https://usn.ubuntu.com/usn/usn-3762-1
- https://usn.ubuntu.com/usn/usn-3762-2
- https://ubuntu.com/security/notices/USN-3696-1
- https://ubuntu.com/security/notices/USN-3696-2
- https://ubuntu.com/security/notices/USN-3762-1
- https://ubuntu.com/security/notices/USN-3762-2
- https://www.cve.org/CVERecord?id=CVE-2017-13695
comments:
  debian/bwh: |-
    This is not a security issue, since ACPI tables must already be
    trusted.
  ubuntu/sbeattie: drivers/acpi/acpica/nseval.c::AcpiNsEvaluate()
  ubuntu/tyhicks: As of 17.04, KASLR is not yet enabled by default in Ubuntu
reporters:
- Seunghun Han
fixed-by:
  aosp/3.18: [c81492260a2202dcea658087b5dd1b319f59bbf0]
  cip/4.4: [dfcb739c20d88461fbd0dc007670f63ad82db881]
  cip/4.4-rt: [dfcb739c20d88461fbd0dc007670f63ad82db881]
  cip/4.4-st: [dfcb739c20d88461fbd0dc007670f63ad82db881]
  debian/buster-security: ['version:debian/4.17.3-1']
  mainline: [97f3c0a4b0579b646b6b10ae5a3d59f0441cc12c]
  stable/3.18: [c81492260a2202dcea658087b5dd1b319f59bbf0]
  stable/4.14: [1d1646c408f62148fd2bbc399927bdc5381cb3ba]
  stable/4.16: [1313bbe2d4a7dfd1fc503a2a9b7af4c88e2f68ec]
  stable/4.4: [dfcb739c20d88461fbd0dc007670f63ad82db881]
  stable/4.9: [9c6d844357a30e5dfcbb015c0d07a8175464b9c6]
  ubuntu/bionic: [d15bd7485c9c70083aea87f49c7b8803662066b1]
  ubuntu/xenial: [13bcaf55d4994fd748498ac591d46ec210003463]
ignore:
  all: Not a security issue
