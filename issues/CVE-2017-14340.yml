description: |-
  The XFS_IS_REALTIME_INODE macro in fs/xfs/xfs_linux.h in the Linux kernel
  before 4.13.2 does not verify that a filesystem has a realtime device,
  which allows local users to cause a denial of service (NULL pointer
  dereference and OOPS) via vectors related to setting an RHINHERIT flag on a
  directory.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14340
- http://seclists.org/oss-sec/2017/q3/436
- http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.13.2
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=b31ff3cdf540110da4572e3e29bd172087af65cc
- https://bugzilla.redhat.com/show_bug.cgi?id=1491344
- http://www.openwall.com/lists/oss-security/2017/09/13/1
- http://www.ubuntu.com/usn/usn-3468-1
- http://www.ubuntu.com/usn/usn-3468-2
- http://www.ubuntu.com/usn/usn-3469-1
- http://www.ubuntu.com/usn/usn-3469-2
- http://www.ubuntu.com/usn/usn-3468-3
- http://www.ubuntu.com/usn/usn-3470-1
- http://www.ubuntu.com/usn/usn-3470-2
- https://usn.ubuntu.com/usn/usn-3468-1
- https://usn.ubuntu.com/usn/usn-3468-2
- https://usn.ubuntu.com/usn/usn-3469-1
- https://usn.ubuntu.com/usn/usn-3469-2
- https://usn.ubuntu.com/usn/usn-3468-3
- https://usn.ubuntu.com/usn/usn-3470-1
- https://usn.ubuntu.com/usn/usn-3470-2
comments:
  debian/bwh: |-
    Said to be introduced in 2.6.15 by commit f538d4da8d52 "[XFS] write
    barrier support".
reporters:
- Dave Chinner
introduced-by:
  mainline: [f538d4da8d521746ca5ebf8c1a8105eb49bfb45e]
fixed-by:
  cip/4.4: [ad3903434142953a03b84ec8719ce80373a62266]
  cip/4.4-rt: [ad3903434142953a03b84ec8719ce80373a62266]
  debian/buster-security: ['version:debian/4.12.13-1']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u4:bugfix/all/xfs-xfs_is_realtime_inode-should-be-false-if-no-rt-d.patch']
  debian/stretch-security: ['patch:debian/4.9.30-2+deb9u4:bugfix/all/xfs-XFS_IS_REALTIME_INODE-should-be-false-if-no-rt-d.patch']
  mainline: [b31ff3cdf540110da4572e3e29bd172087af65cc]
  stable/3.16: [1e48f7b93c3a8f1d7bb136ab7fa61e763893a6fd]
  stable/3.18: [b766f0849a52e235268f362b7d8ec8bc36cdc7f0]
  stable/3.2: [90b59e69283444326907eb6c6b447366814d0960]
  stable/4.1: [d8f0ead1e72bcc040a858ddf5d1de0a9d6cce8ca]
  stable/4.12: [9f7df0bca168528aba20794f400be134495551b8]
  stable/4.13: [24cb33252843e531194e78222af2d8afb75fac5f]
  stable/4.4: [ad3903434142953a03b84ec8719ce80373a62266]
  stable/4.9: [5b82e0e938af5d9dfb038e2483cb2a84e24584fd]
