description: |-
  The XFS_IS_REALTIME_INODE macro in fs/xfs/xfs_linux.h in the Linux kernel
  before 4.13.2 does not verify that a filesystem has a realtime device,
  which allows local users to cause a denial of service (NULL pointer
  dereference and OOPS) via vectors related to setting an RHINHERIT flag on a
  directory.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14340
- http://seclists.org/oss-sec/2017/q3/436
- http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.13.2
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=b31ff3cdf540110da4572e3e29bd172087af65cc
- https://bugzilla.redhat.com/show_bug.cgi?id=1491344
- http://www.openwall.com/lists/oss-security/2017/09/13/1
- http://www.ubuntu.com/usn/usn-3468-1
- http://www.ubuntu.com/usn/usn-3468-2
- http://www.ubuntu.com/usn/usn-3469-1
- http://www.ubuntu.com/usn/usn-3469-2
- http://www.ubuntu.com/usn/usn-3468-3
- http://www.ubuntu.com/usn/usn-3470-1
- http://www.ubuntu.com/usn/usn-3470-2
- https://usn.ubuntu.com/usn/usn-3468-1
- https://usn.ubuntu.com/usn/usn-3468-2
- https://usn.ubuntu.com/usn/usn-3469-1
- https://usn.ubuntu.com/usn/usn-3469-2
- https://usn.ubuntu.com/usn/usn-3468-3
- https://usn.ubuntu.com/usn/usn-3470-1
- https://usn.ubuntu.com/usn/usn-3470-2
comments:
  Debian-bwh: |-
    Said to be introduced in 2.6.15 by commit f538d4da8d52 "[XFS] write
    barrier support".
reporters:
- Dave Chinner
introduced-by:
  mainline: [f538d4da8d521746ca5ebf8c1a8105eb49bfb45e]
fixed-by:
  linux-3.16.y: [1e48f7b93c3a8f1d7bb136ab7fa61e763893a6fd]
  linux-3.18.y: [b766f0849a52e235268f362b7d8ec8bc36cdc7f0]
  linux-3.2.y: [90b59e69283444326907eb6c6b447366814d0960]
  linux-4.1.y: [d8f0ead1e72bcc040a858ddf5d1de0a9d6cce8ca]
  linux-4.12.y: [9f7df0bca168528aba20794f400be134495551b8]
  linux-4.13.y: [24cb33252843e531194e78222af2d8afb75fac5f]
  linux-4.4.y: [ad3903434142953a03b84ec8719ce80373a62266]
  linux-4.9.y: [5b82e0e938af5d9dfb038e2483cb2a84e24584fd]
  mainline: [b31ff3cdf540110da4572e3e29bd172087af65cc]
