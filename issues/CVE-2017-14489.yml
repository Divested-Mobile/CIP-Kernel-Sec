description: |-
  The iscsi_if_rx function in drivers/scsi/scsi_transport_iscsi.c in the
  Linux kernel through 4.13.2 allows local users to cause a denial of service
  (panic) by leveraging incorrect length validation.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14489
- https://patchwork.kernel.org/patch/9923803/
- https://bugzilla.redhat.com/show_bug.cgi?id=1490421
- https://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi.git/commit/drivers/scsi/scsi_transport_iscsi.c?h=fixes&id=c88f0e6b06f4092995688211a631bb436125d77b
- http://www.ubuntu.com/usn/usn-3469-1
- http://www.ubuntu.com/usn/usn-3469-2
- https://usn.ubuntu.com/usn/usn-3469-1
- https://usn.ubuntu.com/usn/usn-3469-2
- https://usn.ubuntu.com/usn/usn-3487-1
- https://usn.ubuntu.com/usn/usn-3583-1
- https://usn.ubuntu.com/usn/usn-3583-2
- https://ubuntu.com/security/notices/USN-3469-1
- https://ubuntu.com/security/notices/USN-3469-2
- https://ubuntu.com/security/notices/USN-3487-1
- https://ubuntu.com/security/notices/USN-3583-1
- https://ubuntu.com/security/notices/USN-3583-2
- https://www.cve.org/CVERecord?id=CVE-2017-14489
comments:
  debian/bwh: |-
    Appears to have been introduced in 2.6.15 by commit 0896b7523026
    "[SCSI] open-iscsi/linux-iscsi-5 Initiator: Transport class update for
    iSCSI".
  debian/carnil: |-
    7f564528a480084e2318cd48caba7aef4a54a77f is presumably the upstream
    fix already fixing the issue, cf.
    http://www.openwall.com/lists/oss-security/2017/09/25/3 but
    "nevertheless, the buffer overwrite is still there, so a suggested
    patch 9923803 (or its later version) is still needed."
    Fix is pending for 4.14/scsi-fixes in:
    https://git.kernel.org/pub/scm/linux/kernel/git/mkp/scsi.git/commit/?h=4.14/scsi-fixes&id=c88f0e6b06f4092995688211a631bb436125d77b
reporters:
- ChunYu Wang
introduced-by:
  mainline: [0896b752302662909b52895bd7f601136001069d]
fixed-by:
  aosp/3.18: [fec4cd33779f9edd7ab2d0d5ad7228f55f3f6887]
  cip/4.4: [9d2534917c25a58b67864ea1db930670d48dee75]
  cip/4.4-rt: [9d2534917c25a58b67864ea1db930670d48dee75]
  cip/4.4-st: [9d2534917c25a58b67864ea1db930670d48dee75]
  debian/buster-security: ['patch:debian/4.12.13-1:bugfix/all/scsi-fix-the-issue-that-iscsi_if_rx-doesn-t-parse-nlmsg-properly.patch']
  debian/jessie-security: ['patch:debian/3.16.43-2+deb8u4:bugfix/all/scsi-fix-the-issue-that-iscsi_if_rx-doesn-t-parse-nlmsg-properly.patch']
  debian/stretch-security: ['patch:debian/4.9.30-2+deb9u4:bugfix/all/scsi-fix-the-issue-that-iscsi_if_rx-doesn-t-parse-nlmsg-properly.patch']
  mainline: [c88f0e6b06f4092995688211a631bb436125d77b]
  stable/3.16: [a1b438ad8590add8f6b0b679171bf5e0d45e2da1]
  stable/3.18: [fec4cd33779f9edd7ab2d0d5ad7228f55f3f6887]
  stable/3.2: [7d38a8202c4a6acf91d6163f53f3253a261bbd22]
  stable/4.1: [74fbce9bea7351161fb5864e2fc31c02145fcab7]
  stable/4.13: [1fc547cd09e2d7295656fde40a34706448bf6098]
  stable/4.4: [9d2534917c25a58b67864ea1db930670d48dee75]
  stable/4.9: [b42bf0f15cf70926f3a460e7517703fda6191ba7]
  ubuntu/xenial: [f1e5734f6b38e4f5ec6457db7282e297c03f9eb5]
