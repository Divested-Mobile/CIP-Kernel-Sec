description: |-
  The KEYS subsystem in the Linux kernel through 4.13.7 mishandles use of
  add_key for a key that already exists but is uninstantiated, which allows
  local users to cause a denial of service (NULL pointer dereference and
  system crash) or possibly have unspecified other impact via a crafted
  system call.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15299
- https://bugzilla.redhat.com/show_bug.cgi?id=1498016
- https://marc.info/?t=150654188100001&r=1&w=2
- https://marc.info/?t=150783958600011&r=1&w=2
- https://www.mail-archive.com/linux-kernel@vger.kernel.org/msg1499828.html
- https://usn.ubuntu.com/usn/usn-3485-1
- https://usn.ubuntu.com/usn/usn-3485-2
- https://usn.ubuntu.com/usn/usn-3485-3
- https://usn.ubuntu.com/usn/usn-3507-1
- https://usn.ubuntu.com/usn/usn-3507-2
- https://usn.ubuntu.com/usn/usn-3798-1
- https://usn.ubuntu.com/usn/usn-3798-2
- https://ubuntu.com/security/notices/USN-3485-1
- https://ubuntu.com/security/notices/USN-3485-2
- https://ubuntu.com/security/notices/USN-3485-3
- https://ubuntu.com/security/notices/USN-3507-1
- https://ubuntu.com/security/notices/USN-3507-2
- https://ubuntu.com/security/notices/USN-3798-1
- https://ubuntu.com/security/notices/USN-3798-2
- https://www.cve.org/CVERecord?id=CVE-2017-15299
comments:
  debian/carnil: |-
    The bug is not restricted to CONFIG_ENCRYPTED_KEYS=y
    only, but the impact is different. As noted in the commit
    message: "In the case of the "user" and "logon" key types
    this causes a memory leak, at best.  Maybe even worse, the
    ->update() methods of the "encrypted" and "trusted" key types
    actually just dereference a NULL pointer when passed an
    uninstantiated key.
    For 4.13.x fixed in 4.13.10 with 24a33a0c96f3e976c18e4321ca09f71cb835a9b5
reporters:
- Eric Biggers
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  aosp/3.18: [98c4e5cae5204c1114390219331ddd649d78a5a7]
  cip/4.4: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  cip/4.4-rt: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  cip/4.4-st: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  debian/buster-security: ['version:debian/4.13.10-1']
  debian/jessie-security: ['version:debian/3.16.51-1']
  debian/stretch-security: ['version:debian/4.9.65-1']
  mainline: [60ff5b2f547af3828aebafd54daded44cfb0807a]
  stable/3.10: [20d94bc94065e6fc3f82b7d39b9a2011696aa074]
  stable/3.16: [24832178de3ab7b6fb42f2730d8d675e3d30adb2]
  stable/3.18: [98c4e5cae5204c1114390219331ddd649d78a5a7]
  stable/3.2: [57f94e88bb255bf7b7d267c999aefbe4557307c1]
  stable/4.1: [7aeb11ac706537b29b704c344572c3f9ac908389]
  stable/4.13: [24a33a0c96f3e976c18e4321ca09f71cb835a9b5]
  stable/4.4: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  stable/4.9: [da0c7503c0b886784bf8bcb279c7d71c1e50c438]
  ubuntu/xenial: [09d7ffb7ae1c8499f8fe227cc568ce5a7d26bb9a]
