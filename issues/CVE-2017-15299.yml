description: |-
  The KEYS subsystem in the Linux kernel through 4.13.7 mishandles use of
  add_key for a key that already exists but is uninstantiated, which allows
  local users to cause a denial of service (NULL pointer dereference and
  system crash) or possibly have unspecified other impact via a crafted
  system call.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15299
- https://bugzilla.redhat.com/show_bug.cgi?id=1498016
- https://marc.info/?t=150654188100001&r=1&w=2
- https://marc.info/?t=150783958600011&r=1&w=2
- https://www.mail-archive.com/linux-kernel@vger.kernel.org/msg1499828.html
- https://usn.ubuntu.com/usn/usn-3485-1
- https://usn.ubuntu.com/usn/usn-3485-2
- https://usn.ubuntu.com/usn/usn-3485-3
- https://usn.ubuntu.com/usn/usn-3507-1
- https://usn.ubuntu.com/usn/usn-3507-2
- https://usn.ubuntu.com/usn/usn-3798-1
- https://usn.ubuntu.com/usn/usn-3798-2
comments:
  debian/carnil: |-
    The bug is not restricted to CONFIG_ENCRYPTED_KEYS=y
    only, but the impact is different. As noted in the commit
    message: "In the case of the "user" and "logon" key types
    this causes a memory leak, at best.  Maybe even worse, the
    ->update() methods of the "encrypted" and "trusted" key types
    actually just dereference a NULL pointer when passed an
    uninstantiated key.
    For 4.13.x fixed in 4.13.10 with 24a33a0c96f3e976c18e4321ca09f71cb835a9b5
reporters:
- Eric Biggers
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  linux-3.10.y: [20d94bc94065e6fc3f82b7d39b9a2011696aa074]
  linux-3.16.y: [24832178de3ab7b6fb42f2730d8d675e3d30adb2]
  linux-3.18.y: [98c4e5cae5204c1114390219331ddd649d78a5a7]
  linux-3.2.y: [57f94e88bb255bf7b7d267c999aefbe4557307c1]
  linux-4.1.y: [7aeb11ac706537b29b704c344572c3f9ac908389]
  linux-4.13.y: [24a33a0c96f3e976c18e4321ca09f71cb835a9b5]
  linux-4.4.y: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  linux-4.4.y-cip: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  linux-4.4.y-cip-rt: [33dea302f9bc1e2c41392a308cfb50f6c02bb096]
  linux-4.9.y: [da0c7503c0b886784bf8bcb279c7d71c1e50c438]
  mainline: [60ff5b2f547af3828aebafd54daded44cfb0807a]
