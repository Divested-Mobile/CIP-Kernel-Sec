description: |-
  The bnep_add_connection function in net/bluetooth/bnep/core.c in the Linux
  kernel before 3.19 does not ensure that an l2cap socket is available, which
  allows local users to gain privileges via a crafted application.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15868
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=71bb99a02b32b4cc4265118e85f6035ca72923f0
- https://github.com/torvalds/linux/commit/71bb99a02b32b4cc4265118e85f6035ca72923f0
- https://patchwork.kernel.org/patch/9882449/
- https://source.android.com/security/bulletin/pixel/2017-12-01
- https://usn.ubuntu.com/usn/usn-3583-1
- https://usn.ubuntu.com/usn/usn-3583-2
- https://ubuntu.com/security/notices/USN-3583-1
- https://ubuntu.com/security/notices/USN-3583-2
- https://www.cve.org/CVERecord?id=CVE-2017-15868
comments:
  debian/bwh: |-
    Depends on commit b3916db32c4a "Bluetooth: hidp: verify l2cap sockets"
    which is also an important security fix.  Should also apply commit
    96c26653ce65 "Bluetooth: cmtp: cmtp_add_connection() should verify that
    it's dealing with l2cap socket".
fixed-by:
  aosp/3.18: [f6237750acc4494cb28e174289d5d335313ff2ea]
  debian/buster-security: ['version:debian/4.0.2-1']
  debian/jessie-security: ['patch:debian/3.16.51-3+deb8u1:bugfix/all/bluetooth-bnep-bnep_add_connection-should-verify-tha.patch']
  debian/stretch-security: ['version:debian/4.0.2-1']
  mainline: [71bb99a02b32b4cc4265118e85f6035ca72923f0]
  stable/3.10: [b8d57eb2f414876510ffffa88105a9d4f350f575]
  stable/3.16: [77369e6ee42b28a529932f5f7a5522de73310d21]
  stable/3.18: [f6237750acc4494cb28e174289d5d335313ff2ea]
  stable/3.2: [d5623517462d7bdf03cae13e8b713389b0cdd381]
