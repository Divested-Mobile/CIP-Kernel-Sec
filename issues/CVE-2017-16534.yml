description: 'USB: core: harden cdc_parse_cdc_header'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16534
- https://github.com/torvalds/linux/commit/2e1c42391ff2556387b3cb6308b24f6f65619feb
- https://groups.google.com/d/msg/syzkaller/nXnjqI73uPo/6sUyq6kqAgAJ
- https://usn.ubuntu.com/usn/usn-3485-1
- https://usn.ubuntu.com/usn/usn-3485-2
- https://usn.ubuntu.com/usn/usn-3487-1
- https://usn.ubuntu.com/usn/usn-3485-3
- https://ubuntu.com/security/notices/USN-3485-1
- https://ubuntu.com/security/notices/USN-3485-2
- https://ubuntu.com/security/notices/USN-3487-1
- https://ubuntu.com/security/notices/USN-3485-3
- https://www.cve.org/CVERecord?id=CVE-2017-16534
comments:
  debian/bwh: |-
    Introduced in 4.4 by commit c40a2c8817e4 "CDC: common parser for extra
    headers", but there may be similar bugs in individual drivers in older
    versions.  cdc_ether seems to have missed a length check for
    USB_CDC_ACM_TYPE.
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [c40a2c8817e42273a4627c48c884b805475a733f]
fixed-by:
  cip/4.4: [feab51a916ed07219dee38b898fe22bd2a98193a]
  cip/4.4-rt: [feab51a916ed07219dee38b898fe22bd2a98193a]
  cip/4.4-st: [feab51a916ed07219dee38b898fe22bd2a98193a]
  debian/buster-security: ['version:debian/4.13.10-1']
  debian/stretch-security: ['version:debian/4.9.65-1']
  mainline: [2e1c42391ff2556387b3cb6308b24f6f65619feb]
  stable/4.13: [7dddbeaf504434f37e041479af997b14b0f9ea0d]
  stable/4.4: [feab51a916ed07219dee38b898fe22bd2a98193a]
  stable/4.9: [767f7a2cf33a135fe3f57010b51c3f6e92d7677d]
  ubuntu/xenial: [6473c4121e88b687a39e723ac2ee756033f7dc98]
