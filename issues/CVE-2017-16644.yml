description: '[media] hdpvr: Fix an error handling path in hdpvr_probe()'
references:
- https://patchwork.kernel.org/patch/9966135/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16644
- https://groups.google.com/d/msg/syzkaller/ngC5SLvxPm4/gduhCARhAwAJ
- https://git.linuxtv.org/media_tree.git/commit/?id=c0f71bbb810237a38734607ca4599632f7f5d47f
comments:
  Debian-bwh: |-
    I believe this CVE is for passing a zeroed work_struct to
    flush_work(), leading to an oops (denial of service).  That
    was introduced in 4.8 by commit 5612e191ca1f "[media] hdpvr:
    Remove deprecated create_singlethread_workqueue".  The patch
    fixing this also fixes memory leaks on the failure path which
    have been present for much longer.
  Ubuntu-sbeattie: possibly introduced in 5612e191ca1f88e16c48bb373d90d1508196aa95
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [5612e191ca1f88e16c48bb373d90d1508196aa95]
fixed-by:
  mainline: [c0f71bbb810237a38734607ca4599632f7f5d47f]
