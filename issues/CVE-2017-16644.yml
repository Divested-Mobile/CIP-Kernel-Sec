description: '[media] hdpvr: Fix an error handling path in hdpvr_probe()'
references:
- https://patchwork.kernel.org/patch/9966135/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16644
- https://groups.google.com/d/msg/syzkaller/ngC5SLvxPm4/gduhCARhAwAJ
- https://git.linuxtv.org/media_tree.git/commit/?id=c0f71bbb810237a38734607ca4599632f7f5d47f
- https://usn.ubuntu.com/usn/usn-3754-1
- https://usn.ubuntu.com/usn/usn-4904-1
- https://ubuntu.com/security/notices/USN-3754-1
- https://ubuntu.com/security/notices/USN-4904-1
- https://www.cve.org/CVERecord?id=CVE-2017-16644
comments:
  debian/bwh: |-
    I believe this CVE is for passing a zeroed work_struct to
    flush_work(), leading to an oops (denial of service).  That
    was introduced in 4.8 by commit 5612e191ca1f "[media] hdpvr:
    Remove deprecated create_singlethread_workqueue".  The patch
    fixing this also fixes memory leaks on the failure path which
    have been present for much longer.
  ubuntu/sbeattie: possibly introduced in 5612e191ca1f88e16c48bb373d90d1508196aa95
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [5612e191ca1f88e16c48bb373d90d1508196aa95]
fixed-by:
  aosp/3.18: [8069f6ce57c5f89f5a1fb9186b030cd760b624d6]
  cip/4.4: [4f1600b92f97828b114c31c64e41665276e310cd]
  cip/4.4-rt: [4f1600b92f97828b114c31c64e41665276e310cd]
  cip/4.4-st: [4f1600b92f97828b114c31c64e41665276e310cd]
  debian/buster-security: ['patch:debian/4.14.7-1:bugfix/all/media-hdpvr-fix-an-error-handling-path-in-hdpvr_prob.patch']
  debian/stretch-security: ['patch:debian/4.9.65-3+deb9u1:bugfix/all/media-hdpvr-fix-an-error-handling-path-in-hdpvr_prob.patch']
  mainline: [c0f71bbb810237a38734607ca4599632f7f5d47f]
  openela/4.14: [dd24d173b50af3aadb1ea2e04edaa8d68ca59b23]
  stable/4.14: [dd24d173b50af3aadb1ea2e04edaa8d68ca59b23]
  stable/4.15: [2eeaddcc139b5ccf1784148e08c7f2f57ec2c998]
  stable/4.4: [4f1600b92f97828b114c31c64e41665276e310cd]
  stable/4.9: [198a7ddaf5d2c76130b28f19ed6d768860ea2b8e]
  ubuntu/bionic: [6ea26f306fdd94f582339e2f94e83b958e23c799]
  ubuntu/eoan: ['version:5.0.0-13.14']
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
  ubuntu/xenial: [c312a37dd21a5f55b4d4252511c94838f3b736b6]
