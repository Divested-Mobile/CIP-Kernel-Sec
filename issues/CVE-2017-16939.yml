description: |-
  The XFRM dump policy implementation in net/xfrm/xfrm_user.c in the Linux
  kernel before 4.13.11 allows local users to gain privileges or cause a
  denial of service (use-after-free) via a crafted SO_RCVBUF setsockopt
  system call in conjunction with XFRM_MSG_GETPOLICY Netlink messages.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16939
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=1137b5e2529a8f5ca8ee709288ecba3e68044df2
- http://seclists.org/fulldisclosure/2017/Nov/40
- http://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.13.11
- https://blogs.securiteam.com/index.php/archives/3535
- https://bugzilla.suse.com/show_bug.cgi?id=1069702
- https://github.com/torvalds/linux/commit/1137b5e2529a8f5ca8ee709288ecba3e68044df2
- https://usn.ubuntu.com/usn/usn-3511-1
- https://usn.ubuntu.com/usn/usn-3510-1
- https://usn.ubuntu.com/usn/usn-3510-2
- https://usn.ubuntu.com/usn/usn-3509-1
- https://usn.ubuntu.com/usn/usn-3509-2
- https://usn.ubuntu.com/usn/usn-3508-1
- https://usn.ubuntu.com/usn/usn-3508-2
- https://usn.ubuntu.com/usn/usn-3507-1
- https://usn.ubuntu.com/usn/usn-3507-2
- https://ubuntu.com/security/notices/USN-3511-1
- https://ubuntu.com/security/notices/USN-3510-1
- https://ubuntu.com/security/notices/USN-3510-2
- https://ubuntu.com/security/notices/USN-3509-1
- https://ubuntu.com/security/notices/USN-3509-2
- https://ubuntu.com/security/notices/USN-3508-1
- https://ubuntu.com/security/notices/USN-3508-2
- https://ubuntu.com/security/notices/USN-3507-1
- https://ubuntu.com/security/notices/USN-3507-2
comments:
  ubuntu/sbeattie: |-
    priority is low for linux_precise/esm, as unprivileged user
      namespaces is not implemented there.
reporters:
- Mohamed Ghannam
introduced-by:
  mainline: [12a169e7d8f4b1c95252d8b04ed0f1033ed7cfe2]
fixed-by:
  aosp/3.18: [8586e18413441d265f0ff536378d6ef358d18853]
  cip/4.4: [b377c453b3631531679cbe594b7d28c5ecd82cea]
  cip/4.4-rt: [b377c453b3631531679cbe594b7d28c5ecd82cea]
  debian/buster-security: ['version:debian/4.13.13-1']
  debian/jessie-security: ['patch:debian/3.16.51-3+deb8u1:bugfix/all/ipsec-fix-aborted-xfrm-policy-dump-crash.patch']
  debian/stretch-security: ['version:debian/4.9.65-1']
  mainline: [1137b5e2529a8f5ca8ee709288ecba3e68044df2]
  stable/3.16: [a7d7387cc169e912055faca1b0f123e5bce78f53]
  stable/3.18: [8586e18413441d265f0ff536378d6ef358d18853]
  stable/3.2: [43ce9bf0770f22048156e7b36fe812a3352da842]
  stable/4.1: [5e80f6036c71f6ce1dbba0ad2925c331767f76ac]
  stable/4.13: [20d17a2d1347b3754acfc395c7c57a068fc84d40]
  stable/4.4: [b377c453b3631531679cbe594b7d28c5ecd82cea]
  stable/4.9: [543aabb7d14b2414f40b632e37b0921bd0af3a96]
  ubuntu/xenial: [331a33c222a6159e98b8c179504e5a0a1c4fd217, 707a13c368c6f3672c9fead446f8d2e84dce4c66]
