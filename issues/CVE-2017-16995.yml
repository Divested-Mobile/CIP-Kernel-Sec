description: |-
  The check_alu_op function in kernel/bpf/verifier.c in the Linux kernel
  through 4.14.8 allows local users to cause a denial of service (memory
  corruption) or possibly have unspecified other impact by leveraging
  incorrect sign extension.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16995
- http://openwall.com/lists/oss-security/2017/12/21/2
- https://usn.ubuntu.com/usn/usn-3523-1
- https://usn.ubuntu.com/usn/usn-3523-2
- https://usn.ubuntu.com/usn/usn-3523-3
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1454
- http://www.openwall.com/lists/oss-security/2017/12/21/2
- https://github.com/brl/grlh/blob/master/get-rekt-linux-hardened.c
- https://usn.ubuntu.com/usn/usn-3619-1
- https://usn.ubuntu.com/usn/usn-3619-2
- https://usn.ubuntu.com/usn/usn-3633-1
comments:
  Debian-carnil: Intorduced in 4.9-rc1 with 484611357c19f9e19ef742ebef4505a07d243cc9
  Ubuntu-smb: |-
    Current breaks sha1 (taken from the fix patch) only makes 4.14+
    affected. However upstream stable backported a fix for it. So I
    will modify the breaks sha1 to point to when the surrounding code
    was added.
  Ubuntu-tyhicks: |-
    Mitigation for this vulnerability is available by setting the
     kernel.unprivileged_bpf_disabled sysctl to 1:
     $ sudo sysctl kernel.unprivileged_bpf_disabled=1
     $ echo kernel.unprivileged_bpf_disabled=1 | \
       sudo tee /etc/sysctl.d/90-CVE-2017-16995-CVE-2017-16996.conf
reporters:
- Jann Horn
introduced-by:
  mainline: [484611357c19f9e19ef742ebef4505a07d243cc9]
fixed-by:
  linux-4.14.y: [6e12ea4fb45ca86cdd7425276b6993455fee947a]
  linux-4.4.y: [a6132276ab5dcc38b3299082efeb25b948263adb]
  linux-4.9.y: [3695b3b18519099224efbc5875569d2cb6da256d]
  mainline: [95a762e2c8c942780948091f8f2a4f32fce1ac6f]
