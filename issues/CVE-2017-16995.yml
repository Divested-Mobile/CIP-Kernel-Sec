description: |-
  The check_alu_op function in kernel/bpf/verifier.c in the Linux kernel
  through 4.14.8 allows local users to cause a denial of service (memory
  corruption) or possibly have unspecified other impact by leveraging
  incorrect sign extension.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16995
- http://openwall.com/lists/oss-security/2017/12/21/2
- https://usn.ubuntu.com/usn/usn-3523-1
- https://usn.ubuntu.com/usn/usn-3523-2
- https://usn.ubuntu.com/usn/usn-3523-3
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1454
- http://www.openwall.com/lists/oss-security/2017/12/21/2
- https://github.com/brl/grlh/blob/master/get-rekt-linux-hardened.c
- https://usn.ubuntu.com/usn/usn-3619-1
- https://usn.ubuntu.com/usn/usn-3619-2
- https://usn.ubuntu.com/usn/usn-3633-1
- https://ubuntu.com/security/notices/USN-3523-1
- https://ubuntu.com/security/notices/USN-3523-2
- https://ubuntu.com/security/notices/USN-3523-3
- https://ubuntu.com/security/notices/USN-3619-1
- https://ubuntu.com/security/notices/USN-3619-2
- https://ubuntu.com/security/notices/USN-3633-1
- https://www.cve.org/CVERecord?id=CVE-2017-16995
comments:
  debian/carnil: Intorduced in 4.9-rc1 with 484611357c19f9e19ef742ebef4505a07d243cc9
  ubuntu/smb: |-
    Current breaks sha1 (taken from the fix patch) only makes 4.14+
    affected. However upstream stable backported a fix for it. So I
    will modify the breaks sha1 to point to when the surrounding code
    was added.
  ubuntu/tyhicks: |-
    Mitigation for this vulnerability is available by setting the
     kernel.unprivileged_bpf_disabled sysctl to 1:
     $ sudo sysctl kernel.unprivileged_bpf_disabled=1
     $ echo kernel.unprivileged_bpf_disabled=1 | \
       sudo tee /etc/sysctl.d/90-CVE-2017-16995-CVE-2017-16996.conf
reporters:
- Jann Horn
introduced-by:
  mainline: [484611357c19f9e19ef742ebef4505a07d243cc9]
fixed-by:
  aosp/3.18: [5ac641f9499c256aaab06c758a5cfc15f3a9db5d]
  cip/4.4: [a6132276ab5dcc38b3299082efeb25b948263adb]
  cip/4.4-rt: [a6132276ab5dcc38b3299082efeb25b948263adb]
  cip/4.4-st: [a6132276ab5dcc38b3299082efeb25b948263adb]
  debian/buster-security: ['patch:debian/4.14.7-1:bugfix/all/bpf-fix-incorrect-sign-extension-in-check_alu_op.patch']
  debian/stretch-security: ['patch:debian/4.9.65-3+deb9u1:bugfix/all/bpf-fix-incorrect-sign-extension-in-check_alu_op.patch']
  mainline: [95a762e2c8c942780948091f8f2a4f32fce1ac6f]
  openela/4.14: [6e12ea4fb45ca86cdd7425276b6993455fee947a]
  stable/4.14: [6e12ea4fb45ca86cdd7425276b6993455fee947a]
  stable/4.4: [a6132276ab5dcc38b3299082efeb25b948263adb]
  stable/4.9: [3695b3b18519099224efbc5875569d2cb6da256d]
  ubuntu/xenial: [04e1c8dbc5501cb49d51325bb365da722f633a12]
