description: |-
  The raw_sendmsg() function in net/ipv4/raw.c in the Linux kernel through
  4.14.6 has a race condition in inet->hdrincl that leads to uninitialized
  stack pointer usage; this allows a local user to execute code and gain
  privileges.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17712
- http://www.openwall.com/lists/oss-security/2017/12/16/1
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c008ba5bdc9fa830e1a349b20b0be5a137bdef7a
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8f659a03a0ba9289b9aeb9b4470e6fb263d6f483
- https://usn.ubuntu.com/usn/usn-3581-1
- https://usn.ubuntu.com/usn/usn-3581-2
- https://usn.ubuntu.com/usn/usn-3582-1
- https://usn.ubuntu.com/usn/usn-3582-2
- https://usn.ubuntu.com/usn/usn-3581-3
comments:
  Ubuntu-sarnold: |-
    I haven't tested the exploit; 'high' may or may not be
     appropriate for our kernels. Please feel free to re-adjust.
reporters:
- Mohamed Ghannam
introduced-by:
  linux-3.16.y: [96231fe7577d91bb2f4e0271ca39d4f19fa904ef]
  linux-3.2.y: [b800532602c7249778ea2af0c4bcbb583eaeb705]
  mainline: [c008ba5bdc9fa830e1a349b20b0be5a137bdef7a]
fixed-by:
  linux-3.16.y: [fcccc845838ad5c88b5b7c6f0ab3ab01686e0bdd]
  linux-3.18.y: [000c7141a1feace09bf4c0f65008e51fa69ecede]
  linux-3.2.y: [8eec37d0e9039d5fbfc400324a06793b21ff24cd]
  linux-4.1.y: [d61b40939ebdc84dad77dbc78c3e26ad9d2da68b]
  linux-4.14.y: [3bc400bad0e003d40a0a2412411aed7cbae16f96]
  linux-4.4.y: [be27b620a861dc2a143b78e81e23f5622d9105da]
  linux-4.9.y: [f75f910ffa90af17eeca18714847eaa0f16cb4ad]
  mainline: [8f659a03a0ba9289b9aeb9b4470e6fb263d6f483]
