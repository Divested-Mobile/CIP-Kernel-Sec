description: |-
  The raw_sendmsg() function in net/ipv4/raw.c in the Linux kernel through
  4.14.6 has a race condition in inet->hdrincl that leads to uninitialized
  stack pointer usage; this allows a local user to execute code and gain
  privileges.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17712
- http://www.openwall.com/lists/oss-security/2017/12/16/1
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c008ba5bdc9fa830e1a349b20b0be5a137bdef7a
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=8f659a03a0ba9289b9aeb9b4470e6fb263d6f483
- https://usn.ubuntu.com/usn/usn-3581-1
- https://usn.ubuntu.com/usn/usn-3581-2
- https://usn.ubuntu.com/usn/usn-3582-1
- https://usn.ubuntu.com/usn/usn-3582-2
- https://usn.ubuntu.com/usn/usn-3581-3
- https://ubuntu.com/security/notices/USN-3581-1
- https://ubuntu.com/security/notices/USN-3581-2
- https://ubuntu.com/security/notices/USN-3582-1
- https://ubuntu.com/security/notices/USN-3582-2
- https://ubuntu.com/security/notices/USN-3581-3
- https://www.cve.org/CVERecord?id=CVE-2017-17712
comments:
  ubuntu/seth-arnold: |-
    I haven't tested the exploit; 'high' may or may not be
     appropriate for our kernels. Please feel free to re-adjust.
reporters:
- Mohamed Ghannam
introduced-by:
  mainline: [c008ba5bdc9fa830e1a349b20b0be5a137bdef7a]
  stable/3.16: [96231fe7577d91bb2f4e0271ca39d4f19fa904ef]
  stable/3.2: [b800532602c7249778ea2af0c4bcbb583eaeb705]
fixed-by:
  aosp/3.18: [000c7141a1feace09bf4c0f65008e51fa69ecede]
  cip/4.4: [be27b620a861dc2a143b78e81e23f5622d9105da]
  cip/4.4-rt: [be27b620a861dc2a143b78e81e23f5622d9105da]
  cip/4.4-st: [be27b620a861dc2a143b78e81e23f5622d9105da]
  debian/buster-security: ['patch:debian/4.14.7-1:bugfix/all/net-ipv4-fix-for-a-race-condition-in-raw_sendmsg.patch']
  debian/stretch-security: ['patch:debian/4.9.65-3+deb9u1:bugfix/all/net-ipv4-fix-for-a-race-condition-in-raw_sendmsg.patch']
  mainline: [8f659a03a0ba9289b9aeb9b4470e6fb263d6f483]
  openela/4.14: [3bc400bad0e003d40a0a2412411aed7cbae16f96]
  stable/3.16: [fcccc845838ad5c88b5b7c6f0ab3ab01686e0bdd]
  stable/3.18: [000c7141a1feace09bf4c0f65008e51fa69ecede]
  stable/3.2: [8eec37d0e9039d5fbfc400324a06793b21ff24cd]
  stable/4.1: [d61b40939ebdc84dad77dbc78c3e26ad9d2da68b]
  stable/4.14: [3bc400bad0e003d40a0a2412411aed7cbae16f96]
  stable/4.4: [be27b620a861dc2a143b78e81e23f5622d9105da]
  stable/4.9: [f75f910ffa90af17eeca18714847eaa0f16cb4ad]
  ubuntu/bionic: ['version:4.15.0-10.11']
  ubuntu/xenial: [63da13a92f24468262daef38150e069b908c3659]
