description: |-
  The Salsa20 encryption algorithm in the Linux kernel before 4.14.8 does not
  correctly handle zero-length inputs, allowing a local attacker able to use
  the AF_ALG-based skcipher interface (CONFIG_CRYPTO_USER_API_SKCIPHER) to
  cause a denial of service (uninitialized-memory free and kernel crash) or
  have unspecified other impact by executing a crafted sequence of system
  calls that use the blkcipher_walk API. Both the generic implementation
  (crypto/salsa20_generic.c) and x86 implementation
  (arch/x86/crypto/salsa20_glue.c) of Salsa20 were vulnerable.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17805
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ecaaab5649781c5a0effdaf298a925063020500e
- https://github.com/torvalds/linux/commit/ecaaab5649781c5a0effdaf298a925063020500e
- https://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.14.8
- https://usn.ubuntu.com/usn/usn-3617-1
- https://usn.ubuntu.com/usn/usn-3617-2
- https://usn.ubuntu.com/usn/usn-3617-3
- https://usn.ubuntu.com/usn/usn-3619-1
- https://usn.ubuntu.com/usn/usn-3620-1
- https://usn.ubuntu.com/usn/usn-3620-2
- https://usn.ubuntu.com/usn/usn-3619-2
- https://usn.ubuntu.com/usn/usn-3632-1
- https://ubuntu.com/security/notices/USN-3617-1
- https://ubuntu.com/security/notices/USN-3617-2
- https://ubuntu.com/security/notices/USN-3617-3
- https://ubuntu.com/security/notices/USN-3619-1
- https://ubuntu.com/security/notices/USN-3620-1
- https://ubuntu.com/security/notices/USN-3620-2
- https://ubuntu.com/security/notices/USN-3619-2
- https://ubuntu.com/security/notices/USN-3632-1
- https://www.cve.org/CVERecord?id=CVE-2017-17805
comments:
  debian/carnil: |-
    For linux-4.14.y fixed in c68b31521d5fb7216cb1113130399afe65437c6c (4.14.8)
    Introduce in eb6f13eb9f812f5812ed5d14f241309da369dee6 (2.6.25-rc1)
introduced-by:
  mainline: [eb6f13eb9f812f5812ed5d14f241309da369dee6]
fixed-by:
  aosp/3.18: [ebd52f8b6422b920b4d1697d90679a2bb4b48a0b]
  cip/4.4: [8a311b0462b59d12cb14e82e626d3612d988135b]
  cip/4.4-rt: [8a311b0462b59d12cb14e82e626d3612d988135b]
  cip/4.4-st: [8a311b0462b59d12cb14e82e626d3612d988135b]
  debian/buster-security: ['patch:debian/4.14.7-1:bugfix/all/crypto-salsa20-fix-blkcipher_walk-API-usage.patch']
  debian/jessie-security: ['patch:debian/3.16.51-3+deb8u1:bugfix/all/crypto-salsa20-fix-blkcipher_walk-API-usage.patch']
  debian/stretch-security: ['patch:debian/4.9.65-3+deb9u1:bugfix/all/crypto-salsa20-fix-blkcipher_walk-API-usage.patch']
  mainline: [ecaaab5649781c5a0effdaf298a925063020500e]
  stable/3.16: [9517d9d0c1d62515d33c0405b5a86e88647012a2]
  stable/3.18: [ebd52f8b6422b920b4d1697d90679a2bb4b48a0b]
  stable/3.2: [a1eb10d948c39388c5dea527aa4e76ac90a6a7e1]
  stable/4.1: [bbda4c57b91619642a94b193531312fe01bc2398]
  stable/4.14: [c68b31521d5fb7216cb1113130399afe65437c6c]
  stable/4.4: [8a311b0462b59d12cb14e82e626d3612d988135b]
  stable/4.9: [c32e053a11f231376f0899ef906fd43f8fc8dbd0]
  ubuntu/bionic: ['version:4.15.0-10.11']
  ubuntu/xenial: [76b3ad230c060d8117fb378c414cf068d310ed55]
