description: |-
  The KEYS subsystem in the Linux kernel before 4.14.6 omitted an
  access-control check when adding a key to the current task's "default
  request-key keyring" via the request_key() system call, allowing a local
  user to use a sequence of crafted system calls to add keys to a keyring
  with only Search permission (not Write permission) to that keyring, related
  to construct_get_dest_keyring() in security/keys/request_key.c.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17807
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=4dca6ea1d9432052afb06baf2e3ae78188a4410b
- https://github.com/torvalds/linux/commit/4dca6ea1d9432052afb06baf2e3ae78188a4410b
- https://www.kernel.org/pub/linux/kernel/v4.x/ChangeLog-4.14.6
- https://usn.ubuntu.com/usn/usn-3617-1
- https://usn.ubuntu.com/usn/usn-3617-2
- https://usn.ubuntu.com/usn/usn-3617-3
- https://usn.ubuntu.com/usn/usn-3619-1
- https://usn.ubuntu.com/usn/usn-3620-1
- https://usn.ubuntu.com/usn/usn-3620-2
- https://usn.ubuntu.com/usn/usn-3619-2
- https://usn.ubuntu.com/usn/usn-3632-1
- https://ubuntu.com/security/notices/USN-3617-1
- https://ubuntu.com/security/notices/USN-3617-2
- https://ubuntu.com/security/notices/USN-3617-3
- https://ubuntu.com/security/notices/USN-3619-1
- https://ubuntu.com/security/notices/USN-3620-1
- https://ubuntu.com/security/notices/USN-3620-2
- https://ubuntu.com/security/notices/USN-3619-2
- https://ubuntu.com/security/notices/USN-3632-1
- https://www.cve.org/CVERecord?id=CVE-2017-17807
comments:
  debian/carnil: Introduced in 3e30148c3d524a9c1c63ca28261bc24c457eb07a (2.6.13-rc1)
introduced-by:
  mainline: [3e30148c3d524a9c1c63ca28261bc24c457eb07a]
fixed-by:
  aosp/3.18: [228014b20bd8902b05942ce4db4197ce345296f3]
  cip/4.4: [13e86efb2eee6bd1f2d0aae5b0273e8e65683c9d]
  cip/4.4-rt: [13e86efb2eee6bd1f2d0aae5b0273e8e65683c9d]
  cip/4.4-st: [13e86efb2eee6bd1f2d0aae5b0273e8e65683c9d]
  debian/buster-security: ['version:debian/4.14.7-1']
  debian/jessie-security: ['patch:debian/3.16.51-3+deb8u1:bugfix/all/keys-add-missing-permission-check-for-request_key-de.patch']
  debian/stretch-security: ['patch:debian/4.9.65-3+deb9u1:bugfix/all/keys-add-missing-permission-check-for-request_key-de.patch']
  mainline: [4dca6ea1d9432052afb06baf2e3ae78188a4410b]
  openela/4.14: [69d5894ce0a67d37f900d2597fc0b2b8cef6c863]
  stable/3.16: [d3dc1ffed4044437339a22acebebaf1c5bc141ee]
  stable/3.18: [228014b20bd8902b05942ce4db4197ce345296f3]
  stable/3.2: [5d8207e99e9baadab32d815772da60bff3a07eb5]
  stable/4.14: [69d5894ce0a67d37f900d2597fc0b2b8cef6c863]
  stable/4.4: [13e86efb2eee6bd1f2d0aae5b0273e8e65683c9d]
  stable/4.9: [982707eb4ff84d4ae21618c02dd8926801b10a07]
  ubuntu/bionic: ['version:4.15.0-10.11']
  ubuntu/xenial: [ec25f148ae68253479cc7663f96fe98848ccaf42]
