description: |-
  kernel/bpf/verifier.c in the Linux kernel through 4.14.8 mishandles
  states_equal comparisons between the pointer data type and the
  UNKNOWN_VALUE data type, which allows local users to obtain potentially
  sensitive address information, aka a "pointer leak."
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17864
- http://www.openwall.com/lists/oss-security/2017/12/24/1
- https://usn.ubuntu.com/usn/usn-3523-1
- https://usn.ubuntu.com/usn/usn-3523-2
- https://usn.ubuntu.com/usn/usn-3523-3
- https://ubuntu.com/security/notices/USN-3523-1
- https://ubuntu.com/security/notices/USN-3523-2
- https://ubuntu.com/security/notices/USN-3523-3
- https://www.cve.org/CVERecord?id=CVE-2017-17864
comments:
  debian/bwh: |-
    I know that the test case was fixed upstream and in sid by the recent
    series of fixes, so have marked this as released even though I'm not
    absolutely certain that this is the specific commit that fixed it.
  debian/carnil: |-
    Ben's commit message states "This was fixed differently upstream,
    but the code around here waslargely rewritten in 4.14 by commit
    f1174f77b50c "bpf/verifier: rework value tracking". The bug can be
    detected by the bpf/verifier sub-test "pointer/scalar confusion in
    state equality check (way 1)"."
    how was it fixed? Which upstream commit?
    So needs to be checked if 179d1c5602997fef5a940c6ddcf31212cbfebd14
    fixed that problem.
reporters:
- Jann Horn
introduced-by:
  mainline: [f1174f77b50c94eecaa658fdc56fa69b421de4b8]
fixed-by:
  debian/buster-security: ['patch:debian/4.14.7-1:bugfix/all/bpf-don-t-prune-branches-when-a-scalar-is-replaced-w.patch']
  debian/stretch-security: ['patch:debian/4.9.65-3+deb9u1:bugfix/all/bpf-verifier-fix-states_equal-comparison-of-pointer-and-unknown.patch']
  mainline: [179d1c5602997fef5a940c6ddcf31212cbfebd14]
  stable/4.14: [cb56cc1b292b8b3f787fad89f1208f8e98d12c7d]
  stable/4.9: [37435f7e80ef9adc32a69013c18f135e3f434244]
