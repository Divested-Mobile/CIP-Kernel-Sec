description: |-
  In the Linux kernel before 4.15, fs/ocfs2/aops.c omits use of a semaphore
  and consequently has a race condition for access to the extent tree during
  read operations in DIRECT mode, which allows local users to cause a denial
  of service (BUG) by modifying a certain e_cpos field.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-18224
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=3e4c56d41eef5595035872a2ec5a483f42e8917f
- https://www.cve.org/CVERecord?id=CVE-2017-18224
comments:
  debian/bwh: |-
    Introduced in 4.6 by commit c15471f79506 "ocfs2: fix sparse file
    & data ordering issue in direct io"
introduced-by:
  mainline: [c15471f79506830f80eca0e7fe09b8213953ab5f]
fixed-by:
  debian/buster-security: ['version:debian/4.15.4-1']
  debian/stretch-security: ['patch:debian/4.9.88-1:bugfix/all/ocfs2-ip_alloc_sem-should-be-taken-in-ocfs2_get_bloc.patch']
  mainline: [3e4c56d41eef5595035872a2ec5a483f42e8917f]
  stable/4.14: [1ccab2bf726e1cd9292deecf4d72d732527035d6]
  stable/4.9: [78a65505cdf7b7392c963d3715269516bc812ef2]
  ubuntu/bionic: ['version:4.15.0-10.11']
