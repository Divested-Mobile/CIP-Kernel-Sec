description: |-
  The nested_vmx_check_vmptr function in arch/x86/kvm/vmx.c in the Linux
  kernel through 4.9.8 improperly emulates the VMXON instruction, which
  allows KVM L1 guest OS users to cause a denial of service (host OS memory
  consumption) by leveraging the mishandling of page references.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2596
- https://www.spinics.net/lists/kvm/msg144319.html
- https://bugzilla.redhat.com/show_bug.cgi?id=1417812
- http://www.ubuntu.com/usn/usn-3293-1
- http://www.ubuntu.com/usn/usn-3312-1
- http://www.ubuntu.com/usn/usn-3312-2
- http://www.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3293-1
- https://usn.ubuntu.com/usn/usn-3312-1
- https://usn.ubuntu.com/usn/usn-3312-2
- https://usn.ubuntu.com/usn/usn-3361-1
comments:
  Debian-bwh: |-
    Introduced in 3.16 by 3573e22cfeca "KVM: nVMX: additional checks on vmxon
    region"
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Dmitry Vyukov
introduced-by:
  mainline: [3573e22cfecaac83f82ef4f6847d90e466fc8e10]
fixed-by:
  linux-3.16.y: [591fc80b6369a886a1d21cacf11f91b455781df3]
  linux-3.18.y: [aa5b35bad59a2691db0ea739fb79be82aff5cbb8]
  linux-4.1.y: [68e9c254f662e4c2763e672b026a513d91f3a1c4]
  linux-4.10.y: [b04940e26f100c7d19fc0b5cab0210d4d924b002]
  linux-4.4.y: [c1fc1d2f214e33f91565a65ad1b4c09dae618d84]
  linux-4.4.y-cip: [c1fc1d2f214e33f91565a65ad1b4c09dae618d84]
  linux-4.4.y-cip-rt: [c1fc1d2f214e33f91565a65ad1b4c09dae618d84]
  linux-4.9.y: [75465e71ec3139b958d06d48dfc85720aed69b6a]
  mainline: [06ce521af9558814b8606c0476c54497cf83a653]
