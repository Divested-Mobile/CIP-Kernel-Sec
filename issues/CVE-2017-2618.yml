description: |-
  selinux: fix off-by-one in setprocattr
  a local process with the process:setfscreate permission can cause a kernel
  panic
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2618
- http://www.ubuntu.com/usn/usn-3361-1
- http://www.ubuntu.com/usn/usn-3381-1
- http://www.ubuntu.com/usn/usn-3381-2
- https://usn.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3381-1
- https://usn.ubuntu.com/usn/usn-3381-2
- https://ubuntu.com/security/notices/USN-3361-1
- https://ubuntu.com/security/notices/USN-3381-1
- https://ubuntu.com/security/notices/USN-3381-2
- https://www.cve.org/CVERecord?id=CVE-2017-2618
comments:
  debian/bwh: |-
    The off-by-one error was introduced in Linux 2.6.12 (just before
    the switch to git), as a (very minor) information leak.  The above
    commit increased the security impact - writing exactly "\n" can
    result in a buffer under-read and oops, which is what this CVE
    describes.  Later, commit bb646cdb12e7 "proc_pid_attr_write():
    switch to memdup_user()" reduced the buffer size so there is also
    a buffer over-read.  However, I think that has no additional impact
    since even SLOB pads heap allocations to at least 2 bytes.
  debian/carnil: Possibly introduced in 3.5-rc1 with d6ea83ec6864e9297fa8b00ec3dae183413a90e3
  ubuntu/PHLin: this code is sick from 1da177e4, commit bb646cdb mentioned in the
    fix is where this flaw can cause problem.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
introduced-by:
  mainline: [bb646cdb12e75d82258c2f2e7746d5952d3e321a, 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  aosp/3.18: [0f436bf3f81b0674414d198a01bffc4ecae4590e]
  cip/4.4: [e72c13d93e9ed2b131ceb9a290ab056ce0dd41ab]
  cip/4.4-rt: [e72c13d93e9ed2b131ceb9a290ab056ce0dd41ab]
  cip/4.4-st: [e72c13d93e9ed2b131ceb9a290ab056ce0dd41ab]
  debian/buster-security: ['version:debian/4.9.10-1']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u1:bugfix/all/selinux-fix-off-by-one-in-setprocattr.patch']
  debian/stretch-security: ['version:debian/4.9.10-1']
  mainline: [0c461cb727d146c9ef2d3e86214f498b78b7d125]
  stable/3.10: [a71b4196a72f09ed223d8140de7fd47ccdaf6e2b]
  stable/3.12: [8f52584d2277df36b41b45d0caa716640d562e09]
  stable/3.16: [0646217322101c829aaabf95294ce9b8b02ab807]
  stable/3.18: [0f436bf3f81b0674414d198a01bffc4ecae4590e]
  stable/4.1: [96e74ad7ac38ca330d16222e6da38c9a196deb40]
  stable/4.4: [e72c13d93e9ed2b131ceb9a290ab056ce0dd41ab]
  stable/4.9: [6cbaf7b94373743deb42fd410173aab81f8945fe]
  ubuntu/xenial: [e4615ab07177ad7de1d3ca7381782fdde11ea5d0]
