description: |-
  Race condition in drivers/tty/n_hdlc.c in the Linux kernel through 4.10.1
  allows local users to gain privileges or cause a denial of service (double
  free) by setting the HDLC line discipline.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-2636
- http://www.openwall.com/lists/oss-security/2017/03/07/6
- http://www.ubuntu.com/usn/usn-3219-1
- http://www.ubuntu.com/usn/usn-3218-1
- http://www.ubuntu.com/usn/usn-3219-2
- http://www.ubuntu.com/usn/usn-3220-1
- http://www.ubuntu.com/usn/usn-3220-2
- http://www.ubuntu.com/usn/usn-3221-1
- http://www.ubuntu.com/usn/usn-3221-2
- http://www.ubuntu.com/usn/usn-3220-3
- https://usn.ubuntu.com/usn/usn-3219-1
- https://usn.ubuntu.com/usn/usn-3218-1
- https://usn.ubuntu.com/usn/usn-3219-2
- https://usn.ubuntu.com/usn/usn-3220-1
- https://usn.ubuntu.com/usn/usn-3220-2
- https://usn.ubuntu.com/usn/usn-3221-1
- https://usn.ubuntu.com/usn/usn-3221-2
- https://usn.ubuntu.com/usn/usn-3220-3
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro,
    mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/tyhicks: |-
    all of our kernels are affected as CONFIG_N_HDLC=m is set
     in all releases
reporters:
- Alexander Popov
introduced-by:
  mainline: [be10eb7589337e5defbe214dae038a53dd21add8]
fixed-by:
  cip/4.4: [999853d941b99ca2ac4a331552c388e2603a9b1d]
  cip/4.4-rt: [999853d941b99ca2ac4a331552c388e2603a9b1d]
  debian/buster-security: ['version:debian/4.9.16-1']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u2:bugfix/all/tty-n_hdlc-get-rid-of-racy-n_hdlc.tbuf.patch']
  debian/stretch-security: ['version:debian/4.9.16-1']
  mainline: [82f2341c94d270421f383641b7cd670e474db56b]
  stable/3.10: [030e0b58183ab3d7260e5246589427139067c3c4]
  stable/3.12: [63075fbddd5151d2e98fa7cf0608a2113e23607d]
  stable/3.16: [2e523bd949e3bc43cf61cc8a690350fa778e3f88]
  stable/3.18: [477f7e81b30f70d45659c2c6e6aef4f79fbd15b7]
  stable/3.2: [d7ac6cf6751a0ffa00f9e46022024f79b0daa771]
  stable/4.1: [209fd3f3ef14e0b0a1d07d6ff27d75c49e656e84]
  stable/4.10: [72e5440223836633e2b5e658e7503d8b0e795f5d]
  stable/4.4: [999853d941b99ca2ac4a331552c388e2603a9b1d]
  stable/4.9: [e5b9778761558ff3d239ed76925a1a7a734918ea]
