description: |-
  The simple_set_acl function in fs/posix_acl.c in the Linux kernel before
  4.9.6 preserves the setgid bit during a setxattr call involving a tmpfs
  filesystem, which allows local users to gain group privileges by leveraging
  the existence of a setgid program with restrictions on execute permissions.
   NOTE: this vulnerability exists because of an incomplete fix for
  CVE-2016-7097.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5551
- http://seclists.org/oss-sec/2017/q1/161
- http://www.ubuntu.com/usn/usn-3234-2
- http://www.ubuntu.com/usn/usn-3234-1
- http://www.ubuntu.com/usn/usn-3359-1
- http://www.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3234-2
- https://usn.ubuntu.com/usn/usn-3234-1
- https://usn.ubuntu.com/usn/usn-3359-1
- https://usn.ubuntu.com/usn/usn-3361-1
comments:
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
introduced-by:
  cip/4.4: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  cip/4.4-rt: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  mainline: [073931017b49d9458aa351605b43a7e34598caef]
  stable/3.10: [dd2421b5edbadc5404e1cbc8fdc552f1558cc541]
  stable/3.12: [a88a2be387d1d8a5843826e12009c79e32fb46c8]
  stable/3.16: [f2ba3e2310b3967720b83126db8684c69ce41894]
  stable/3.18: [d8333c045f045385a914013a220cd1ed54c88d48]
  stable/3.2: [a06d3be52bce98746341cfb290203603fd028290]
  stable/4.1: [62fa696b7b435e93ed114dd6a23aa0881d7f81b9]
  stable/4.4: [57c9cfdb61ea270936fab76da99a742c6ef0b86f]
  stable/4.8: [ea288a690cc4e53a528ae6a1d37cd6e14320ed27]
  ubuntu/xenial: [a665e1b4b94d6c9f6f73447231b90515a73adc1d]
fixed-by:
  cip/4.4: [36672b8b99e2cf2ab0587f08a19f394f8f65a861]
  cip/4.4-rt: [36672b8b99e2cf2ab0587f08a19f394f8f65a861]
  debian/buster-security: ['version:debian/4.9.6-1']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u1:bugfix/all/tmpfs-clear-s_isgid-when-setting-posix-acls.patch']
  debian/stretch-security: ['version:debian/4.9.6-1']
  mainline: [497de07d89c1410d76a15bec2bb41f24a2a89f31]
  stable/3.10: [1026a8ce24e2598dbde2882b8b56fcfa48a2c43c]
  stable/3.12: [b0369e53c851f8cd87afd059d360a4f646840c8c]
  stable/3.16: [b35e1587153b27e12747137ce7a0df0eb921cd85]
  stable/4.4: [36672b8b99e2cf2ab0587f08a19f394f8f65a861]
  stable/4.9: [782b361c93062f083bbc9a78928498218f950399]
  ubuntu/xenial: [f4d9f3f801c03a2c1d63c708ca65f327558e86e4]
