description: |-
  The do_shmat function in ipc/shm.c in the Linux kernel through 4.9.12 does
  not restrict the address calculated by a certain rounding operation, which
  allows local users to map page zero, and consequently bypass a protection
  mechanism that exists for the mmap system call, by making crafted shmget
  and shmat system calls in a privileged context.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5669
- https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/?id=e1d35d4dc7f089e6c9c080d556feedf9c706f0c7
- https://bugzilla.kernel.org/show_bug.cgi?id=192931
- http://www.ubuntu.com/usn/usn-3265-1
- http://www.ubuntu.com/usn/usn-3265-2
- http://www.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3265-1
- https://usn.ubuntu.com/usn/usn-3265-2
- https://usn.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3583-1
- https://usn.ubuntu.com/usn/usn-3583-2
- https://ubuntu.com/security/notices/USN-3265-1
- https://ubuntu.com/security/notices/USN-3265-2
- https://ubuntu.com/security/notices/USN-3361-1
- https://ubuntu.com/security/notices/USN-3583-1
- https://ubuntu.com/security/notices/USN-3583-2
comments:
  debian/bwh: Confirmed this affects 3.2 with a simple test program
  debian/carnil: 'Fix in linux-next: https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/?id=e1d35d4dc7f089e6c9c080d556feedf9c706f0c7'
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/tyhicks: |-
    See References for a link to the fix in the linux-next tree. As of
     2017-02-27, I don't see the fix in Linus' tree.
reporters:
- Gareth Evans
fixed-by:
  aosp/3.18: [f8eb722b1f25c95fff14dcfe3fa4acf9a488cb96]
  cip/4.4: [f0ae01568e0cf4b00071d1dfd27c90022c2b6d7e]
  cip/4.4-rt: [f0ae01568e0cf4b00071d1dfd27c90022c2b6d7e]
  cip/4.4-st: [f0ae01568e0cf4b00071d1dfd27c90022c2b6d7e]
  debian/buster-security: ['patch:debian/4.9.13-1:bugfix/all/ipc-shm-fix-shmat-mmap-nil-page-protection.patch']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u2:bugfix/all/ipc-shm-Fix-shmat-mmap-nil-page-protection.patch']
  debian/stretch-security: ['patch:debian/4.9.13-1:bugfix/all/ipc-shm-fix-shmat-mmap-nil-page-protection.patch']
  mainline: [95e91b831f87ac8e1f8ed50c14d709089b4e01b8]
  stable/3.10: [20bfb0a079b45828a5937d1e3133234f06af9223]
  stable/3.12: [afa870b96a40e523f96130beeef6cdc51de4e8d9]
  stable/3.16: [13508cb3bf17a73b91957e7070112b710bdfadc2]
  stable/3.2: [c14d51ebac238f5bb6148c6999a54b02821445c6]
  stable/4.1: [c9cf983337a046e93f33c66c2707a704ec6440ac]
  stable/4.10: [87d1f686d6bf9d9003372469ffb5f1c310f28299]
  stable/4.4: [f0ae01568e0cf4b00071d1dfd27c90022c2b6d7e]
  stable/4.9: [270e84a1e6effd6c0c6e9b13b196b5fdaa392954]
  ubuntu/xenial: [1750dbb187bea5de6015fbf759977db0d5ff7d2a]
