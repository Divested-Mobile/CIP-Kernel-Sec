description: 'ipv4: Invalid IP options could cause skb->dst drop'
references:
- http://seclists.org/oss-sec/2017/q1/414
- https://patchwork.ozlabs.org/patch/724136/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5970
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=34b2cef20f19c87999fff3da4071e66937db9644
- http://www.openwall.com/lists/oss-security/2017/02/12/3
- https://bugzilla.redhat.com/show_bug.cgi?id=1421638
- https://github.com/torvalds/linux/commit/34b2cef20f19c87999fff3da4071e66937db9644
- http://www.ubuntu.com/usn/usn-3265-1
- http://www.ubuntu.com/usn/usn-3265-2
- http://www.ubuntu.com/usn/usn-3361-1
- http://www.ubuntu.com/usn/usn-3422-1
- http://www.ubuntu.com/usn/usn-3422-2
comments:
  Debian-bwh: |-
    This was actually introduced in 2.6.35 by commit f84af32cbca70
    ("net: ip_queue_rcv_skb() helper").
  Ubuntu-sbeattie: |-
    upstream commit references d826eb14ecef as
      the break point, but Nicholas Leudkte's cve references
      f84af32cbca70a3c6d30463dc08c7984af11c277. The latter predates the
      former, and there is early dropping of the dst added there. even
      before the conversion in d826eb14ecef.
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [f84af32cbca70a3c6d30463dc08c7984af11c277]
fixed-by:
  linux-3.10.y: [050c309794e9e68319843d452196994bcbde245f]
  linux-3.12.y: [e5a82d662d35933e5511c0280e8513d38d9d4fa0]
  linux-3.16.y: [631f00df1b2fa51492de8ab93a91a3876b697aeb]
  linux-3.18.y: [eeae5e030fcdba3a924bb951c4c62ef40dfc8974]
  linux-4.4.y: [2d9c2e011fd3f1be4e5643d6ad186faa5e50d4d1]
  linux-4.9.y: [f5b54446630a973e1f27b68599366bbd0ac53066]
  mainline: [34b2cef20f19c87999fff3da4071e66937db9644]
