description: |-
  Race condition in the sctp_wait_for_sndbuf function in net/sctp/socket.c in
  the Linux kernel before 4.9.11 allows local users to cause a denial of
  service (assertion failure and panic) via a multithreaded application that
  peels off an association in a certain buffer-full state.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5986
- http://www.ubuntu.com/usn/usn-3264-1
- http://www.ubuntu.com/usn/usn-3264-2
- http://www.ubuntu.com/usn/usn-3266-2
- http://www.ubuntu.com/usn/usn-3266-1
- http://www.ubuntu.com/usn/usn-3265-1
- http://www.ubuntu.com/usn/usn-3265-2
- https://usn.ubuntu.com/usn/usn-3264-1
- https://usn.ubuntu.com/usn/usn-3264-2
- https://usn.ubuntu.com/usn/usn-3266-2
- https://usn.ubuntu.com/usn/usn-3266-1
- https://usn.ubuntu.com/usn/usn-3265-1
- https://usn.ubuntu.com/usn/usn-3265-2
- https://ubuntu.com/security/notices/USN-3264-1
- https://ubuntu.com/security/notices/USN-3264-2
- https://ubuntu.com/security/notices/USN-3266-2
- https://ubuntu.com/security/notices/USN-3266-1
- https://ubuntu.com/security/notices/USN-3265-1
- https://ubuntu.com/security/notices/USN-3265-2
- https://www.cve.org/CVERecord?id=CVE-2017-5986
comments:
  debian/bwh: |-
    Upstream fix actually makes things worse; see
    https://marc.info/?l=linux-sctp&m=148770688203103&w=2 and CVE-2017-6353
  debian/carnil: Introduced in 2.6.17-rc5 with 61c9fed41638249f8b6ca5345064eb1beb50179f
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
  ubuntu/sbeattie: |-
    introduces CVE-2017-6353, which is fixed by
      dfcb9f4f99f1e9a49e43398a7bfbf56927544af1
reporters:
- Alexander Popov
introduced-by:
  mainline: [61c9fed41638249f8b6ca5345064eb1beb50179f]
fixed-by:
  aosp/3.18: [a4a3d26a1d4e0702b1b54c8dc9c56ed61742568a]
  cip/4.4: [a4226c7ebfb5748447f1640c97f0306ed69e44f8]
  cip/4.4-rt: [a4226c7ebfb5748447f1640c97f0306ed69e44f8]
  cip/4.4-st: [a4226c7ebfb5748447f1640c97f0306ed69e44f8]
  debian/buster-security: ['patch:debian/4.9.10-1:bugfix/all/sctp-avoid-BUG_ON-on-sctp_wait_for_sndbuf.patch']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u2:bugfix/all/sctp-avoid-BUG_ON-on-sctp_wait_for_sndbuf.patch']
  debian/stretch-security: ['patch:debian/4.9.10-1:bugfix/all/sctp-avoid-BUG_ON-on-sctp_wait_for_sndbuf.patch']
  mainline: [2dcab598484185dea7ec22219c76dcdd59e3cb90]
  stable/3.10: [1f7cb732afeda60fb18012a79759400f611ab31f]
  stable/3.12: [7a814bf5fc8b6738af64bc05d824a22d269962c6]
  stable/3.16: [2ad78d37e15d7adba80deb103068faf6d88f95ac]
  stable/3.18: [a4a3d26a1d4e0702b1b54c8dc9c56ed61742568a]
  stable/3.2: [8b9f297cd4171ffaec7441b38cecd61f9c5b3a7f]
  stable/4.4: [a4226c7ebfb5748447f1640c97f0306ed69e44f8]
  stable/4.9: [00eff2ebbd229758e90659907724c14dd5a18339]
  ubuntu/xenial: [c78182334410cba73e54bf945258627b6b93f40d]
