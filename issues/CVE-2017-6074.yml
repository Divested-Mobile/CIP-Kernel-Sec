description: |-
  The dccp_rcv_state_process function in net/dccp/input.c in the Linux kernel
  through 4.9.11 mishandles DCCP_PKT_REQUEST packet data structures in the
  LISTEN state, which allows local users to obtain root privileges or cause a
  denial of service (double free) via an application that makes an
  IPV6_RECVPKTINFO setsockopt system call.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6074
- https://patchwork.ozlabs.org/patch/728808/
- https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-6074
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4
- http://www.ubuntu.com/usn/usn-3206-1
- http://www.ubuntu.com/usn/usn-3207-1
- http://www.ubuntu.com/usn/usn-3207-2
- http://www.ubuntu.com/usn/usn-3208-1
- http://www.ubuntu.com/usn/usn-3208-2
- http://www.ubuntu.com/usn/usn-3209-1
- http://www.openwall.com/lists/oss-security/2017/02/26/2
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1665935
- https://usn.ubuntu.com/usn/usn-3206-1
- https://usn.ubuntu.com/usn/usn-3207-1
- https://usn.ubuntu.com/usn/usn-3207-2
- https://usn.ubuntu.com/usn/usn-3208-1
- https://usn.ubuntu.com/usn/usn-3208-2
- https://usn.ubuntu.com/usn/usn-3209-1
- https://ubuntu.com/security/notices/USN-3206-1
- https://ubuntu.com/security/notices/USN-3207-1
- https://ubuntu.com/security/notices/USN-3207-2
- https://ubuntu.com/security/notices/USN-3208-1
- https://ubuntu.com/security/notices/USN-3208-2
- https://ubuntu.com/security/notices/USN-3209-1
- https://www.cve.org/CVERecord?id=CVE-2017-6074
comments:
  debian/carnil: bwh disabled dccp auto-loading in 4.9.10-1
  ubuntu/sbeattie: |-
    MITIGATION: blacklist the dccp ipv[46] autoloading aliases by
      adding the following lines to /etc/modprobe.d/blacklist-dccp.conf:
        alias net-pf-2-proto-0-type-6 off
        alias net-pf-2-proto-33-type-6 off
        alias net-pf-10-proto-0-type-6 off
        alias net-pf-10-proto-33-type-6 off
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [333fad5364d6b457c8d837f7d05802d2aaf8a961]
fixed-by:
  aosp/3.18: [ae803f3ffbca73a8ba65759c71ce30f3bbcda83f]
  cip/4.4: [a95df078e86624ee330e82aad34cfd3b5fcf21ce]
  cip/4.4-rt: [a95df078e86624ee330e82aad34cfd3b5fcf21ce]
  cip/4.4-st: [a95df078e86624ee330e82aad34cfd3b5fcf21ce]
  debian/buster-security: ['version:debian/4.9.13-1']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u1:bugfix/all/dccp-fix-freeing-skb-too-early-for-IPV6_RECVPKTINFO.patch']
  debian/stretch-security: ['version:debian/4.9.13-1']
  mainline: [5edabca9d4cff7f1f2b68f0bac55ef99d9798ba4]
  stable/3.10: [4155279174e8cbe4d06b256e4e66b5491a897e5e]
  stable/3.12: [336d459d464a2d23b5df724ae5fb5cd92bc9074c]
  stable/3.16: [c21341fd2c2e0e840864062707825d6d0d5e13b2]
  stable/3.18: [ae803f3ffbca73a8ba65759c71ce30f3bbcda83f]
  stable/3.2: [fd75b79ea9c7cf89d5b95f9896c6b4dcdac8c4cb]
  stable/4.1: [98442999b9671784e659b205be8b5b6be8e81629]
  stable/4.4: [a95df078e86624ee330e82aad34cfd3b5fcf21ce]
  stable/4.9: [171d92a9d915d238e05285ca67faf30f554d7df7]
  ubuntu/xenial: [4feb04ade2a559e0e76a0215d259c5673e5b1cbd]
