description: |-
  Race condition in net/packet/af_packet.c in the Linux kernel before 4.9.13
  allows local users to cause a denial of service (use-after-free) or
  possibly have unspecified other impact via a multithreaded application that
  makes PACKET_FANOUT setsockopt system calls.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6346
comments:
  Debian-bwh: |-
    The races can clearly lead to a UAF since 4.2.  The impact may be
    less severe in earlier versions but still needs to be fixed.
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
introduced-by:
  mainline: [dc99f600698dcac69b8f56dda9a8a00d645c5ffc]
fixed-by:
  linux-4.9.y: [722737f27774b14be5a1d2d3b9281dcded7c48b2]
  mainline: [d199fab63c11998a602205f7ee7ff7c05c97164b]
