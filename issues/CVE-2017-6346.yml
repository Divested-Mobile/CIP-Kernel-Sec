description: |-
  Race condition in net/packet/af_packet.c in the Linux kernel before 4.9.13
  allows local users to cause a denial of service (use-after-free) or
  possibly have unspecified other impact via a multithreaded application that
  makes PACKET_FANOUT setsockopt system calls.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6346
- http://www.ubuntu.com/usn/usn-3265-1
- http://www.ubuntu.com/usn/usn-3265-2
- http://www.ubuntu.com/usn/usn-3361-1
- http://www.ubuntu.com/usn/usn-3422-1
- http://www.ubuntu.com/usn/usn-3422-2
- https://usn.ubuntu.com/usn/usn-3265-1
- https://usn.ubuntu.com/usn/usn-3265-2
- https://usn.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3422-1
- https://usn.ubuntu.com/usn/usn-3422-2
- https://ubuntu.com/security/notices/USN-3265-1
- https://ubuntu.com/security/notices/USN-3265-2
- https://ubuntu.com/security/notices/USN-3361-1
- https://ubuntu.com/security/notices/USN-3422-1
- https://ubuntu.com/security/notices/USN-3422-2
- https://www.cve.org/CVERecord?id=CVE-2017-6346
comments:
  debian/bwh: |-
    The races can clearly lead to a UAF since 4.2.  The impact may be
    less severe in earlier versions but still needs to be fixed.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
introduced-by:
  mainline: [dc99f600698dcac69b8f56dda9a8a00d645c5ffc]
fixed-by:
  aosp/3.10: [4e6bee65c56af545baeea8284ba2da3c645eef51]
  aosp/3.18: [be671c7e17454b4f144a8e05268a6071748a8791]
  cip/4.4: [abd672deb170c4443e41173160de0ba2ae1abc08]
  cip/4.4-rt: [abd672deb170c4443e41173160de0ba2ae1abc08]
  cip/4.4-st: [abd672deb170c4443e41173160de0ba2ae1abc08]
  debian/buster-security: ['version:debian/4.9.13-1']
  debian/jessie-security: ['patch:debian/3.16.39-1+deb8u2:bugfix/all/packet-fix-races-in-fanout_add.patch']
  debian/stretch-security: ['version:debian/4.9.13-1']
  mainline: [d199fab63c11998a602205f7ee7ff7c05c97164b]
  stable/3.10: [2a272abc4e543f488b3a73292ee75a06f20d077a]
  stable/3.12: [6d46193d7ccae0758a8e887a6897a3e133eb9610]
  stable/3.16: [bf7916239a591920427b0ee8022c222eeccba840]
  stable/3.2: [382299a020add34cc75ac501bbcb655195c123b8]
  stable/4.1: [7babaac5d49ee7a88a5a324668dd13b575635d09]
  stable/4.4: [abd672deb170c4443e41173160de0ba2ae1abc08]
  stable/4.9: [722737f27774b14be5a1d2d3b9281dcded7c48b2]
  ubuntu/xenial: [cb2344c61873e758074f06eb5566a83dd1164810]
