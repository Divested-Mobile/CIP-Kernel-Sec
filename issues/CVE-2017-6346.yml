description: |-
  Race condition in net/packet/af_packet.c in the Linux kernel before 4.9.13
  allows local users to cause a denial of service (use-after-free) or
  possibly have unspecified other impact via a multithreaded application that
  makes PACKET_FANOUT setsockopt system calls.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6346
- http://www.ubuntu.com/usn/usn-3265-1
- http://www.ubuntu.com/usn/usn-3265-2
- http://www.ubuntu.com/usn/usn-3361-1
- http://www.ubuntu.com/usn/usn-3422-1
- http://www.ubuntu.com/usn/usn-3422-2
- https://usn.ubuntu.com/usn/usn-3265-1
- https://usn.ubuntu.com/usn/usn-3265-2
- https://usn.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3422-1
- https://usn.ubuntu.com/usn/usn-3422-2
comments:
  debian/bwh: |-
    The races can clearly lead to a UAF since 4.2.  The impact may be
    less severe in earlier versions but still needs to be fixed.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
introduced-by:
  mainline: [dc99f600698dcac69b8f56dda9a8a00d645c5ffc]
fixed-by:
  linux-3.10.y: [2a272abc4e543f488b3a73292ee75a06f20d077a]
  linux-3.12.y: [6d46193d7ccae0758a8e887a6897a3e133eb9610]
  linux-3.16.y: [bf7916239a591920427b0ee8022c222eeccba840]
  linux-3.2.y: [382299a020add34cc75ac501bbcb655195c123b8]
  linux-4.1.y: [7babaac5d49ee7a88a5a324668dd13b575635d09]
  linux-4.4.y: [abd672deb170c4443e41173160de0ba2ae1abc08]
  linux-4.4.y-cip: [abd672deb170c4443e41173160de0ba2ae1abc08]
  linux-4.4.y-cip-rt: [abd672deb170c4443e41173160de0ba2ae1abc08]
  linux-4.9.y: [722737f27774b14be5a1d2d3b9281dcded7c48b2]
  mainline: [d199fab63c11998a602205f7ee7ff7c05c97164b]
