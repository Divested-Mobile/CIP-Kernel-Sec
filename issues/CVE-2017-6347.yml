description: |-
  The ip_cmsg_recv_checksum function in net/ipv4/ip_sockglue.c in the Linux
  kernel before 4.10.1 has incorrect expectations about skb data layout,
  which allows local users to cause a denial of service (buffer over-read) or
  possibly have unspecified other impact via crafted system calls, as
  demonstrated by use of the MSG_MORE flag in conjunction with loopback UDP
  transmission.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6347
- http://www.ubuntu.com/usn/usn-3265-1
- http://www.ubuntu.com/usn/usn-3265-2
- http://www.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3265-1
- https://usn.ubuntu.com/usn/usn-3265-2
- https://usn.ubuntu.com/usn/usn-3361-1
- https://ubuntu.com/security/notices/USN-3265-1
- https://ubuntu.com/security/notices/USN-3265-2
- https://ubuntu.com/security/notices/USN-3361-1
- https://www.cve.org/CVERecord?id=CVE-2017-6347
comments:
  debian/bwh: |-
    Introduced in 4.0 by commit ad6f939ab193 "ip: Add offset parameter to
    ip_cmsg_recv".
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [ad6f939ab193750cc94a265f58e007fb598c97b7]
fixed-by:
  cip/4.4: [ce9ecb8d7f3c698c48b0885936d0b7275dacde9c]
  cip/4.4-rt: [ce9ecb8d7f3c698c48b0885936d0b7275dacde9c]
  cip/4.4-st: [ce9ecb8d7f3c698c48b0885936d0b7275dacde9c]
  debian/buster-security: ['version:debian/4.9.13-1']
  debian/stretch-security: ['version:debian/4.9.13-1']
  mainline: [ca4ef4574f1ee5252e2cd365f8f5d5bafd048f32]
  stable/4.10: [7e963e31ded6cf66f85f03faa48ad9fb11a7b03d]
  stable/4.4: [ce9ecb8d7f3c698c48b0885936d0b7275dacde9c]
  stable/4.9: [481aedf869fbf2d4503ca0005dbd68b78422955a]
  ubuntu/xenial: [7d8061373711cf4716cc2473590a32521a96c7ca]
