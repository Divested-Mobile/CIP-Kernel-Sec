description: Missing range checks in xfrm_user allow heap buffer overflow and privilege
  escalation
references:
- http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7184
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7184
- http://www.eweek.com/security/ubuntu-linux-falls-on-day-1-of-pwn2own-hacking-competition
- https://blog.trendmicro.com/results-pwn2own-2017-day-one/
- https://twitter.com/thezdi/status/842126074435665920
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=52b9c816807abd46c285cd8ab183fe93194bfb3f
- https://git.kernel.org/linus/677e806da4d916052585301785d847c3b3e6186a
- https://git.kernel.org/linus/f843ee6dd019bcece3e74e76ad9df0155655d0df
- http://www.ubuntu.com/usn/usn-3250-2
- http://www.ubuntu.com/usn/usn-3251-1
- http://www.ubuntu.com/usn/usn-3251-2
- http://www.ubuntu.com/usn/usn-3249-2
- http://www.ubuntu.com/usn/usn-3249-1
- http://www.ubuntu.com/usn/usn-3250-1
- http://www.ubuntu.com/usn/usn-3248-1
- https://usn.ubuntu.com/usn/usn-3250-2
- https://usn.ubuntu.com/usn/usn-3251-1
- https://usn.ubuntu.com/usn/usn-3251-2
- https://usn.ubuntu.com/usn/usn-3249-2
- https://usn.ubuntu.com/usn/usn-3249-1
- https://usn.ubuntu.com/usn/usn-3250-1
- https://usn.ubuntu.com/usn/usn-3248-1
- https://ubuntu.com/security/notices/USN-3250-2
- https://ubuntu.com/security/notices/USN-3251-1
- https://ubuntu.com/security/notices/USN-3251-2
- https://ubuntu.com/security/notices/USN-3249-2
- https://ubuntu.com/security/notices/USN-3249-1
- https://ubuntu.com/security/notices/USN-3250-1
- https://ubuntu.com/security/notices/USN-3248-1
comments:
  debian/bwh: |-
    xfrm_user is only accessible with CAP_NET_ADMIN capability (in any
    user namespace).  So this is not exploitable by unprivileged users
    in a default Debian configuration.
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
fixed-by:
  aosp/3.18: [281edc5a3778cd551e688e8d0c88d05d948b4faf, 88570aa8333e1b3e250fcbd0ac2778f1c9174416]
  cip/4.4: [cce7e56dd73f75fef0a7f594fb129285a660fec0, 22c9e7c092f63335ba7a7301e0e0b4c4ebed53a8]
  cip/4.4-rt: [cce7e56dd73f75fef0a7f594fb129285a660fec0, 22c9e7c092f63335ba7a7301e0e0b4c4ebed53a8]
  cip/4.4-st: [cce7e56dd73f75fef0a7f594fb129285a660fec0, 22c9e7c092f63335ba7a7301e0e0b4c4ebed53a8]
  debian/buster-security: ['patch:debian/4.9.18-1:bugfix/all/xfrm_user-validate-xfrm_msg_newae-xfrma_replay_esn_val-replay_window.patch',
    'patch:debian/4.9.18-1:bugfix/all/xfrm_user-validate-xfrm_msg_newae-incoming-esn-size-harder.patch']
  debian/jessie-security: ['patch:debian/3.16.43-1:bugfix/all/xfrm_user-validate-xfrm_msg_newae-xfrma_replay_esn_val-replay_window.patch',
    'patch:debian/3.16.43-1:bugfix/all/xfrm_user-validate-xfrm_msg_newae-incoming-esn-size-harder.patch']
  debian/stretch-security: ['patch:debian/4.9.18-1:bugfix/all/xfrm_user-validate-xfrm_msg_newae-xfrma_replay_esn_val-replay_window.patch',
    'patch:debian/4.9.18-1:bugfix/all/xfrm_user-validate-xfrm_msg_newae-incoming-esn-size-harder.patch']
  mainline: [677e806da4d916052585301785d847c3b3e6186a, f843ee6dd019bcece3e74e76ad9df0155655d0df]
  stable/3.10: [ccf85441e11acf8db050d9dcd5dce61f893c454e, cbd95d10ef8248a02864a45f26089553294b155d]
  stable/3.12: [be4f4140ab3e8d4142f47c79b0a29f0ec53540b5, 1b2150972c265d0e477c52d59b7061bdb6889c35]
  stable/3.16: [811f5600db1a0a9c4f1abad5017e09f43d7088f3, fda265baa45b630675359db3699bb68350c4b907]
  stable/3.18: [281edc5a3778cd551e688e8d0c88d05d948b4faf, 88570aa8333e1b3e250fcbd0ac2778f1c9174416]
  stable/3.2: [04dba730e9d4798184b4769f74ef14c20f8c6f9a, 4d09fd3505c59374e599a29918ca40059be3d554]
  stable/4.1: [438db92d7f2792e3bad17be70e6edf0f44a081f0, 171a957989c4f398adb41078dbfff73b0821e383]
  stable/4.10: [ffcf5de8152006ee478f3135412aac59b7ab1796, 843e5b6c801a0ce74a4f53c1300fb19ef9a6060a]
  stable/4.4: [cce7e56dd73f75fef0a7f594fb129285a660fec0, 22c9e7c092f63335ba7a7301e0e0b4c4ebed53a8]
  stable/4.9: [64a5465799ee40e3d54d9da3037934cd4b7b502f, 79191ea36dc9be10a9c9b03d6b341ed2d2f76045]
  ubuntu/xenial: [81b0ca30edd09f5244b48acaf501e1573c5c3627, e51e16484079a1704bc33c16acbc7b59307be29d]
