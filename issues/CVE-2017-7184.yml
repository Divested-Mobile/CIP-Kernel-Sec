description: Missing range checks in xfrm_user allow heap buffer overflow and privilege
  escalation
references:
- http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7184
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7184
- http://www.eweek.com/security/ubuntu-linux-falls-on-day-1-of-pwn2own-hacking-competition
- https://blog.trendmicro.com/results-pwn2own-2017-day-one/
- https://twitter.com/thezdi/status/842126074435665920
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=52b9c816807abd46c285cd8ab183fe93194bfb3f
- https://git.kernel.org/linus/677e806da4d916052585301785d847c3b3e6186a
- https://git.kernel.org/linus/f843ee6dd019bcece3e74e76ad9df0155655d0df
- http://www.ubuntu.com/usn/usn-3250-2
- http://www.ubuntu.com/usn/usn-3251-1
- http://www.ubuntu.com/usn/usn-3251-2
- http://www.ubuntu.com/usn/usn-3249-2
- http://www.ubuntu.com/usn/usn-3249-1
- http://www.ubuntu.com/usn/usn-3250-1
- http://www.ubuntu.com/usn/usn-3248-1
comments:
  Debian-bwh: |-
    xfrm_user is only accessible with CAP_NET_ADMIN capability (in any
    user namespace).  So this is not exploitable by unprivileged users
    in a default Debian configuration.
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
fixed-by:
  linux-3.12.y: [be4f4140ab3e8d4142f47c79b0a29f0ec53540b5, 1b2150972c265d0e477c52d59b7061bdb6889c35]
  linux-3.16.y: [811f5600db1a0a9c4f1abad5017e09f43d7088f3, fda265baa45b630675359db3699bb68350c4b907]
  linux-3.18.y: [281edc5a3778cd551e688e8d0c88d05d948b4faf, 88570aa8333e1b3e250fcbd0ac2778f1c9174416]
  linux-3.2.y: [04dba730e9d4798184b4769f74ef14c20f8c6f9a, 4d09fd3505c59374e599a29918ca40059be3d554]
  linux-4.10.y: [ffcf5de8152006ee478f3135412aac59b7ab1796, 843e5b6c801a0ce74a4f53c1300fb19ef9a6060a]
  linux-4.4.y: [cce7e56dd73f75fef0a7f594fb129285a660fec0, 22c9e7c092f63335ba7a7301e0e0b4c4ebed53a8]
  linux-4.9.y: [64a5465799ee40e3d54d9da3037934cd4b7b502f, 79191ea36dc9be10a9c9b03d6b341ed2d2f76045]
  mainline: [677e806da4d916052585301785d847c3b3e6186a, f843ee6dd019bcece3e74e76ad9df0155655d0df]
