description: |-
  The sg_ioctl function in drivers/scsi/sg.c in the Linux kernel through
  4.10.4 allows local users to cause a denial of service (stack-based buffer
  overflow) or possibly have unspecified other impact via a large command
  size in an SG_NEXT_CMD_LEN ioctl call, leading to out-of-bounds write
  access in the sg_write function.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7187
- https://gist.github.com/dvyukov/48ad14e84de45b0be92b7f0eda20ff1b
- https://git.kernel.org/pub/scm/linux/kernel/git/mkp/scsi.git/commit/?h=4.11/scsi-fixes&id=bf33f87dd04c371ea33feb821b60d63d754e3124
- http://www.ubuntu.com/usn/usn-3293-1
- http://www.ubuntu.com/usn/usn-3291-1
- http://www.ubuntu.com/usn/usn-3291-2
- http://www.ubuntu.com/usn/usn-3291-3
- http://www.ubuntu.com/usn/usn-3361-1
- http://www.ubuntu.com/usn/usn-3422-1
- http://www.ubuntu.com/usn/usn-3422-2
- https://usn.ubuntu.com/usn/usn-3293-1
- https://usn.ubuntu.com/usn/usn-3291-1
- https://usn.ubuntu.com/usn/usn-3291-2
- https://usn.ubuntu.com/usn/usn-3291-3
- https://usn.ubuntu.com/usn/usn-3361-1
- https://usn.ubuntu.com/usn/usn-3422-1
- https://usn.ubuntu.com/usn/usn-3422-2
- https://ubuntu.com/security/notices/USN-3293-1
- https://ubuntu.com/security/notices/USN-3291-1
- https://ubuntu.com/security/notices/USN-3291-2
- https://ubuntu.com/security/notices/USN-3291-3
- https://ubuntu.com/security/notices/USN-3361-1
- https://ubuntu.com/security/notices/USN-3422-1
- https://ubuntu.com/security/notices/USN-3422-2
- https://www.cve.org/CVERecord?id=CVE-2017-7187
comments:
  debian/bwh: 'Introduced in 3.17 by 65c26a0f3969 "sg: relax 16 byte cdb restriction"'
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Dmitry Vyukov
introduced-by:
  mainline: [65c26a0f39695ba01d9693754f27ca76cc8a3ab5]
fixed-by:
  aosp/3.18: [a3bc27d43f5b5e8cac993b447eeb2f2efb1493af]
  cip/4.4: [a92f411914cad6532e82e4607bc4075a5ffaa366]
  cip/4.4-rt: [a92f411914cad6532e82e4607bc4075a5ffaa366]
  cip/4.4-st: [a92f411914cad6532e82e4607bc4075a5ffaa366]
  debian/buster-security: ['patch:debian/4.9.18-1:bugfix/all/scsi-sg-check-length-passed-to-sg_next_cmd_len.patch']
  debian/stretch-security: ['patch:debian/4.9.18-1:bugfix/all/scsi-sg-check-length-passed-to-sg_next_cmd_len.patch']
  mainline: [bf33f87dd04c371ea33feb821b60d63d754e3124]
  stable/3.18: [a3bc27d43f5b5e8cac993b447eeb2f2efb1493af]
  stable/4.1: [861b5c18bb146f3845dc52f64e7bc997d6cf8db3]
  stable/4.10: [f7019040f6d7d09c3eb8835b38730a4b62f78734]
  stable/4.4: [a92f411914cad6532e82e4607bc4075a5ffaa366]
  stable/4.9: [c2a869527865c35b605877f966cb5d514fdc5fbb]
  ubuntu/xenial: [bff00b11d9e8925f23c6c9835e55d5bb5654d5dc]
