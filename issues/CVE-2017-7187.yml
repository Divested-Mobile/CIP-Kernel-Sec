description: |-
  The sg_ioctl function in drivers/scsi/sg.c in the Linux kernel through
  4.10.4 allows local users to cause a denial of service (stack-based buffer
  overflow) or possibly have unspecified other impact via a large command
  size in an SG_NEXT_CMD_LEN ioctl call, leading to out-of-bounds write
  access in the sg_write function.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7187
- https://gist.github.com/dvyukov/48ad14e84de45b0be92b7f0eda20ff1b
- https://git.kernel.org/pub/scm/linux/kernel/git/mkp/scsi.git/commit/?h=4.11/scsi-fixes&id=bf33f87dd04c371ea33feb821b60d63d754e3124
comments:
  Debian-bwh: 'Introduced in 3.17 by 65c26a0f3969 "sg: relax 16 byte cdb restriction"'
  Ubuntu-jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
fixed-by:
  linux-3.18.y: [a3bc27d43f5b5e8cac993b447eeb2f2efb1493af]
  linux-4.10.y: [f7019040f6d7d09c3eb8835b38730a4b62f78734]
  linux-4.4.y: [a92f411914cad6532e82e4607bc4075a5ffaa366]
  linux-4.9.y: [c2a869527865c35b605877f966cb5d514fdc5fbb]
  mainline: [bf33f87dd04c371ea33feb821b60d63d754e3124]
