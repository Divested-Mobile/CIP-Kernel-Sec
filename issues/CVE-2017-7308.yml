description: AF_PACKET missing/incorrect range checks allow heap buffer overflow
references:
- https://patchwork.ozlabs.org/patch/744811/
- https://patchwork.ozlabs.org/patch/744812/
- https://patchwork.ozlabs.org/patch/744813/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7308
- http://www.ubuntu.com/usn/usn-3256-1
- http://www.ubuntu.com/usn/usn-3256-2
- https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html
- https://usn.ubuntu.com/usn/usn-3256-1
- https://usn.ubuntu.com/usn/usn-3256-2
- https://ubuntu.com/security/notices/USN-3256-1
- https://ubuntu.com/security/notices/USN-3256-2
- https://www.cve.org/CVERecord?id=CVE-2017-7308
comments:
  debian/bwh: |-
    3.2 is also missing an earlier related fix, commit dc808110bb62
    "packet: handle too big packets for PACKET_V3"
  debian/carnil: |-
    which was 16fc98c2479f5477f2df220acd9cb53686e33f4c (in 4.9.23)
    the other two commits are in 4.9.26
  debian/nsl: only saw one of the commits in the 4.9 release
  ubuntu/jdstrand: |-
    android kernels (flo, goldfish, grouper, maguro, mako and manta) are
     not supported on the Ubuntu Touch 14.10 and earlier preview kernels
    linux-lts-saucy no longer receives official support
    linux-lts-quantal no longer receives official support
reporters:
- Andrey Konovalov
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2, 8913336a7e8d56e984109a3137d6c0e3362596a4,
    f6fb8f100b807378fda19e83e5ac6828b638603a]
fixed-by:
  aosp/3.18: [eeead20a3d208b411eab883f9ba3180c15b566d0, 3e77cacaae604cd127642869381a87774880afb6,
    fe6fe14f1158bbcf4a07240cb93925e84ef25e89]
  cip/4.4: [d35f8fa0b93e61dd95b8f86928a783c4d8a32d3e, cf71bd41f8091588c7b28ebba6eaa635a6874493,
    25adf4e32a890244f4f53d2ab30b423efb5aab41]
  cip/4.4-rt: [d35f8fa0b93e61dd95b8f86928a783c4d8a32d3e, cf71bd41f8091588c7b28ebba6eaa635a6874493,
    25adf4e32a890244f4f53d2ab30b423efb5aab41]
  cip/4.4-st: [d35f8fa0b93e61dd95b8f86928a783c4d8a32d3e, cf71bd41f8091588c7b28ebba6eaa635a6874493,
    25adf4e32a890244f4f53d2ab30b423efb5aab41]
  debian/buster-security: ['patch:debian/4.9.18-1:bugfix/all/net-packet-fix-overflow-in-check-for-priv-area-size.patch',
    'patch:debian/4.9.18-1:bugfix/all/net-packet-fix-overflow-in-check-for-tp_frame_nr.patch',
    'patch:debian/4.9.18-1:bugfix/all/net-packet-fix-overflow-in-check-for-tp_reserve.patch']
  debian/jessie-security: ['patch:debian/3.16.43-1:bugfix/all/net-packet-fix-overflow-in-check-for-priv-area-size.patch',
    'patch:debian/3.16.43-1:bugfix/all/net-packet-fix-overflow-in-check-for-tp_frame_nr.patch',
    'patch:debian/3.16.43-1:bugfix/all/net-packet-fix-overflow-in-check-for-tp_reserve.patch']
  debian/stretch-security: ['patch:debian/4.9.18-1:bugfix/all/net-packet-fix-overflow-in-check-for-priv-area-size.patch',
    'patch:debian/4.9.18-1:bugfix/all/net-packet-fix-overflow-in-check-for-tp_frame_nr.patch',
    'patch:debian/4.9.18-1:bugfix/all/net-packet-fix-overflow-in-check-for-tp_reserve.patch']
  mainline: [2b6867c2ce76c596676bec7d2d525af525fdc6e2, 8f8d28e4d6d815a391285e121c3a53a0b6cb9e7b,
    bcc5364bdcfe131e6379363f089e7b4108d35b70]
  stable/3.10: [56bc42d0db996003318b06d9c0033506da007c23, 492980ca268c3a213a71f5c0aef116b58c665e16,
    a8069aeebf93c1f3a397364a44cddaa90ff472f3]
  stable/3.12: [0a39eb8a881e83154aadacc36fc8bda8258f1991, 1bfb6e1bc972137a4aa7df3397d5e0fe90e13025,
    915ff058627e270b93b3d398b4b0f2c42d27a362]
  stable/3.16: [a481ab4edd87bc2dc6f1fa9029866dd69c86fc5c, a318bc0bcec7f7867f1f1d8cef5ae6f25aa169a7,
    7bb3f26487e578c2cb0567196ce93c008967a269]
  stable/3.18: [eeead20a3d208b411eab883f9ba3180c15b566d0, 3e77cacaae604cd127642869381a87774880afb6,
    fe6fe14f1158bbcf4a07240cb93925e84ef25e89]
  stable/3.2: [091a6de006536c50f8a30db60d994a5b083b1c7b, 1634172286550a62d8a0a98cf8bec5cd975fa09c,
    96053b293c69c636d8d34fc569ac81fbf1118658]
  stable/4.1: [dd07486ceba48b5d2157b212bb9bd5ce9a46b593, fed853407cc28fff0db4e4976a80323fea39d183,
    cc09115fb0b9cecc1fffd881416aad0b0639adc3]
  stable/4.10: [10e13823b0a984d3184031e292d15a99cb4c0b81, 57a88382a9692c123e98be64c64535088c442c0e,
    f9bd6b937de64a4f3fcfce3a6899e1d5f061c73d]
  stable/4.4: [d35f8fa0b93e61dd95b8f86928a783c4d8a32d3e, cf71bd41f8091588c7b28ebba6eaa635a6874493,
    25adf4e32a890244f4f53d2ab30b423efb5aab41]
  stable/4.9: [16fc98c2479f5477f2df220acd9cb53686e33f4c, 10452124bac39411e92fc8910dd418648bbb78ac,
    1f49c8cd2c9a53ea04bd86bce01247415d12aa26]
  ubuntu/xenial: [79beb34f69d31a2dbe59d34df4958cbd37b3c1fb, 80c3efbbdf8bd5c599f7866b0f18189a8499b01b,
    bdc65960d57bb539c44e634745d579f979a5517d]
