description: |-
  The Linux Kernel versions 4.14, 4.15, and 4.16 has a null pointer
  dereference which can result in an out of memory (OOM) killing of large
  mlocked processes. The issue arises from an oom killed process's final
  thread calling exit_mmap(), which calls munlock_vma_pages_all() for mlocked
  vmas.This can happen synchronously with the oom reaper's unmap_page_range()
  since the vma's VM_LOCKED bit is cleared before munlocking (to determine if
  any other vmas share the memory and are mlocked).
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000200
- http://openwall.com/lists/oss-security/2018/04/24/3
- https://marc.info/?l=linux-kernel&m=152400522806945
- http://www.openwall.com/lists/oss-security/2018/04/24/3
- https://marc.info/?l=linux-kernel&m=152460926619256
- https://git.kernel.org/pub/scm/linux/kernel/git/mhocko/mm.git/commit/?h=auto-latest&id=8392ca77d55d2d2cb0d5546c1ff920f7334f0306
- https://usn.ubuntu.com/usn/usn-3752-1
- https://usn.ubuntu.com/usn/usn-3752-2
- https://usn.ubuntu.com/usn/usn-3752-3
comments:
  debian/carnil: |-
    Introduced in 212925802454672e6cd2949a727f5e2c1377bf06 (4.14-rc1)
    proposed fix: https://marc.info/?l=linux-kernel&m=152460926619256
  ubuntu/tyhicks: |-
    Proposed fix (v2): https://marc.info/?l=linux-kernel&m=152401997210084&w=2
    Proposed fix (v3): https://marc.info/?l=linux-kernel&m=152460926619256
introduced-by:
  mainline: [212925802454672e6cd2949a727f5e2c1377bf06]
fixed-by:
  debian/buster-security: ['version:debian/4.16.12-1']
  mainline: [27ae357fa82be5ab73b2ef8d39dcb8ca2563483a]
  stable/4.14: [2270dfcc4b12d49c6d74394d245858ae882a8b79]
  stable/4.16: [092d4bd6bdf55899d238737d6870adef6f225211]
  ubuntu/bionic: [b5c4fcb648852576d067a725f814bfd4d810e2be]
