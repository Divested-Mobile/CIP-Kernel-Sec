description: |-
  The Linux kernel before version 4.11 is vulnerable to a NULL pointer
  dereference in fs/cifs/cifsencrypt.c:setup_ntlmv2_rsp() that allows an
  attacker controlling a CIFS server to kernel panic a client that has this
  server mounted, because an empty TargetInfo field in an NTLMSSP setup
  negotiation response is mishandled during session recovery.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1066
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=cabfb3680f78981d26c078a26e5c748531257ebb
- https://bugzilla.redhat.com/show_bug.cgi?id=1539599
- https://github.com/torvalds/linux/commit/cabfb3680f78981d26c078a26e5c748531257ebb
- https://patchwork.kernel.org/patch/10187633/
- http://www.openwall.com/lists/oss-security/2018/03/06/1
- https://usn.ubuntu.com/usn/usn-3880-1
- https://usn.ubuntu.com/usn/usn-3880-2
- https://ubuntu.com/security/notices/USN-3880-1
- https://ubuntu.com/security/notices/USN-3880-2
- https://www.cve.org/CVERecord?id=CVE-2018-1066
comments:
  debian/bwh: |-
    Minimal fix for older versions:
    https://patchwork.kernel.org/patch/10187633/
  debian/carnil: |-
    Issue fixed upstream differently/unknownigly with the
    referenced commit cabfb3680f78981d26c078a26e5c748531257ebb
    Cf. https://patchwork.kernel.org/patch/10187633/ discussion.
fixed-by:
  aosp/3.18: [c2938dc1ef1702663c66b4b4e143cc0b66f53388]
  cip/4.4: [26dc7476efad2151aadb7f72c0c8a253823ef289]
  cip/4.4-rt: [26dc7476efad2151aadb7f72c0c8a253823ef289]
  cip/4.4-st: [26dc7476efad2151aadb7f72c0c8a253823ef289]
  debian/buster-security: ['version:debian/4.11.6-1']
  debian/jessie-security: ['patch:debian/3.16.56-1:bugfix/all/CIFS-Enable-encryption-during-session-setup-phase.patch']
  debian/stretch-security: ['patch:debian/4.9.88-1:bugfix/all/CIFS-Enable-encryption-during-session-setup-phase.patch']
  mainline: [cabfb3680f78981d26c078a26e5c748531257ebb]
  stable/3.16: [36a0db05310fbee38b59fed7e1306c1a095f8c8f]
  stable/4.1: [b0b6d2f2c5377d169598f0ca00c25a78db651d35]
  stable/4.4: [26dc7476efad2151aadb7f72c0c8a253823ef289]
  stable/4.9: [df09b6f7b54adba78693997096d0bcb1bd80537c]
  ubuntu/xenial: [5884b3ed26d5d020c5e060f8c0d47f8ff7b45c4a]
