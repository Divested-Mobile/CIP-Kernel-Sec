description: |-
  The ext4_iget function in fs/ext4/inode.c in the Linux kernel through
  4.15.15 mishandles the case of a root directory with a zero i_links_count,
  which allows attackers to cause a denial of service
  (ext4_process_freed_data NULL pointer dereference and OOPS) via a crafted
  ext4 image.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1092
- https://bugzilla.kernel.org/show_bug.cgi?id=199179
- https://usn.ubuntu.com/usn/usn-3676-1
- https://usn.ubuntu.com/usn/usn-3676-2
- https://usn.ubuntu.com/usn/usn-3677-1
- https://usn.ubuntu.com/usn/usn-3677-2
- https://usn.ubuntu.com/usn/usn-3678-1
- https://usn.ubuntu.com/usn/usn-3678-2
- https://usn.ubuntu.com/usn/usn-3678-3
- https://usn.ubuntu.com/usn/usn-3678-4
- http://www.openwall.com/lists/oss-security/2018/04/20/2
- https://bugzilla.kernel.org/show_bug.cgi?id=199275
- https://usn.ubuntu.com/usn/usn-3754-1
reporters:
- Wen Xu
fixed-by:
  cip/4.4: [990251318b97ed7153d9adbf633035536c7d685b]
  cip/4.4-rt: [990251318b97ed7153d9adbf633035536c7d685b]
  debian/buster-security: ['patch:debian/4.15.17-1:bugfix/all/ext4-fail-ext4_iget-for-root-directory-if-unallocate.patch']
  debian/jessie-security: ['patch:debian/3.16.56-1:bugfix/all/ext4-fail-ext4_iget-for-root-directory-if-unallocated.patch']
  debian/stretch-security: ['patch:debian/4.9.88-1:bugfix/all/ext4-fail-ext4_iget-for-root-directory-if-unallocated.patch']
  mainline: [8e4b5eae5decd9dfe5a4ee369c22028f90ab4c44]
  stable/3.16: [43ef70b328eddc46938878a270895a9ff7b51059]
  stable/3.18: [bf1b17715e9117c1c22c7a24e38f27a92eb98413]
  stable/3.2: [bf7fc655f12864b4c12d902cf60ae37a708cc344]
  stable/4.14: [8e0e94683f8449f4e83b4b563b80eb9c76b9e18f]
  stable/4.16: [510c85c3f0bcfa6111e866b8f3c1a5a58d42da58]
  stable/4.4: [990251318b97ed7153d9adbf633035536c7d685b]
  stable/4.9: [6b289a7c34d72212bcd5a8ab9b6a657f2f44f0ee]
