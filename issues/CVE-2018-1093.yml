description: |-
  The ext4_valid_block_bitmap function in fs/ext4/balloc.c in the Linux
  kernel through 4.15.15 allows attackers to cause a denial of service
  (out-of-bounds read and system crash) via a crafted ext4 image because
  balloc.c and ialloc.c do not validate bitmap block numbers.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1093
- https://bugzilla.kernel.org/show_bug.cgi?id=199181
- https://usn.ubuntu.com/usn/usn-3676-1
- https://usn.ubuntu.com/usn/usn-3676-2
- https://usn.ubuntu.com/usn/usn-3752-1
- https://usn.ubuntu.com/usn/usn-3752-2
- https://usn.ubuntu.com/usn/usn-3754-1
- https://usn.ubuntu.com/usn/usn-3752-3
comments:
  Debian-bwh: |-
    Regressions should be fixed by commit 22be37acce25 "ext4: fix bitmap
    position validation".
  Debian-carnil: |-
    Ben noticed that the fix is not correct in Message-ID:
    <30c688b5783a5779811ce68893b7001390b9e200.camel@decadent.org.uk>
    and fix needs a followup.
    Caused other regressions:
    https://marc.info/?l=linux-ext4&m=152416385122029&w=2
reporters:
- Wen Xu
fixed-by:
  linux-3.16.y: [91a9c8e8ac7da66d7159fd758464808d2a1c979a, 73cc97df78e4fbc22a34b0eeedbaaf30b47d7ee5]
  linux-3.18.y: [0643dbdb5c697fbe20dd380bcb3faa1dcec03b78]
  linux-3.2.y: [f278235ce148485cdb9dc990673943addafbd577, 02a37ffd681be59775c9f13686e20621f7097f7e]
  linux-4.14.y: [b39430ea068797bb45b72429db3743064280b1be]
  linux-4.16.y: [169c851575ece8ae4be7a36ee30caa01a43a1b0f]
  linux-4.4.y: [ea057aed06d8f13d931652bc4faa604ac0c50aa2]
  linux-4.4.y-cip: [ea057aed06d8f13d931652bc4faa604ac0c50aa2]
  linux-4.9.y: [76964816c83d3e4e8a6a393777b30f22a6f9cd51, 1fd7c778ebf0f74e0aadcdf112800736cfdbca00]
  mainline: [7dac4a1726a9c64a517d595c40e95e2d0d135f6f]
