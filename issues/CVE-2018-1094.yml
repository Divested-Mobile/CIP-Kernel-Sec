description: |-
  The ext4_fill_super function in fs/ext4/super.c in the Linux kernel through
  4.15.15 does not always initialize the crc32c checksum driver, which allows
  attackers to cause a denial of service (ext4_xattr_inode_hash NULL pointer
  dereference and system crash) via a crafted ext4 image.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1094
- https://bugzilla.kernel.org/show_bug.cgi?id=199183
- https://usn.ubuntu.com/usn/usn-3695-1
- https://usn.ubuntu.com/usn/usn-3695-2
- https://ubuntu.com/security/notices/USN-3695-1
- https://ubuntu.com/security/notices/USN-3695-2
comments:
  debian/bwh: |-
    This is related to metadata checksums, which were added to ext4 in
    Linux 3.5.
  debian/carnil: |-
    Additionally 18db4b4e6fc31eda838dd1c1296d67dbcb3dc957 ("ext4:
    don't allow r/w mounts if metadata blocks overlap the
    superblock") might need to be applied:
    https://bugzilla.kernel.org/show_bug.cgi?id=199183#c4
    but not strictly needed for the security fix.
    According to Ben's triage a similar issue is affecting 4.9 but
    but the issue reported for CVE-2018-1094 does not apply to 4.9.
  ubuntu/tyhicks: |-
    When backporting a45403b, note this upstream bug comment:
     https://bugzilla.kernel.org/show_bug.cgi?id=199183#c7
reporters:
- Wen Xu
introduced-by:
  mainline: [dec214d00e0d78a08b947d7dccdfdb84407a9f4d]
fixed-by:
  debian/buster-security: ['patch:debian/4.15.17-1:bugfix/all/ext4-always-initialize-the-crc32c-checksum-driver.patch']
  mainline: [a45403b51582a87872927a3e0fc0a389c26867f1]
  stable/4.14: [26dbb30c58ffb85bc015bd5e58831483d50f7d18]
  stable/4.16: [114c42aaa63152d31d3c18d5b750de9560f38a63]
  ubuntu/bionic: [c430b6f3dab30eeb9a06361b42291983ef1320c8]
