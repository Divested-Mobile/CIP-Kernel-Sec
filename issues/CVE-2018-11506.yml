description: 'sr: pass down correctly sized SCSI sense buffer'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11506
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f7068114d45ec55996b9040e98111afa56e010fe
- https://github.com/torvalds/linux/commit/f7068114d45ec55996b9040e98111afa56e010fe
- https://usn.ubuntu.com/usn/usn-3752-1
- https://usn.ubuntu.com/usn/usn-3752-2
- https://usn.ubuntu.com/usn/usn-3752-3
comments:
  Debian-bwh: |-
    The change in 4.11 moved the copying of sense data into
    __scsi_execute() and changed the length to a fixed 96 bytes.
    Prior to that scsi_io_completion() could still copy up to 96
    bytes into the sense buffer.  So I think a fix is still
    needed in older versions, but we need to be careful to avoid
    introducing an information leak.
  Debian-carnil: |-
    Possibly just introduced with 82ed4db499b8598f16f8871261bff088d6b0597f
    in 4.11-rc1.
    For 4.16 fixed in 4.16.13.
reporters:
- Piotr Gabriel Kosinski
- Daniel Shapira
introduced-by:
  mainline: [820732b501a5bbdd3bde1263f391891e21b5ed8c]
fixed-by:
  linux-3.16.y: [d98da66531a3b203dded83749d69dd07ca9e646a]
  linux-4.14.y: [2a039b93679fb2e974bedf5b0d76da81731474ba]
  linux-4.16.y: [98d02fd4618c48d75589820e8fc39e60c3d3728e]
  linux-4.4.y: [8aca77150a9a2f89aba94f62a09c95f9a00c2956]
  linux-4.4.y-cip: [8aca77150a9a2f89aba94f62a09c95f9a00c2956]
  linux-4.4.y-cip-rt: [8aca77150a9a2f89aba94f62a09c95f9a00c2956]
  linux-4.9.y: [cb101349f51699074fc1739534cb4346a49e56ef]
  mainline: [f7068114d45ec55996b9040e98111afa56e010fe]
ignore:
  linux-3.2.y: EOL
