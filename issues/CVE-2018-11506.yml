description: 'sr: pass down correctly sized SCSI sense buffer'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11506
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f7068114d45ec55996b9040e98111afa56e010fe
- https://github.com/torvalds/linux/commit/f7068114d45ec55996b9040e98111afa56e010fe
- https://usn.ubuntu.com/usn/usn-3752-1
- https://usn.ubuntu.com/usn/usn-3752-2
- https://usn.ubuntu.com/usn/usn-3752-3
comments:
  debian/bwh: |-
    The change in 4.11 moved the copying of sense data into
    __scsi_execute() and changed the length to a fixed 96 bytes.
    Prior to that scsi_io_completion() could still copy up to 96
    bytes into the sense buffer.  So I think a fix is still
    needed in older versions, but we need to be careful to avoid
    introducing an information leak.
  debian/carnil: |-
    Possibly just introduced with 82ed4db499b8598f16f8871261bff088d6b0597f
    in 4.11-rc1.
    For 4.16 fixed in 4.16.13.
reporters:
- Piotr Gabriel Kosinski
- Daniel Shapira
introduced-by:
  mainline: [820732b501a5bbdd3bde1263f391891e21b5ed8c]
fixed-by:
  aosp/3.18: [a31f342e6e16394ad48b05191239ee71e45cacbc]
  cip/4.4: [8aca77150a9a2f89aba94f62a09c95f9a00c2956]
  cip/4.4-rt: [8aca77150a9a2f89aba94f62a09c95f9a00c2956]
  debian/buster-security: ['version:debian/4.16.16-1']
  debian/jessie-security: ['patch:debian/3.16.57-1:bugfix/all/sr-pass-down-correctly-sized-scsi-sense-buffer.patch']
  debian/stretch-security: ['patch:debian/4.9.110-1:bugfix/all/sr-pass-down-correctly-sized-scsi-sense-buffer.patch']
  mainline: [f7068114d45ec55996b9040e98111afa56e010fe]
  stable/3.16: [d98da66531a3b203dded83749d69dd07ca9e646a]
  stable/3.18: [a31f342e6e16394ad48b05191239ee71e45cacbc]
  stable/4.14: [2a039b93679fb2e974bedf5b0d76da81731474ba]
  stable/4.16: [98d02fd4618c48d75589820e8fc39e60c3d3728e]
  stable/4.4: [8aca77150a9a2f89aba94f62a09c95f9a00c2956]
  stable/4.9: [cb101349f51699074fc1739534cb4346a49e56ef]
  ubuntu/bionic: [7aaed69e1a966b0140eb81805367d2fa8f3e6093]
  ubuntu/xenial: [73636d9f2295521d666e28b8af2c28a729fbd024]
ignore:
  stable/3.2: EOL
