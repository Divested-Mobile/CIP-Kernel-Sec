description: Double-free in ion_system_heap.c
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1661435
- https://www.codeaurora.org/security-bulletin/2018/12/03/december-2018-code-aurora-security-bulletin#_CVE-2018-11987
- https://source.codeaurora.org/quic/la/kernel/msm-4.9/commit/?id=5e9ffcfa152ecb2832990c42fcd8a0f2e63c2c04
comments:
  Debian-carnil: |-
    Affects potentially upstream as well in
    drivers/staging/android/ion/ion_system_heap.c . For Debian the
    code is not build so would be unimportant.
    Possibly introduced in e7f63771b60e7802c5a9b437c5ab1a8e33a0bb35 (4.9-rc1)?
  bwh: |-
    Although the fix on the msm-4.9 branch might be a useful safeguard
    for upstream, the issue does not exist in mainline as
    ion_system_heap_destroy_pools() is never called a second time on
    the same pools.
introduced-by:
  mainline: never
