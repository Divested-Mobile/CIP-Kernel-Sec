description: |-
  Improper invalidation for page table updates by a virtual guest operating
  system for multiple Intel(R) Processors may allow an authenticated user to
  potentially enable denial of service of the host system via local access.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12207
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/TAA_MCEPSC_i915
- https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00210.html
- https://software.intel.com/security-software-guidance/insights/deep-dive-machine-check-error-avoidance-page-size-change
- https://software.intel.com/security-software-guidance/insights/deep-dive-machine-check-error-avoidance-page-size-change-0
- https://usn.ubuntu.com/usn/usn-4183-1
- https://usn.ubuntu.com/usn/usn-4184-1
- https://usn.ubuntu.com/usn/usn-4185-1
- https://usn.ubuntu.com/usn/usn-4185-2
- https://usn.ubuntu.com/usn/usn-4186-1
- https://usn.ubuntu.com/usn/usn-4186-2
- https://blogs.intel.com/technology/2019/11/ipas-november-2019-intel-platform-update-ipu/
- https://software.intel.com/security-software-guidance/api-app/insights/deep-dive-machine-check-error-avoidance-page-size-change
- https://xenbits.xen.org/xsa/advisory-304.html
- https://ubuntu.com/security/notices/USN-4183-1
- https://ubuntu.com/security/notices/USN-4184-1
- https://ubuntu.com/security/notices/USN-4185-1
- https://ubuntu.com/security/notices/USN-4185-2
- https://ubuntu.com/security/notices/USN-4186-1
- https://ubuntu.com/security/notices/USN-4186-2
- https://www.cve.org/CVERecord?id=CVE-2018-12207
comments:
  debian/bwh: |-
    Exploitable only by VM guests on Intel
    CPUs.  Will be fixed by "NX" patch series.
  ubuntu/tyhicks: |-
    This issue only affects processors manufactured by Intel that support
     Extended Page Tables (EPT)
reporters:
- Deepak Gupta
fixed-by:
  cip/4.19: [a991063ce57684a2259688886643cf1c430f8188, f9aa6b73a407b714c9aac44734eb4045c893c6f7,
    955607466ace0455164cf391a93c23918022e8e8, db5ae6596ae2ba03f66cfeceea4b65e35785600a,
    5219505fcbb640e273a0d51c19c38de0100ec5a9, 6082f2e28887bcef66d9b3b5710fd3491a722f0b,
    46a4a014c48e64e28970ca775bb7adf4778821af, 580c79e7e3e50afbd5a69b2b6ab2c61c5225f48e]
  cip/4.19-rt: [a991063ce57684a2259688886643cf1c430f8188, f9aa6b73a407b714c9aac44734eb4045c893c6f7,
    955607466ace0455164cf391a93c23918022e8e8, db5ae6596ae2ba03f66cfeceea4b65e35785600a,
    5219505fcbb640e273a0d51c19c38de0100ec5a9, 6082f2e28887bcef66d9b3b5710fd3491a722f0b,
    46a4a014c48e64e28970ca775bb7adf4778821af, 580c79e7e3e50afbd5a69b2b6ab2c61c5225f48e]
  debian/buster-security: ['patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0011-x86-bugs-Add-ITLB_MULTIHIT-bug-infrastructure.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0013-cpu-speculation-Uninline-and-export-CPU-mitigations-.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0014-Documentation-Add-ITLB_MULTIHIT-documentation.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0016-kvm-x86-powerpc-do-not-allow-clearing-largepages-deb.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0017-kvm-Convert-kvm_lock-to-a-mutex.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0018-kvm-mmu-Do-not-release-the-page-inside-mmu_set_spte.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0019-KVM-x86-make-FNAME-fetch-and-__direct_map-more-simil.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0020-KVM-x86-remove-now-unneeded-hugepage-gfn-adjustment.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0021-KVM-x86-change-kvm_mmu_page_get_gfn-BUG_ON-to-WARN_O.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0022-KVM-x86-add-tracepoints-around-__direct_map-and-FNAM.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0023-KVM-vmx-svm-always-run-with-EFER.NXE-1-when-shadow-p.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0024-kvm-mmu-ITLB_MULTIHIT-mitigation.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0025-kvm-Add-helper-function-for-creating-VM-worker-threa.patch',
    'patch:debian/4.19.67-2+deb10u2:bugfix/x86/itlb_multihit/0026-kvm-x86-mmu-Recovery-of-shattered-NX-large-pages.patch']
  debian/stretch-security: ['patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0012-KVM-x86-simplify-ept_misconfig.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0013-KVM-x86-extend-usage-of-RET_MMIO_PF_-constants.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0014-KVM-MMU-drop-vcpu-param-in-gpte_access.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0015-kvm-Convert-kvm_lock-to-a-mutex.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0016-kvm-x86-Do-not-release-the-page-inside-mmu_set_spte.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0017-KVM-x86-make-FNAME-fetch-and-__direct_map-more-simil.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0018-KVM-x86-remove-now-unneeded-hugepage-gfn-adjustment.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0019-KVM-x86-change-kvm_mmu_page_get_gfn-BUG_ON-to-WARN_O.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0020-KVM-x86-Add-is_executable_pte.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0021-KVM-x86-add-tracepoints-around-__direct_map-and-FNAM.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0022-KVM-vmx-svm-always-run-with-EFER.NXE-1-when-shadow-p.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0023-x86-bugs-Add-ITLB_MULTIHIT-bug-infrastructure.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0024-cpu-speculation-Uninline-and-export-CPU-mitigations-.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0025-kvm-mmu-ITLB_MULTIHIT-mitigation.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0026-kvm-Add-helper-function-for-creating-VM-worker-threa.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0027-kvm-x86-mmu-Recovery-of-shattered-NX-large-pages.patch',
    'patch:debian/4.9.189-3+deb9u2:bugfix/x86/itlb_multihit/0028-Documentation-Add-ITLB_MULTIHIT-documentation.patch']
  mainline: [833b45de69a6016c4b0cebe6765d526a31a81580, db4d30fbb71b47e4ecb11c4efa5d8aad4b03dfae,
    cad14885a8d32c1c0d8eaa7bf5c0152a22b6080e, 731dc9df975a5da21237a18c3384f811a7a41cc6,
    b8e8c8303ff28c61046a4d0f6ea99aea609a7dc0, c57c80467f90e5504c8df9ad3555d2c78800bf94,
    1aa9b9572b10529c2e64e2b8f44025d86e124308, 7f00cc8d4a51074eb0ad4c3f16c15757b1ddfb7d]
  stable/4.14: [82e77746f07db70367f66ef272256037d6415353, 56a0f3867c1bc40c6f155c780a284cc881a89488,
    402c32059af1a308ff9eab0fb3666bb8a6e77c67, fa8617fddad51c42f66e56cd14382ee0e9f9782e,
    bb16a6ba5d1ed79b40caea8d924e237f63205b7c, 73959112cc8dbd30a09e169a9da868f40e750e2d,
    2d371f8836c5d633f9f495c9165eaf814643539d, cc5b0b7602f6f56cf6a03cbf091fc3ac2e4bb744]
  stable/4.19: [a991063ce57684a2259688886643cf1c430f8188, f9aa6b73a407b714c9aac44734eb4045c893c6f7,
    955607466ace0455164cf391a93c23918022e8e8, db5ae6596ae2ba03f66cfeceea4b65e35785600a,
    5219505fcbb640e273a0d51c19c38de0100ec5a9, 6082f2e28887bcef66d9b3b5710fd3491a722f0b,
    46a4a014c48e64e28970ca775bb7adf4778821af, 580c79e7e3e50afbd5a69b2b6ab2c61c5225f48e]
  stable/4.9: [43a39a3e9b0573cd4383e52d8ded9965ae8994c5, 61524f1bccc041b7871a21984b69b8e538f446c0,
    c6170b81e7b78942cb4b36fc72cbd75145fd08d5, 2f57300f68fb40acff2e350686ec5e41463526c1,
    2e013f0fa714399d91c0fc9e3e4d64a9b517db6c, 1d48204bd77090c950b13106ab51821729ae0d72,
    515fa37a3e550ac7f291fb295b4e6174b6bbbd85, 9dc6bc3f22f08099a27c38c68983fbc419e879f3,
    52644d80850a3fe965ee964e903acef7be61a62c, 1b08d2ab698ddf78833717908e2a41336ab9c6ef,
    12ceedb7604dfbe370a21df444819ece665c91db, e2bd0778adc4b13e3874b48eaad689e4a3a35833,
    a7ad7943b84fae87f5be18f05025c51ae103f732, 61e191b467f1edea6fae9123c37355133273a31a,
    c6e94acbf6abab3e3c25fcdd3343d0c2a3f160ca, ca60c77067d4cde390e1f58a6f947c7c7fb75f97]
  stable/5.3: [1655a277fe4aed4cab0590fa712961993d56e936, 8e79a48022f5f861e39babf31ee62f55328b8e09,
    034967e8bd7d7f9dfd9c1348463906f0372fc999, d068ec1dca619fdaf37351424dbba21429644f64,
    78ffa84f00ff6b19f00c0e6dfe1870aba0db4025, 4ad894b92932c8d1518d634994b1928db6033e19,
    a46ee66f47837a36a1eaa48920601db6e05a1c56, 1af2cfe692941116565396065d6c86e203564fcd]
  ubuntu/bionic: [eb15ff263c76a5c1832db0b48e4eee32e3ad88f4, 34d52a5237d6ea582a7831d703c4725b01d09e2a,
    e264f854888a4e14c37f81a46a424a6a1e0ec7a6, 5052fe9cac7c4e7d4fbc9674d5b1cf26c3220329,
    5bd291d772698820914724efb941bce57a60173b, 6a23103cf165c34fbff6133e2b1e98249687e060,
    3ad51c84fcd0b5953417d6ec3b219896902d738c, 4eaa950156ee2b3d64a944db9d9ab31e68ed4315,
    6bea1213aac8f73ba5ac3d90328cd9283d4cd435, 349806c43afb1f174c53c1a49bdc8bd8842d97cd,
    5bfdb2356c7be7befb45ad1d9cc3bf63446bd810, ebce4f7669f0dc2effce32b323d0d3a66e9deca9,
    90b9e10ebb74ae10526de52a8e9a877ed03234f4, fee33a7d55d613941462afed5b5439055cd4c1d4,
    b087cf34360d8c2d149580644331d7c29c81cba2]
  ubuntu/eoan: [9790d566a951f563530b675acd2f1a53bafb9850, cf423e32937332adc238a49bd2b04e11761186d0,
    1c7402fdeb28741b130c76a1f5637d031e6abd61, a122e8fcc42704962d958a9ead1fe4dad7672b19,
    024c6b5c572ee243517e0fb91cd8c8a4abf88637, 4d908308f9ca70e958a497cd1a15ed170e2b5ac3,
    0a6940c064e8cb07957b889a15f867381508c32f, 5a9ae0700c5d7c7e03050c15152c73b0ad3f90cf]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
  ubuntu/xenial: [700e3a38fe437addd1a79fa5b8d3af65497df8e2, 0b139e8bbca9d77162b496678e4c82ce4f3c8ca5,
    d55d4a9c1311556df86bba8722bea2df5438b6e4, ef51b2ed849f358461747dc6cff4eb37b1e8f4a0,
    5c7312756bfaa859d5ee409b5fbe61cdcf9ec06a, 4391bd8a243ce1c1be3da36485cfd5b4df7c27e6,
    7d0475b3b550ab0ad4678a6651909ef8601031ab, a8c8b7f253353833af29a65ca9fecb6b90a6c4c1,
    0da886be824debc1099ddf2516d418dbfa6a5b79, 428b029405148534000a35c7dd10a97192c207d4,
    a634fbe98cff33d10141ab72510194908e046746, 3639763c08d891624446e91d62ab655a22e1878f,
    5e50df2d9717398c46a8bcec804c27b9d8dc3e08, 7411be044acb24ac8226576add6da55b41cc591c,
    ded8fef3973ce34b5a9b0ea92fe3d0104ff40e29, 68ffdcac219254ee613eaaa6e95b81a25a777d1a,
    52b2fe27c61d4a2f5f745dadbcf8b436cf9ebf79, ede7288e5a9711a0a0fffac457b2e2c315d5ae4d,
    82db338ff478fca4b0262d60da853624a9e35cf7, 4e9d580d61da8cc015ffdf5b8f23f38baded9035,
    77bf82b2c996fc89459e019862bf22d4c525016f, c6c9a37b564b8b4f7aad099388c55978ef456bb5,
    fc1120599318e3b2043f5d5ef62d28f79f804256, ddfd4c9a8dc6417fd9774a2e5d8de95b3f85b411,
    218bd776c65358b17bde6a21b2729608a93a7cad, 7965c809a86c170dc9bcc1b5e87de705dc2240cf]
ignore:
  cip/4.19: Untrusted guests are not supported
  cip/4.19-rt: Untrusted guests are not supported
  cip/4.4: Untrusted guests are not supported
  cip/4.4-rt: Untrusted guests are not supported
  cip/4.4-st: Untrusted guests are not supported
  debian/jessie-security: Untrusted guests are no longer supportable
  stable/3.16: Untrusted guests are no longer supportable
  stable/4.4: Untrusted guests are no longer supportable
