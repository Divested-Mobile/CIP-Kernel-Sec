description: |-
  In net/socket.c in the Linux kernel through 4.17.1, there is a race
  condition between fchownat and close in cases where they target the same
  socket file descriptor, related to the sock_close and sockfs_setattr
  functions. fchownat does not increment the file descriptor reference count,
  which allows close to set the socket to NULL during fchownat's execution,
  leading to a NULL pointer dereference and system crash.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12232
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6d8c50dcb029872b298eea68cc6209c866fd3e14
- https://github.com/torvalds/linux/commit/6d8c50dcb029872b298eea68cc6209c866fd3e14
- https://lkml.org/lkml/2018/6/5/14
- https://patchwork.ozlabs.org/patch/926519/
- https://usn.ubuntu.com/usn/usn-3752-1
- https://usn.ubuntu.com/usn/usn-3752-2
- https://usn.ubuntu.com/usn/usn-3752-3
- https://ubuntu.com/security/notices/USN-3752-1
- https://ubuntu.com/security/notices/USN-3752-2
- https://ubuntu.com/security/notices/USN-3752-3
- https://www.cve.org/CVERecord?id=CVE-2018-12232
comments:
  debian/bwh: |-
    Introduced in 4.10 by commit 86741ec25462 "net: core: Add a UID
    field to struct sock."
reporters:
- Shankara Pailoor
introduced-by:
  mainline: [86741ec25462e4c8cdce6df2f41ead05568c7d5e]
fixed-by:
  aosp/3.18: [3e56ed2fd0c8f1fd7ae5c03460aa600ec2b7314f]
  debian/buster-security: ['version:debian/4.17.3-1']
  mainline: [6d8c50dcb029872b298eea68cc6209c866fd3e14]
  openela/4.14: [91717ffc9057f38a0203a40ef36ae2e482fd7cbe]
  stable/4.14: [91717ffc9057f38a0203a40ef36ae2e482fd7cbe]
  stable/4.16: [abaa1bb5e3652593a22a51e289bf9dfd4d4a8542]
  stable/4.17: [be3bb23cc0e4943922db828b923648af7a9f2dc3]
  ubuntu/bionic: [4ba6b27dfa4c39a59522f91a266f997bab0ea976]
