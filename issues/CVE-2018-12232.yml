description: |-
  In net/socket.c in the Linux kernel through 4.17.1, there is a race
  condition between fchownat and close in cases where they target the same
  socket file descriptor, related to the sock_close and sockfs_setattr
  functions. fchownat does not increment the file descriptor reference count,
  which allows close to set the socket to NULL during fchownat's execution,
  leading to a NULL pointer dereference and system crash.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12232
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6d8c50dcb029872b298eea68cc6209c866fd3e14
- https://github.com/torvalds/linux/commit/6d8c50dcb029872b298eea68cc6209c866fd3e14
- https://lkml.org/lkml/2018/6/5/14
- https://patchwork.ozlabs.org/patch/926519/
comments:
  Debian-bwh: |-
    Introduced in 4.10 by commit 86741ec25462 "net: core: Add a UID
    field to struct sock."
fixed-by:
  linux-4.14.y: [91717ffc9057f38a0203a40ef36ae2e482fd7cbe]
  linux-4.16.y: [abaa1bb5e3652593a22a51e289bf9dfd4d4a8542]
  linux-4.17.y: [be3bb23cc0e4943922db828b923648af7a9f2dc3]
  mainline: [6d8c50dcb029872b298eea68cc6209c866fd3e14]
