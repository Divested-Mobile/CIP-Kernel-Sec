description: |-
  An issue was discovered in the Linux kernel through 4.17.2.
  vbg_misc_device_ioctl() in drivers/virt/vboxguest/vboxguest_linux.c reads
  the same user data twice with copy_from_user. The header part of the user
  data is double-fetched, and a malicious user thread can tamper with the
  critical variables (hdr.size_in and hdr.size_out) in the header between the
  two fetches because of a race condition, leading to severe kernel errors,
  such as buffer over-accesses. This bug can cause a local denial of service
  and information leakage.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12633
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=bd23a7269834dc7c1f93e83535d16ebc44b75eba
- https://bugzilla.kernel.org/show_bug.cgi?id=200131
- https://github.com/torvalds/linux/commit/bd23a7269834dc7c1f93e83535d16ebc44b75eba
- https://www.cve.org/CVERecord?id=CVE-2018-12633
comments:
  debian/bwh: We haven't yet enabled the VirtualBox guest drivers in official builds
introduced-by:
  mainline: [0ba002bc4393dcfae031fc707b11c094b46a5048]
fixed-by:
  debian/buster-security: ['patch:debian/4.17.3-1:bugfix/x86/virt-vbox-Only-copy_from_user-the-request-header-onc.patch']
  mainline: [bd23a7269834dc7c1f93e83535d16ebc44b75eba]
  stable/4.17: [a61b352a7c23191108ae0c747a170f6bce5b154a]
  ubuntu/eoan: ['version:5.0.0-13.14']
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
