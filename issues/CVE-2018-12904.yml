description: KVM L1 guest escape
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1589
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=727ba748e110b4de50d142edca9d6a9b7e6111d8
- https://ubuntu.com/security/notices/USN-3752-1
- https://ubuntu.com/security/notices/USN-3752-2
- https://ubuntu.com/security/notices/USN-3752-3
- https://www.cve.org/CVERecord?id=CVE-2018-12904
comments:
  debian/bwh: |-
    Introduced by commit 70f3aac964ae "kvm: nVMX: Remove superfluous VMX
    instruction fault checks".
  ubuntu/tyhicks: |-
    Ubuntu kernels do not enable nested KVM virtualization by default and
     are unaffected by this flaw in the default configuration. To ensure that
     nested virtualization is not enabled, verify that the
     /sys/module/kvm_intel/parameters/nested file contains "N".
reporters:
- Felix Wilhelm
introduced-by:
  mainline: [70f3aac964ae2bc9a0a1d5d65a62e258591ade18]
fixed-by:
  debian/buster-security: ['version:debian/4.16.16-1']
  mainline: [727ba748e110b4de50d142edca9d6a9b7e6111d8]
  openela/4.14: [b1bd9caf5e98d8111361f53367fece3444b0a7c2]
  stable/4.14: [b1bd9caf5e98d8111361f53367fece3444b0a7c2]
