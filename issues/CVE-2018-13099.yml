description: use-after-free in update_sit_entry() when operating on a corrupted f2fs
  image
references:
- https://bugzilla.kernel.org/show_bug.cgi?id=200179
- https://git.kernel.org/pub/scm/linux/kernel/git/chao/linux.git/commit/?h=f2fs-dev&id=67d88628bd1dcc9ded6f0b7dfc363d1370688004
- https://sourceforge.net/p/linux-f2fs/mailman/message/36356878/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13099
- https://git.kernel.org/pub/scm/linux/kernel/git/chao/linux.git/commit/?h=f2fs-dev&id=cc60e90f9bfab8d6a7fb826937e824333c3bf94a
- https://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fs.git/commit/?h=dev&id=4dbe38dc386910c668c75ae616b99b823b59f3eb
- https://usn.ubuntu.com/usn/usn-3932-1
- https://usn.ubuntu.com/usn/usn-3932-2
- https://usn.ubuntu.com/usn/usn-4094-1
- https://usn.ubuntu.com/usn/usn-4118-1
- https://ubuntu.com/security/notices/USN-3932-1
- https://ubuntu.com/security/notices/USN-3932-2
- https://ubuntu.com/security/notices/USN-4094-1
- https://ubuntu.com/security/notices/USN-4118-1
- https://www.cve.org/CVERecord?id=CVE-2018-13099
comments:
  ubuntu/sbeattie: |-
    possible reproducer in kernel bugzilla
    fix subject "f2fs: fix to do sanity check with reserved
      blkaddr of inline inode"
  ubuntu/tyhicks: |-
    The affected user base for this issue is likely small since f2fs is
     not the default filesystem and it is not widely used in Ubuntu
reporters:
- Wen Xu
introduced-by:
  mainline: [bfad7c2d40332be6a1d7a89660bceb0f6ea1d73a]
fixed-by:
  cip/4.4: [3bfe2049c222b23342ff2a216cd5a869e8a14897]
  cip/4.4-rt: [3bfe2049c222b23342ff2a216cd5a869e8a14897]
  cip/4.4-st: [3bfe2049c222b23342ff2a216cd5a869e8a14897]
  debian/buster-security: ['version:debian/4.18.10-1']
  debian/stretch-security: ['patch:debian/4.9.110-3+deb9u5:bugfix/all/f2fs-fix-to-do-sanity-check-with-reserved-blkaddr-of.patch']
  mainline: [4dbe38dc386910c668c75ae616b99b823b59f3eb]
  openela/4.14: [7fb2b50ee59689578d5a712633d1e6755fc98933]
  stable/4.14: [7fb2b50ee59689578d5a712633d1e6755fc98933]
  stable/4.18: [235fd393825b8b79d962eb2f9a2d6aa454eb17a5]
  stable/4.4: [3bfe2049c222b23342ff2a216cd5a869e8a14897]
  stable/4.9: [7e0782ceebaaed70b0c4b775c27b81e8f8cf6ddb]
  ubuntu/bionic: [e5841b7ae7308d894d8b1971a4b286be1bf1a7e1]
  ubuntu/xenial: [18e4a85d0aa1e79128b573c3db34d5708e3d54fd]
ignore:
  debian/jessie-security: Hard to backport and low priority outside of Android
  stable/3.16: Hard to backport and low priority outside of Android
tests:
- CVE-2018-13099
