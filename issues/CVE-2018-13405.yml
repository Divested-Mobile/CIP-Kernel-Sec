description: Fix up non-directory creation in SGID directories
references:
- https://twitter.com/grsecurity/status/1015082951204327425
- http://www.openwall.com/lists/oss-security/2018/07/13/2
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1611
- https://git.kernel.org/linux/0fa3ecd87848c9c93c2c828ef4c3a8ca36ce46c7
- https://www.halfdog.net/Security/2015/SetgidDirectoryPrivilegeEscalation/
- https://ubuntu.com/security/notices/USN-3752-1
- https://ubuntu.com/security/notices/USN-3752-2
- https://ubuntu.com/security/notices/USN-3753-1
- https://ubuntu.com/security/notices/USN-3753-2
- https://ubuntu.com/security/notices/USN-3754-1
- https://ubuntu.com/security/notices/USN-3752-3
- https://www.cve.org/CVERecord?id=CVE-2018-13405
- https://launchpad.net/bugs/1779923
comments:
  ubuntu/tyhicks: |-
    While inode_init_owner() has only been vulnerable since its
     introduction in a1bd120d13e586ea1c424048fd2c8420a442852a, this flaw has been
     present in individual filesystems since the beginning of the kernel git
     history.
reporters:
- Jann Horn
- halfdog
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  aosp/3.18: [c5f2c5be9d1787a7bde81186d093be54c0caeb34]
  cip/4.4: [e71dbad7563db674f91af9e12ef592c107d0c2cd]
  cip/4.4-rt: [e71dbad7563db674f91af9e12ef592c107d0c2cd]
  cip/4.4-st: [e71dbad7563db674f91af9e12ef592c107d0c2cd]
  debian/buster-security: ['patch:debian/4.17.6-1:bugfix/all/fix-up-non-directory-creation-in-sgid-directories.patch']
  debian/stretch-security: ['patch:debian/4.9.110-3+deb9u1:bugfix/all/fix-up-non-directory-creation-in-sgid-directories.patch']
  mainline: [0fa3ecd87848c9c93c2c828ef4c3a8ca36ce46c7]
  openela/4.14: [298243a5fb640f018e2fae22c0c895f1b27f0963]
  stable/3.18: [c5f2c5be9d1787a7bde81186d093be54c0caeb34]
  stable/4.14: [298243a5fb640f018e2fae22c0c895f1b27f0963]
  stable/4.4: [e71dbad7563db674f91af9e12ef592c107d0c2cd]
  stable/4.9: [d2c7c52431819aa05d76fae77bb3f95dd0955da1]
