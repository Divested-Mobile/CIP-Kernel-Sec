description: |-
  An issue was discovered in the Linux kernel through 4.17.11, as used in Xen
  through 4.11.x. The xen_failsafe_callback entry point in
  arch/x86/entry/entry_64.S does not properly maintain RBX, which allows
  local users to cause a denial of service (uninitialized memory usage and
  system crash). Within Xen, 64-bit x86 PV Linux guest OS users can trigger a
  guest OS crash or possibly gain privileges.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14678
- https://xenbits.xen.org/xsa/advisory-274.html
- https://git.kernel.org/linus/b3681dd548d06deb2e1573890829dff4b15abf46
- https://usn.ubuntu.com/usn/usn-3931-1
- https://usn.ubuntu.com/usn/usn-3931-2
- https://ubuntu.com/security/notices/USN-3931-1
- https://ubuntu.com/security/notices/USN-3931-2
- https://www.cve.org/CVERecord?id=CVE-2018-14678
comments:
  debian/canril: possibly use the respective fixed bug to crash the kernel
  debian/carnil: |-
    Fixes 3ac6d8c787b8 ("x86/entry/64: Clear registers for
    exceptions/interrupts, to reduce speculation attack surface")
    which was cc'ed to stable@vger.kernel.org.
    Seems to have been applied to 4.14+
    But according to Andy Lutomirski malicious userspace could
    even withouth the offending patch (3ac6d8c787b8) applied.
reporters:
- M. Vefa Bicakci
- Andy Lutomirski
introduced-by:
  mainline: [3ac6d8c787b835b997eb23e43e09aa0895ef7d58]
  openela/4.14: [d10d0bb86d974c41ccbbf1f22044e700597a84d0]
  stable/4.14: [d10d0bb86d974c41ccbbf1f22044e700597a84d0]
  ubuntu/bionic: [df25c2800cc3dd72a4f35fe7e5a58e1fa05560f3]
fixed-by:
  cip/4.4: [9ee68ff9c6e350e43821c19642485466d9506e32]
  cip/4.4-rt: [9ee68ff9c6e350e43821c19642485466d9506e32]
  cip/4.4-st: [9ee68ff9c6e350e43821c19642485466d9506e32]
  debian/buster-security: ['version:debian/4.17.14-1']
  debian/jessie-security: ['version:debian/3.16.59-1']
  debian/stretch-security: ['patch:debian/4.9.110-3+deb9u5:bugfix/x86/x86-entry-64-Remove-ebx-handling-from-error_entry-ex.patch']
  mainline: [b3681dd548d06deb2e1573890829dff4b15abf46]
  openela/4.14: [c1a29c2d00c656fcc4abfeec5f4f92762e3c7437]
  stable/3.16: [78ff116fd34c3d86db2b15b9213591c8f929111f]
  stable/4.14: [c1a29c2d00c656fcc4abfeec5f4f92762e3c7437]
  stable/4.4: [9ee68ff9c6e350e43821c19642485466d9506e32]
  stable/4.9: [987156381c5f875d75ef1f7cc29994d82f646dad]
  ubuntu/bionic: [b105cac4b9154a8a68da63948404e68e5ed04c14]
  ubuntu/xenial: [1d53567666dd4e5e86863dafa64e72afd5525349]
