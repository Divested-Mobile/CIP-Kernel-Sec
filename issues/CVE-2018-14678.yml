description: |-
  An issue was discovered in the Linux kernel through 4.17.11, as used in Xen
  through 4.11.x. The xen_failsafe_callback entry point in
  arch/x86/entry/entry_64.S does not properly maintain RBX, which allows
  local users to cause a denial of service (uninitialized memory usage and
  system crash). Within Xen, 64-bit x86 PV Linux guest OS users can trigger a
  guest OS crash or possibly gain privileges.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-14678
- https://xenbits.xen.org/xsa/advisory-274.html
- https://git.kernel.org/linus/b3681dd548d06deb2e1573890829dff4b15abf46
- https://usn.ubuntu.com/usn/usn-3931-1
- https://usn.ubuntu.com/usn/usn-3931-2
comments:
  debian/canril: possibly use the respective fixed bug to crash the kernel
  debian/carnil: |-
    Fixes 3ac6d8c787b8 ("x86/entry/64: Clear registers for
    exceptions/interrupts, to reduce speculation attack surface")
    which was cc'ed to stable@vger.kernel.org.
    Seems to have been applied to 4.14+
    But according to Andy Lutomirski malicious userspace could
    even withouth the offending patch (3ac6d8c787b8) applied.
reporters:
- M. Vefa Bicakci
- Andy Lutomirski
introduced-by:
  linux-4.14.y: [d10d0bb86d974c41ccbbf1f22044e700597a84d0]
  mainline: [3ac6d8c787b835b997eb23e43e09aa0895ef7d58]
fixed-by:
  linux-3.16.y: [78ff116fd34c3d86db2b15b9213591c8f929111f]
  linux-4.14.y: [c1a29c2d00c656fcc4abfeec5f4f92762e3c7437]
  linux-4.4.y: [9ee68ff9c6e350e43821c19642485466d9506e32]
  linux-4.4.y-cip: [9ee68ff9c6e350e43821c19642485466d9506e32]
  linux-4.4.y-cip-rt: [9ee68ff9c6e350e43821c19642485466d9506e32]
  linux-4.9.y: [987156381c5f875d75ef1f7cc29994d82f646dad]
  mainline: [b3681dd548d06deb2e1573890829dff4b15abf46]
