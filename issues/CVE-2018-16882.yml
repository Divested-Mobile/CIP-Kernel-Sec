description: |-
  A use-after-free issue was found in the way the Linux kernel's KVM
  hypervisor processed posted interrupts when nested(=1) virtualization is
  enabled. In nested_get_vmcs12_pages(), in case of an error while processing
  posted interrupt address, it unmaps the 'pi_desc_page' without resetting
  'pi_desc' descriptor address, which is later used in
  pi_test_and_clear_on(). A guest user/process could use this flaw to crash
  the host kernel resulting in DoS or potentially gain privileged access to a
  system. Kernel versions before 4.14.91 and before 4.19.13 are vulnerable.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16882
- https://www.openwall.com/lists/oss-security/2018/12/18/6
- https://marc.info/?l=kvm&m=154514994222809&w=2
- https://usn.ubuntu.com/usn/usn-3871-1
- https://usn.ubuntu.com/usn/usn-3872-1
- https://usn.ubuntu.com/usn/usn-3871-3
- https://usn.ubuntu.com/usn/usn-3871-4
- https://usn.ubuntu.com/usn/usn-3878-1
- https://usn.ubuntu.com/usn/usn-3871-5
- https://usn.ubuntu.com/usn/usn-3878-2
comments:
  debian/carnil: |-
    Commit fixes 5e2f30b756a37 "KVM: nVMX: get rid of nested_get_page()"
    needs to check if issue only introduced post/with 4.14-rc1.
  ubuntu/tyhicks: |-
    Ubuntu kernels do not enable nested KVM virtualization by default and
     are unaffected by this flaw in the default configuration. To ensure that
     nested virtualization is not enabled, verify that the
     /sys/module/kvm_intel/parameters/nested file contains "N".
reporters:
- Cfir Cohen
introduced-by:
  mainline: [5e2f30b756a37bd80c5b0471d0e10d769ab2eb9a]
fixed-by:
  cip/4.19: [1972ca04708330b0edd52956e644e3974065a613]
  cip/4.19-rt: [1972ca04708330b0edd52956e644e3974065a613]
  mainline: [c2dd5146e9fe1f22c77c1b011adf84eea0245806]
  stable/4.14: [cc70f14956fa0ea84ee1a3a5b79347730c6c2d08]
  stable/4.19: [1972ca04708330b0edd52956e644e3974065a613]
