description: use-after-free due to a race condition between anout_add from setsockopt
  and bind on an AF_PACKET socket
references:
- https://blogs.securiteam.com/index.php/archives/3731
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18559
- https://www.cve.org/CVERecord?id=CVE-2018-18559
comments:
  debian/carnil: "Issue exists because of the 15fe076edea787807a7cdc168df832544b58eba6\
    \ \n(4.15-c2) incomplete fix for a race condition. It was backported e.g.\nas\
    \ well to 5471afeef41388ec08e6cf610640aaf89805d6db (4.9.70) and\na0992bdf1e286a7b5e0dd696e2f2fd0fcbe08c7c\
    \ (3.16.55).\nThe actual fix is 15fe076edea787807a7cdc168df832544b58eba6 complete.\n\
    https://bugzilla.redhat.com/show_bug.cgi?id=1641878#c3\nhttps://bugzilla.novell.com/show_bug.cgi?id=1112859"
  ubuntu/tyhicks: The xenial 4.4 kernel inherited the fix via a rebase on linux-stable
introduced-by:
  aosp/3.18: [f236cda193b0f27d44c8f6f6809036e7246074fc]
  mainline: [30f7ea1c2b5f5fb7462c5ae44fe2e40cb2d6a474]
  stable/3.16: [78be569977c1ef9946be590113407ef0ae4a39fc]
  stable/3.18: [f236cda193b0f27d44c8f6f6809036e7246074fc]
fixed-by:
  aosp/3.18: [18f0f8c1e866a5c22d2bebcc368c5217670753cf]
  cip/4.4: [b90f87c641bc9af04f0d8a21008880ae032de72c]
  cip/4.4-rt: [b90f87c641bc9af04f0d8a21008880ae032de72c]
  cip/4.4-st: [b90f87c641bc9af04f0d8a21008880ae032de72c]
  debian/buster-security: ['version:debian/4.14.7-1']
  debian/jessie-security: ['version:debian/3.16.56-1']
  debian/stretch-security: ['version:debian/4.9.80-1']
  mainline: [15fe076edea787807a7cdc168df832544b58eba6]
  openela/4.14: [589983eb9986ea9c851c8906a81781f317207313]
  stable/3.16: [a0992bdf1e286a7b5e0dd696e2f2fd0fcbe08c7c]
  stable/3.18: [18f0f8c1e866a5c22d2bebcc368c5217670753cf]
  stable/4.14: [589983eb9986ea9c851c8906a81781f317207313]
  stable/4.4: [b90f87c641bc9af04f0d8a21008880ae032de72c]
  stable/4.9: [5471afeef41388ec08e6cf610640aaf89805d6db]
  ubuntu/bionic: ['version:4.15.0-10.11']
  ubuntu/xenial: [a7e3525727e580a8eedae35057f2432b9885c03a]
