description: FragmentSmack (IP fragments)
references:
- https://www.kb.cert.org/vuls/id/641765
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-5391
- https://usn.ubuntu.com/usn/usn-3740-1
- https://usn.ubuntu.com/usn/usn-3740-2
- https://usn.ubuntu.com/usn/usn-3741-1
- https://usn.ubuntu.com/usn/usn-3741-2
- https://usn.ubuntu.com/usn/usn-3742-1
- https://usn.ubuntu.com/usn/usn-3742-2
comments:
  Debian-canril: |-
    It needs to be checked that the upstream fixes will for 4.9-upstream-
    stable and 3.16-upstream-stable do not cause CVE-2018-14641. In
    the proposed patch series from Florian Fainelli <f.fainelli@gmail.com>,
  Debian-carnil: |-
    Should affect 3.9 and later and mitigation/good enough fix is
    to revert c2a936600f78aea00d3312ea4b66a79a4619f9b4. Or change
    the default values of net.ipv4.ipfrag_high_thresh and
    net.ipv4.ipfrag_low_thresh back to 256kB and 192 kB (respectively)
    or below.
    "Proper" patches in the works.
    SuSE identifies upstream commits which seem to properly address
    the issue, but needs more checking:
    https://bugzilla.novell.com/show_bug.cgi?id=1103097
    Candidates for backports:
    https://bugzilla.novell.com/show_bug.cgi?id=1103097#c15
    56e2c94f05    inet: frag: enforce memory limits earlier
    4672694bd4    ipv4: frags: handle possible skb truesize change
    and
    0ed4229b08c1  ipv6: defrag: drop non-last frags smaller than min mtu
    7969e5c40dfd  ip: discard IPv4 datagrams with overlapping segments.
    385114dec8a4  net: modify skb_rbtree_purge to return the truesize of all
    purged skbs.
    fa0f527358bd  ip: use rb trees for IP frag queue.
    ("[PATCH stable 4.9 v2 00/29] backport of IP fragmentation fixes") contain
    the needed fix.
    The commits backported to 4.9.134 are complete and are not introducing
    thus CVE-2018-14641.
  Ubuntu-tyhicks: CERT recommends reverting c2a936600f78aea00d3312ea4b66a79a4619f9b4
fixed-by:
  linux-4.14.y: [6093d5abcf5ada86d2bb61bd5154bc144bf5a3aa, 673220d6417de8812b20bfeb4d2f809e05a82463,
    0cbf74b9519d8f73dd27cc6fad6e03851788f956, 0512f7e93504386cd1223990d9692c20a878d2d9,
    eb1686ae5e20b4455b80be571e7e41f1c9d7b2ac, 266da0fb83f32e26470017d3eb32cb092b2210ed,
    11be675bf0aaf4a6dcde817126168b9cbd8ba90e, 33dc9f7c5d127bfc203a17f7a31d4dcc754376df,
    9aee41eff751e4c789ff785c561d7bf7ad72c286, bd3df633f17d64523828d0ef5d74e4f1a768683c,
    5b1b3ad46dd100932925e979562aeefaf9ef189e, caa4249eca082c5954ea377aa3ef86b5fc5c1ac1,
    990204ddc5f67530b2ac616767a5c6937c9fc2af, 085a0147447a4f82138825b6a3a329b997c2fb13,
    3226bdcb044862084c3bfc3278d148948600ebc4, bd946fb5226e205530bea2581d867642e4b457ed,
    8291cd943a9b4e2d764a4a294999bbb2f94f153c, 48c2afc16888873da727f9ed7102a620a178fad8,
    5fff99e88a1f4b4e62fd07bf3eb87305c88f3400, 1c44969111cc68f361638b6e54f5a176609aa05a,
    7750c414b89bd8204901855bda21c512e269be35, 3bde783eca23d5d3019c220752f5a29083dea27c,
    5123ffdad65954b3c308e055b388db08987a13ff, 6bf32cda46ebfbaf13da3c48a0a009adae925703,
    37c7cc80b1d7de36a6ed54796ae30ee091d05eab, 6b921536f1707a240e6f53843f1f26231016fda5,
    04b28f406e86512a3592664553b5e17efe663ece, c91f27fb571666a176e1446646726f78d4657ddb,
    b3a0c61b73699b3764a6568e85c67f599158c541, 08fb833b40e361ce927c64d40e348af96996d9eb]
  linux-4.4.y: [ef0f963de1d2c5bc99d3d6ace3dd44a7d6002717, 26cfea3c1d041d08edacae291565f295553e15ce,
    3f78a3f45e79ca378cb850a598e4c76633710e92, 5f2d68b6b5a439c3223d8fa6ba20736f91fc58d8,
    acd00a0692072b374afee4b6f38c1eb1c6cf6f4a, 2039bd8669f4ecefca163f0c9d8c5f5f6a4c8610,
    2822475e70db5a4b46de88a5b66eb2aceb3734af, cb5fd4aa24b57206548d5940dc359f0b181a2688]
  linux-4.4.y-cip: [ef0f963de1d2c5bc99d3d6ace3dd44a7d6002717, 26cfea3c1d041d08edacae291565f295553e15ce,
    3f78a3f45e79ca378cb850a598e4c76633710e92, 5f2d68b6b5a439c3223d8fa6ba20736f91fc58d8,
    acd00a0692072b374afee4b6f38c1eb1c6cf6f4a, 2039bd8669f4ecefca163f0c9d8c5f5f6a4c8610,
    2822475e70db5a4b46de88a5b66eb2aceb3734af, cb5fd4aa24b57206548d5940dc359f0b181a2688]
  linux-4.4.y-cip-rt: [ef0f963de1d2c5bc99d3d6ace3dd44a7d6002717, 26cfea3c1d041d08edacae291565f295553e15ce,
    3f78a3f45e79ca378cb850a598e4c76633710e92, 5f2d68b6b5a439c3223d8fa6ba20736f91fc58d8,
    acd00a0692072b374afee4b6f38c1eb1c6cf6f4a, 2039bd8669f4ecefca163f0c9d8c5f5f6a4c8610,
    2822475e70db5a4b46de88a5b66eb2aceb3734af, cb5fd4aa24b57206548d5940dc359f0b181a2688]
  linux-4.9.y: [7fca77153c5c2a2c59e70720332bce7088aef8e8, 2ffb1c363dfa89858dded0b291f005faf1b72adc,
    bbf6d8604475f36279c7b2d9a1f425654bc24588, dae73e7d73fce8d8d5132ec3c94de16280653fc6,
    1b363f81f38f28bd69ec90837da0f65161f36325, 620018dd713da51daac7ec4cd0ae54b0f0fa0f75,
    fb19348bd709e3f948825ed995bdc477a0414772, 23ce9c5ce704b985dad79bce944a348f0c205869,
    ea7496f018adcfbac5396ead5756dcabb9866749, 49106f36c253a3c4ce7cf297415826af0c4339ea,
    965e2adc5850836586e0961c350b94c2092da319, 7f6170683223cb38cabaff21ecbb9a6375ad10f6,
    7a87ec92d36a660820d426d8c54794c44077277f, cbc45497b39c4626adaeca2a409588f19ae19e34,
    6060bcdcffaba68c3ff158a88faab6df27210ffc, 5b68fda0a455be7f48fdf97407de1aa09d046fdd,
    316986fe4dcac011b4f85d9bbef1edf4953c0219, d838486621c38f084b867743a0abd0968c6cb196,
    82f36cbc74595f06900f478d4eaf7217a4f06e13, f5d17b55f4be318adf3b642b50bd25e5245ecc17,
    871695951ec6f6b0b1a258c9bb5336bfeffab409, a8444b1ccb20339774af58e40ad42296074fb484,
    791521e2e377f66ef5ee6e5002dec758234d8d32, b475cf3bf1e8212b0287c6d15249e2c942693ae5,
    10043954eadac2d8f8c1886190f7a7ee584ff939, e9e4ac488c017739b2832177550ba2569fffc709,
    4077ddb2cb48ca4592d738ea37cd58c5d41754bd, 85e59af99a7f7c9bcd089f2404b405df7ee665ba,
    5a0f340f5ad6a6cc6518f212802f95b669e8fe27]
  mainline: [7969e5c40dfd04799d4341f1b7cd266b6e47f227, 385114dec8a49b5e5945e77ba7de6356106713f4,
    fa0f527358bd900ef92f925878ed6bfbd51305cc, 0ed4229b08c13c84a3c301a08defdc9e7f4467e6,
    70837ffe3085c9a91488b52ca13ac84424da1042, 353c9cb360874e737fb000545f783df756c06f9a,
    a4fd284a1f8fd4b6c59aa59db2185b1e17c5c11c, 5d407b071dc369c26a38398326ee2be53651cfe4]
ignore:
  linux-3.16.y: Too risky to apply upstream fix, and it can be mitigated with sysctl
    changes
