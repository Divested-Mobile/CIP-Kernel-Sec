description: 'CIFS: Relative paths injection in directory entry lists'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1741727
- https://bugzilla.suse.com/show_bug.cgi?id=1144903
- https://bugzilla.samba.org/show_bug.cgi?id=14072
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10220
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10220
comments:
  Debian-bwh: |-
    Although this was reported against CIFS, it seems to be a general
    vulnerability for all filesystems dealing with untrusted servers or
    storage.  Thankfully the fix is also general.
  Debian-carnil: |-
    Needed a followup c512c6918719 ("uaccess: implement a proper
    unsafe_copy_to_user() and switch filldir over to it"), cf.
    https://lore.kernel.org/linux-fsdevel/20191006222046.GA18027@roeck-us.net/
    which landed in 5.4-rc3.
fixed-by:
  mainline: [9f79b78ef74436c7507bac6bfb7b8b989263bccb, 8a23eb804ca4f2be909e372cf5a9e7b30ae476cd]
