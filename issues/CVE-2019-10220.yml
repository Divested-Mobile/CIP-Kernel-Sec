description: 'CIFS: Relative paths injection in directory entry lists'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1741727
- https://bugzilla.suse.com/show_bug.cgi?id=1144903
- https://bugzilla.samba.org/show_bug.cgi?id=14072
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10220
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10220
- https://usn.ubuntu.com/usn/usn-4226-1
- https://ubuntu.com/security/notices/USN-4226-1
- https://www.cve.org/CVERecord?id=CVE-2019-10220
comments:
  debian/bwh: |-
    Although this was reported against CIFS, it seems to be a general
    vulnerability for all filesystems dealing with untrusted servers or
    storage.  Thankfully the fix is also general.
    The changes to uaccess in filldir are *not* required.
  debian/carnil: |-
    Needed a followup c512c6918719 ("uaccess: implement a proper
    unsafe_copy_to_user() and switch filldir over to it"), cf.
    https://lore.kernel.org/linux-fsdevel/20191006222046.GA18027@roeck-us.net/
    which landed in 5.4-rc3.
  ubuntu/tyhicks: Exploiting this vulnerability requires a malicious Samba server
fixed-by:
  aosp/3.18: [ab851f19f15b08d51de1dfb532a2a2bbc41efe62, 96643b4362a82dbbfa642ea53573e6d740ab1914]
  cip/4.19: [40696eb2bce798c4764886fbc576426bd5c4cc3c, 0643c3d694ad9f1e5cb0bc7a487bf9f86a5eaf75]
  cip/4.19-rt: [40696eb2bce798c4764886fbc576426bd5c4cc3c, 0643c3d694ad9f1e5cb0bc7a487bf9f86a5eaf75]
  cip/4.4: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  cip/4.4-rt: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  cip/4.4-st: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  debian/buster-security: ['version:debian/4.19.98-1']
  debian/jessie-security: ['version:debian/3.16.81-1']
  debian/stretch-security: ['version:debian/4.9.210-1']
  mainline: [8a23eb804ca4f2be909e372cf5a9e7b30ae476cd, b9959c7a347d6adbb558fba7e36e9fef3cba3b07]
  openela/4.14: [26b363149dd53a36bbd61901df5ac16bde39badb, 9c0ffae88f7507078c7e6db73eda3b60478628eb]
  stable/3.16: [8b85eda7dac918a308e6e1d9137887930e80827a, 0ad70158f3c02e373e17377237b85e43f06d6752]
  stable/4.14: [26b363149dd53a36bbd61901df5ac16bde39badb, 9c0ffae88f7507078c7e6db73eda3b60478628eb]
  stable/4.19: [40696eb2bce798c4764886fbc576426bd5c4cc3c, 0643c3d694ad9f1e5cb0bc7a487bf9f86a5eaf75]
  stable/4.4: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  stable/4.9: [89f58402e7088d38365f227a7943b1b3fed7489b, 1944687187713590a8722f3f1dfd1cd90e7cbde6]
  stable/5.3: [19487220604b33df12847c9bb9dac470e52e31c2, 54e21d25b72eeea08435ce8623da82fc60381ed3]
  ubuntu/bionic: [d8138509291cd09b64762c0fb91fa8688369f097, 21ebadb1084ad55c1531ee774cb2c14d78392a2f]
  ubuntu/eoan: [284ffbf8dad07e61516685c471e04409a9051bd8, 219452ee2b4b006a3c8970fe487c739ac7d8bc0a]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
  ubuntu/xenial: [07c9dfce6f066454513d26ba1030c0ed0d465a63, c3f4210664380d63df3477ea2fded170528116e4]
