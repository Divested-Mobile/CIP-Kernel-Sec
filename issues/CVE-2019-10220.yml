description: 'CIFS: Relative paths injection in directory entry lists'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1741727
- https://bugzilla.suse.com/show_bug.cgi?id=1144903
- https://bugzilla.samba.org/show_bug.cgi?id=14072
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10220
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2019-10220
- https://usn.ubuntu.com/usn/usn-4226-1
comments:
  Debian-bwh: |-
    Although this was reported against CIFS, it seems to be a general
    vulnerability for all filesystems dealing with untrusted servers or
    storage.  Thankfully the fix is also general.
    The changes to uaccess in filldir are *not* required.
  Debian-carnil: |-
    Needed a followup c512c6918719 ("uaccess: implement a proper
    unsafe_copy_to_user() and switch filldir over to it"), cf.
    https://lore.kernel.org/linux-fsdevel/20191006222046.GA18027@roeck-us.net/
    which landed in 5.4-rc3.
  Ubuntu-tyhicks: Exploiting this vulnerability requires a malicious Samba server
fixed-by:
  linux-3.16.y: [8b85eda7dac918a308e6e1d9137887930e80827a, 0ad70158f3c02e373e17377237b85e43f06d6752]
  linux-4.14.y: [26b363149dd53a36bbd61901df5ac16bde39badb, 9c0ffae88f7507078c7e6db73eda3b60478628eb]
  linux-4.19.y: [40696eb2bce798c4764886fbc576426bd5c4cc3c, 0643c3d694ad9f1e5cb0bc7a487bf9f86a5eaf75]
  linux-4.19.y-cip: [40696eb2bce798c4764886fbc576426bd5c4cc3c, 0643c3d694ad9f1e5cb0bc7a487bf9f86a5eaf75]
  linux-4.19.y-cip-rt: [40696eb2bce798c4764886fbc576426bd5c4cc3c, 0643c3d694ad9f1e5cb0bc7a487bf9f86a5eaf75]
  linux-4.4.y: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  linux-4.4.y-cip: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  linux-4.4.y-cip-rt: [cce8d88a5a2735305198c23fa944737c2a1b3939, 5d41a0c34053b38a687087747f7d76494aa9f05c]
  linux-4.9.y: [89f58402e7088d38365f227a7943b1b3fed7489b, 1944687187713590a8722f3f1dfd1cd90e7cbde6]
  linux-5.3.y: [19487220604b33df12847c9bb9dac470e52e31c2, 54e21d25b72eeea08435ce8623da82fc60381ed3]
  mainline: [8a23eb804ca4f2be909e372cf5a9e7b30ae476cd, b9959c7a347d6adbb558fba7e36e9fef3cba3b07]
