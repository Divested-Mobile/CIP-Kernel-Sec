description: Weak randomisation of IP ID generation
references:
- https://arxiv.org/pdf/1906.10478.pdf
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10638
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.8
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.1.7
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=355b98553789b646ed97ad801a619ff898471b92
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=df453700e8d81b1bdafdf684365ee2b9431fb702
- https://github.com/torvalds/linux/commit/355b98553789b646ed97ad801a619ff898471b92
- https://github.com/torvalds/linux/commit/55f0fc7a02de8f12757f4937143d8d5091b2e40b
- https://github.com/torvalds/linux/commit/df453700e8d81b1bdafdf684365ee2b9431fb702
- https://usn.ubuntu.com/usn/usn-4114-1
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4116-1
- https://usn.ubuntu.com/usn/usn-4117-1
- https://usn.ubuntu.com/usn/usn-4118-1
comments:
  Debian-bwh: |-
    That has been applied to 3.16 but I had to revert it and backport
    several more upstream changes before I could switch to siphash.
  Debian-carnil: |-
    Versions older than 4.1 might need 55f0fc7a02de ("inet: update
    the IP ID generation algorithm to higher standards.").
    This needs clarifying on the fixing commits.
  Ubuntu-tyhicks: |-
    Kernels prior to 4.1 also need the following commit
     https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-3.16.y&id=8b197d3ce585d6777197e0633d71e5af7d98cb35
reporters:
- Amit Klein
- Benny Pinkas
fixed-by:
  linux-3.16.y: [9ebeec41ed3f52fd94267f25f8b9bf3f4cbf1e4e]
  linux-4.14.y: [e10789acbe6a76b304f45cbc8bb77a926ae4f201]
  linux-4.19.y: [07480da0c8a1979e0973d6dd783b6aed966dccf6]
  linux-4.19.y-cip: [07480da0c8a1979e0973d6dd783b6aed966dccf6]
  linux-4.19.y-cip-rt: [07480da0c8a1979e0973d6dd783b6aed966dccf6]
  linux-4.4.y: [66f8c5ff8ed3d99dd21d8f24aac89410de7a4a05]
  linux-4.9.y: [6996763856e1fb27ccae260e41fd73a3fff56678]
  mainline: [df453700e8d81b1bdafdf684365ee2b9431fb702]
