description: Weak randomisation of IP ID generation
references:
- https://arxiv.org/pdf/1906.10478.pdf
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10638
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.8
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.1.7
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=355b98553789b646ed97ad801a619ff898471b92
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=df453700e8d81b1bdafdf684365ee2b9431fb702
- https://github.com/torvalds/linux/commit/355b98553789b646ed97ad801a619ff898471b92
- https://github.com/torvalds/linux/commit/55f0fc7a02de8f12757f4937143d8d5091b2e40b
- https://github.com/torvalds/linux/commit/df453700e8d81b1bdafdf684365ee2b9431fb702
- https://usn.ubuntu.com/usn/usn-4114-1
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4116-1
- https://usn.ubuntu.com/usn/usn-4117-1
- https://usn.ubuntu.com/usn/usn-4118-1
- https://ubuntu.com/security/notices/USN-4114-1
- https://ubuntu.com/security/notices/USN-4115-1
- https://ubuntu.com/security/notices/USN-4116-1
- https://ubuntu.com/security/notices/USN-4117-1
- https://ubuntu.com/security/notices/USN-4118-1
- https://www.cve.org/CVERecord?id=CVE-2019-10638
comments:
  debian/bwh: |-
    That has been applied to 3.16 but I had to revert it and backport
    several more upstream changes before I could switch to siphash.
  debian/carnil: |-
    Versions older than 4.1 might need 55f0fc7a02de ("inet: update
    the IP ID generation algorithm to higher standards.").
    This needs clarifying on the fixing commits.
  ubuntu/tyhicks: |-
    Kernels prior to 4.1 also need the following commit
     https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-3.16.y&id=8b197d3ce585d6777197e0633d71e5af7d98cb35
reporters:
- Amit Klein
- Benny Pinkas
fixed-by:
  aosp/3.18: [c2bca92ba948f3def1f99f6b429ec39e07354dc2, 39473a3279bf34c6ca6d478fc62a8eaedd1f0d21]
  cip/4.19: [a1c2f3229734a4bb8d5ac008c0a67e025aa11547, 07480da0c8a1979e0973d6dd783b6aed966dccf6]
  cip/4.19-rt: [a1c2f3229734a4bb8d5ac008c0a67e025aa11547, 07480da0c8a1979e0973d6dd783b6aed966dccf6]
  cip/4.4: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc, 66f8c5ff8ed3d99dd21d8f24aac89410de7a4a05]
  cip/4.4-rt: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc, 66f8c5ff8ed3d99dd21d8f24aac89410de7a4a05]
  cip/4.4-st: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc, 66f8c5ff8ed3d99dd21d8f24aac89410de7a4a05]
  debian/buster-security: ['patch:debian/4.19.37-5+deb10u2:bugfix/all/net-switch-IP-ID-generator-to-siphash.patch']
  debian/jessie-security: ['version:debian/3.16.72-1']
  debian/stretch-security: ['patch:debian/4.9.168-1+deb9u5:bugfix/all/inet-switch-ip-id-generator-to-siphash.patch']
  mainline: [355b98553789b646ed97ad801a619ff898471b92, df453700e8d81b1bdafdf684365ee2b9431fb702]
  openela/4.14: [adbb8bdd392db14dc80ad1ac29f8f1d37ab57a62, e10789acbe6a76b304f45cbc8bb77a926ae4f201]
  stable/3.16: [9ebeec41ed3f52fd94267f25f8b9bf3f4cbf1e4e]
  stable/4.14: [adbb8bdd392db14dc80ad1ac29f8f1d37ab57a62, e10789acbe6a76b304f45cbc8bb77a926ae4f201]
  stable/4.19: [a1c2f3229734a4bb8d5ac008c0a67e025aa11547, 07480da0c8a1979e0973d6dd783b6aed966dccf6]
  stable/4.4: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc, 66f8c5ff8ed3d99dd21d8f24aac89410de7a4a05]
  stable/4.9: [6996763856e1fb27ccae260e41fd73a3fff56678, b97a2f3d58f439d11ececb2faa21dac775d63c5c]
  ubuntu/bionic: ['version:4.15.0-60.67']
  ubuntu/xenial: [932e344bf73c8cea3bff41a5fd3a3478f5abb222, babc199b82d18b589837044f0dfe29bd1aac63a5,
    a79a821964ab7692e111b9b8418fdb1aea997a13]
