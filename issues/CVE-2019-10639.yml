description: 'netns: provide pure entropy for net_hash_mix()'
references:
- https://arxiv.org/pdf/1906.10478.pdf
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10639
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.8
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=355b98553789b646ed97ad801a619ff898471b92
- https://github.com/torvalds/linux/commit/355b98553789b646ed97ad801a619ff898471b92
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4118-1
comments:
  debian/bwh: |-
    This is a leak of net namespace addresses, which also leaks the KASLR
    base address since init_net is static.  It was specifically found to
    leak through IPv4 IDs since commit b6a7719aedd7 "ipv4: hash net ptr
    into fragmentation bucket selection" in Linux 4.1.  However, other
    uses may also leak the address in 3.16.
reporters:
- Amit Klein
- Benny Pinkas
introduced-by:
  mainline: [0b4419162aa6c4204843f3a13b48d9ab821d3167]
fixed-by:
  cip/4.19: [a1c2f3229734a4bb8d5ac008c0a67e025aa11547]
  cip/4.19-rt: [a1c2f3229734a4bb8d5ac008c0a67e025aa11547]
  cip/4.4: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc]
  cip/4.4-rt: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc]
  debian/buster-security: ['version:debian/4.19.37-1']
  debian/jessie-security: ['version:debian/3.16.70-1']
  debian/stretch-security: ['patch:debian/4.9.168-1+deb9u5:bugfix/all/inet-switch-ip-id-generator-to-siphash.patch']
  mainline: [355b98553789b646ed97ad801a619ff898471b92]
  stable/3.16: [188da790e1f4d164bcfdea486e91fd47e1ba59c5]
  stable/4.14: [adbb8bdd392db14dc80ad1ac29f8f1d37ab57a62]
  stable/4.19: [a1c2f3229734a4bb8d5ac008c0a67e025aa11547]
  stable/4.4: [0ede14314f6d9e6a172eb4c4b6b9fe5477aa70bc]
  stable/4.9: [6996763856e1fb27ccae260e41fd73a3fff56678]
  ubuntu/bionic: [1d532ad3c6ef04e55d3d923a225a3c44324fb1c4]
  ubuntu/eoan: ['version:5.0.0-16.17']
  ubuntu/xenial: [eb1a6a57db00f6ddead82523ed91b554453d9417]
