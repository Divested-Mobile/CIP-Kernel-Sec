description: |-
  The Linux kernel through 5.0.7, when CONFIG_IA32_AOUT is enabled and
  ia32_aout is loaded, allows local users to bypass ASLR on setuid a.out
  programs (if any exist) because install_exec_creds() is called too late in
  load_aout_binary() in fs/binfmt_aout.c, and thus the ptrace_may_access()
  check has a race condition when reading /proc/pid/stat.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11191
- https://www.openwall.com/lists/oss-security/2019/04/03/4
- https://www.openwall.com/lists/oss-security/2019/04/03/4/1
- https://usn.ubuntu.com/usn/usn-4006-1
- https://usn.ubuntu.com/usn/usn-4006-2
- https://usn.ubuntu.com/usn/usn-4007-1
- https://usn.ubuntu.com/usn/usn-4007-2
- https://usn.ubuntu.com/usn/usn-4008-1
- https://usn.ubuntu.com/usn/usn-4008-3
- https://bugs.launchpad.net/bugs/1818552
- https://ubuntu.com/security/notices/USN-4006-1
- https://ubuntu.com/security/notices/USN-4006-2
- https://ubuntu.com/security/notices/USN-4007-1
- https://ubuntu.com/security/notices/USN-4007-2
- https://ubuntu.com/security/notices/USN-4008-1
- https://ubuntu.com/security/notices/USN-4008-3
- https://www.cve.org/CVERecord?id=CVE-2019-11191
comments:
  bwh: Only ELF supports ASLR.
  debian/bwh: Only ELF supports ASLR.
  debian/carnil: |-
    CVE is for the issue in binfmt_aout.c specifically.
    Upstream plans to deprecate a.out format.
  ubuntu/sbeattie: |-
    configuration changes to disable i386 a.out support are in
     progress.
  ubuntu/tyhicks: |-
    This only affects i386 Ubuntu kernels. Additionally, it is very
     unlikely that systems will have a setuid a.out program installed.
reporters:
- Federico Manuel Bento
fixed-by:
  mainline: [eac616557050737a8d6ef6fe0322d0980ff0ffde]
  ubuntu/bionic: ['version:4.15.0-51.55']
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/xenial: ['version:4.4.0-150.176']
ignore:
  all: Invalid
