description: page->_refcount overflow via FUSE with ~140GiB RAM usage
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1752
- https://lwn.net/Articles/786044/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11487
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=15fab63e1e57be9fdb5eec1bbc5916e9825e9acb
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6b3a707736301c2128ca85ce85fb13f60b5e350a
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=88b1a17dfc3ed7728316478fae0f5ad508f50397
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8fde12ca79aff9b5ba951fce1a2641901b8d8e64
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f958d7b528b1b40c44cfda5eabe2d82760d868c3
- https://github.com/torvalds/linux/commit/15fab63e1e57be9fdb5eec1bbc5916e9825e9acb
- https://github.com/torvalds/linux/commit/6b3a707736301c2128ca85ce85fb13f60b5e350a
- https://github.com/torvalds/linux/commit/88b1a17dfc3ed7728316478fae0f5ad508f50397
- https://github.com/torvalds/linux/commit/8fde12ca79aff9b5ba951fce1a2641901b8d8e64
- https://github.com/torvalds/linux/commit/f958d7b528b1b40c44cfda5eabe2d82760d868c3
- https://usn.ubuntu.com/usn/usn-4069-1
- https://usn.ubuntu.com/usn/usn-4069-2
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4118-1
comments:
  Debian-bwh: |-
    I'm having trouble backporting to this to 3.16 because we don't
    have commit ddc58f27f9ee "mm: drop tail page refcounting".
  Debian-carnil: |-
    604d7b594c6d ("mm: add 'try_get_page()' helper function") was
    already added in 4.9.175, possibly for preparation.
  Ubuntu-tyhicks: Requires >= 140 GiB of RAM which is rare
  bwh: |
    For kernel versions before 4.13, arch/x86/mm/gup.c also needs to be
    updated.  This is done by the last commit listed for linux-4.9.y.
reporters:
- Jann Horn
introduced-by:
  mainline: [b6aeadeda22a9aa322fdfcd3f4c69ccf0da5cbdd]
fixed-by:
  linux-4.14.y: [c88a0aa7ace7eb10dca42be59f21e2cbd263575e, 2a280d881726795ae490dc45bcaa9f6d4bf43741,
    04198de24771f6aaf6374979db64403101d809df, 94d99a2355e32ba8eae7bdfdf861f90286634cd9]
  linux-4.19.y: [0311ff82b70fa12e80d188635bff24029ec06ae1, 0612cae7ec6b79d2ff1b34562bab79d5bf96327a,
    d972ebbf42ba6712460308ae57c222a0706f2af3, 9f6da5fd05577ef4a05c1744cc7098d0173823af]
  linux-4.19.y-cip: [0311ff82b70fa12e80d188635bff24029ec06ae1, 0612cae7ec6b79d2ff1b34562bab79d5bf96327a,
    d972ebbf42ba6712460308ae57c222a0706f2af3, 9f6da5fd05577ef4a05c1744cc7098d0173823af]
  linux-4.19.y-cip-rt: [0311ff82b70fa12e80d188635bff24029ec06ae1, 0612cae7ec6b79d2ff1b34562bab79d5bf96327a,
    d972ebbf42ba6712460308ae57c222a0706f2af3, 9f6da5fd05577ef4a05c1744cc7098d0173823af]
  linux-4.9.y: [9557090582a33801349f0a0920a55d134a27e740, 604d7b594c6d18582650dd06b201643b15202232,
    2ed768cfd8956df77f60dd073251699ad3e56cd4, 96019c69145840a498e4e988f56a7524dc0c59b7,
    d73af79742e708a171c1a224759fb0661ed6fcac]
  linux-5.0.y: [27f651142eec95373c7ed6e10a3929fab1733c1a, bdc8dfd6587378458e248e36ab79a129f24ba8e9,
    ad73e3a199066ad9bf48ea1334ef312e5aa078f4, 258fc3baeb4b2da15391735fd806facf4a91b585]
  mainline: [15fab63e1e57be9fdb5eec1bbc5916e9825e9acb, 88b1a17dfc3ed7728316478fae0f5ad508f50397,
    8fde12ca79aff9b5ba951fce1a2641901b8d8e64, f958d7b528b1b40c44cfda5eabe2d82760d868c3]
ignore:
  linux-3.16.y: Minor issue, difficult to backport fix
  linux-4.4.y: Minor issue, difficult to backport fix
  linux-4.4.y-cip: Minor issue, difficult to backport fix
  linux-4.4.y-cip-rt: Minor issue, difficult to backport fix
