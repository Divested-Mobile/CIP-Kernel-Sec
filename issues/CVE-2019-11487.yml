description: page->_refcount overflow via FUSE with ~140GiB RAM usage
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1752
- https://lwn.net/Articles/786044/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11487
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=15fab63e1e57be9fdb5eec1bbc5916e9825e9acb
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6b3a707736301c2128ca85ce85fb13f60b5e350a
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=88b1a17dfc3ed7728316478fae0f5ad508f50397
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8fde12ca79aff9b5ba951fce1a2641901b8d8e64
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f958d7b528b1b40c44cfda5eabe2d82760d868c3
- https://github.com/torvalds/linux/commit/15fab63e1e57be9fdb5eec1bbc5916e9825e9acb
- https://github.com/torvalds/linux/commit/6b3a707736301c2128ca85ce85fb13f60b5e350a
- https://github.com/torvalds/linux/commit/88b1a17dfc3ed7728316478fae0f5ad508f50397
- https://github.com/torvalds/linux/commit/8fde12ca79aff9b5ba951fce1a2641901b8d8e64
- https://github.com/torvalds/linux/commit/f958d7b528b1b40c44cfda5eabe2d82760d868c3
- https://usn.ubuntu.com/usn/usn-4069-1
- https://usn.ubuntu.com/usn/usn-4069-2
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4118-1
- https://usn.ubuntu.com/usn/usn-4145-1
- https://ubuntu.com/security/notices/USN-4069-1
- https://ubuntu.com/security/notices/USN-4069-2
- https://ubuntu.com/security/notices/USN-4115-1
- https://ubuntu.com/security/notices/USN-4118-1
- https://ubuntu.com/security/notices/USN-4145-1
- https://www.cve.org/CVERecord?id=CVE-2019-11487
comments:
  bwh: |
    For kernel versions before 4.13, arch/x86/mm/gup.c also needs to be
    updated.  This is done by the last commit listed for linux-4.9.y.
  debian/bwh: |-
    I'm having trouble backporting to this to 3.16 because we don't
    have commit ddc58f27f9ee "mm: drop tail page refcounting".
  debian/carnil: |-
    604d7b594c6d ("mm: add 'try_get_page()' helper function") was
    already added in 4.9.175, possibly for preparation.
  ubuntu/tyhicks: Requires >= 140 GiB of RAM which is rare
reporters:
- Jann Horn
introduced-by:
  mainline: [b6aeadeda22a9aa322fdfcd3f4c69ccf0da5cbdd]
fixed-by:
  cip/4.19: [0311ff82b70fa12e80d188635bff24029ec06ae1, 0612cae7ec6b79d2ff1b34562bab79d5bf96327a,
    d972ebbf42ba6712460308ae57c222a0706f2af3, 9f6da5fd05577ef4a05c1744cc7098d0173823af]
  cip/4.19-rt: [0311ff82b70fa12e80d188635bff24029ec06ae1, 0612cae7ec6b79d2ff1b34562bab79d5bf96327a,
    d972ebbf42ba6712460308ae57c222a0706f2af3, 9f6da5fd05577ef4a05c1744cc7098d0173823af]
  debian/buster-security: ['patch:debian/4.19.37-1:bugfix/all/0001-mm-make-page-ref-count-overflow-check-tighter-and-mo.patch',
    'patch:debian/4.19.37-1:bugfix/all/0002-mm-add-try_get_page-helper-function.patch',
    'patch:debian/4.19.37-1:bugfix/all/0003-mm-prevent-get_user_pages-from-overflowing-page-refc.patch',
    'patch:debian/4.19.37-1:bugfix/all/0004-fs-prevent-page-refcount-overflow-in-pipe_buf_get.patch']
  debian/stretch-security: ['version:debian/4.9.184-1']
  mainline: [15fab63e1e57be9fdb5eec1bbc5916e9825e9acb, 88b1a17dfc3ed7728316478fae0f5ad508f50397,
    8fde12ca79aff9b5ba951fce1a2641901b8d8e64, f958d7b528b1b40c44cfda5eabe2d82760d868c3]
  stable/4.14: [c88a0aa7ace7eb10dca42be59f21e2cbd263575e, 2a280d881726795ae490dc45bcaa9f6d4bf43741,
    04198de24771f6aaf6374979db64403101d809df, 94d99a2355e32ba8eae7bdfdf861f90286634cd9]
  stable/4.19: [0311ff82b70fa12e80d188635bff24029ec06ae1, 0612cae7ec6b79d2ff1b34562bab79d5bf96327a,
    d972ebbf42ba6712460308ae57c222a0706f2af3, 9f6da5fd05577ef4a05c1744cc7098d0173823af]
  stable/4.9: [9557090582a33801349f0a0920a55d134a27e740, 604d7b594c6d18582650dd06b201643b15202232,
    2ed768cfd8956df77f60dd073251699ad3e56cd4, 96019c69145840a498e4e988f56a7524dc0c59b7,
    d73af79742e708a171c1a224759fb0661ed6fcac]
  stable/5.0: [27f651142eec95373c7ed6e10a3929fab1733c1a, bdc8dfd6587378458e248e36ab79a129f24ba8e9,
    ad73e3a199066ad9bf48ea1334ef312e5aa078f4, 258fc3baeb4b2da15391735fd806facf4a91b585]
  ubuntu/bionic: [9254e54659424e62aed231d10004e8ce6f491c70, 16748b28f83dad114f02c23dd0de697ac8f7d8a6,
    a991ca8f7a3d3867a226bc94139ebccf8d52fa8c, 7d225d5fb4ef90ffcd4e4f395b73b4838755504a]
  ubuntu/xenial: [a2394a66e57ee8d02efcad7c943245c046f98668, 3596fb0f96f5f11155a77f6255a0a2796f0a42f9,
    cdd6f6a13d6d5a729d097a675a390ab859662344, d4a5d4fe58f1c28ecd3e3a02306e65474db28418,
    e507e5ef508ea8819476d1f416d181e193b4fe53, e55a9a7a9af1948d4b5e46b6c471ce4217ff116e]
ignore:
  cip/4.4: Minor issue, difficult to backport fix
  cip/4.4-rt: Minor issue, difficult to backport fix
  cip/4.4-st: Minor issue, difficult to backport fix
  debian/jessie-security: Minor issue and high risk of regression
  stable/3.16: Minor issue, difficult to backport fix
  stable/4.4: Minor issue, difficult to backport fix
