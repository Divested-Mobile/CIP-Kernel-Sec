description: 'net: rds: force to destroy connection if t_sock is NULL in rds_tcp_kill_sock()'
references:
- https://bugs.debian.org/928989
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11815
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.0.8
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=cb66ddd156203daefb8d71158036b27b0e2caf63
- https://github.com/torvalds/linux/commit/cb66ddd156203daefb8d71158036b27b0e2caf63
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1829055
- https://usn.ubuntu.com/usn/usn-4005-1
- https://usn.ubuntu.com/usn/usn-4008-1
- https://usn.ubuntu.com/usn/usn-4008-3
- https://usn.ubuntu.com/usn/usn-4068-1
- https://usn.ubuntu.com/usn/usn-4068-2
- https://usn.ubuntu.com/usn/usn-4118-1
- https://ubuntu.com/security/notices/USN-4005-1
- https://ubuntu.com/security/notices/USN-4008-1
- https://ubuntu.com/security/notices/USN-4008-3
- https://ubuntu.com/security/notices/USN-4068-1
- https://ubuntu.com/security/notices/USN-4068-2
- https://ubuntu.com/security/notices/USN-4118-1
- https://www.cve.org/CVERecord?id=CVE-2019-11815
comments:
  debian/bwh: |-
    Introduced in 4.3 by commit 467fa15356ac "RDS-TCP: Support multiple
    RDS-TCP listen endpoints, one per netns."  Debian disables auto-
    loading of rds which mitigates this on systems that don't normally
    use it.
  ubuntu/seth-arnold: |-
    I haven't yet seen evidence to support allegations that this is
     remotely exploitable. Blacklisting rds.ko module is probably sufficient
     to prevent the vulnerable code from loading. The default configuration of
     the kmod package has included RDS in /etc/modprobe.d/blacklist-rare-network.conf
     since 14.04 LTS. I'm dropping priority as a result.
introduced-by:
  mainline: [467fa15356acfb7b2efa38839c3e76caa4e6e0ea]
fixed-by:
  cip/4.19: [78b4bf26a8a76569fd6d0b47d98fb553c333b06f]
  cip/4.19-rt: [78b4bf26a8a76569fd6d0b47d98fb553c333b06f]
  cip/4.4: [c4e97b06cfdc5213494c22dd5c2b41ff8b15e0ee]
  cip/4.4-rt: [c4e97b06cfdc5213494c22dd5c2b41ff8b15e0ee]
  cip/4.4-st: [c4e97b06cfdc5213494c22dd5c2b41ff8b15e0ee]
  debian/buster-security: ['version:debian/4.19.37-1']
  debian/stretch-security: ['patch:debian/4.9.168-1+deb9u3:bugfix/all/net-rds-force-to-destroy-connection-if-t_sock-is-nul.patch']
  mainline: [cb66ddd156203daefb8d71158036b27b0e2caf63]
  stable/4.14: [c8a88799e632045399af886a1b1a5205e5d49897]
  stable/4.19: [78b4bf26a8a76569fd6d0b47d98fb553c333b06f]
  stable/4.4: [c4e97b06cfdc5213494c22dd5c2b41ff8b15e0ee]
  stable/4.9: [a1aa69beac4d88dfb892a95ee04fe6f932803952]
  stable/5.0: [4e8d8e767f11aa420b6fef1f260d40010df77628]
  ubuntu/bionic: [241527c1d1f5f427f4c0a5d2a726e753329bb415]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/xenial: [bf5ad0ecf4c49c79f18033d720a468e158e5858f]
