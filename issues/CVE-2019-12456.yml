description: |-
  An issue was discovered in the MPT3COMMAND case in _ctl_ioctl_main in
  drivers/scsi/mpt3sas/mpt3sas_ctl.c in the Linux kernel through 5.1.5. It
  allows local users to cause a denial of service or possibly have
  unspecified other impact by changing the value of ioc_number between two
  kernel reads of that value, aka a "double fetch" vulnerability.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12456
- https://git.kernel.org/pub/scm/linux/kernel/git/mkp/scsi.git/commit/?h=5.3/scsi-queue&id=86e5aca7fa2927060839f3e3b40c8bd65a7e8d1e
- https://lkml.org/lkml/2019/5/29/1164
- https://bugzilla.redhat.com/show_bug.cgi?id=1717182#c3
- https://www.cve.org/CVERecord?id=CVE-2019-12456
comments:
  bwh: |
    The double-fetched value is not used after the second fetch, so
    although it seems like a good idea to guard against a possible
    TOCTTOU issue I don't think there was an actual vulnerability
    here.
  debian/bwh: The double-fetched value is not used after the second fetch
  ubuntu/tyhicks: |-
    There seems to be no security impact as the ioc_number is never used
     after the "double fetch"
introduced-by:
  mainline: [f92363d12359498f9a9960511de1a550f0ec41c2]
fixed-by:
  mainline: [f9e3ebeea4521652318af903cddeaf033527e93e]
ignore:
  all: Invalid
