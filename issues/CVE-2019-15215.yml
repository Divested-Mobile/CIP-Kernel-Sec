description: 'media: cpia2_usb: first wake up, then free in disconnect'
references:
- https://syzkaller.appspot.com/bug?id=b68d3c254cf294f8a802582094fa3251d6de5247
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15215
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.2.6
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=eff73de2b1600ad8230692f00bc0ab49b166512a
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4118-1
- https://usn.ubuntu.com/usn/usn-4145-1
- https://usn.ubuntu.com/usn/usn-4147-1
comments:
  Debian-bwh: |-
    Maybe introduced in 3.5 by commit 6c493f8b28c6 "[media] cpia2:
    major overhaul to get it in a working state again", but might be
    older.
  Ubuntu-tyhicks: |-
    Setting priority to low since this issue requires a malicious USB
     device to be inserted into the system
introduced-by:
  mainline: [6c493f8b28c6744995e92801a20dca192635dd22]
fixed-by:
  linux-3.16.y: [136f9120ecef4d43b5d87000542f16e87c93e2b1]
  linux-4.14.y: [3566a98e59b5cb19829d21bfe18cd396812ce15e]
  linux-4.19.y: [8b44cc225e6024174508164931cab9f01c79dca2]
  linux-4.19.y-cip: [8b44cc225e6024174508164931cab9f01c79dca2]
  linux-4.19.y-cip-rt: [8b44cc225e6024174508164931cab9f01c79dca2]
  linux-4.4.y: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  linux-4.4.y-cip: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  linux-4.4.y-cip-rt: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  linux-4.9.y: [0b8a71a8bd2129ca9cc115195fd9630564765772]
  linux-5.2.y: [7951663c80a558ac97978e19ba893f9f6d3dec3d]
  mainline: [eff73de2b1600ad8230692f00bc0ab49b166512a]
ignore:
  linux-4.19.y-cip: No member enables cpia2
  linux-4.19.y-cip-rt: No member enables cpia2
  linux-4.4.y-cip: No member enables cpia2
  linux-4.4.y-cip-rt: No member enables cpia2
