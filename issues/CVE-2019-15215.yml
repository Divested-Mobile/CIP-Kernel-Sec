description: 'media: cpia2_usb: first wake up, then free in disconnect'
references:
- https://syzkaller.appspot.com/bug?id=b68d3c254cf294f8a802582094fa3251d6de5247
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15215
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.2.6
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=eff73de2b1600ad8230692f00bc0ab49b166512a
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4118-1
- https://usn.ubuntu.com/usn/usn-4145-1
- https://usn.ubuntu.com/usn/usn-4147-1
- https://ubuntu.com/security/notices/USN-4115-1
- https://ubuntu.com/security/notices/USN-4118-1
- https://ubuntu.com/security/notices/USN-4145-1
- https://ubuntu.com/security/notices/USN-4147-1
- https://www.cve.org/CVERecord?id=CVE-2019-15215
comments:
  debian/bwh: |-
    Maybe introduced in 3.5 by commit 6c493f8b28c6 "[media] cpia2:
    major overhaul to get it in a working state again", but might be
    older.
  ubuntu/tyhicks: |-
    Setting priority to low since this issue requires a malicious USB
     device to be inserted into the system
introduced-by:
  mainline: [6c493f8b28c6744995e92801a20dca192635dd22]
fixed-by:
  aosp/3.18: [6a43cbe341844a7273c3cfc07f9dd0501117f876]
  cip/4.19: [8b44cc225e6024174508164931cab9f01c79dca2]
  cip/4.19-rt: [8b44cc225e6024174508164931cab9f01c79dca2]
  cip/4.4: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  cip/4.4-rt: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  cip/4.4-st: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  debian/buster-security: ['version:debian/4.19.67-1']
  debian/jessie-security: ['version:debian/3.16.74-1']
  debian/stretch-security: ['version:debian/4.9.189-1']
  mainline: [eff73de2b1600ad8230692f00bc0ab49b166512a]
  stable/3.16: [136f9120ecef4d43b5d87000542f16e87c93e2b1]
  stable/4.14: [3566a98e59b5cb19829d21bfe18cd396812ce15e]
  stable/4.19: [8b44cc225e6024174508164931cab9f01c79dca2]
  stable/4.4: [63a80df0ea2b94813f60e8372f9ee93856bcfd5b]
  stable/4.9: [0b8a71a8bd2129ca9cc115195fd9630564765772]
  stable/5.2: [7951663c80a558ac97978e19ba893f9f6d3dec3d]
  ubuntu/bionic: [9000ae437f1c85b2f087cd4a6a577c44e698cd8d]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/xenial: [fcef9a58aa06287988e8d2b0344389078e6ed52b]
ignore:
  cip/4.19: No member enables cpia2
  cip/4.19-rt: No member enables cpia2
  cip/4.4: No member enables cpia2
  cip/4.4-rt: No member enables cpia2
