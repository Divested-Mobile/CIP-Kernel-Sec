description: 'nbd_genl_status: null check for nla_nest_start'
references:
- https://lore.kernel.org/patchwork/patch/1106884/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16089
- https://lore.kernel.org/lkml/20190911164013.27364-1-navid.emamdoost@gmail.com/
- https://lore.kernel.org/patchwork/patch/1126650/
- https://bugzilla.suse.com/show_bug.cgi?id=1150004
- https://usn.ubuntu.com/usn/usn-4414-1
- https://usn.ubuntu.com/usn/usn-4425-1
- https://usn.ubuntu.com/usn/usn-4439-1
- https://usn.ubuntu.com/usn/usn-4440-1
- https://ubuntu.com/security/notices/USN-4414-1
- https://ubuntu.com/security/notices/USN-4425-1
- https://ubuntu.com/security/notices/USN-4439-1
- https://ubuntu.com/security/notices/USN-4440-1
- https://www.cve.org/CVERecord?id=CVE-2019-16089
comments:
  bwh: |
    nla_nest_start() will only fail if there is insufficient space in
    the given skb.  This does seem to be possible in theory, as the
    size nbd_genl_status() requests does not account for the size of
    nested attribute headers.  In practice skb sizes are cache-line-
    aligned and that will probably avoid failure at this point.
  debian/bwh: |-
    Introduced in 4.12 by commit 47d902b90a32 "nbd: add a status netlink
    command".  Probably not exploitable in most configurations.
  ubuntu/sbeattie: fix has not landed upstream as of 2020-04-22
introduced-by:
  mainline: [47d902b90a32a42a3d33aef3a02170fc6f70aa23]
fixed-by:
  ubuntu/bionic: [66d3f179e96424517779c27bc46af233e039bd50]
  ubuntu/focal: [20521da1f93f88b5eb95646c84b2d7962f8fd072]
  ubuntu/groovy: [20521da1f93f88b5eb95646c84b2d7962f8fd072]
