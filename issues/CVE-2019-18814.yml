description: |-
  An issue was discovered in the Linux kernel through 5.3.9. There is a
  use-after-free when aa_label_parse() fails in aa_audit_rule_init() in
  security/apparmor/audit.c.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18814
- https://lore.kernel.org/patchwork/patch/1142523/
- https://www.cve.org/CVERecord?id=CVE-2019-18814
comments:
  debian/bwh: |-
    Introduced in 4.18 by commit 52e8c38001d8 "apparmor: Fix memory leak of
    rule on error exit path".
introduced-by:
  mainline: [52e8c38001d8ef0ca07ef428e480cd4a35e46abf]
fixed-by:
  cip/4.19: [f1738ae012a106c6c8fa7d33ed47fb478d9d3c75]
  cip/4.19-rt: [f1738ae012a106c6c8fa7d33ed47fb478d9d3c75]
  debian/buster-security: ['version:debian/4.19.131-1']
  mainline: [c54d481d71c6849e044690d3960aaebc730224cc]
  stable/4.19: [f1738ae012a106c6c8fa7d33ed47fb478d9d3c75]
  stable/5.4: [97d817b9ef13e2d52a86ea032b0df6a922e0e9df]
  ubuntu/eoan: ['version:5.0.0-13.14']
