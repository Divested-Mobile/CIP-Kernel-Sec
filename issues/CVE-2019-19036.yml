description: |-
  btrfs_root_node in fs/btrfs/ctree.c in the Linux kernel through 5.3.12
  allows a NULL pointer dereference because rcu_dereference(root->node) can
  be zero.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19036
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19036
- https://bugzilla.suse.com/show_bug.cgi?id=1157692
comments:
  Ubuntu-sbeattie: |-
    likely addressed by the btrfs write time tree-checker, which
      would mean it is addressed for kernels back through 4.4.x
  Ubuntu-tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
  wens: |-
    Based on comments from SUSE bugzilla, the tree checker rejects
    rootid == 0. This check was introduced in commit 259ee7754b67
    ("btrfs: tree-checker: Add ROOT_ITEM check") in v5.4.
fixed-by:
  mainline: [259ee7754b6793af8bdd77f9ca818bc41cfe9541]
