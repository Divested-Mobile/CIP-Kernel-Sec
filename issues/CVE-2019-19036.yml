description: |-
  btrfs_root_node in fs/btrfs/ctree.c in the Linux kernel through 5.3.12
  allows a NULL pointer dereference because rcu_dereference(root->node) can
  be zero.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19036
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19036
- https://bugzilla.suse.com/show_bug.cgi?id=1157692
- https://usn.ubuntu.com/usn/usn-4414-1
- https://bugzilla.redhat.com/show_bug.cgi?id=1775187
- https://usn.ubuntu.com/usn/usn-4439-1
- https://ubuntu.com/security/notices/USN-4414-1
- https://ubuntu.com/security/notices/USN-4439-1
- https://www.cve.org/CVERecord?id=CVE-2019-19036
comments:
  debian/bwh: |-
    I think this affects 4.9 but the fix depends on commits going back
    to at least 581c1760415c "btrfs: Validate child tree block's level
    and first key".
  debian/carnil: |-
    This is a good candidate and is included in 5.4-rc1. It was
    futhermore backported to 5.3.4, 5.2.19 and 4.19.129, where the
    5.3.4 fixing information would as well match what is available
    from the Red Hat bugzilla.
  debian/jmm: Fixed by 62fdaa52a3d00a875da771719b6dc537ca79fce1 ?
  ubuntu/sbeattie: |-
    likely addressed by the btrfs write time tree-checker, which
      would mean it is addressed for kernels back through 4.4.x
  ubuntu/tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
  wens: |-
    Based on comments from SUSE bugzilla, the tree checker rejects
    rootid == 0. This check was introduced in commit 259ee7754b67
    ("btrfs: tree-checker: Add ROOT_ITEM check") in v5.4.
reporters:
- bobfuzzer
fixed-by:
  cip/4.19: [227af79e6cb0ee3faeb8c70be4bc0aec0b09ea25]
  cip/4.19-rt: [227af79e6cb0ee3faeb8c70be4bc0aec0b09ea25]
  debian/buster-security: ['version:debian/4.19.131-1']
  mainline: [62fdaa52a3d00a875da771719b6dc537ca79fce1]
  stable/4.19: [227af79e6cb0ee3faeb8c70be4bc0aec0b09ea25]
  ubuntu/bionic: [a134ef1f21a1e5e9d888a66b9e311ad11d77338c]
  ubuntu/eoan: [67706de26bd2f55c7aa9ffe184063da7ca06ab3a]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
ignore:
  cip/4.4-rt: No member enables btrfs
  debian/jessie-security: EOL
  debian/stretch-security: EOL
tests:
- CVE-2019-19036
