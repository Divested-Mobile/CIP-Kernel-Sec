description: |-
  btrfs_root_node in fs/btrfs/ctree.c in the Linux kernel through 5.3.12
  allows a NULL pointer dereference because rcu_dereference(root->node) can
  be zero.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19036
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19036
- https://bugzilla.suse.com/show_bug.cgi?id=1157692
- https://usn.ubuntu.com/usn/usn-4414-1
- https://bugzilla.redhat.com/show_bug.cgi?id=1775187
- https://usn.ubuntu.com/usn/usn-4439-1
comments:
  debian/carnil: |-
    This is a good candidate and is included in 5.4-rc1. It was
    futhermore backported to 5.3.4, 5.2.19 and 4.19.129, where the
    5.3.4 fixing information would as well match what is available
    from the Red Hat bugzilla.
  debian/jmm: Fixed by 62fdaa52a3d00a875da771719b6dc537ca79fce1 ?
  ubuntu/sbeattie: |-
    likely addressed by the btrfs write time tree-checker, which
      would mean it is addressed for kernels back through 4.4.x
  ubuntu/tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
  wens: |-
    Based on comments from SUSE bugzilla, the tree checker rejects
    rootid == 0. This check was introduced in commit 259ee7754b67
    ("btrfs: tree-checker: Add ROOT_ITEM check") in v5.4.
reporters:
- bobfuzzer
fixed-by:
  mainline: [259ee7754b6793af8bdd77f9ca818bc41cfe9541]
  ubuntu/bionic: [a134ef1f21a1e5e9d888a66b9e311ad11d77338c]
  ubuntu/eoan: [67706de26bd2f55c7aa9ffe184063da7ca06ab3a]
  ubuntu/focal: ['version:5.4.0-9.12']
