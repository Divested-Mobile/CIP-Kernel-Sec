description: |-
  ext4_empty_dir in fs/ext4/namei.c in the Linux kernel through 5.3.12 allows
  a NULL pointer dereference because ext4_read_dirblock(inode,0,DIRENT_HTREE)
  can be zero.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19037
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19037
- https://lore.kernel.org/stable/20191127131258.1163-1-jack@suse.cz/
- https://lore.kernel.org/stable/20191202170213.4761-2-jack@suse.cz/
comments:
  Debian-carnil: |-
    commit fixes Fixes: 4e19d6b65fb4 ("ext4: allow directory
    holes") which is in 5.3-rc1 but was backported to various other
    stable trees in 5.2.4, 5.1.21, 4.19.62, 4.14.135 and 4.9.187
    already.
  Ubuntu-tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
  bwh: |-
    The description is wrong.  ext4_read_dirblock() will not return a
    null pointer when the "type" parameter is DIRENT_HTREE but may do
    when it is EITHER.
introduced-by:
  linux-4.14.y: [514631c2225c1fd556c799cc1893fb27b0f48f00]
  linux-4.19.y: [3a17ca864baffc0c6f6e8aad525aa4365775a193]
  linux-4.19.y-cip: [3a17ca864baffc0c6f6e8aad525aa4365775a193]
  linux-4.19.y-cip-rt: [3a17ca864baffc0c6f6e8aad525aa4365775a193]
  linux-4.9.y: [3f0307b0d2d8b333a6964fc4c820dc86896fd1cf]
  mainline: [4e19d6b65fb4fc42e352ce9883649e049da14743]
fixed-by:
  linux-4.14.y: [11755d82e1adeb898976f3fb48ed6c8c67a9ed45]
  linux-4.19.y: [1e62ac6b1307129c0f9ca68e9db4227239b4ab19]
  linux-4.19.y-cip: [1e62ac6b1307129c0f9ca68e9db4227239b4ab19]
  linux-4.9.y: [dfcbd407f81e645601bccef8912af79b3d1ca87b]
  linux-5.4.y: [6cc4ccdd0b975f5f4c334fac71fee47e564472bf]
  mainline: [64d4ce892383b2ad6d782e080d25502f91bf2a38]
