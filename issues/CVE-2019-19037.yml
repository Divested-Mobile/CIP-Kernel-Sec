description: |-
  ext4_empty_dir in fs/ext4/namei.c in the Linux kernel through 5.3.12 allows
  a NULL pointer dereference because ext4_read_dirblock(inode,0,DIRENT_HTREE)
  can be zero.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19037
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19037
- https://lore.kernel.org/stable/20191127131258.1163-1-jack@suse.cz/
- https://lore.kernel.org/stable/20191202170213.4761-2-jack@suse.cz/
- https://lore.kernel.org/linux-ext4/20191202170213.4761-2-jack@suse.cz/
comments:
  bwh: |-
    The description is wrong.  ext4_read_dirblock() will not return a
    null pointer when the "type" parameter is DIRENT_HTREE but may do
    when it is EITHER.
  debian/carnil: |-
    commit fixes Fixes: 4e19d6b65fb4 ("ext4: allow directory
    holes") which is in 5.3-rc1 but was backported to various other
    stable trees in 5.2.4, 5.1.21, 4.19.62, 4.14.135 and 4.9.187
    already.
  ubuntu/tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
introduced-by:
  cip/4.19: [3a17ca864baffc0c6f6e8aad525aa4365775a193]
  cip/4.19-rt: [3a17ca864baffc0c6f6e8aad525aa4365775a193]
  mainline: [4e19d6b65fb4fc42e352ce9883649e049da14743]
  stable/4.14: [514631c2225c1fd556c799cc1893fb27b0f48f00]
  stable/4.19: [3a17ca864baffc0c6f6e8aad525aa4365775a193]
  stable/4.9: [3f0307b0d2d8b333a6964fc4c820dc86896fd1cf]
fixed-by:
  cip/4.19: [1e62ac6b1307129c0f9ca68e9db4227239b4ab19]
  cip/4.19-rt: [1e62ac6b1307129c0f9ca68e9db4227239b4ab19]
  debian/buster-security: ['version:debian/4.19.98-1']
  debian/stretch-security: ['version:debian/4.9.210-1']
  mainline: [64d4ce892383b2ad6d782e080d25502f91bf2a38]
  stable/4.14: [11755d82e1adeb898976f3fb48ed6c8c67a9ed45]
  stable/4.19: [1e62ac6b1307129c0f9ca68e9db4227239b4ab19]
  stable/4.9: [dfcbd407f81e645601bccef8912af79b3d1ca87b]
  stable/5.4: [6cc4ccdd0b975f5f4c334fac71fee47e564472bf]
