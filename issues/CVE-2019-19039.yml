description: |-
  __btrfs_free_extent in fs/btrfs/extent-tree.c in the Linux kernel through
  5.3.12 calls btrfs_print_leaf in a certain ENOENT case, which allows local
  users to obtain potentially sensitive information about register values via
  the dmesg program.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19039
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19039
- https://bugzilla.suse.com/show_bug.cgi?id=1157719
- https://usn.ubuntu.com/usn/usn-4414-1
- https://ubuntu.com/security/notices/USN-4414-1
- https://www.cve.org/CVERecord?id=CVE-2019-19039
comments:
  bwh: |-
    The actual issue seems to be that it's possible to trigger a
    WARN(), which logs a register dump.  That may reveal sensitive
    information if the kernel log is not restricted (or may result in
    a panic, hence denial-of-service).
  debian/bwh: |-
    The reporter describes this as an information leak because a WARN()
    causes register contents to be logged.  This is mitigated on stretch
    onward because we restrict access to the kernel log by default.
    However this can still be a denial-of-service if panic_on_warn is
    enabled.  Apparently fixed along with CVE-2019-19377.
  ubuntu/tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
fixed-by:
  cip/4.19: [1527c0e0229d2dd1c8ae1e73b1579bd8d5866b5b]
  cip/4.19-rt: [1527c0e0229d2dd1c8ae1e73b1579bd8d5866b5b]
  debian/buster-security: ['version:debian/4.19.160-1']
  mainline: [b3ff8f1d380e65dddd772542aa9bff6c86bf715a]
  stable/4.19: [1527c0e0229d2dd1c8ae1e73b1579bd8d5866b5b]
  stable/5.4: [941dabde6c1a56908696d6642229521a125dd77e]
  ubuntu/bionic: [72799690723a57c737655ffb8fa864180b11e103]
  ubuntu/eoan: [841df9e5a58603b43cba4d3ff401dd44ec27df6b]
  ubuntu/focal: [1fc074018f1a7302c4811174598a4f7c672d2129]
  ubuntu/groovy: ['version:5.4.0-42.46']
ignore:
  cip/4.4-rt: No member enables btrfs
  debian/jessie-security: EOL
  debian/stretch-security: EOL
tests:
- CVE-2019-19039
