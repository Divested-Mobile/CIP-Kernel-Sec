description: 'btrfs: crafted image causes use-after-free in rwsem_can_spin_on_owner'
references:
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19318
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19318
- https://bugzilla.suse.com/show_bug.cgi?id=1158026
- https://www.cve.org/CVERecord?id=CVE-2019-19318
comments:
  debian/bwh: |-
    I don't think so.  That commit did not introduce the dereference of
    the owner pointer, and the issue is also said to be reproducible on
    5.0.21 (which does not have a backport of it).
  debian/carnil: |-
    Introduced in 78134300579a ("locking/rwsem: Don't call
    owner_on_cpu() on read-owner") in 5.3-rc2?
  ubuntu/sbeattie: |-
    possibly fixed by btrfs tree checker, which would mean it's
      addressed for all kernels 4.4.x and newer.
  ubuntu/tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
introduced-by:
  mainline: [78134300579a45f527ca173ec8fdb4701b69f16e]
fixed-by:
  aosp/3.18: [3918c6d30c0ba4a690baf1504ceb0d4eac7ba1b7]
  cip/4.19: [cd823ab582225b2ce6eb37b9e22581a8d171a24a]
  cip/4.19-rt: [cd823ab582225b2ce6eb37b9e22581a8d171a24a]
  cip/4.4: [04d83a8dde6bb38a79db3049584d9b57a31b3f5c]
  cip/4.4-rt: [04d83a8dde6bb38a79db3049584d9b57a31b3f5c]
  cip/4.4-st: [04d83a8dde6bb38a79db3049584d9b57a31b3f5c]
  debian/buster-security: ['version:debian/4.19.146-1']
  debian/stretch-security: ['version:debian/4.9.258-1']
  mainline: [9f7fec0ba89108b9385f1b9fb167861224912a4a]
  openela/4.14: [c1528b789816efb09418ecf445555feeb4ea4816]
  stable/4.14: [c1528b789816efb09418ecf445555feeb4ea4816]
  stable/4.19: [cd823ab582225b2ce6eb37b9e22581a8d171a24a]
  stable/4.4: [04d83a8dde6bb38a79db3049584d9b57a31b3f5c]
  stable/4.9: [cb6874171820fe34f7d99c4a4353ee3abb1ecbd9]
  ubuntu/bionic: [6260315faae8651e66d542430e7a36c70fade84c]
  ubuntu/eoan: [1063d7fef9950533738ee1d6a1816de194f2f820]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/xenial: [1cc1d94527861adce834f1f80339a3b30e7bfb72]
ignore:
  debian/jessie-security: EOL
tests:
- CVE-2019-19318
