description: 'btrfs: crafted image causes use-after-free in rwsem_can_spin_on_owner'
references:
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19318
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19318
- https://bugzilla.suse.com/show_bug.cgi?id=1158026
comments:
  debian/bwh: |-
    I don't think so.  That commit did not introduce the dereference of
    the owner pointer, and the issue is also said to be reproducible on
    5.0.21 (which does not have a backport of it).
  debian/carnil: |-
    Introduced in 78134300579a ("locking/rwsem: Don't call
    owner_on_cpu() on read-owner") in 5.3-rc2?
  ubuntu/sbeattie: |-
    possibly fixed by btrfs tree checker, which would mean it's
      addressed for all kernels 4.4.x and newer.
  ubuntu/tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
introduced-by:
  mainline: [78134300579a45f527ca173ec8fdb4701b69f16e]
fixed-by:
  cip/4.19: [cd823ab582225b2ce6eb37b9e22581a8d171a24a]
  mainline: [9f7fec0ba89108b9385f1b9fb167861224912a4a]
  stable/4.19: [cd823ab582225b2ce6eb37b9e22581a8d171a24a]
  ubuntu/bionic: [6260315faae8651e66d542430e7a36c70fade84c]
  ubuntu/eoan: [1063d7fef9950533738ee1d6a1816de194f2f820]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  debian/jessie-security: EOL
