description: 'btrfs: crafted image causes use-after-free in rwsem_can_spin_on_owner'
references:
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19318
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19318
- https://bugzilla.suse.com/show_bug.cgi?id=1158026
comments:
  Debian-bwh: |-
    I don't think so.  That commit did not introduce the dereference of
    the owner pointer, and the issue is also said to be reproducible on
    5.0.21 (which does not have a backport of it).
  Debian-carnil: |-
    Introduced in 78134300579a ("locking/rwsem: Don't call
    owner_on_cpu() on read-owner") in 5.3-rc2?
  Ubuntu-sbeattie: |-
    possibly fixed by btrfs tree checker, which would mean it's
      addressed for all kernels 4.4.x and newer.
  Ubuntu-tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
introduced-by:
  mainline: [78134300579a45f527ca173ec8fdb4701b69f16e]
