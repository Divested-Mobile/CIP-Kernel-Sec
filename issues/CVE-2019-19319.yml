description: 'ext4: crafted image causes heap OOB write in ext4_xattr_set_entry'
references:
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19319
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19319
- https://bugzilla.suse.com/show_bug.cgi?id=1158021
comments:
  Debian-bwh: The fix is unknown but the PoC is reported to fail on 5.3.11 and 5.4.0.
  Debian-carnil: |-
    Introduced in dec214d00e0d ("ext4: xattr inode deduplication")
    in 4.13-rc1? Cf.
    https://bugzilla.suse.com/show_bug.cgi?id=1158021#c2
  Ubuntu-sbeattie: |-
    it's asserted by Jan Kara in the suse bug below that
     345c0dbf3a30 (plus related commits) addresses the issue
  Ubuntu-tyhicks: |-
    Exploiting this vulnerability requires a crafted filesystem image to
     be mounted
  wens: |-
    Besides 345c0dbf3a30 ("ext4: protect journal inode's blocks using
    block_validity"), additional fixes are required, as seen in a regression
    report [1] against the first backport of the patch. The additional ones
    seem to be the following, found with fixes tags.

      fbbbbd2f28ae ext4: unsigned int compared against zero
      170417c8c7bb ext4: fix block validity checks for journal inodes using indirect blocks
      0a944e8a6c66 ext4: don't perform block validity checks on the journal inode

    [1] https://lkml.org/lkml/2019/5/22/17
introduced-by:
  mainline: [dec214d00e0d78a08b947d7dccdfdb84407a9f4d]
fixed-by:
  linux-4.19.y: [2fd4629de51974002f4e9cf1a35a1926dd6c9d99, ff69322509bb3f48c4e08cc3bef7c414519a7862,
    292666d2d868f30a55f6d5f15c5a1a16a38a99c5, 97fbf573460e56ddf172614f70cdfa2af03b20ea]
  linux-4.19.y-cip: [2fd4629de51974002f4e9cf1a35a1926dd6c9d99, ff69322509bb3f48c4e08cc3bef7c414519a7862,
    292666d2d868f30a55f6d5f15c5a1a16a38a99c5, 97fbf573460e56ddf172614f70cdfa2af03b20ea]
  linux-4.19.y-cip-rt: [2fd4629de51974002f4e9cf1a35a1926dd6c9d99, ff69322509bb3f48c4e08cc3bef7c414519a7862,
    292666d2d868f30a55f6d5f15c5a1a16a38a99c5, 97fbf573460e56ddf172614f70cdfa2af03b20ea]
  mainline: [345c0dbf3a30872d9b204db96b5857cd00808cae, fbbbbd2f28aec991f3fbc248df211550fbdfd58c,
    170417c8c7bb2cbbdd949bf5c443c0c8f24a203b, 0a944e8a6c66ca04c7afbaa17e22bf208a8b37f0]
