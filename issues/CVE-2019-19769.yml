description: perf_trace_lock_acquire use-after-free
references:
- https://bugzilla.kernel.org/show_bug.cgi?id=205705
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19769
comments:
  Debian-carnil: |-
    Introduced in 5.0-rc1 with 16306a61d3b7 ("fs/locks: always
    delete_block after waiting.")
    Original commit 6d390e4b5d48 (locks: fix a potential use-after-
    free problem when wakeup a waiter) caused a performance impact,
    and needed a followup dcf23ac3e846 ("locks: reinstate
    locks_delete_block optimization") in 5.6-rc7.
  Ubuntu-sbeattie: |-
    first attempted fix was
      6d390e4b5d48ec03bb87e63cf0a2bff5f4e116da but that showed
      performance issues in synthetic benchmarks, more complex fix is
      dcf23ac3e846ca0cf626c155a0e3fcbbcf4fae8a
    may be introduced by
      16306a61d3b7c433c7a127ec6224867b88ece687
    no confirmation that the fixes listed actually address the
      reporter's issue
    the conservative fix for this issue may be to just apply
      6d390e4b5d48ec03bb87e63cf0a2bff5f4e116da
  wens: Second commit dcf23ac3e846ca0cf626c155a0e3fcbbcf4fae8a was from Linus addressing
    performance regressions from the first fix commit.
reporters:
- Tristan Madani
introduced-by:
  mainline: [16306a61d3b7c433c7a127ec6224867b88ece687]
fixed-by:
  linux-5.4.y: [384e15fc4226551a45b54226dc57bca7e23db9d8, f9f635c04769bae7014e2ff3f86f9c4f1d4d184c]
  linux-5.5.y: [5e62fb2c5d44e82ee7fae8c7fe946c7116489281, 6a42cea67491cedecaed7bfdf4e76ddce581f1fb]
  mainline: [6d390e4b5d48ec03bb87e63cf0a2bff5f4e116da, dcf23ac3e846ca0cf626c155a0e3fcbbcf4fae8a]
