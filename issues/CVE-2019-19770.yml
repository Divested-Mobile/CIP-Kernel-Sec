description: debugfs_remove use-after-free
references:
- https://bugzilla.kernel.org/show_bug.cgi?id=205713
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19770
- https://syzkaller.appspot.com/bug?extid=903b72a010ad6b7a40f2
- https://lore.kernel.org/lkml/20200206111052.45356-1-yukuai3@huawei.com/
- https://lore.kernel.org/linux-block/20200402000002.7442-1-mcgrof@kernel.org/
- https://lore.kernel.org/linux-block/20200419194529.4872-1-mcgrof@kernel.org/
- https://github.com/mcgrof/break-blktrace
- https://lore.kernel.org/linux-block/20200516031956.2605-1-mcgrof@kernel.org/
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1904471
- https://usn.ubuntu.com/usn/usn-4680-1
- https://ubuntu.com/security/notices/USN-4680-1
- https://www.cve.org/CVERecord?id=CVE-2019-19770
comments:
  debian/bwh: |-
    Note that only root can access debugfs by default.
    Introduced in 4.11-rc1 by commit 6ac93117ab00 "blktrace: use existing
    disk debugfs directory".
  debian/carnil: Commit landed in 5.7.16, 5.8.2 as well.
  ubuntu: |-
    sbeattie| no fix from upstream as of 2020/04/22, though proposed
      patches are working their way through the review process.
  ubuntu/sbeattie: |-
    reproducer in github link
    according to kernel maintainer, needed commits are:
     (1b0b28364816) blktrace: break out of blktrace setup on concurrent calls
     (c3dbe541ef77) blktrace: Avoid sparse warnings when assigning q->blk_trace
     (a67549c8e568) blktrace: annotate required lock on do_blk_trace_setup()
     (bad8e64fb19d) blktrace: fix debugfs use after free
     (b431ef837e33) blktrace: ensure our debugfs dir exists
introduced-by:
  mainline: [6ac93117ab009d3901ed5d3d0f79056eb5fc0afd]
fixed-by:
  cip/4.19: [8a78b4c0d6292d32d76b4268b5a33ae089a5d791]
  cip/4.19-rt: [8a78b4c0d6292d32d76b4268b5a33ae089a5d791]
  debian/buster-security: ['version:debian/4.19.160-1']
  mainline: [bad8e64fb19d3a0de5e564d9a7271c31bd684369]
  stable/4.14: [8268f88785ca9476c68da06d1f93c3d0d9747d28]
  stable/4.19: [8a78b4c0d6292d32d76b4268b5a33ae089a5d791]
  stable/5.4: [6a291f9c21e4acf3429aacfa2e019d9965806c51]
  stable/5.7: [4470c2949a07883cda4de6899ce8507b0fc6aa5d]
  stable/5.8: [00734ff000fc72cb48a1aec214f024824f8b7419]
  ubuntu/bionic: [77c891bd34321d1e9bcb32a4739ce83913c03824]
  ubuntu/focal: [8c16d61c8688ec3cf5ca9f87b6fca9ef1957d2b8]
  ubuntu/groovy: [126bae2bbcc431e34d6ef9c209d4a3449e18354a]
ignore:
  debian/jessie-security: EOL
