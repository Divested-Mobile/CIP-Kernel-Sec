description: |-
  In the Linux kernel before 5.3.11, sound/core/timer.c has a use-after-free
  caused by erroneous code refactoring, aka CID-e7af6307a8a5. This is related
  to snd_timer_open and snd_timer_close_locked. The timeri variable was
  originally intended to be for a newly created timer instance, but was used
  for a different purpose after refactoring.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19807
- https://git.kernel.org/linus/e7af6307a8a54f0b873960b32b6a644f2d0fbd97
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.3.11
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=e7af6307a8a54f0b873960b32b6a644f2d0fbd97
- https://github.com/torvalds/linux/commit/e7af6307a8a54f0b873960b32b6a644f2d0fbd97
- https://usn.ubuntu.com/usn/usn-4225-1
- https://usn.ubuntu.com/usn/usn-4227-1
- https://usn.ubuntu.com/usn/usn-4227-2
comments:
  debian/carnil: |-
    Intoduced in 41672c0c24a6 ("ALSA: timer: Simplify error path in
    snd_timer_open()") in 5.2-rc1 which was backported to various
    stable series, namely 4.19.82, 4.14.152 and 4.9.199.
reporters:
- Tristan Madani
introduced-by:
  linux-3.16.y: [3e16d31a94e3224ec2d9079bacc93d7eeb6f3164]
  linux-4.14.y: [b617db2ebf29bc60768df01a831d79582630ee8a]
  linux-4.19.y: [145fadf6d99a91ad41fd0a6e9357afec827a046f]
  linux-4.19.y-cip: [145fadf6d99a91ad41fd0a6e9357afec827a046f]
  linux-4.19.y-cip-rt: [145fadf6d99a91ad41fd0a6e9357afec827a046f]
  linux-4.9.y: [681789d5d92f24fc3bd2c3d47053b674de311fad]
  mainline: [41672c0c24a62699d20aab53b98d843b16483053]
fixed-by:
  linux-3.16.y: [7e625ef1b008551a72e6d579ca272d6cd162e672]
  linux-4.14.y: [f536bdb834c0c54743721e7e5000d0006671b848]
  linux-4.19.y: [b85472244b7051538047ddd32ae0a897928df35b]
  linux-4.19.y-cip: [b85472244b7051538047ddd32ae0a897928df35b]
  linux-4.19.y-cip-rt: [b85472244b7051538047ddd32ae0a897928df35b]
  linux-4.9.y: [8bdaac0c926f7dc65a60ef756740ef2353e4f54f]
  mainline: [e7af6307a8a54f0b873960b32b6a644f2d0fbd97]
