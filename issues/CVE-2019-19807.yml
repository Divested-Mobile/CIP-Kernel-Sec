description: |-
  In the Linux kernel before 5.3.11, sound/core/timer.c has a use-after-free
  caused by erroneous code refactoring, aka CID-e7af6307a8a5. This is related
  to snd_timer_open and snd_timer_close_locked. The timeri variable was
  originally intended to be for a newly created timer instance, but was used
  for a different purpose after refactoring.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19807
- https://git.kernel.org/linus/e7af6307a8a54f0b873960b32b6a644f2d0fbd97
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.3.11
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=e7af6307a8a54f0b873960b32b6a644f2d0fbd97
- https://github.com/torvalds/linux/commit/e7af6307a8a54f0b873960b32b6a644f2d0fbd97
- https://usn.ubuntu.com/usn/usn-4225-1
- https://usn.ubuntu.com/usn/usn-4227-1
- https://usn.ubuntu.com/usn/usn-4227-2
comments:
  debian/carnil: |-
    Intoduced in 41672c0c24a6 ("ALSA: timer: Simplify error path in
    snd_timer_open()") in 5.2-rc1 which was backported to various
    stable series, namely 4.19.82, 4.14.152 and 4.9.199.
reporters:
- Tristan Madani
introduced-by:
  cip/4.19: [145fadf6d99a91ad41fd0a6e9357afec827a046f]
  cip/4.19-rt: [145fadf6d99a91ad41fd0a6e9357afec827a046f]
  mainline: [41672c0c24a62699d20aab53b98d843b16483053]
  stable/3.16: [3e16d31a94e3224ec2d9079bacc93d7eeb6f3164]
  stable/4.14: [b617db2ebf29bc60768df01a831d79582630ee8a]
  stable/4.19: [145fadf6d99a91ad41fd0a6e9357afec827a046f]
  stable/4.9: [681789d5d92f24fc3bd2c3d47053b674de311fad]
  ubuntu/bionic: [2ec7970c73b4d171f17ac70b1f371bcba0043c27]
fixed-by:
  cip/4.19: [b85472244b7051538047ddd32ae0a897928df35b]
  cip/4.19-rt: [b85472244b7051538047ddd32ae0a897928df35b]
  mainline: [e7af6307a8a54f0b873960b32b6a644f2d0fbd97]
  stable/3.16: [7e625ef1b008551a72e6d579ca272d6cd162e672]
  stable/4.14: [f536bdb834c0c54743721e7e5000d0006671b848]
  stable/4.19: [b85472244b7051538047ddd32ae0a897928df35b]
  stable/4.9: [8bdaac0c926f7dc65a60ef756740ef2353e4f54f]
  ubuntu/bionic: [021de0993207fd4f28e7088f1a831bb9cb6c6358]
  ubuntu/eoan: [a03ae53d52338c0030a55786ba9c8f52602b5d97]
