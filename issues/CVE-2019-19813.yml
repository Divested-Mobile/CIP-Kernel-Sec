description: In the Linux kernel 5.0.21, mounting a crafted btrfs filesystem image,
  performing some operations, and then making a syncfs system call can lead to a use-after-free
  in __mutex_lock in kernel/locking/mutex.c. This is related to mutex_can_spin_on_owner
  in kernel/locking/mutex.c, __btrfs_qgroup_free_meta in fs/btrfs/qgroup.c, and btrfs_insert_delayed_items
  in fs/btrfs/delayed-inode.c.
references:
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19813
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19813
- https://nvd.nist.gov/vuln/detail/CVE-2019-19813
- https://bugzilla.suse.com/show_bug.cgi?id=1159435
- https://usn.ubuntu.com/usn/usn-4414-1
comments:
  debian/bwh: Apparently fixed along with CVE-2019-19816.
  ubuntu/sbeattie: |-
    upstream developer asserts in suse bug that the enhanced
       btrfs tree-checker addresses this issue, which was backported to at
       least the 4.4 kernel.
  ubuntu/tyhicks: As of 2020-01-09, no upstream fix is available
  wens: Exploiting this vulnerability requires a crafted filesystem image to be mounted
reporters:
- bobfuzzer
fixed-by:
  cip/4.19: [4e986ab36ed11ecf21de9b5aab0e46ac3342df93]
  cip/4.19-rt: [4e986ab36ed11ecf21de9b5aab0e46ac3342df93]
  debian/buster-security: ['version:debian/4.19.146-1']
  mainline: [6bf9e4bd6a277840d3fe8c5d5d530a1fbd3db592]
  stable/4.14: [3b68f5961224b7948004fd8a8e185867ecab7974]
  stable/4.19: [4e986ab36ed11ecf21de9b5aab0e46ac3342df93]
  stable/4.4: [d4d0b4f942fed5d5b69effe200c1df6108483385]
  stable/4.9: [a93a374efd8e0c01abaec21fc808b1cb7fad0b49]
  ubuntu/bionic: [9e97d9faa5fb3f89854182aa1e755ee55cf6289d]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
ignore:
  debian/jessie-security: EOL
tests:
- CVE-2019-19813
