description: In the Linux kernel 5.0.21, mounting a crafted btrfs filesystem image
  and performing some operations can cause slab-out-of-bounds write access in __btrfs_map_block
  in fs/btrfs/volumes.c, because a value of 1 for the number of data stripes is mishandled.
references:
- https://github.com/bobfuzzer/CVE/tree/master/CVE-2019-19816
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-19816
- https://nvd.nist.gov/vuln/detail/CVE-2019-19816
- https://bugzilla.suse.com/show_bug.cgi?id=1159439
- https://usn.ubuntu.com/usn/usn-4414-1
- https://usn.ubuntu.com/usn/usn-4709-1
- https://usn.ubuntu.com/usn/usn-4708-1
- https://ubuntu.com/security/notices/USN-4414-1
- https://ubuntu.com/security/notices/USN-4709-1
- https://ubuntu.com/security/notices/USN-4708-1
- https://www.cve.org/CVERecord?id=CVE-2019-19816
comments:
  debian/bwh: Apparently fixed along with CVE-2019-19813.
  ubuntu/sbeattie: |-
    upstream developer asserts in suse bug that the enhanced
      btrfs tree-checker will address this issue, so would be fixed in
      4.4.x and newer
  ubuntu/tyhicks: As of 2020-01-09, no upstream fix is available
  wens: Exploiting this vulnerability requires a crafted filesystem image to be mounted
reporters:
- bobfuzzer
fixed-by:
  cip/4.19: [bedd9974c106fe96b518da667d49b0bfe6353590]
  cip/4.19-rt: [bedd9974c106fe96b518da667d49b0bfe6353590]
  cip/4.4: [fd915013950f0a8db0dac011fcd79d68ec651d7e]
  cip/4.4-rt: [fd915013950f0a8db0dac011fcd79d68ec651d7e]
  cip/4.4-st: [fd915013950f0a8db0dac011fcd79d68ec651d7e]
  debian/buster-security: ['version:debian/4.19.160-1']
  debian/stretch-security: ['version:debian/4.9.258-1']
  mainline: [80e46cf22ba0bcb57b39c7c3b52961ab3a0fd5f2]
  openela/4.14: [598ddb024d0a951a172aa0deeaa3235fdbbd8b2b]
  stable/4.14: [598ddb024d0a951a172aa0deeaa3235fdbbd8b2b]
  stable/4.19: [bedd9974c106fe96b518da667d49b0bfe6353590]
  stable/4.4: [fd915013950f0a8db0dac011fcd79d68ec651d7e]
  stable/4.9: [bd1ea5f04bca1a2b3a99ade001fb0db0d308a487]
  ubuntu/bionic: [6510d3e5bdd47624b0b8677d057d127ec04b152b, 1e6bb3df83cc6328bf728603ddf17045a5690b68,
    5afcb50b58e874b0fc8732598cb97e0d719824f8, be0171e60cea15db51772f1ab50eda360f658f89,
    019eda06bf94571c7762bc0f7c23a887a2c34527, 47e5d56ae285603bc8253f097dbffd58c73485ff,
    636a9aab8f1ad6b71c9552f67db647ddd3bbe491, 3fa928444ec11674793093482c3d8daad7065466,
    613d04b6e3c18abc4c779fc31ecaf12a7012610a]
  ubuntu/focal: never
  ubuntu/groovy: ['version:5.4.0-26.30']
  ubuntu/xenial: [3aad965c2d4c88b4a35f8b36989682d616742160]
ignore:
  debian/jessie-security: EOL
tests:
- CVE-2019-19816
