description: 'efi: Restrict efivar_ssdt_load when the kernel is locked down'
references:
- https://git.zx2c4.com/american-unsigned-language/tree/american-unsigned-language.sh
- https://www.openwall.com/lists/oss-security/2020/06/14/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20908
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.4
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1957a85b0032a81e6482ca4aab883643b8dae06e
- https://mailarchives.bentasker.co.uk/Mirrors/OSSSec/2020/06-Jun/msg00035.html
- https://usn.ubuntu.com/usn/usn-4426-1
- https://usn.ubuntu.com/usn/usn-4427-1
- https://usn.ubuntu.com/usn/usn-4439-1
- https://usn.ubuntu.com/usn/usn-4440-1
- https://www.openwall.com/lists/oss-security/2020/07/30/2
- https://ubuntu.com/security/notices/USN-4426-1
- https://ubuntu.com/security/notices/USN-4427-1
- https://ubuntu.com/security/notices/USN-4439-1
- https://ubuntu.com/security/notices/USN-4440-1
- https://www.cve.org/CVERecord?id=CVE-2019-20908
comments:
  wens: |-
    efivar_ssdr_load introduced in v4.8-rc1. Kernel lockdown introduced
    in v5.4-rc1, same time as the fix. efivar_ssdt_load was split out
    into a separate CUSTOM_SSDT_OVERLAYS Kconfig option in v5.5-rc1.
reporters:
- Jason A. Donenfeld
introduced-by:
  mainline: never
fixed-by:
  debian/buster-security: ['patch:debian/4.19.132-1:features/all/lockdown/0032-efi-Restrict-efivar_ssdt_load-when-the-kernel-is-loc.patch']
  mainline: [1957a85b0032a81e6482ca4aab883643b8dae06e]
  ubuntu/bionic: [9b8794a58283a80699e5afb71d1e0832b0b8f8c9]
  ubuntu/eoan: [f1d84855bf6278428f7719cc89be848163297e2f]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
  ubuntu/xenial: ['version:4.4.0-186.216']
ignore:
  debian/stretch-security: securelevel included but not supported
