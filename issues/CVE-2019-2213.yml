description: 'binder: fix possible UAF when freeing buffer'
references:
- https://lore.kernel.org/patchwork/patch/1087916/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2213
- https://www.cve.org/CVERecord?id=CVE-2019-2213
comments:
  debian/bwh: |-
    For branches older than 4.20, the second hunk should be applied
    to binder_thread_write() instead of binder_free_buf().
    For branches older than 4.14, the first hunk should be applied to
    binder_pop_transaction() instead of binder_free_transaction().
    It's not clear how the locking should be done for branches older
    than 4.14 though.
introduced-by:
  mainline: [457b9a6f09f011ebcb9b52cc203a6331a6fc2de7]
fixed-by:
  aosp/3.18: [3f2494ff5ad4f755d698ed6fa91c7b24c4a7c6de]
  cip/4.19: [22068d49d09d2b3890e19d7b2048a33340f992da]
  cip/4.19-rt: [22068d49d09d2b3890e19d7b2048a33340f992da]
  debian/buster-security: ['version:debian/4.19.67-1']
  mainline: [a370003cc301d4361bae20c9ef615f89bf8d1e8a]
  openela/4.14: [a4a3c070b8760f71c8311399fa9bfe67c8629bca]
  stable/4.14: [a4a3c070b8760f71c8311399fa9bfe67c8629bca]
  stable/4.19: [22068d49d09d2b3890e19d7b2048a33340f992da]
  ubuntu/bionic: [0224f2e05af6b9ffc4beda4cbe01a320fe8c0500]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-9.12']
ignore:
  cip/4.4: No member enables binder
  cip/4.4-rt: No member enables binder
  cip/4.4-st: No member enables binder
  debian/jessie-security: Android drivers not supported
  debian/stretch-security: EOL
  stable/3.16: not used in Android
  stable/4.4: |-
    Fixed in Android 4.4 branches, but would need too many
    changes for stable
  stable/4.9: |-
    Fixed in Android 4.9 branches, but would need too many
    changes for stable
