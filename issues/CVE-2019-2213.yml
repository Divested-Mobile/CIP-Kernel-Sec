description: 'binder: fix possible UAF when freeing buffer'
references:
- https://lore.kernel.org/patchwork/patch/1087916/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2213
comments:
  debian/bwh: |-
    For branches older than 4.20, the second hunk should be applied
    to binder_thread_write() instead of binder_free_buf().
    For branches older than 4.14, the first hunk should be applied to
    binder_pop_transaction() instead of binder_free_transaction().
    It's not clear how the locking should be done for branches older
    than 4.14 though.
introduced-by:
  mainline: [457b9a6f09f011ebcb9b52cc203a6331a6fc2de7]
fixed-by:
  cip/4.19: [22068d49d09d2b3890e19d7b2048a33340f992da]
  cip/4.19-rt: [22068d49d09d2b3890e19d7b2048a33340f992da]
  mainline: [a370003cc301d4361bae20c9ef615f89bf8d1e8a]
  stable/4.14: [a4a3c070b8760f71c8311399fa9bfe67c8629bca]
  stable/4.19: [22068d49d09d2b3890e19d7b2048a33340f992da]
ignore:
  cip/4.4: No member enables binder
  cip/4.4-rt: No member enables binder
  stable/3.16: not used in Android
  stable/4.4: |-
    Fixed in Android 4.4 branches, but would need too many
    changes for stable
  stable/4.9: |-
    Fixed in Android 4.9 branches, but would need too many
    changes for stable
