description: information leak within a KVM guest
references:
- https://www.openwall.com/lists/oss-security/2020/01/30/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3016
- https://usn.ubuntu.com/usn/usn-4300-1
- https://usn.ubuntu.com/usn/usn-4301-1
- https://usn.ubuntu.com/lsn/0065-1/
- https://ubuntu.com/security/notices/USN-4300-1
- https://ubuntu.com/security/notices/USN-4301-1
- https://www.cve.org/CVERecord?id=CVE-2019-3016
comments:
  debian/bwh: |-
    I think it was introduced by 858a43aae236 ("KVM: X86: use
    paravirtualized TLB Shootdown", as that introduced the second
    flag in kvm_steal_time::preempted which is being cleared.
    I believe the additional fixes *are* needed for 4.19.
  debian/carnil: |-
    Issue present since 0b9f6c4615c99 ("x86/kvm: Support the vCPU
    preemption check") in 4.10-rc1. But might need double-check.
    Fixed as well in 5.4.19. For 4.19.103 only one commit was
    backported, is this already sufficient?
    The additional commits were added for 4.19.x in 4.19.119.
  ubuntu/cascardo: |-
    It is thought that issue does not affect Intel processors
     *not* supporting Process-Context Identifiers (PCIDs). You can check
     support for PCIDs on systems with Intel processors by running "grep pcid
     /proc/cpuinfo" and verifying that "pcid" shows as one of the flags.
    it was mentioned that it was only easily reproducible on AMD
     CPUs.
  ubuntu/tyhicks: |-
    This issue does not affect default installations of Ubuntu as the
     paravirtual TLB flush feature in KVM is not enabled by default. The QEMU CPU
     feature "kvm-pv-tlb-flush" is used to enable paravirtual TLB flush.
introduced-by:
  mainline: [858a43aae23672d46fe802a41f4748f322965182]
fixed-by:
  cip/4.19: [25a7898937f4a9f32ca2d1e9b7f5f07176af8037, e36d68ec5090599058650152547d4a58ef3d79a0,
    ccfc73e56da7c8e68ab6a543c5b8cd0b83c9e9bb, b5b79c757e6f22f17d8ddf2979abb7bf231bb327,
    c434092ef8172ed027f2bd9afcd42c0ee5002b85]
  cip/4.19-rt: [25a7898937f4a9f32ca2d1e9b7f5f07176af8037, e36d68ec5090599058650152547d4a58ef3d79a0,
    ccfc73e56da7c8e68ab6a543c5b8cd0b83c9e9bb, b5b79c757e6f22f17d8ddf2979abb7bf231bb327,
    c434092ef8172ed027f2bd9afcd42c0ee5002b85]
  debian/buster-security: ['patch:debian/4.19.118-2+deb10u1:bugfix/x86/x86-kvm-Introduce-kvm_-un-map_gfn.patch',
    'patch:debian/4.19.118-2+deb10u1:bugfix/x86/x86-kvm-Cache-gfn-to-pfn-translation.patch',
    'patch:debian/4.19.118-2+deb10u1:bugfix/x86/x86-KVM-Make-sure-KVM_VCPU_FLUSH_TLB-flag-is-not-mis.patch',
    'patch:debian/4.19.118-2+deb10u1:bugfix/x86/x86-KVM-Clean-up-host-s-steal-time-structure.patch']
  mainline: [8c6de56a42e0c657955e12b882a81ef07d1d073e, 1eff70a9abd46f175defafd29bc17ad456f398a7,
    917248144db5d7320655dbb41d3af0b8a0f3d589, b043138246a41064527cf019a3d51d9f015e9796,
    a6bd811f1209fe1c64c9f6fd578101d6436c6b6e]
  stable/4.19: [25a7898937f4a9f32ca2d1e9b7f5f07176af8037, e36d68ec5090599058650152547d4a58ef3d79a0,
    ccfc73e56da7c8e68ab6a543c5b8cd0b83c9e9bb, b5b79c757e6f22f17d8ddf2979abb7bf231bb327,
    c434092ef8172ed027f2bd9afcd42c0ee5002b85]
  stable/5.4: [68460ceba319a46ea14b36129bfd0a152e0f00c3, a3db2949904b81ae53a840d99f71021f02a01fd3,
    f7c1a6c67ff36532f1b0b339e3aae7701a2c0b1e, d71eef9fcc0b81fd56e59afd305a215d81239894,
    2aebc6ed84efeb1e255fd6417f9230388f2206cd]
  stable/5.5: [06b34107899d1b004462c9d2e52ff5a146ee9898, f6ad4449ddeffec8bf492ad495c2fc4e45ff2d42,
    072690664a42b688b4a7620b9ad97add92918fbb, 91fefc3e32294f16099d768a51492e56399dcb54,
    43ba65a5394cd4e153cca878a9e0d475ba62b7e3]
  ubuntu/eoan: [518534f7c29be5e1715050f610b56cfb46ef62e0, ea3db8d0ccde809fe9556be2184084bc1a0f4888,
    e29b06c2c996bc240afa1bdf4e2079d7fd551aa0, 8bed6123885a5855cce39fff47f32d1bc2591cc0,
    6cceff4db129fc054b929e26900886d713325ff1]
  ubuntu/focal: [8d38194d24f212eff378356357890132592e2d4f, 3490a3c32bdd2f5919609be846aee9c70e37e5f0,
    7cf07ad4f5a037e181c294e8c850cf8e66ec1e69, 015fe89b036e180c51aa0c58fcba6391c2bf89dd,
    c6207391ecf28d21e6176170b2fd631ea79c8e35]
