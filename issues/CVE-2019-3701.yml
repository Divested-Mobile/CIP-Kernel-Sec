description: |-
  An issue was discovered in can_can_gw_rcv in net/can/gw.c in the Linux
  kernel through 4.19.13. The CAN frame modification rules allow bitwise
  logical operations that can be also applied to the can_dlc field. Because
  of a missing check, the CAN drivers may write arbitrary content beyond the
  data registers in the CAN controller's I/O memory when processing can-gw
  manipulated outgoing frames. This is related to cgw_csum_xor_rel. A
  privileged user can trigger a system crash (general protection fault).
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3701
- https://marc.info/?l=linux-netdev&m=154659326324991&w=2
- https://bugzilla.suse.com/show_bug.cgi?id=1120386
- https://marc.info/?l=linux-netdev&m=154651842302479&w=2
- https://marc.info/?l=linux-can&m=154659326224990&w=2
- https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/net/can?id=0aaa81377c5a01f686bcdb8c7a6929a7bf330c68
- https://usn.ubuntu.com/usn/usn-3932-1
- https://usn.ubuntu.com/usn/usn-3932-2
- https://usn.ubuntu.com/usn/usn-4115-1
- https://usn.ubuntu.com/usn/usn-4118-1
- https://ubuntu.com/security/notices/USN-3932-1
- https://ubuntu.com/security/notices/USN-3932-2
- https://ubuntu.com/security/notices/USN-4115-1
- https://ubuntu.com/security/notices/USN-4118-1
- https://www.cve.org/CVERecord?id=CVE-2019-3701
comments:
  debian/carnil: |-
    unprivileged user namespaces might be needed to exploit the bug,
    but needs to be checked.
  ubuntu/tyhicks: |-
    The original CVE description that states that an unprivileged user
     can trigger a system crash is incorrect. Only the root user, from the init
     namespace, can trigger the system crash. Therefore, we'll prioritize this
     issue as negligible.
reporters:
- Muyu Yu
- Marcus Meissner
introduced-by:
  mainline: [c1aabdf379bc2feeb0df7057ed5bad96f492133e]
fixed-by:
  aosp/3.18: [4c3b21c842deb09721015a8463087e3c262be385]
  cip/4.19: [8db82a6f2b76d42ec2615f8def6e797e064e7822]
  cip/4.19-rt: [8db82a6f2b76d42ec2615f8def6e797e064e7822]
  cip/4.4: [693ae291197429f404e7d9c191e1541f61925278]
  cip/4.4-rt: [693ae291197429f404e7d9c191e1541f61925278]
  cip/4.4-st: [693ae291197429f404e7d9c191e1541f61925278]
  debian/buster-security: ['version:debian/4.19.20-1']
  debian/jessie-security: ['version:debian/3.16.64-1']
  debian/stretch-security: ['version:debian/4.9.161-1']
  mainline: [0aaa81377c5a01f686bcdb8c7a6929a7bf330c68]
  stable/3.16: [1c7dcfd106f42f09e3b7520c26e6eee70a939928]
  stable/3.18: [4c3b21c842deb09721015a8463087e3c262be385]
  stable/4.14: [39ff087b5c6be2ff0b08e617d334e5bf72a08b44]
  stable/4.19: [8db82a6f2b76d42ec2615f8def6e797e064e7822]
  stable/4.20: [a4aba230bb0c702fee6acd6d812828766ed14ef1]
  stable/4.4: [693ae291197429f404e7d9c191e1541f61925278]
  stable/4.9: [d379b338387e3d5a9b5ebe5ab16656a9c65c988d]
  ubuntu/bionic: [357dfeb112882f16d6884bba2aa75b39e4f316ec]
  ubuntu/eoan: ['version:5.0.0-13.14']
  ubuntu/xenial: [68fa70982b082715a76495bb7ff9065a73677e7a]
ignore:
  all: |-
    Only the global root user can trigger this bug and the result is a
    crash. This doesn't seem to have a security impact.
