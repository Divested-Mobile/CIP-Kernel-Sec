description: SCTP socket unbounded memory usage leading to denial of service
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1686373
- https://discuss.kubernetes.io/t/kubernetes-security-announcement-linux-kernel-memory-cgroups-escape-via-sctp-cve-2019-3874/5594
- https://lore.kernel.org/netdev/20190401113110.GA20717@hmswarspite.think-freely.org/T/#u
- https://lore.kernel.org/netdev/cover.1554022192.git.lucien.xin@gmail.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3874
- https://git.kernel.org/pub/scm/linux/kernel/git/davem/net-next.git/commit/?id=1033990ac5b2ab6cee93734cb6d301aa3a35bcaa
- https://git.kernel.org/pub/scm/linux/kernel/git/davem/net-next.git/commit/?id=9dde27de3e5efa0d032f3c891a0ca833a0d31911
- https://usn.ubuntu.com/usn/usn-3979-1
- https://usn.ubuntu.com/usn/usn-3980-1
- https://usn.ubuntu.com/usn/usn-3981-1
- https://usn.ubuntu.com/usn/usn-3982-1
- https://usn.ubuntu.com/usn/usn-3982-2
- https://usn.ubuntu.com/usn/usn-3980-2
- https://usn.ubuntu.com/usn/usn-3981-2
comments:
  debian/bwh: |-
    Based on the proposed fixes, I don't believe there is a memory
    leak.  The issue is that the cgroup memory controller's kmem
    limits didn't affect SCTP sockets.  Since it is already usual to
    restrict the socket types allowed in a container, I don't consider
    this an important issue.
  debian/carnil: Only first commit backported to 4.19.137, the second is missing.
  ubuntu/tyhicks: |-
    As of 2019-04-01, a patch series that addresses this issue has been
     submitted for upstream review but it has not yet been ACK'ed or merged.
    As of 2019-04-09, the patch series is still in the same state.
reporters:
- Matteo Croce
- Natale Vinto
- Andrea Spagnolo
fixed-by:
  mainline: [1033990ac5b2ab6cee93734cb6d301aa3a35bcaa, 9dde27de3e5efa0d032f3c891a0ca833a0d31911]
  stable/4.19: [9a84bb13816fe3b361a75e10ee9821ab68aa36f5]
  ubuntu/bionic: [45d428a245a3a7e8b18a71be06acdca04d640679, 57c14eea38521b8e0428a7ffa6a1b101e772852e,
    1bc9dafa1b04f9b4054826f92852d466d19fcab3]
  ubuntu/xenial: [ce21ac1f673de3f0147cdcb4e290c8bd27d0cd15, 7da95efa7342ff3d8f732cb25b85b55e5fc6a75a,
    0857f0fcc58786b90248fc15cc2b4437f4a66457, 642dd4d3dcf76036030f0fbf0d19f4604fbc795e]
ignore:
  all: Minor issue
