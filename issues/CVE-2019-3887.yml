description: 'KVM: x86: nVMX: close leak of L0''s x2APIC MSR'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-3887
- https://www.openwall.com/lists/oss-security/2019/04/08/1
- https://usn.ubuntu.com/usn/usn-3979-1
- https://usn.ubuntu.com/usn/usn-3980-1
- https://usn.ubuntu.com/usn/usn-3980-2
- https://ubuntu.com/security/notices/USN-3979-1
- https://ubuntu.com/security/notices/USN-3980-1
- https://ubuntu.com/security/notices/USN-3980-2
- https://www.cve.org/CVERecord?id=CVE-2019-3887
comments:
  debian/carnil: Likely introduced during a merge in 15303ba5d1cd, 4.16-rc1.
  ubuntu/sbeattie: |-
    MITIGATION: if qemu is installed, to prevent nested
      virtualization from being enabled, set "options kvm_intel nested=0"
      in /etc/modprobe.d/qemu-system-x86.conf
  ubuntu/tyhicks: |-
    Ubuntu kernels do not enable nested KVM virtualization by default and
     are unaffected by this flaw in the default configuration. However, installing
     QEMU results in nested KVM support to be enabled via the
     /etc/modprobe.d/qemu-system-x86.conf file. To ensure that nested
     virtualization is not enabled, verify that the
     /sys/module/kvm_intel/parameters/nested file contains "N".
reporters:
- Marc Orr
introduced-by:
  mainline: [15303ba5d1cd9b28d03a980456c0978c0ea3b208]
fixed-by:
  cip/4.19: [119031be7b0a2ce4ff4cd5525bec6d42817ff53d, 59bf185ae6b7d1a7ec2d7ff312b94df787ebcb11]
  cip/4.19-rt: [119031be7b0a2ce4ff4cd5525bec6d42817ff53d, 59bf185ae6b7d1a7ec2d7ff312b94df787ebcb11]
  debian/buster-security: ['version:debian/4.19.37-1']
  mainline: [acff78477b9b4f26ecdf65733a4ed77fe837e9dc, c73f4c998e1fd4249b9edfa39e23f4fda2b9b041]
  stable/4.19: [119031be7b0a2ce4ff4cd5525bec6d42817ff53d, 59bf185ae6b7d1a7ec2d7ff312b94df787ebcb11]
  stable/5.0: [b564364f22ac56f8be0ed7367fbebbe9df6d1569, 7af79a36d1881bdf54284c1a87318d772ebe6636]
