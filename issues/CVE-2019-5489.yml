description: |-
  The mincore() implementation in mm/mincore.c in the Linux kernel through
  4.19.13 allowed local attackers to observe page cache access patterns of
  other processes on the same system, potentially allowing sniffing of secret
  information. (Fixing this affects the output of the fincore program.)
  Limited remote exploitation may be possible, as demonstrated by latency
  differences in accessing public files from an Apache HTTP Server.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-5489
- https://www.openwall.com/lists/oss-security/2019/01/07/2
- https://arxiv.org/pdf/1901.01161.pdf
- https://www.openwall.com/lists/oss-security/2019/01/07/1
- https://www.theregister.co.uk/2019/01/05/boffins_beat_page_cache/
- https://arxiv.org/abs/1901.01161
- https://bugzilla.suse.com/show_bug.cgi?id=1120843
- https://twitter.com/lavados/status/1081205802046607361
- https://lore.kernel.org/lkml/CAHk-=wiqbKEC5jUXr3ax+oUuiRrp=QMv_ZnUfO-SPv=UNJ-OTw@mail.gmail.com/T/#mf09fc35229f38e5b657f299a3a3865c8ca39e7e1
- https://lore.kernel.org/lkml/CAHk-=wiqbKEC5jUXr3ax+oUuiRrp=QMv_ZnUfO-SPv=UNJ-OTw@mail.gmail.com/
- https://lore.kernel.org/lkml/CAHk-=wg+C65FJHB=Jx1OvuJP4kvpWdw+5G=XOXB6X_KB2XuofA@mail.gmail.com/#t
- https://lore.kernel.org/lkml/nycvar.YFH.7.76.1901272335040.6626@cbobk.fhfr.pm/
comments:
  debian/carnil: |-
    574823bfab82d9d8fa47f422778043fbb4b4f50e was marked explicitly
    not yet for stable as it is expected to check if there are issues
    with this approach. There are enough tools which depend on mincore()
    to try to tell wheter a file is loaded in cache or not.
    574823bfab82d9d8fa47f422778043fbb4b4f50e was reverted in
    30bac164aca750892b93eef350439a0562a68647 again to open way for an
    alternative approach of solving the original information leak issue.
    Further approach https://lore.kernel.org/lkml/20190130124420.1834-1-vbabka@suse.cz/
    Upstream 134fca9063ad ("mm/mincore.c: make mincore() more
    conservative") relates to this.
  ubuntu/sbeattie: |-
    v1 fix was reverted. v2 of fix is now
     134fca9063ad4851de767d1768180e5dede9a881
  ubuntu/tyhicks: |-
    On 2018-01-06, a potential fix for this issue was committed in the
     upstream kernel git tree. The potential fix changes the behavior of the
     mincore(2) system call in ways that could possibly break userspace
     applications. The potential fix landed during the kernel's "merge window"
     which allows for the change to mature and receive additional testing.
     Applying the potential fix to Ubuntu kernels, at this time, could potentially
     break some existing applications. Ubuntu will continue to monitor related
     changes in the upstream kernel and evaluate/test the potential fix.
reporters:
- Daniel Gruss
- Erik Kraft
- Trishita Tiwari
- Michael Schwarz
- Ari Trachtenberg
- Jason Hennessey
- Alex Ionescu
- Anders Fogh
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  cip/4.19: [f580a54bbd522f2518fd642f7d4d73ad728e5d58]
  cip/4.19-rt: [f580a54bbd522f2518fd642f7d4d73ad728e5d58]
  cip/4.4: [b614485b6b93dbb2f6202341c60594fcdc110d5c]
  cip/4.4-rt: [b614485b6b93dbb2f6202341c60594fcdc110d5c]
  cip/4.4-st: [b614485b6b93dbb2f6202341c60594fcdc110d5c]
  debian/buster-security: ['patch:debian/4.19.37-4:bugfix/all/mm-mincore.c-make-mincore-more-conservative.patch']
  debian/jessie-security: ['patch:debian/3.16.68-2:bugfix/all/mm-mincore.c-make-mincore-more-conservative.patch']
  debian/stretch-security: ['patch:debian/4.9.168-1+deb9u3:bugfix/all/mm-mincore.c-make-mincore-more-conservative.patch']
  mainline: [574823bfab82d9d8fa47f422778043fbb4b4f50e]
  stable/3.16: [b96659f18c61120dbf8b4cc36fbc05589bf9dc02]
  stable/4.14: [212c5685825c1ed45ac3a191dd7ada6e5889bfa2]
  stable/4.19: [f580a54bbd522f2518fd642f7d4d73ad728e5d58]
  stable/4.4: [b614485b6b93dbb2f6202341c60594fcdc110d5c]
  stable/4.9: [fef85fb00224cb22f9efec262e9ffe8970e555ee]
  ubuntu/bionic: ['version:4.15.0-60.67']
  ubuntu/xenial: ['version:4.4.0-157.185']
