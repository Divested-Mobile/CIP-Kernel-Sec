description: out-of-bounds speculation on pointer arithmetic in various cases
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1711
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7308
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=979d63d50c0c0f7bc537bf821e056cc9fe5abd38
- https://www.openwall.com/lists/oss-security/2019/02/02/3
- https://usn.ubuntu.com/usn/usn-3930-1
- https://usn.ubuntu.com/usn/usn-3930-2
- https://usn.ubuntu.com/usn/usn-3931-1
- https://usn.ubuntu.com/usn/usn-3931-2
comments:
  bwh: |
    Before commit f1174f77b50c "bpf/verifier: rework value tracking",
    the only case where pointer arithmetic was permitted with a variable
    offset was packet (context) access. The upstream fixes don't cover
    that case (though it's not clear to me why) so I don't believe this
    issue is applicable to any version before that rework.
  debian/bwh: |-
    Before commit f1174f77b50c "bpf/verifier: rework value tracking",
    the only case where pointer arithmetic was permitted with a variable
    offset was packet (context) access. The upstream fixes don't cover
    that case (though it's not clear to me why) so I don't believe this
    issue is applicable to any version before that rework.
  debian/carnil: |-
    At last be95a845cc4402272994ce290e3ad928aff06cb9 was backported to 4.9.x
    as 5cb917aa1f1e03df9a4c29b363e3900d73508fa8 and included in 4.9.79.
  ubuntu/tyhicks: |-
    Mitigation for this vulnerability is available by setting the
     kernel.unprivileged_bpf_disabled sysctl to 1:
     $ sudo sysctl kernel.unprivileged_bpf_disabled=1
     $ echo kernel.unprivileged_bpf_disabled=1 | \
       sudo tee /etc/sysctl.d/90-CVE-2019-7308.conf
    This issue is mitigated on systems that use secure boot, thanks to
     the kernel lockdown feature which blocks BPF program loading.
reporters:
- Jann Horn
introduced-by:
  mainline: [f1174f77b50c94eecaa658fdc56fa69b421de4b8]
fixed-by:
  cip/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  cip/4.19-rt: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  mainline: [979d63d50c0c0f7bc537bf821e056cc9fe5abd38]
  stable/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96, eed84f94ff8d97abcbc5706f6f9427520fd60a10]
  stable/4.20: [078da99d449f64ca04d459cdbdcce513b64173cd]
