description: out-of-bounds speculation on pointer arithmetic in various cases
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1711
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-7308
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=979d63d50c0c0f7bc537bf821e056cc9fe5abd38
- https://www.openwall.com/lists/oss-security/2019/02/02/3
- https://usn.ubuntu.com/usn/usn-3930-1
- https://usn.ubuntu.com/usn/usn-3930-2
- https://usn.ubuntu.com/usn/usn-3931-1
- https://usn.ubuntu.com/usn/usn-3931-2
- https://ubuntu.com/security/notices/USN-3930-1
- https://ubuntu.com/security/notices/USN-3930-2
- https://ubuntu.com/security/notices/USN-3931-1
- https://ubuntu.com/security/notices/USN-3931-2
- https://www.cve.org/CVERecord?id=CVE-2019-7308
comments:
  bwh: |
    Before commit f1174f77b50c "bpf/verifier: rework value tracking",
    the only case where pointer arithmetic was permitted with a variable
    offset was packet (context) access. The upstream fixes don't cover
    that case (though it's not clear to me why) so I don't believe this
    issue is applicable to any version before that rework.
  debian/bwh: |-
    Before commit f1174f77b50c "bpf/verifier: rework value tracking",
    the only case where pointer arithmetic was permitted with a variable
    offset was packet (context) access. The upstream fixes don't cover
    that case (though it's not clear to me why) so I don't believe this
    issue is applicable to any version before that rework.
  debian/carnil: |-
    At last be95a845cc4402272994ce290e3ad928aff06cb9 was backported to 4.9.x
    as 5cb917aa1f1e03df9a4c29b363e3900d73508fa8 and included in 4.9.79.
  ubuntu/tyhicks: |-
    Mitigation for this vulnerability is available by setting the
     kernel.unprivileged_bpf_disabled sysctl to 1:
     $ sudo sysctl kernel.unprivileged_bpf_disabled=1
     $ echo kernel.unprivileged_bpf_disabled=1 | \
       sudo tee /etc/sysctl.d/90-CVE-2019-7308.conf
    This issue is mitigated on systems that use secure boot, thanks to
     the kernel lockdown feature which blocks BPF program loading.
reporters:
- Jann Horn
introduced-by:
  mainline: [f1174f77b50c94eecaa658fdc56fa69b421de4b8]
fixed-by:
  cip/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  cip/4.19-rt: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  debian/buster-security: ['version:debian/4.19.20-1']
  mainline: [979d63d50c0c0f7bc537bf821e056cc9fe5abd38]
  openela/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96, eed84f94ff8d97abcbc5706f6f9427520fd60a10]
  stable/4.20: [078da99d449f64ca04d459cdbdcce513b64173cd]
  ubuntu/bionic: [010150ffa72a14d593933da6c4f1f336e2d1cdcf, f93a623fd0e0aab06527fab92672e52ca0b2b92c,
    1ead6876b4ee61744984485ebd42b14ec98c41b9, 92c22ad692718debca246a5f1b18e646baabdc5c,
    d25f7129a54eeb7fff8aff7ee18e79abcdf7accc, 4e28ad401276deb251f3fee62bfa6a41904a06dc,
    1bbe41a83396fa1f7dc1daf5fe04a1b8f7644167, f02d76c14b82987cf6c08baeb176ec2878878777,
    d51999cbfa8b3681846da5c5caacfc4f8f23fe0f, a3f6c1f4f5f6a50edb4557584fb7c89d3c8fe218]
  ubuntu/eoan: ['version:5.0.0-13.14']
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
