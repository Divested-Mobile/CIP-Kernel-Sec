description: 'mm: enforce min addr even if capable() in expand_downwards()'
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=1792
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9213
- http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=0a1d52994d440e21def1c2174932410b4f2a98a1
- https://usn.ubuntu.com/usn/usn-3930-1
- https://usn.ubuntu.com/usn/usn-3930-2
- https://usn.ubuntu.com/usn/usn-3931-1
- https://usn.ubuntu.com/usn/usn-3931-2
- https://usn.ubuntu.com/usn/usn-3932-1
- https://usn.ubuntu.com/usn/usn-3932-2
- https://usn.ubuntu.com/usn/usn-3933-1
- https://usn.ubuntu.com/usn/usn-3933-2
comments:
  Debian-bwh: |-
    This is effectively mitigated in stable branches that backported
    the Stack Clash fixes without commit 32e4e6d5cbb0 "mm/mmap.c:
    expand_downwards: don't require the gap if !vm_prev", as the
    stack won't expand below stack_guard_gap.  However Debian
    security branches do include that commit.
reporters:
- Jann Horn
introduced-by:
  mainline: [8869477a49c3e99def1fcdadd6bbc407fea14b45]
fixed-by:
  linux-3.16.y: [c90030281dc8b6a25ac8850e98e15877f80b8d66]
  linux-4.14.y: [f5817069248630b3b7b17ebfcdee0b679c52be33]
  linux-4.19.y: [de04d2973a62e4efb3de45e93bd46acd6d510e0a]
  linux-4.4.y: [40952b6a649b9bfad11ae4fa2862fa0108c9ec24]
  linux-4.9.y: [331fc4df776be3e5a88a1a9f08ef2f7e063ef1a9]
  mainline: [0a1d52994d440e21def1c2174932410b4f2a98a1]
