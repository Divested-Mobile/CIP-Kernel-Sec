description: 'powerpc/powernv/idle: Restore AMR/UAMOR/AMOR after idle'
references:
- https://www.openwall.com/lists/oss-security/2020/04/15/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11669
- https://git.kernel.org/linus/53a712bae5dd919521a58d7bad773b949358add0
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.2
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=53a712bae5dd919521a58d7bad773b949358add0
- https://github.com/torvalds/linux/commit/53a712bae5dd919521a58d7bad773b949358add0
- https://usn.ubuntu.com/usn/usn-4363-1
- https://usn.ubuntu.com/usn/usn-4368-1
- https://ubuntu.com/security/notices/USN-4363-1
- https://ubuntu.com/security/notices/USN-4368-1
- https://www.cve.org/CVERecord?id=CVE-2020-11669
comments:
  debian/carnil: Support for KVM guests on POWER9 only added in v4.10-rc1.
  ubuntu/cascardo: The announcement on oss-sec mentions 4.10 as the first affected
    kernel.
  wens: |-
    This is related to kernel user access prevention (KUAP), introduced
    for this platform in v4.10 in

      3b10d0095a1e powerpc/mm/radix: Prevent kernel execution of user space

    with an incomplete fix in

      a3f3072db6ca powerpc/powernv/idle: Restore IAMR after idle

    The fix is in v5.2. Incidentally, in the same release, the idle code was
    rewritten in C later on, and the same issue arose and was later fixed.
    The rewrite was not backported to earlier kernels.

      e9cef0189c5b powerpc/powernv/idle: Restore AMR/UAMOR/AMOR/IAMR after idle
      10d91611f426 powerpc/64s: Reimplement book3s idle code in C
reporters:
- David Gibson
introduced-by:
  cip/4.19: [3b10d0095a1e2d6ce11f6537e04806ff8aba9cdd, 71b20cdb4353274ce071fde797e5ed428e5ac54a]
  cip/4.19-rt: [3b10d0095a1e2d6ce11f6537e04806ff8aba9cdd, 71b20cdb4353274ce071fde797e5ed428e5ac54a]
  mainline: [3b10d0095a1e2d6ce11f6537e04806ff8aba9cdd, a3f3072db6cad40895c585dce65e36aab997f042]
  stable/4.14: [3b10d0095a1e2d6ce11f6537e04806ff8aba9cdd, af2db2a1e7e7e1e0e2c6dd850d816155ab86d7be]
  stable/4.19: [3b10d0095a1e2d6ce11f6537e04806ff8aba9cdd, 71b20cdb4353274ce071fde797e5ed428e5ac54a]
  ubuntu/bionic: [3b10d0095a1e2d6ce11f6537e04806ff8aba9cdd, 7c1f105c2478b873ebc153375f4695e67bdbe5ce]
fixed-by:
  cip/4.19: [1855c5436fa50e8dc930b0a24c52157dceef9a54]
  cip/4.19-rt: [1855c5436fa50e8dc930b0a24c52157dceef9a54]
  debian/buster-security: ['version:debian/4.19.118-1']
  mainline: [53a712bae5dd919521a58d7bad773b949358add0]
  stable/4.14: [66a93f57330d3e172bf2c3da29f0501634bfac7a]
  stable/4.19: [1855c5436fa50e8dc930b0a24c52157dceef9a54]
  ubuntu/bionic: [e5fbad902c96f994287d9d769ea0254a7ac27036]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: No member uses PowerPC
  cip/4.19-rt: No member uses PowerPC
  cip/4.4: No member uses PowerPC
  cip/4.4-rt: No member uses PowerPC
