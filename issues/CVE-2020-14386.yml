description: 'net/packet: fix overflow in tpacket_rcv'
references:
- https://www.openwall.com/lists/oss-security/2020/09/03/3
- https://www.openwall.com/lists/oss-security/2020/09/04/2
- https://lore.kernel.org/netdev/CAM6JnLf_8nwzq+UGO+amXpeApCDarJjwzOEHQd5qBhU7YKm3DQ@mail.gmail.com/
- https://lore.kernel.org/netdev/20200904040528.3635711-1-edumazet@google.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14386
- https://lore.kernel.org/netdev/20200904040528.3635711-1-edumazet@google.com/T/#u
- https://lore.kernel.org/netdev/20200904133052.20299-1-snu@amazon.com/
- https://usn.ubuntu.com/usn/usn-4489-1
- https://ubuntu.com/security/notices/USN-4489-1
comments:
  debian/carnil: |-
    To create AF_PACKET sockets one needs CAP_NET_RAW in the
    network namepsace, which could be aquired by unprivileged
    processes on systems where unprivileged namespaces are enabled.
    Debian does not enable those.
  ubuntu/cascardo: Added break as investigated by Solar Designer.
  ubuntu/sbeattie: |-
    requires CAP_NET_RAW
    older backports without 8e8e2951e309 will need second
      lore.kernel.org variant
  wens: |-
    Introduced in v4.6. As of 2020-09-08, backports queued up for
    v5.4 and v5.8 only.
reporters:
- Or Cohen
introduced-by:
  mainline: [58d19b19cd99b438541eea4cdbf5c171900b25e5]
fixed-by:
  cip/4.19: [1c3886dc302329f199cc04f8a56ba44d17a0df16]
  cip/4.19-rt: [1c3886dc302329f199cc04f8a56ba44d17a0df16]
  debian/buster-security: ['patch:debian/4.19.146-1:bugfix/all/net-packet-fix-overflow-in-tpacket_rcv.patch']
  debian/stretch-security: ['version:debian/4.9.240-1']
  mainline: [acf69c946233259ab4d64f8869d4037a198c7f06]
  stable/4.14: [5b08356f184a0314d87f9a889be2ed9fef087691]
  stable/4.19: [1c3886dc302329f199cc04f8a56ba44d17a0df16]
  stable/4.9: [9a675ac9fe9794f0981db6e4b101503818f61622]
  stable/5.4: [bc846b58fe5cecaa2632d566355e607954779d45]
  stable/5.8: [03ca1f09ab1ff47a24777c13f9bd161394122f41]
  ubuntu/bionic: [91dd575cab4e415b01980fe9a9252ff2c48adec6]
  ubuntu/focal: [7b52b013b290157fa93241b8d15e3194c4f22202]
  ubuntu/groovy: [cc1849b0cd07dd0249ce4e5408cab908c3322361]
