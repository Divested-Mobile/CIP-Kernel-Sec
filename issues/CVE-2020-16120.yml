description: incorrect unprivileged overlayfs permission checking
references:
- https://www.openwall.com/lists/oss-security/2020/10/13/6
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-16120
- https://usn.ubuntu.com/usn/usn-4578-1
- https://usn.ubuntu.com/usn/usn-4577-1
- https://usn.ubuntu.com/usn/usn-4576-1
- https://bugs.launchpad.net/bugs/1894980
comments:
  debian/carnil: |-
    Additionally to the three fixing commits
    130fdbc3d1f9966dd4230709c30f3768bccd3065 ("ovl: pass correct
    flags for opening real directory") and
    292f902a40c11f043a5ca1305a114da0e523eaa3 ("ovl: call secutiry
    hook in ovl_real_ioctl()") might be wanted (see oss-security
    post).
    Only exploitable when unprivileged user namespaces are enabled.
  ubuntu/sbeattie: |-
    this issue most likely only has an impact on Ubuntu systems
      as it is dependent on unprivileged user namespaces being enabled.
reporters:
- Giuseppe Scrivano
fixed-by:
  mainline: [48bd024b8a40d73ad6b086de2615738da0c7004f, 56230d956739b9cb1cbde439d76227d77979a04d,
    05acefb4872dae89e772729efb194af754c877e8]
  ubuntu/bionic: [dd9365fe4e334a203dbda1bd33efc9d072b0cae0, 9ef61e599406a8c9a0c0a4ef64409b4e4af7cc08,
    88d6373c1edf905b743c1e56b13e9aa8aadff1c1, 12cc0f0ffcbf57acd5bf6ab8566362c34e707073]
  ubuntu/focal: [32fd0cdff791825af096b7adfaf7ee929a33e7bc, dcdcca986781adfacb6e078879a324bae2efc097,
    13edb02efd5895d590661f31966990cbcbabea0b, 87609cff432503281b082898093bd2a7ceab8cc0,
    d9e213524a5aef163c810aa47eba589b18c01b5c, 24d019b8deb5863ff1cd8306c81202ebabdf652e]
