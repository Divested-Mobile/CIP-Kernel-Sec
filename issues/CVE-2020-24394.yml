description: |-
  In the Linux kernel before 5.7.8, fs/nfsd/vfs.c (in the NFS server) can set
  incorrect permissions on new filesystem objects when the filesystem lacks
  ACL support, aka CID-22cf8419f131. This occurs because the current umask is
  not considered.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-24394
- https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=962254
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.7.8
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=22cf8419f1319ff87ec759d0ebdff4cbafaee832
- https://usn.ubuntu.com/usn/usn-4465-1
- https://bugs.debian.org/962254
- https://usn.ubuntu.com/usn/usn-4483-1
- https://usn.ubuntu.com/usn/usn-4485-1
- https://ubuntu.com/security/notices/USN-4465-1
- https://ubuntu.com/security/notices/USN-4483-1
- https://ubuntu.com/security/notices/USN-4485-1
- https://www.cve.org/CVERecord?id=CVE-2020-24394
comments:
  debian/carnil: |-
    Introduced with 47057abde515 ("nfsd: add support for the umask
    attribute") in 4.10-rc1.
introduced-by:
  mainline: [47057abde515155a4fee53038e7772d6b387e0aa]
fixed-by:
  cip/4.19: [2b3faab744b04de198aee4ed8dd74fca7a2a8306]
  cip/4.19-rt: [2b3faab744b04de198aee4ed8dd74fca7a2a8306]
  debian/buster-security: ['version:debian/4.19.131-1']
  mainline: [22cf8419f1319ff87ec759d0ebdff4cbafaee832]
  stable/4.14: [15fefb108c7af7ec8e19a88caed928d8b88120ff]
  stable/4.19: [2b3faab744b04de198aee4ed8dd74fca7a2a8306]
  stable/5.4: [fe05e114d0fde7f644ac9ab5edfce3fa65650875]
  stable/5.7: [fb17be570b470fd56ccb2db7c1b0beb4d0d590d7]
  ubuntu/bionic: [86109345398f495a5e7a0d3fb0591cece8e83599]
  ubuntu/eoan: [fce52a552a83c6cc29a7fb1c03b2e9fe27a6c02b]
  ubuntu/focal: [963ae5e2c321b575041bcba42991079816556b5d]
  ubuntu/groovy: ['version:5.8.0-16.17']
