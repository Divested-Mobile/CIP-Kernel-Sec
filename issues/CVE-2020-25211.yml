description: 'netfilter: ctnetlink: add a range check for l3/l4 protonum'
references:
- https://twitter.com/grsecurity/status/1303646421158109185
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25211
- https://git.kernel.org/linus/1cc5ef91d2ff94d2bf2de3b3585423e8a1051cb6
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1cc5ef91d2ff94d2bf2de3b3585423e8a1051cb6
- https://patchwork.ozlabs.org/project/netfilter-devel/patch/20200908150947.12623-2-pablo@netfilter.org/
- https://lore.kernel.org/stable/20200727190731.4035744-2-willmcvicker@google.com/
- https://usn.ubuntu.com/usn/usn-4657-1
- https://usn.ubuntu.com/usn/usn-4658-1
- https://usn.ubuntu.com/usn/usn-4660-1
- https://ubuntu.com/security/notices/USN-4657-1
- https://ubuntu.com/security/notices/USN-4658-1
- https://ubuntu.com/security/notices/USN-4660-1
- https://www.cve.org/CVERecord?id=CVE-2020-25211
comments:
  debian/bwh: |-
    Introduced in 2.6.17 by commit c1d10adb4a52 "[NETFILTER]: Add
    ctnetlink port for nf_conntrack".
  ubuntu/sbeattie: |-
    fixed in 5.4 somewhere; proposed fix only going to stable
      trees
introduced-by:
  mainline: [c1d10adb4a521de5760112853f42aaeefcec96eb]
fixed-by:
  aosp/3.18: [6caf13e4439c5efbecd3cc01be3e86c57d9aa48f]
  cip/4.19: [289fe546ea16c2dcb57c5198c5a7b7387604530e]
  cip/4.19-rt: [289fe546ea16c2dcb57c5198c5a7b7387604530e]
  cip/4.4: [3f5bfa0a2c3401bfbc0cab5894df8262de619641]
  cip/4.4-rt: [3f5bfa0a2c3401bfbc0cab5894df8262de619641]
  cip/4.4-st: [3f5bfa0a2c3401bfbc0cab5894df8262de619641]
  debian/buster-security: ['version:debian/4.19.152-1']
  debian/stretch-security: ['version:debian/4.9.240-1']
  mainline: [1cc5ef91d2ff94d2bf2de3b3585423e8a1051cb6]
  openela/4.14: [60634d81cb43b19817b79a8a1d38e25e907e5ea1]
  stable/4.14: [60634d81cb43b19817b79a8a1d38e25e907e5ea1]
  stable/4.19: [289fe546ea16c2dcb57c5198c5a7b7387604530e]
  stable/4.4: [3f5bfa0a2c3401bfbc0cab5894df8262de619641]
  stable/4.9: [9c61977a713511c01abdf9b2a72693d21cb60556]
  stable/5.4: [253052b636e98083b1ecc3e9b0cf6f151e1cb8c6]
  stable/5.8: [24c4f2ae019bfcd2a82783e07c2894a519eb1050]
  ubuntu/bionic: [916da3cedc0fb5e9654140fdf31db74e0f0e15ee]
  ubuntu/focal: [9b89cda70225dada979aa114a16614f55d2f6dcb]
  ubuntu/groovy: [5ebdd166fbd4aa4f7d4307ed694c83e9418110f4]
  ubuntu/xenial: [c905dd478215ea260ffa76510e5e5a262947834d]
