description: 'rbd: require global CAP_SYS_ADMIN for mapping and unmapping'
references:
- https://twitter.com/grsecurity/status/1304537507560919041
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25284
- https://git.kernel.org/linus/f44d04e696feaf13d192d942c4f14ad2e117065a
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f44d04e696feaf13d192d942c4f14ad2e117065a
- https://usn.ubuntu.com/usn/usn-4657-1
- https://usn.ubuntu.com/usn/usn-4658-1
- https://usn.ubuntu.com/usn/usn-4660-1
- https://usn.ubuntu.com/usn/usn-4752-1
- https://ubuntu.com/security/notices/USN-4657-1
- https://ubuntu.com/security/notices/USN-4658-1
- https://ubuntu.com/security/notices/USN-4660-1
- https://ubuntu.com/security/notices/USN-4752-1
- https://www.cve.org/CVERecord?id=CVE-2020-25284
comments:
  debian/bwh: |-
    Introduced in 2.6.37 by commit 602adf400201 "rbd: introduce rados
    block device (rbd), based on libceph".
  debian/carnil: Fixed as well in 5.8.10.
  wens: Siemens stated they do not use rbd and the Kconfig option was likely enabled
    by mistake.
introduced-by:
  mainline: [602adf400201636e95c3fed9f31fba54a3d7e844]
fixed-by:
  aosp/3.18: [6941c27f4c1d53dbc4b7b0343a8745e926a15a4d]
  cip/4.19: [0070f9906d7190d4c69e338403db4abfec81fe7f]
  cip/4.19-rt: [0070f9906d7190d4c69e338403db4abfec81fe7f]
  cip/4.4: [e349a5786f4c23eb11d1e7385703ddbf94f3f061]
  cip/4.4-rt: [e349a5786f4c23eb11d1e7385703ddbf94f3f061]
  cip/4.4-st: [e349a5786f4c23eb11d1e7385703ddbf94f3f061]
  debian/buster-security: ['version:debian/4.19.146-1']
  debian/stretch-security: ['version:debian/4.9.240-1']
  mainline: [f44d04e696feaf13d192d942c4f14ad2e117065a]
  stable/4.14: [af4a88994936474294b2f484be01117dc7550e68]
  stable/4.19: [0070f9906d7190d4c69e338403db4abfec81fe7f]
  stable/4.4: [e349a5786f4c23eb11d1e7385703ddbf94f3f061]
  stable/4.9: [774519ed39da09471abe2c02a7f293c380759cc3]
  stable/5.4: [ea3d3bf85669195247ad6a522f4e4209695edca2]
  stable/5.8: [81f5de838b82144fb336a71b697d28ceefc5aead]
  ubuntu/bionic: [f5bf15562dfe5d87048b25f8045765cf7a1639f3]
  ubuntu/focal: [dbc5caf715c73016df737de077d8b214c092de39]
  ubuntu/groovy: [069e553e61b21fe327e8db713d1c5f20e4901d5c]
  ubuntu/xenial: [49c74e7b7336739d4f0fe4fa3fb5151901a41d19]
ignore:
  cip/4.19: No member uses rbd
  cip/4.19-rt: No member uses rbd
  cip/4.4: No member uses rbd
  cip/4.4-rt: No member uses rbd
