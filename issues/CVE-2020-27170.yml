description: 'bpf: Prohibit alu ops for pointer types not defining ptr_limit'
references:
- https://www.openwall.com/lists/oss-security/2021/03/19/2
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=f232326f6966cf2a1d1db7bc917a4ce5f9f55f76
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27170
- https://usn.ubuntu.com/usn/usn-4887-1
- https://usn.ubuntu.com/usn/usn-4890-1
- https://ubuntu.com/security/notices/USN-4887-1
- https://ubuntu.com/security/notices/USN-4890-1
- https://www.cve.org/CVERecord?id=CVE-2020-27170
comments:
  debian/bwh: |-
    I believe this does not apply to 4.9 for the same reason that
    CVE-2019-7308 does not.
  ubuntu: |2-
     alexmurray> According to the upstream advisory,
       f232326f6966cf2a1d1db7bc917a4ce5f9f55f76 is the minimal fix but the whole
       series should be applied together
     sbeattie> kernels before 4.15 are not affected by this.
  wens: Introduced first in v4.15-rc8; fixed in v5.12-rc5.
reporters:
- Piotr Krysiuk
introduced-by:
  mainline: [b2157399cc9898260d6031c5bfe45fe137c1fbe7, 7c6967326267bd5c0dded0a99541357d70dd11ac]
  stable/5.4: [b2157399cc9898260d6031c5bfe45fe137c1fbe7, 4801ffdd6962ad70f32aa6e7d8fc9cfc4789ab81]
  ubuntu/focal: [b2157399cc9898260d6031c5bfe45fe137c1fbe7, 9468cf15d393460c09ff9fb1e9fd2a34c17cb549]
  ubuntu/groovy: [b2157399cc9898260d6031c5bfe45fe137c1fbe7, 3c9d617e82aba2a418c7945e6fa9138a027f6c97]
fixed-by:
  cip/4.19: [bc49612a0e2c379a0d997375901c5371ba015518]
  cip/4.19-rt: [bc49612a0e2c379a0d997375901c5371ba015518]
  cip/5.10: [c4d37eea1c641a9319baf34253cc373abb39d3e1]
  cip/5.10-rt: [c4d37eea1c641a9319baf34253cc373abb39d3e1]
  debian/buster-security: ['patch:debian/4.19.181-1:bugfix/all/bpf-Prohibit-alu-ops-for-pointer-types-not-defining-.patch']
  mainline: [f232326f6966cf2a1d1db7bc917a4ce5f9f55f76]
  openela/4.14: [c49e70a5e7f24b8be2969e5ccf9ba6acd779abbb]
  stable/4.14: [c49e70a5e7f24b8be2969e5ccf9ba6acd779abbb]
  stable/4.19: [bc49612a0e2c379a0d997375901c5371ba015518]
  stable/5.10: [c4d37eea1c641a9319baf34253cc373abb39d3e1]
  stable/5.11: [6bf7609666f6b2a9169c39c79a47ef8d6082afae]
  stable/5.4: [ea8fb45eaac141b13f656a7056e4823845aa3b69]
  ubuntu/bionic: [1ad481b8da3b1257efa248e75df49738485d6893]
  ubuntu/focal: [8ea3ebf533e8f4e33ef1becfb894c52b8d18451c]
  ubuntu/groovy: [794ae94266507143ad982bb95aa67e1da4bcf7d0]
