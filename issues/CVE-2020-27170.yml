description: 'bpf: Prohibit alu ops for pointer types not defining ptr_limit'
references:
- https://www.openwall.com/lists/oss-security/2021/03/19/2
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=f232326f6966cf2a1d1db7bc917a4ce5f9f55f76
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27170
- https://usn.ubuntu.com/usn/usn-4887-1
- https://usn.ubuntu.com/usn/usn-4890-1
comments:
  ubuntu: |2-
     amurray| According to the upstream advisory,
     f232326f6966cf2a1d1db7bc917a4ce5f9f55f76 is the minimal fix but the whole
     series should be applied together
  wens: Introduced first in v4.15-rc8; fixed in v5.12-rc5.
reporters:
- Piotr Krysiuk
introduced-by:
  mainline: [b2157399cc9898260d6031c5bfe45fe137c1fbe7, 7c6967326267bd5c0dded0a99541357d70dd11ac]
fixed-by:
  mainline: [f232326f6966cf2a1d1db7bc917a4ce5f9f55f76]
  stable/4.19: [bc49612a0e2c379a0d997375901c5371ba015518]
  stable/5.10: [c4d37eea1c641a9319baf34253cc373abb39d3e1]
  ubuntu/bionic: [1ad481b8da3b1257efa248e75df49738485d6893]
