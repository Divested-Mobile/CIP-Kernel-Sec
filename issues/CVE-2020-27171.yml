description: 'bpf: Fix off-by-one for area size in creating mask to left'
references:
- https://www.openwall.com/lists/oss-security/2021/03/19/3
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=10d2bb2e6b1d8c4576c56a748f697dbeb8388899
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-27171
- https://usn.ubuntu.com/usn/usn-4887-1
- https://usn.ubuntu.com/usn/usn-4890-1
- https://ubuntu.com/security/notices/USN-4887-1
- https://ubuntu.com/security/notices/USN-4890-1
- https://www.cve.org/CVERecord?id=CVE-2020-27171
comments:
  debian/bwh: |-
    Introduced in 5.0 by commit 979d63d50c0c "bpf: prevent out of bounds
    speculation on pointer arithmetic" and backported into 4.19.19.
  ubuntu/alexmurray: |-
    According to the upstream advisory,
     10d2bb2e6b1d8c4576c56a748f697dbeb8388899 is the minimal fix but the whole
     series should be applied together
  ubuntu/amurray: |-
    According to the upstream advisory,
     10d2bb2e6b1d8c4576c56a748f697dbeb8388899 is the minimal fix but the whole
     series should be applied together
  wens: Introduced in v5.0-rc1; fixed in v5.12-rc5.
reporters:
- Piotr Krysiuk
introduced-by:
  cip/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  cip/4.19-rt: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  mainline: [979d63d50c0c0f7bc537bf821e056cc9fe5abd38]
  stable/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  ubuntu/bionic: [010150ffa72a14d593933da6c4f1f336e2d1cdcf]
fixed-by:
  cip/4.19: [ec5307f2ed2377fc55f0a8c990c6004c63014a54]
  cip/4.19-rt: [ec5307f2ed2377fc55f0a8c990c6004c63014a54]
  cip/5.10: [ac1b87a18c1ffbe3d093000b762121b5aae0a3f9]
  cip/5.10-rt: [ac1b87a18c1ffbe3d093000b762121b5aae0a3f9]
  debian/buster-security: ['patch:debian/4.19.181-1:bugfix/all/bpf-Fix-off-by-one-for-area-size-in-creating-mask-to.patch']
  mainline: [10d2bb2e6b1d8c4576c56a748f697dbeb8388899]
  stable/4.14: [92df5a174c6e7a3078e81b919c4d859d4f9f3f2e]
  stable/4.19: [ec5307f2ed2377fc55f0a8c990c6004c63014a54]
  stable/5.10: [ac1b87a18c1ffbe3d093000b762121b5aae0a3f9]
  stable/5.11: [c4f3aa4343deccf5b8e1bfcc7c36224aaf3a8b26]
  stable/5.4: [2da0540739e43154b500a817d9c95d36c2f6a323]
  ubuntu/bionic: [672eaf4b66ff33ddd3775a8f265f34b39c3c8187]
  ubuntu/focal: [98abeb5700d3f7bf3ccd7ec5ca4a375b7ba6d458]
  ubuntu/groovy: [1c26999ec5df14107f32f3f91e50e07640c4c9cb]
