description: |-
  SCSI "EXTENDED COPY" (XCOPY) requests sent to a Linux SCSI target
  (LIO) allow an attacker to read or write anywhere on any LIO backstore
  configured on the host, provided the attacker has access to one
  LUN and knowledge of the victim backstore's vpd_unit_serial (AKA
  "wwn"). This is possible regardless of the transport/HBA settings
  for the victim backstore.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28374
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=2896c93811e39d63a4d9b63ccf12a8fbc226e5e4
- https://github.com/open-iscsi/tcmu-runner/pull/644
comments:
  ubuntu/sbeattie: |-
    MITIGATION
      XCOPY support is enabled by default, but can be disabled via:
        echo 0 > /sys/kernel/config/target/core/<backstore>/<name>/attrib/emulate_3pc
      or
        targetcli /backstores/<backstore>/<name> set attribute emulate_3pc=0
      .
      This workaround does *not* affect XCOPY requests sent to tcmu-runner
      based backstores.
introduced-by:
  mainline: [cbf031f425fd0b30ff10ba83b612753189a6bbbf]
fixed-by:
  mainline: [2896c93811e39d63a4d9b63ccf12a8fbc226e5e4]
