description: |-
  An issue was discovered in __split_huge_pmd in mm/huge_memory.c in the
  Linux kernel before 5.7.5. The copy-on-write implementation can grant
  unintended write access because of a race condition in a THP mapcount
  check, aka CID-c444eb564fb1.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-29368
- https://git.kernel.org/linus/c444eb564fb16645c172d550359cb3d75fe8a040
- https://bugs.chromium.org/p/project-zero/issues/detail?id=2045
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.7.5
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c444eb564fb16645c172d550359cb3d75fe8a040
- https://usn.ubuntu.com/usn/usn-4752-1
- https://ubuntu.com/security/notices/USN-4752-1
- https://www.cve.org/CVERecord?id=CVE-2020-29368
comments:
  debian/carnil: |-
    Another 4.9-stable-only commit is needed as per
    https://lore.kernel.org/stable/20210226162200.20548-1-vbabka@suse.cz/
    The followup commit was commited as cc916628eae7 ("mm, thp:
    make do_huge_pmd_wp_page() lock page for testing mapcount") in
    4.9.259.
  wens: Fixed in v5.8-rc1. Based on commit log, should be backported to v4.6+. 4.9-stable-only
    commit will be in 4.9.259.
reporters:
- Jann Horn
introduced-by:
  mainline: [6d0a07edd17cfc12fdc1f36de8072fa17cc3666f]
fixed-by:
  cip/4.19: [453d8a481b127edfa7fb76af1bc7586b7a63bdd2]
  cip/4.19-rt: [453d8a481b127edfa7fb76af1bc7586b7a63bdd2]
  debian/buster-security: ['version:debian/4.19.131-1']
  debian/stretch-security: ['version:debian/4.9.228-1']
  mainline: [c444eb564fb16645c172d550359cb3d75fe8a040]
  openela/4.14: [3b6c93db0a02b843694cf91f8bacd94f8e7259c8]
  stable/4.14: [3b6c93db0a02b843694cf91f8bacd94f8e7259c8]
  stable/4.19: [453d8a481b127edfa7fb76af1bc7586b7a63bdd2]
  stable/4.9: [d93d7bd61072a03dde173d36ae5815488a585fc0, cc916628eae7a8494b9a3de329d7baf12fd964c6]
  stable/5.4: [a88d8aaf9b8b5e0af163a235a3baa9fdcb7d430a]
  ubuntu/bionic: [7f4b541307b006f479d17a06c6e71c63a3169dfa]
  ubuntu/focal: [484e4094fbcd22a223b474579abbe49e59f9896d]
  ubuntu/groovy: ['version:5.8.0-16.17']
