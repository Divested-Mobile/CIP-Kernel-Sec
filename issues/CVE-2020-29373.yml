description: |-
  An issue was discovered in fs/io_uring.c in the Linux kernel before 5.6. It
  unsafely handles the root directory during path lookups, and thus a process
  inside a mount namespace can escape to unintended filesystem locations, aka
  CID-ff002b30181d.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-29373
- https://git.kernel.org/linus/ff002b30181d30cdfbca316dadd099c3ca0d739c
- https://bugs.chromium.org/p/project-zero/issues/detail?id=2011
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.6
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ff002b30181d30cdfbca316dadd099c3ca0d739c
- https://www.cve.org/CVERecord?id=CVE-2020-29373
comments:
  ubuntu: |-
    sbeattie| asserted that the issue affects 5.3 and newer, but not
      clear which commit(s) introduced the issue.
  ubuntu/cascardo: |-
    using the commit that introduced io_uring, though the earlier
      commit would be one that introduces io_uring sendmsg support. However,
      any other commits introducing other operations would be vulnerable.
  wens: Likely introduced with io_uring; fixed in v5.6-rc2. Fix for v5.4 are simply
    the two mainline commits squashed in one.
introduced-by:
  mainline: [2b188cc1bb857a9d4701ae59aa7768b5124e262e]
fixed-by:
  mainline: [9392a27d88b9707145d713654eb26f0c29789e50, ff002b30181d30cdfbca316dadd099c3ca0d739c]
  stable/5.4: [cac68d12c531aa3010509a5a55a5dfd18dedaa80]
  ubuntu/focal: ['version:5.4.0-18.22']
  ubuntu/groovy: ['version:5.8.0-16.17']
