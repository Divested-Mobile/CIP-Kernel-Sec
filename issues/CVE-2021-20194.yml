description: heap overflow in __cgroup_bpf_run_filter_getsockopt()
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1912683
- https://patchwork.kernel.org/project/netdevbpf/patch/20210122164232.61770-1-loris.reiff@liblor.ch/#23921223
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20194
- https://usn.ubuntu.com/usn/usn-4879-1
- https://usn.ubuntu.com/usn/usn-4884-1
- https://usn.ubuntu.com/usn/usn-4909-1
- https://usn.ubuntu.com/usn/usn-4912-1
- https://ubuntu.com/security/notices/USN-4879-1
- https://ubuntu.com/security/notices/USN-4884-1
- https://ubuntu.com/security/notices/USN-4909-1
- https://ubuntu.com/security/notices/USN-4912-1
- https://www.cve.org/CVERecord?id=CVE-2021-20194
comments:
  debian/carnil: |-
    kernel.unprivileged_bpf_disabled = 1 can mitigate the issue.
    Prerequisites to exploit the issue seems to be kernel compiled
    with CONFIG_BPF_SYSCALL=y , CONFIG_BPF=y , CONFIG_CGROUPS=y ,
    CONFIG_CGROUP_BPF=y , CONFIG_HARDENED_USERCOPY not set.
  ubuntu/sbeattie: |-
    for 5.8 kernels, HARDENED_USERCOPY is enabled, and so is less
      likely to be vulnerable to code execution. Also, user BPF is disabled
      if booted under secure boot/lockdown.
  wens: Introduced in v5.3-rc1; fixed in v5.11-rc7.
reporters:
- Loris Reiff
introduced-by:
  mainline: [0d01da6afc5402f60325c5da31b22f7d56689b49]
fixed-by:
  cip/5.10: [ee3844e61706dc7a349b5380c1dff7b8d7153cad, 9447d0f8a621be34ba1507b15aa20057c00ae7fc]
  cip/5.10-rt: [ee3844e61706dc7a349b5380c1dff7b8d7153cad, 9447d0f8a621be34ba1507b15aa20057c00ae7fc]
  mainline: [bb8b81e396f7afbe7c50d789e2107512274d2a35, f4a2da755a7e1f5d845c52aee71336cee289935a]
  stable/5.10: [ee3844e61706dc7a349b5380c1dff7b8d7153cad, 9447d0f8a621be34ba1507b15aa20057c00ae7fc]
  stable/5.4: [9146fffc5d2a3ec49906daf18d2e983d995b3521, 02531b5549ebf39d6f3c0602f083901211149355]
  ubuntu/focal: [33a7f1c8000e8bb43438c3fdd1bd70b720e51af8, 8299ac9f0027b5d5ba47a75e0d659ba3bd76c9a4]
  ubuntu/groovy: [03d051edf38ffb971718a002445390670b545dc2, d427ad84f586d001c3883825c690be2243c5ec5e]
