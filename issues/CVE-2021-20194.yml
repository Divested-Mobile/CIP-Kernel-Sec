description: heap overflow in __cgroup_bpf_run_filter_getsockopt()
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1912683
- https://patchwork.kernel.org/project/netdevbpf/patch/20210122164232.61770-1-loris.reiff@liblor.ch/#23921223
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20194
comments:
  debian/carnil: |-
    kernel.unprivileged_bpf_disabled = 1 can mitigate the issue.
    Prerequisites to exploit the issue seems to be kernel compiled
    with CONFIG_BPF_SYSCALL=y , CONFIG_BPF=y , CONFIG_CGROUPS=y ,
    CONFIG_CGROUP_BPF=y , CONFIG_HARDENED_USERCOPY not set.
  wens: Introduced in v5.3-rc1; fixed in v5.11-rc7.
reporters:
- Loris Reiff
introduced-by:
  mainline: [0d01da6afc5402f60325c5da31b22f7d56689b49]
fixed-by:
  mainline: [bb8b81e396f7afbe7c50d789e2107512274d2a35, f4a2da755a7e1f5d845c52aee71336cee289935a]
  stable/5.10: [ee3844e61706dc7a349b5380c1dff7b8d7153cad, 9447d0f8a621be34ba1507b15aa20057c00ae7fc]
  stable/5.4: [9146fffc5d2a3ec49906daf18d2e983d995b3521, 02531b5549ebf39d6f3c0602f083901211149355]
