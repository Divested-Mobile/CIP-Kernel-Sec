description: Linux Kernel io_uring Use-After-Free Privilege Escalation Vulnerability
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20226
- https://www.zerodayinitiative.com/advisories/ZDI-21-001/
- https://www.openwall.com/lists/oss-security/2021/02/05/4
- https://bugzilla.redhat.com/show_bug.cgi?id=1873476
- https://www.openwall.com/lists/oss-security/2021/02/05/7
- https://bugzilla.suse.com/show_bug.cgi?id=1180564#c11
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2021-20226
- https://www.cve.org/CVERecord?id=CVE-2021-20226
comments:
  debian/carnil: |-
    Claimed to be fixed in 5.10.2, but this cannot be the right
    version as there were no changes in 5.10.1 to 5.10.2 in
    io_uring. The Red Hat bugzilla entry has little more details.
    Possibly as well just a duplicate of CVE-2020-29534 and would
    thus be fixed earlier already for the sid branch (See SUSE
    bugzilla bug).
  wens: |-
    Based on SUSE's bug tracker, the fix is actually 0f2122045b94 ("io_uring:
    don't rely on weak ->files references"), which is in v5.10-rc1.
    Commit introducing the issue was taken from CVE-2020-29534.
introduced-by:
  mainline: [05f3fb3c5397524feae2e73ee8e150a9090a7da2]
fixed-by:
  mainline: [0f2122045b946241a9e549c2a76cea54fa58a7ff]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: [b7c2f41ead00285128ca8b625f9996841599910f]
