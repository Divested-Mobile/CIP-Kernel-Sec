description: Untrusted Pointer Dereference in setsockopt system call
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1923636
- https://www.zerodayinitiative.com/advisories/ZDI-21-100/
- https://gist.github.com/Ga-ryo/2ec958e78f55c5d18558960f3fe1c6ec
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20239
- https://usn.ubuntu.com/usn/usn-4878-1
- https://usn.ubuntu.com/usn/usn-4910-1
- https://ubuntu.com/security/notices/USN-4878-1
- https://ubuntu.com/security/notices/USN-4910-1
- https://www.cve.org/CVERecord?id=CVE-2021-20239
comments:
  debian/carnil: |-
    In 5.4.y fixed in 5.4.92 with 55bac51762c3 ("net, sctp, filter:
    remap copy_from_user failure error"). For later kernel
    versions: " In case of later kernel versions this issue won't
    work anymore thanks to Christoph Hellwig's work that got rid of
    the various temporary set_fs() address space overrides
    altogether."
  wens: Introduced in v5.3-rc1; fixed in v5.10-rc1. Different patch needed to fix
    v5.4.
reporters:
- Ryota Shiga
introduced-by:
  mainline: [0d01da6afc5402f60325c5da31b22f7d56689b49]
fixed-by:
  mainline: [f56e65dff6ad52395ef45738799b4fb70ff43376]
  stable/5.4: [55bac51762c39ef033b488dd09b60d48908d317f]
  ubuntu/focal: ['version:5.4.0-67.75']
  ubuntu/groovy: [4e91ea9746e29db25197dd662494b7e46bcb497a]
