description: new DNS Cache Poisoning Attack based on ICMP fragment needed packets
  replies
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20322
- https://bugzilla.redhat.com/show_bug.cgi?id=2014230
- https://lore.kernel.org/stable/YXwNmcIcmOYTRhG2@kroah.com/T/#m0104263473be2806725abb19a30d6288da622898
- https://ubuntu.com/security/notices/USN-5268-1
- https://www.cve.org/CVERecord?id=CVE-2021-20322
comments:
  debian/bwh: |-
    Introduced for ipv4 in 3.6 by commit 4895c771c7f0 "ipv4: Add FIB nexthop
    exceptions."
    Introduced For ipv6 in 4.15 by commits 35732d01fe31 "ipv6: introduce a
    hash table to store dst cache" and 2b760fcf5cfb "ipv6: hook up exception
    table to store dst cache".
    So for the 4.9 branches only ipv4 needs to be fixed.
  debian/carnil: |-
    Backports for 4.19.y and 4.9.y seems incomplete for the time
    beeing and only have the "ipv4: make exception cache less
    predictible" patch.
    For 4.19.y additionally required
    ipv4: use siphash instead of Jenkins in fnhe_hashfun()
    ipv6: use siphash in rt6_exception_hash()
    ipv6: make exception cache less predictible
reporters:
- Keyu Man
introduced-by:
  mainline: [4895c771c7f006b4b90f9d6b1d2210939ba57b38, 35732d01fe311ec13c4e42936878b782b8e7ea85,
    d546c621542df9e45eedc91f35356e887ac63b7b]
fixed-by:
  cip/4.19: [ad829847ad59af8e26a1f1c345716099abbc7a58, 6e2856767eb1a9cfcfcd82136928037f04920e97,
    c6d0d68d6da68159948cad3d808d61bb291a0283, 3e6bd2b583f18da9856fc9741ffa200a74a52cba]
  cip/4.19-rt: [ad829847ad59af8e26a1f1c345716099abbc7a58, 6e2856767eb1a9cfcfcd82136928037f04920e97,
    c6d0d68d6da68159948cad3d808d61bb291a0283, 3e6bd2b583f18da9856fc9741ffa200a74a52cba]
  cip/4.4: [bed8941fbdb72a61f6348c4deb0db69c4de87aca]
  cip/4.4-rt: [bed8941fbdb72a61f6348c4deb0db69c4de87aca]
  cip/4.4-st: [bed8941fbdb72a61f6348c4deb0db69c4de87aca]
  cip/5.10: [dced8347a727528b388f04820f48166f1e651af6, beefd5f0c63a31a83bc5a99e6888af884745684b,
    8692f0bb29927d13a871b198adff1d336a8d2d00, 5867e20e1808acd0c832ddea2587e5ee49813874]
  cip/5.10-rt: [dced8347a727528b388f04820f48166f1e651af6, beefd5f0c63a31a83bc5a99e6888af884745684b,
    8692f0bb29927d13a871b198adff1d336a8d2d00, 5867e20e1808acd0c832ddea2587e5ee49813874]
  debian/buster-security: ['version:debian/4.19.232-1']
  debian/stretch-security: ['version:debian/4.9.290-1']
  mainline: [4785305c05b25a242e5314cc821f54ade4c18810, 6457378fe796815c973f631a1904e147d6ee33b1,
    a00df2caffed3883c341d5685f830434312e4a43, 67d6d681e15b578c1725bad8ad079e05d1c48a8e]
  stable/4.19: [3e6bd2b583f18da9856fc9741ffa200a74a52cba, 6e2856767eb1a9cfcfcd82136928037f04920e97,
    ad829847ad59af8e26a1f1c345716099abbc7a58, c6d0d68d6da68159948cad3d808d61bb291a0283]
  stable/4.4: [bed8941fbdb72a61f6348c4deb0db69c4de87aca]
  stable/4.9: [f10ce783bcc4d8ea454563a7d56ae781640e7dcb]
  stable/5.10: [8692f0bb29927d13a871b198adff1d336a8d2d00, 5867e20e1808acd0c832ddea2587e5ee49813874,
    dced8347a727528b388f04820f48166f1e651af6, beefd5f0c63a31a83bc5a99e6888af884745684b]
  stable/5.14: [4785305c05b25a242e5314cc821f54ade4c18810, 6457378fe796815c973f631a1904e147d6ee33b1,
    55938482a1461a35087c6f3051f8447662889ea8, 4589a12dcf80af31137ef202be1ff4a321707a73]
  stable/5.4: [3f439c231a035bab056a5e20b1fd16f4c4c483c1, 4ba6c163fe64e0836acd0708962fb30cf78dbd42,
    f73cbdd1b8e7ea32c66138426f826c8734b70c18, e46e23c289f62ccd8e2230d9ce652072d777ff30]
  ubuntu/bionic: [b20cba6788d2eceb1637e043a2e2836a932d17c8, f7268aade54271694953bd043720fa13b21c055d,
    51a13326d2286e9eee117e9ea2f1fc55baf69613, deafefb6116c264eedafdcfd669d4e90813c0ed3]
  ubuntu/focal: [78e315399897c1d016b452d81b48767c6a6abc13, 74be67cdbf2984d3a79e68c4d86eba04bab2e9a7,
    7f7c99731debdd88e5f0af34ce1e395066f9dfdd, 6e860b542a4b49601a17deb633584afd6cd68f84]
