description: 'An issue was discovered in the Linux: KVM through Improper handling
  of VM_IO|VM_PFNMAP vmas in KVM can bypass RO checks and can lead to pages being
  freed while still accessible by the VMM and guest. This allows users with the ability
  to start and control a VM to read/write random pages of memory and can result in
  local privilege escalation.'
references:
- https://github.com/google/security-research/security/advisories/GHSA-7wq5-phmq-m584
- http://www.openwall.com/lists/oss-security/2021/05/26/3
- http://www.openwall.com/lists/oss-security/2021/05/26/4
- http://www.openwall.com/lists/oss-security/2021/05/26/5
- https://www.openwall.com/lists/oss-security/2021/05/26/3
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22543
- https://www.openwall.com/lists/oss-security/2021/05/26/4
- https://www.openwall.com/lists/oss-security/2021/05/26/5
- https://github.com/torvalds/linux/commit/f8be156be163a052a067306417cd0ff679068c97
comments:
  masmai: |-
    The hva_to_pfn_remapped() doesn't exist in v4.4 kernel and it use different way to get pfn.
    If v4.4 affects this CVE, it'll need to write a patch.
fixed-by:
  mainline: [f8be156be163a052a067306417cd0ff679068c97]
  stable/4.19: [117777467bc015f0dc5fc079eeba0fa80c965149]
  stable/5.10: [dd8ed6c9bc2224c1ace5292d01089d3feb7ebbc3]
  stable/5.12: [c36fbd888dcc27d365c865e6c959d7f7802a207c]
  stable/5.4: [bb85717e3797123ae7724751af21d0c9d605d61e]
