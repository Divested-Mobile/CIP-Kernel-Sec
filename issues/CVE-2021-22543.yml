description: 'An issue was discovered in the Linux: KVM through Improper handling
  of VM_IO|VM_PFNMAP vmas in KVM can bypass RO checks and can lead to pages being
  freed while still accessible by the VMM and guest. This allows users with the ability
  to start and control a VM to read/write random pages of memory and can result in
  local privilege escalation.'
references:
- https://github.com/google/security-research/security/advisories/GHSA-7wq5-phmq-m584
- http://www.openwall.com/lists/oss-security/2021/05/26/3
- http://www.openwall.com/lists/oss-security/2021/05/26/4
- http://www.openwall.com/lists/oss-security/2021/05/26/5
- https://www.openwall.com/lists/oss-security/2021/05/26/3
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22543
- https://www.openwall.com/lists/oss-security/2021/05/26/4
- https://www.openwall.com/lists/oss-security/2021/05/26/5
- https://github.com/torvalds/linux/commit/f8be156be163a052a067306417cd0ff679068c97
- https://ubuntu.com/security/notices/USN-5070-1
- https://ubuntu.com/security/notices/USN-5071-1
- https://ubuntu.com/security/notices/USN-5071-2
- https://ubuntu.com/security/notices/USN-5071-3
- https://ubuntu.com/security/notices/USN-5094-1
- https://ubuntu.com/security/notices/USN-5094-2
- https://ubuntu.com/security/notices/USN-5106-1
- https://ubuntu.com/security/notices/USN-5120-1
- https://www.cve.org/CVERecord?id=CVE-2021-22543
comments:
  debian/bwh: |-
    For 4.9, at least commits bd2fae8da794 "KVM: do not assume PTE is
    writable after follow_pfn" and 097963959594 "mm: add follow_pte_pmd()"
    need to be applied first.
  masmai: |-
    The hva_to_pfn_remapped() doesn't exist in v4.4 kernel and it use different way to get pfn.
    If v4.4 affects this CVE, it'll need to write a patch. KVM is not our focus so ignore v4.4
    kernel.
introduced-by:
  mainline: [add6a0cd1c5ba51b201e1361b05a5df817083618]
fixed-by:
  cip/4.19: [117777467bc015f0dc5fc079eeba0fa80c965149]
  cip/4.19-rt: [117777467bc015f0dc5fc079eeba0fa80c965149]
  cip/5.10: [dd8ed6c9bc2224c1ace5292d01089d3feb7ebbc3]
  cip/5.10-rt: [dd8ed6c9bc2224c1ace5292d01089d3feb7ebbc3]
  debian/buster-security: ['version:debian/4.19.208-1']
  debian/stretch-security: ['patch:stretch-security:bugfix/all/kvm-do-not-allow-mapping-valid-but-non-reference-cou.patch']
  mainline: [f8be156be163a052a067306417cd0ff679068c97]
  openela/4.14: [46d75ff2c1beebe90e7af8887256d8f0323679e4]
  stable/4.14: [46d75ff2c1beebe90e7af8887256d8f0323679e4]
  stable/4.19: [117777467bc015f0dc5fc079eeba0fa80c965149]
  stable/4.9: [f4b2bfed80e8d0e91b431dd1c21bc3c2c4d5f07e]
  stable/5.10: [dd8ed6c9bc2224c1ace5292d01089d3feb7ebbc3]
  stable/5.12: [c36fbd888dcc27d365c865e6c959d7f7802a207c]
  stable/5.4: [bb85717e3797123ae7724751af21d0c9d605d61e]
  ubuntu/bionic: [5c259c503db331cc508550854c8b8811d98d9dae]
  ubuntu/focal: [70b897a635ae9bc3e1b7a51a78f987284042ed35]
ignore:
  cip/linux-4.4: KVM is not our focus
  cip/linux-4.4-rt: KVM is not our focus
