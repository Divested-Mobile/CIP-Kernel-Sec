description: 'net/sctp: fix race condition in sctp_destroy_sock'
references:
- https://www.openwall.com/lists/oss-security/2021/04/18/2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23133
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net-next.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b
comments:
  debian/carnil: |-
    Commit fixes 610236587600 ("bpf: Add new cgroup attach type to
    enable sock modifications") in 4.10-rc1. Original fix
    b166a20b0738 ("net/sctp: fix race condition in
    sctp_destroy_sock") was reverted, as it caused a dead-lock, cf.
    01bfe5e8e428 ("Revert "net/sctp: fix race condition in
    sctp_destroy_sock"") and then fixed with 34e5b0118685 ("sctp:
    delay auto_asconf init until binding the first addr").
    Unclear yet if this is as well a problem for the 5.10.32,
    4.19.189 and 4.9.268 releases.
    The fix needs to be redone as well for all stable series which
    got the original patch applied.
  ubuntu/sbeattie: |-
    commit b166a20b0738 "net/sctp: fix race condition in
      sctp_destroy_sock" in net-next
  wens: Introduced in v4.10-rc1; fixed in v5.12-rc8.
reporters:
- Or Cohen
introduced-by:
  mainline: [61023658760032e97869b07d54be9681d2529e77]
fixed-by:
  mainline: [b166a20b07382b8bc1dcee2a448715c9c2c81b5b, 01bfe5e8e428b475982a98a46cca5755726f3f7f,
    34e5b01186858b36c4d7c87e1a025071e8e2401f]
  stable/5.10: [5a627026be4a17e5b9db23558cd28e62b2cbc66e, 14919cdf68d03ae59d52fb78e4f998996333e629,
    42f1b8653f85924743ea5b57b051a4e1f05b5e43]
  stable/5.11: [59b5f3e478dbcb4c384cf0888d6cc9f5cad79f2f, cfa52fa7671d8e2b96e2970d96629540810f3d54,
    61ba899553de1930afd8a75b579606b4d8bbb489]
  stable/5.12: [b166a20b07382b8bc1dcee2a448715c9c2c81b5b, 3b31f6e8484986e0ffab2ed0b6af937e5f01b6fc,
    f7a805d1bb53c61d9539e5801af564958d1974d7]
  stable/5.4: [6180d2274b17fc0473fb0764d3417c0bddb99b2e, e1bf000709cc0bb5b40a10a57597be401866acbf,
    3fe9ee040fb7332e2b4cc04c85561eced0a7f227]
