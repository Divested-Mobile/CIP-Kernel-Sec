description: 'net/sctp: fix race condition in sctp_destroy_sock'
references:
- https://www.openwall.com/lists/oss-security/2021/04/18/2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23133
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net-next.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b166a20b07382b8bc1dcee2a448715c9c2c81b5b
- https://ubuntu.com/security/notices/USN-4997-1
- https://ubuntu.com/security/notices/USN-4999-1
- https://ubuntu.com/security/notices/USN-5000-1
- https://ubuntu.com/security/notices/USN-5001-1
- https://ubuntu.com/security/notices/USN-5003-1
- https://ubuntu.com/security/notices/USN-5000-2
- https://ubuntu.com/security/notices/USN-4997-2
- https://www.cve.org/CVERecord?id=CVE-2021-23133
comments:
  debian/carnil: |-
    Commit fixes 610236587600 ("bpf: Add new cgroup attach type to
    enable sock modifications") in 4.10-rc1. Original fix
    b166a20b0738 ("net/sctp: fix race condition in
    sctp_destroy_sock") was reverted, as it caused a dead-lock, cf.
    01bfe5e8e428 ("Revert "net/sctp: fix race condition in
    sctp_destroy_sock"") and then fixed with 34e5b0118685 ("sctp:
    delay auto_asconf init until binding the first addr").
    Unclear yet if this is as well a problem for the 5.10.32,
    4.19.189 and 4.9.268 releases.
    The fix needs to be redone as well for all stable series which
    got the original patch applied.
  ubuntu/sbeattie: |-
    commit b166a20b0738 "net/sctp: fix race condition in
      sctp_destroy_sock" in net-next
  wens: Introduced in v4.10-rc1; fixed in v5.12-rc8.
reporters:
- Or Cohen
introduced-by:
  mainline: [61023658760032e97869b07d54be9681d2529e77]
fixed-by:
  aosp/3.18: [ef740d7de8519564eacf7f4cfc1f308478d5b4ac, db2081991de43bc2d51815acf6f74e693602db76,
    5464c1deb9682bf2ffd7a7c7ce1abfa4eef7b351]
  cip/4.19: [301084de76eb5bfedddda41ec33e2913e90c99e7, c61ecd2e8e70ebdb03ee6b54a261d907f1664b43,
    59339c866e0428fb92bfb3f5290c49a5325d2494]
  cip/4.19-rt: [301084de76eb5bfedddda41ec33e2913e90c99e7, c61ecd2e8e70ebdb03ee6b54a261d907f1664b43,
    59339c866e0428fb92bfb3f5290c49a5325d2494]
  cip/4.4: [e2fe67b243806f06e498f69d7c62a2d5497fc15e, 1b6863dd6a24f84643fe138b46ae9046e1ed52f0,
    ad4dc0db54f9796af2411243292e0e7a10da0f58]
  cip/4.4-rt: [e2fe67b243806f06e498f69d7c62a2d5497fc15e, 1b6863dd6a24f84643fe138b46ae9046e1ed52f0,
    ad4dc0db54f9796af2411243292e0e7a10da0f58]
  cip/4.4-st: [e2fe67b243806f06e498f69d7c62a2d5497fc15e, 1b6863dd6a24f84643fe138b46ae9046e1ed52f0,
    ad4dc0db54f9796af2411243292e0e7a10da0f58]
  cip/5.10: [5a627026be4a17e5b9db23558cd28e62b2cbc66e, 14919cdf68d03ae59d52fb78e4f998996333e629,
    42f1b8653f85924743ea5b57b051a4e1f05b5e43]
  cip/5.10-rt: [5a627026be4a17e5b9db23558cd28e62b2cbc66e, 14919cdf68d03ae59d52fb78e4f998996333e629,
    42f1b8653f85924743ea5b57b051a4e1f05b5e43]
  debian/buster-security: ['version:debian/4.19.194-1']
  debian/stretch-security: ['version:debian/4.9.272-1']
  mainline: [b166a20b07382b8bc1dcee2a448715c9c2c81b5b, 01bfe5e8e428b475982a98a46cca5755726f3f7f,
    34e5b01186858b36c4d7c87e1a025071e8e2401f]
  openela/4.14: [54b63c76b9bb95fba20cd268086ee448f87208c6, 02ba54c49d3fe23d926227cd742a8e40db0da411,
    209e60e5f2d6e97daf329743c99a79d9cbbccbf3]
  stable/4.14: [54b63c76b9bb95fba20cd268086ee448f87208c6, 02ba54c49d3fe23d926227cd742a8e40db0da411,
    209e60e5f2d6e97daf329743c99a79d9cbbccbf3]
  stable/4.19: [301084de76eb5bfedddda41ec33e2913e90c99e7, c61ecd2e8e70ebdb03ee6b54a261d907f1664b43,
    59339c866e0428fb92bfb3f5290c49a5325d2494]
  stable/4.4: [e2fe67b243806f06e498f69d7c62a2d5497fc15e, 1b6863dd6a24f84643fe138b46ae9046e1ed52f0,
    ad4dc0db54f9796af2411243292e0e7a10da0f58]
  stable/4.9: [a75f80fd4fbdeb62cdc7feb9b2002e4ef12ee3c1, 5dafc07ad65a2bfda9d4e3d160da15f3ae6a2800,
    89e55e90c09c6e712c7254467c077802dfd99eaa]
  stable/5.10: [5a627026be4a17e5b9db23558cd28e62b2cbc66e, 14919cdf68d03ae59d52fb78e4f998996333e629,
    42f1b8653f85924743ea5b57b051a4e1f05b5e43]
  stable/5.11: [59b5f3e478dbcb4c384cf0888d6cc9f5cad79f2f, cfa52fa7671d8e2b96e2970d96629540810f3d54,
    61ba899553de1930afd8a75b579606b4d8bbb489]
  stable/5.12: [b166a20b07382b8bc1dcee2a448715c9c2c81b5b, 3b31f6e8484986e0ffab2ed0b6af937e5f01b6fc,
    f7a805d1bb53c61d9539e5801af564958d1974d7]
  stable/5.4: [6180d2274b17fc0473fb0764d3417c0bddb99b2e, e1bf000709cc0bb5b40a10a57597be401866acbf,
    3fe9ee040fb7332e2b4cc04c85561eced0a7f227]
  ubuntu/bionic: [11414aeca348e9c3040ccb22477fa822c8b210c2]
  ubuntu/focal: [bad2011a2d6e1696f0a1a5327738b4694c7f54c8, 9bab324244d48a625adbfa9b18a1f9fa477615bf,
    bb04ae8de5aa0d94d31e380c2eae73155661c363]
  ubuntu/groovy: [25341582a1accb7cd87c1c8ccfffbb6ade894257]
