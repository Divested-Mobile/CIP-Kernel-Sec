description: |-
  In intel_pmu_drain_pebs_nhm in arch/x86/events/intel/ds.c in the Linux
  kernel through 5.11.8 on some Haswell CPUs, userspace applications (such as
  perf-fuzzer) can cause a system crash because the PEBS status in a PEBS
  record is mishandled, aka CID-d88d05a9e0b6.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28971
- https://git.kernel.org/linus/d88d05a9e0b6d9356e97129d4ff9942d765f46ea
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=d88d05a9e0b6d9356e97129d4ff9942d765f46ea
reporters:
- Vince Weaver
introduced-by:
  mainline: [01330d7288e0050c5aaabc558059ff91589e67cd]
fixed-by:
  mainline: [d88d05a9e0b6d9356e97129d4ff9942d765f46ea]
  stable/4.14: [403fdabcc1bcd0d31f9fcb9b9b2e831214ab2192]
  stable/4.19: [b35214c541365c7dd7c9d5f44a02b0633a1cc83f]
  stable/4.9: [6c2ab223a7286ecfa016f532b7231fb049fb2a02]
  stable/5.11: [948aa695eaf6524d4890319c1bfe84a42b7edb95]
  stable/5.4: [da326ba3b84aae8ac0513aa4725a49843f2f871e]
