description: incorrect computation of branch  displacements in BPF JIT compiler
references:
- https://www.openwall.com/lists/oss-security/2021/04/08/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29154
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=e4d4d456436bfb2fe412ee2cd489f7658449b098
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=26f55a59dc65ff77cd1c4b37991e26497fc68049
- https://usn.ubuntu.com/usn/usn-4912-1
- https://usn.ubuntu.com/usn/usn-4916-1
- https://usn.ubuntu.com/usn/usn-4917-1
- https://ubuntu.com/security/notices/USN-4912-1
- https://ubuntu.com/security/notices/USN-4916-1
- https://ubuntu.com/security/notices/USN-4917-1
- https://www.cve.org/CVERecord?id=CVE-2021-29154
comments:
  ubuntu/sbeattie: |-
    this issue is priority medium for trusty/3.13 kernels, as
      unprivileged BPF was not yet available in the Linux kernel of that
      era.
  wens: x86_64 BPF JIT introduced in v3.0-rc1; ia32 one introduced in v4.18-rc1; both
    fixed in v5.12-rc7.
reporters:
- Piotr Krysiuk
introduced-by:
  mainline: [0a14842f5a3c0e88a1e59fac5c3025db39721f74, 03f5781be2c7b7e728d724ac70ba10799cc710d7]
fixed-by:
  cip/4.19: [5f26f1f838aa960045c712e13dbab8ff451fed74, 7b77ae2a0d6f9e110e13e85d802124b111b3e027]
  cip/4.19-rt: [5f26f1f838aa960045c712e13dbab8ff451fed74, 7b77ae2a0d6f9e110e13e85d802124b111b3e027]
  cip/4.4: [ca97582a3fe79543de8e5905e829c5ad3661a1ef]
  cip/4.4-rt: [ca97582a3fe79543de8e5905e829c5ad3661a1ef]
  cip/4.4-st: [ca97582a3fe79543de8e5905e829c5ad3661a1ef]
  cip/5.10: [3edb8967d91ecbc4c5eee34a65d4124267327574, faa30969f66e74910e9424214a4a426c2dc249d8]
  cip/5.10-rt: [3edb8967d91ecbc4c5eee34a65d4124267327574, faa30969f66e74910e9424214a4a426c2dc249d8]
  debian/buster-security: ['version:debian/4.19.194-1']
  debian/stretch-security: ['version:debian/4.9.272-1']
  mainline: [e4d4d456436bfb2fe412ee2cd489f7658449b098, 26f55a59dc65ff77cd1c4b37991e26497fc68049]
  stable/4.14: [32f9a870ab6b1f72f100e9db55b8a022072f78a6]
  stable/4.19: [5f26f1f838aa960045c712e13dbab8ff451fed74, 7b77ae2a0d6f9e110e13e85d802124b111b3e027]
  stable/4.4: [ca97582a3fe79543de8e5905e829c5ad3661a1ef]
  stable/4.9: [d4b234e44aa7108aeadc7b84b162c6f882597005]
  stable/5.10: [3edb8967d91ecbc4c5eee34a65d4124267327574, faa30969f66e74910e9424214a4a426c2dc249d8]
  stable/5.11: [b85b10dc8af463b59a732f299ade2612a8b950c9, 7f6b5b8e03099559a3c05ce3715c147a1df90bbb]
  stable/5.4: [a0b3927a07be0c4cedd69970e082a8c23c92eb72, 6cce3054805860573987efccea43d2d289be9f7b]
  ubuntu/bionic: [8681cd590580fcaffe1f191131de582d2e26982e]
  ubuntu/focal: [f9125a30192ba7d20a3962608c3f451851c49ddc, 75891ef8c55d4b1b899355c50dd3d7d0bae82a89]
  ubuntu/groovy: [1f8e3b8b81cd6727ba0ad514956896cf507ebdb2, e91796102059a0685438e0b78459bedb9980263f]
  ubuntu/xenial: [48a69d1dc2cb19d3d11434e41bc210a132b4b50a]
ignore:
  cip/4.19-rt: No member enables BPF_JIT on x86
  cip/4.4: No member enables BPF_JIT on x86
  cip/4.4-rt: No member enables BPF_JIT on x86
  cip/5.10-rt: No member enables BPF_JIT on x86
