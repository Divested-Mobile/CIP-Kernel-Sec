description: 'bpf: Dont allow vmlinux BTF to be used in map_create and prog_load'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29648
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.11.11
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=350a5c4dd2452ea999cc5e1d4a8dbf12de2f97ef
- https://www.cve.org/CVERecord?id=CVE-2021-29648
comments:
  debian/carnil: |-
    Introduced by 5329722057d4 ("bpf: Assign ID to vmlinux BTF and
    return extra info for BTF in GET_OBJ_INFO") in 5.11-rc1.
  wens: Introduced in v5.11-rc1; fixed in v5.12-rc5.
introduced-by:
  mainline: [5329722057d41aebc31e391907a501feaa42f7d9]
fixed-by:
  mainline: [350a5c4dd2452ea999cc5e1d4a8dbf12de2f97ef]
  stable/5.11: [a9b2ab5db842da37e0f8d830d2a57688d77e3556]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
