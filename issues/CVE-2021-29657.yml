description: 'KVM: SVM: load control fields from VMCB12 before checking them'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-29657
- https://git.kernel.org/linus/a58d9166a756a0f4a6618e4f593232593d6df134
- https://usn.ubuntu.com/usn/usn-4948-1
- https://googleprojectzero.blogspot.com/2021/06/an-epyc-escape-case-study-of-kvm.html
- https://ubuntu.com/security/notices/USN-4948-1
- https://www.cve.org/CVERecord?id=CVE-2021-29657
comments:
  debian/carnil: |-
    Commit fixes 2fcf4876ada ("KVM: nSVM: implement on demand
    allocation of the nested state") in 5.10-rc1.
  wens: Introduced in v5.10-rc1; fixed in v5.12-rc6.
reporters:
- Felix Wilhelm
introduced-by:
  mainline: [2fcf4876ada8a293d3b92a1033b8b990a7c613d3]
fixed-by:
  cip/5.10: [5f6625f5cd5c593fae05a6ce22b406166bc796b8]
  cip/5.10-rt: [5f6625f5cd5c593fae05a6ce22b406166bc796b8]
  mainline: [a58d9166a756a0f4a6618e4f593232593d6df134]
  stable/5.10: [5f6625f5cd5c593fae05a6ce22b406166bc796b8]
  stable/5.11: [c90804920978faba6b5fa91e82edc58e5ffd7d30]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
