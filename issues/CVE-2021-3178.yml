description: 'nfsd4: readdirplus shouldn''t return parent of export'
references:
- https://patchwork.kernel.org/project/linux-nfs/patch/20210111210129.GA11652@fieldses.org/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3178
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=51b2ee7d006a736a9126e8111d1f24e4fd0afaa6
- https://usn.ubuntu.com/usn/usn-4876-1
- https://usn.ubuntu.com/usn/usn-4877-1
- https://usn.ubuntu.com/usn/usn-4878-1
- https://usn.ubuntu.com/usn/usn-4910-1
- https://usn.ubuntu.com/usn/usn-4912-1
- https://ubuntu.com/security/notices/USN-4876-1
- https://ubuntu.com/security/notices/USN-4877-1
- https://ubuntu.com/security/notices/USN-4878-1
- https://ubuntu.com/security/notices/USN-4910-1
- https://ubuntu.com/security/notices/USN-4912-1
- https://www.cve.org/CVERecord?id=CVE-2021-3178
comments:
  ubuntu/mdeslaur: security relevance is disputed
  wens: |-
    Fix mentions that "it is also not very difficult to guess filehandles outside of the export".
    It is recommended to only export entire filesystems.
reporters:
- 吴异
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  aosp/3.18: [c64348057d99d1cd868390ee5203638050c7b748]
  cip/4.19: [a08c2e586ad047fcea3f75664cca0915c77934fe]
  cip/4.19-rt: [a08c2e586ad047fcea3f75664cca0915c77934fe]
  cip/4.4: [c89b2b56fc536d4fd41745bcbf394aa21162e277]
  cip/4.4-rt: [c89b2b56fc536d4fd41745bcbf394aa21162e277]
  cip/4.4-st: [c89b2b56fc536d4fd41745bcbf394aa21162e277]
  cip/5.10: [fdcaa4af5e70e2d984c9620a09e9dade067f2620]
  cip/5.10-rt: [fdcaa4af5e70e2d984c9620a09e9dade067f2620]
  debian/buster-security: ['version:debian/4.19.171-1']
  debian/stretch-security: ['version:debian/4.9.258-1']
  mainline: [51b2ee7d006a736a9126e8111d1f24e4fd0afaa6]
  stable/4.14: [0f60f9d1e6182d9440614c13cdf6106e2d470f89]
  stable/4.19: [a08c2e586ad047fcea3f75664cca0915c77934fe]
  stable/4.4: [c89b2b56fc536d4fd41745bcbf394aa21162e277]
  stable/4.9: [2174b2cf3960b9091c2516feeb9e345fe24f8906]
  stable/5.10: [fdcaa4af5e70e2d984c9620a09e9dade067f2620]
  stable/5.4: [4aef760c28e8bd1860a27fd78067b4ea77124987]
  ubuntu/bionic: [a4ac556e55c16ccff7ab246f147fa3a5d472490a]
  ubuntu/focal: [47437554c37f2564d0025cf450e730e27850fde9]
  ubuntu/groovy: [5aba24d45e5b28ab62a4b07c69fa7972cb6f51af]
  ubuntu/xenial: [3b0d0ac300cc095748a4bacedc39e3a63486717c]
