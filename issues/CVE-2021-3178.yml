description: 'nfsd4: readdirplus shouldn''t return parent of export'
references:
- https://patchwork.kernel.org/project/linux-nfs/patch/20210111210129.GA11652@fieldses.org/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3178
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=51b2ee7d006a736a9126e8111d1f24e4fd0afaa6
comments:
  ubuntu/mdeslaur: security relevance is disputed
  wens: |-
    Fix mentions that "it is also not very difficult to guess filehandles outside of the export".
    It is recommended to only export entire filesystems.
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  mainline: [51b2ee7d006a736a9126e8111d1f24e4fd0afaa6]
  stable/4.14: [0f60f9d1e6182d9440614c13cdf6106e2d470f89]
  stable/4.19: [a08c2e586ad047fcea3f75664cca0915c77934fe]
  stable/4.4: [c89b2b56fc536d4fd41745bcbf394aa21162e277]
  stable/4.9: [2174b2cf3960b9091c2516feeb9e345fe24f8906]
  stable/5.10: [fdcaa4af5e70e2d984c9620a09e9dade067f2620]
  stable/5.4: [4aef760c28e8bd1860a27fd78067b4ea77124987]
