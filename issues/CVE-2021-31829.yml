description: |-
  kernel/bpf/verifier.c in the Linux kernel through 5.12.1 performs
  undesirable speculative loads, leading to disclosure of stack content via
  side-channel attacks, aka CID-801c6058d14a. The specific concern is not
  protecting the BPF stack area against speculative loads. Also, the BPF
  stack can contain uninitialized data that might represent sensitive
  information previously operated on by the kernel.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31829
- https://www.openwall.com/lists/oss-security/2021/05/04/4
- https://ubuntu.com/security/notices/USN-4983-1
- https://ubuntu.com/security/notices/USN-4997-1
- https://ubuntu.com/security/notices/USN-4999-1
- https://ubuntu.com/security/notices/USN-5000-1
- https://ubuntu.com/security/notices/USN-5018-1
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=b9b34ddbe2076ade359cd5ce7537d5ed019e9807
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=801c6058d14a82179a7ee17a4b532cac6fad067f
- https://ubuntu.com/security/notices/USN-5000-2
- https://ubuntu.com/security/notices/USN-4997-2
- https://www.cve.org/CVERecord?id=CVE-2021-31829
comments:
  debian/bwh: Introduced by fix for CVE-2019-7308.
  masami: |-
    According to commit b9b34ddbe207, this CVE is introdueced by 979d63d50c0c.
    Also 979d63d50c0c fixes commit b215739 which was released v4.15-rc8.\nso v4.4
    is not affected this vulnerability.
reporters:
- Piotr Krysiuk
introduced-by:
  cip/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  cip/4.19-rt: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  mainline: [979d63d50c0c0f7bc537bf821e056cc9fe5abd38]
  openela/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  ubuntu/bionic: [010150ffa72a14d593933da6c4f1f336e2d1cdcf]
fixed-by:
  cip/4.19: [0e2dfdc74a7f4036127356d42ea59388f153f42c, bd9df99da9569befff2234b1201ac4e065e363d0]
  cip/4.19-rt: [0e2dfdc74a7f4036127356d42ea59388f153f42c, bd9df99da9569befff2234b1201ac4e065e363d0]
  cip/5.10: [2cfa537674cd1051a3b8111536d77d0558f33d5d, 2fa15d61e4cbaaa1d1250e67b251ff96952fa614]
  cip/5.10-rt: [2cfa537674cd1051a3b8111536d77d0558f33d5d, 2fa15d61e4cbaaa1d1250e67b251ff96952fa614]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [b9b34ddbe2076ade359cd5ce7537d5ed019e9807, 801c6058d14a82179a7ee17a4b532cac6fad067f]
  openela/4.14: [4d542ddb88fb2f39bf7f14caa2902f3e8d06f6ba, 19e4f40ce75079b9532f35f92780db90104648f1]
  stable/4.14: [4d542ddb88fb2f39bf7f14caa2902f3e8d06f6ba, 19e4f40ce75079b9532f35f92780db90104648f1]
  stable/4.19: [0e2dfdc74a7f4036127356d42ea59388f153f42c, bd9df99da9569befff2234b1201ac4e065e363d0]
  stable/5.10: [2cfa537674cd1051a3b8111536d77d0558f33d5d, 2fa15d61e4cbaaa1d1250e67b251ff96952fa614]
  stable/5.4: [53e0db429b37a32b8fc706d0d90eb4583ad13848, 8ba25a9ef9b9ca84d085aea4737e6c0852aa5bfd]
  ubuntu/bionic: ['version:4.15.0-149.153']
  ubuntu/focal: ['version:5.4.0-77.86']
  ubuntu/groovy: ['version:5.8.0-59.66']
ignore:
  cip/4.4: Introduced by v4.15-rc8. Not affected.
  cip/4.4-rt: Introduced by v4.15-rc8. Not affected.
