description: Linux kernel protection of stack pointer against speculative pointer
  arithmetic can be bypassed to leak content of kernel memory
references:
- https://www.openwall.com/lists/oss-security/2021/05/04/4
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=b9b34ddbe2076ade359cd5ce7537d5ed019e9807
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/patch/?id=801c6058d14a82179a7ee17a4b532cac6fad067f
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31829
- https://ubuntu.com/security/notices/USN-4983-1
- https://ubuntu.com/security/notices/USN-4997-1
- https://ubuntu.com/security/notices/USN-4999-1
- https://ubuntu.com/security/notices/USN-5000-1
- https://ubuntu.com/security/notices/USN-5018-1
comments:
  debian/bwh: Introduced by fix for CVE-2019-7308.
  wens: Fixes are queued up in netdev/master as of 2021-05-05 and will likely be in
    v5.13. Consider this introduced with support for unprivileged BPF in v5.8-rc1.
reporters:
- Piotr Krysiuk
introduced-by:
  mainline: [2c78ee898d8f10ae6fb2fa23a3fbaec96b1b7366]
fixed-by:
  cip/4.19: [0e2dfdc74a7f4036127356d42ea59388f153f42c, bd9df99da9569befff2234b1201ac4e065e363d0]
  cip/4.19-rt: [0e2dfdc74a7f4036127356d42ea59388f153f42c, bd9df99da9569befff2234b1201ac4e065e363d0]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [b9b34ddbe2076ade359cd5ce7537d5ed019e9807, 801c6058d14a82179a7ee17a4b532cac6fad067f]
  stable/4.14: [4d542ddb88fb2f39bf7f14caa2902f3e8d06f6ba, 19e4f40ce75079b9532f35f92780db90104648f1]
  stable/4.19: [0e2dfdc74a7f4036127356d42ea59388f153f42c, bd9df99da9569befff2234b1201ac4e065e363d0]
  stable/5.10: [2cfa537674cd1051a3b8111536d77d0558f33d5d, 2fa15d61e4cbaaa1d1250e67b251ff96952fa614]
  stable/5.11: [6eba92a4d4be8feb4dc33976abac544fa99d6ecc, b50fb1b08d6cb3b3b4661d254792794ecdfebab4]
  stable/5.12: [7cf64d8679ca1cb20cf57d6a88bfee79a0922a66, 0356e50a7fa65e9b27cf3363a8f8188608859182]
  stable/5.4: [53e0db429b37a32b8fc706d0d90eb4583ad13848, 8ba25a9ef9b9ca84d085aea4737e6c0852aa5bfd]
  ubuntu/bionic: [0e6575f8f2bc3f34c1e72201b51fff230f5ffb01, 2b630216c49eeb5301b7b5467bce7a5cb1618079]
  ubuntu/focal: [a5c9dafc390c3d6a855b388089580c9c39ab4ab0, a6ad7d824eed81b1e347b861271ab7b2d18277aa]
  ubuntu/groovy: [9458333bcecdbcb24d68daa4ec6def8875f3c9b7, ec2c43ddfa5a739c557659e6d2334a3b84884ae0]
