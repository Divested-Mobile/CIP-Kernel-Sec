description: 'dm ioctl: fix out of bounds array access when no devices'
references:
- https://www.openwall.com/lists/oss-security/2021/03/28/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-31916
- https://git.kernel.org/linus/4edbe1d7bcffcd6269f3b5eb63f710393ff2ec7a
- https://usn.ubuntu.com/usn/usn-4948-1
- https://ubuntu.com/security/notices/USN-4948-1
- https://ubuntu.com/security/notices/USN-4979-1
- https://ubuntu.com/security/notices/USN-4982-1
- https://ubuntu.com/security/notices/USN-4984-1
- https://ubuntu.com/security/notices/USN-5361-1
- https://www.cve.org/CVERecord?id=CVE-2021-31916
comments:
  debian/bwh: Appears to have been introduced before 4.9.
  wens: Present since git history; fixed in v5.12-rc5.
reporters:
- Dan Carpenter
introduced-by:
  mainline: [1da177e4c3f41524e886b7f1b8a0c1fc7321cac2]
fixed-by:
  aosp/3.18: [2f73202e70443ebc22b24ceb5d37e8b7485b4707]
  cip/4.19: [76aa61c55279fdaa8d428236ba8834edf313b372]
  cip/4.19-rt: [76aa61c55279fdaa8d428236ba8834edf313b372]
  cip/4.4: [0c0f93fbd20276d65ae0581edfcdc93579aa1dc7]
  cip/4.4-rt: [0c0f93fbd20276d65ae0581edfcdc93579aa1dc7]
  cip/4.4-st: [0c0f93fbd20276d65ae0581edfcdc93579aa1dc7]
  cip/5.10: [921aae17bb0f02181fa05cf5580ebc855fdbd74d]
  cip/5.10-rt: [921aae17bb0f02181fa05cf5580ebc855fdbd74d]
  debian/buster-security: ['version:debian/4.19.194-1']
  debian/stretch-security: ['version:debian/4.9.272-1']
  mainline: [4edbe1d7bcffcd6269f3b5eb63f710393ff2ec7a]
  stable/4.14: [ba73e621ced58ff4ad1020a140ccb5843da1cb26]
  stable/4.19: [76aa61c55279fdaa8d428236ba8834edf313b372]
  stable/4.4: [0c0f93fbd20276d65ae0581edfcdc93579aa1dc7]
  stable/4.9: [c13f07341685149cfbc2014e8b4a85ff56d4ae0e]
  stable/5.10: [921aae17bb0f02181fa05cf5580ebc855fdbd74d]
  stable/5.11: [45dc10644f03455f472efc366df4024eb62d38df]
  stable/5.4: [e6587d142d0214eb466f9978e25f0575c19b1ea0]
  ubuntu/bionic: [5f20fec4229c5d38656f6482fbcd99bce6bd185b]
  ubuntu/focal: [b277e9bfa7ccdde216cfdb2d6f2f528dd06a8f64]
  ubuntu/groovy: [a40d146fbbb3080ba750eda2230a9ec3e980768f]
