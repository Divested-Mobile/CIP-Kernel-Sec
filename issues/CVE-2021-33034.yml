description: 'Bluetooth: verify AMP hci_chan before amp_destroy'
references:
- https://sites.google.com/view/syzscope/kasan-use-after-free-read-in-hci_send_acl
- https://syzkaller.appspot.com/bug?id=2e1943a94647f7732dd6fc60368642d6e8dc91b1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33034
- https://git.kernel.org/linus/5c4c8c9544099bb9043a10a5318130a943e32fc3
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.12.4
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=5c4c8c9544099bb9043a10a5318130a943e32fc3
- https://ubuntu.com/security/notices/USN-4997-1
- https://ubuntu.com/security/notices/USN-5000-1
- https://ubuntu.com/security/notices/USN-5001-1
- https://ubuntu.com/security/notices/USN-5018-1
- https://ubuntu.com/security/notices/USN-5016-1
- https://ubuntu.com/security/notices/USN-5000-2
- https://ubuntu.com/security/notices/USN-4997-2
- https://ubuntu.com/security/notices/USN-5299-1
- https://ubuntu.com/security/notices/USN-5343-1
- https://www.cve.org/CVERecord?id=CVE-2021-33034
comments:
  debian: 'bwh: Appears to have been introduced before 4.9.'
fixed-by:
  aosp/3.18: [fdcdd7cd375a12a7ed6aec407019dd37dad7a4b5]
  cip/4.19: [75e26178e26f910f7f26c79c2824b726eecf0dfb]
  cip/4.19-rt: [75e26178e26f910f7f26c79c2824b726eecf0dfb]
  cip/4.4: [b27a218d166b7f07cd5616fb90e727b6ed662b1a]
  cip/4.4-rt: [b27a218d166b7f07cd5616fb90e727b6ed662b1a]
  cip/4.4-st: [b27a218d166b7f07cd5616fb90e727b6ed662b1a]
  cip/5.10: [1d7bd87a2c8d264ca3e5c9ba6f3eafc23e994028]
  cip/5.10-rt: [1d7bd87a2c8d264ca3e5c9ba6f3eafc23e994028]
  debian/buster-security: ['version:debian/4.19.194-1']
  debian/stretch-security: ['version:debian/4.9.272-1']
  mainline: [5c4c8c9544099bb9043a10a5318130a943e32fc3]
  openela/4.14: [21f6aee6682a1f7415e23f96ce94ff387d9cdb2e]
  stable/4.14: [21f6aee6682a1f7415e23f96ce94ff387d9cdb2e]
  stable/4.19: [75e26178e26f910f7f26c79c2824b726eecf0dfb]
  stable/4.4: [b27a218d166b7f07cd5616fb90e727b6ed662b1a]
  stable/4.9: [31f20a6e73663c8ac3c625aa6b24cbdc8541c674]
  stable/5.10: [1d7bd87a2c8d264ca3e5c9ba6f3eafc23e994028]
  stable/5.11: [7064d5651ba08adbcd3d8a2fc78f8a117a768935]
  stable/5.12: [c026c3dc3947c714a19779d0a6c596b55e63685d]
  stable/5.4: [3a826ffa80d5c73ad7338fd98ace9c5b53844968]
  ubuntu/bionic: [23df2f2435bb5c4dd044dd59ec9b10425620989c]
  ubuntu/focal: [f474346249b8c67d8a9ef75a7c8f1ab248089507]
  ubuntu/groovy: [c87b488bf099a9bf6cd23cbd6690931222f9172f]
