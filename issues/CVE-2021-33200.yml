description: enforcing incorrect limits for pointer arithmetic operations by BPF verifier
  can be abused to perform out-of-bounds reads and writes in kernel memory
references:
- https://www.openwall.com/lists/oss-security/2021/05/27/1
- https://lore.kernel.org/stable/20210528103810.22025-1-ovidiu.panait@windriver.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33200
- https://ubuntu.com/security/notices/USN-4983-1
- https://ubuntu.com/security/notices/USN-4997-1
- https://ubuntu.com/security/notices/USN-4999-1
- https://ubuntu.com/security/notices/USN-5000-1
- https://ubuntu.com/security/notices/USN-5018-1
- https://ubuntu.com/security/notices/USN-5000-2
- https://ubuntu.com/security/notices/USN-4997-2
- https://www.cve.org/CVERecord?id=CVE-2021-33200
comments:
  debian/carnil: |-
    Introduced by 7fedb63a8307 ("bpf: Tighten speculative pointer
    arithmetic mask") in 5.12-rc8 (and backported to 5.11.17,
    5.10.33, 5.4.116). Note though that 7fedb63a8307 is part of the
    fixes needed to address CVE-2021-29155 which introduces the
    buggy computation.
    Those commits were included in 4.19.193 with the fixes for
    CVE-2021-29155 and so not introducing CVE-2021-33200 in any of
    the released v4.19.y versions. Thus keeping the entry here as
    "N/A".
reporters:
- Piotr Krysiuk
fixed-by:
  cip/4.19: [963e62364c8028090b64818ac455fbe40a52579e, 9324bd041d5c0a9c41238d390838778b9387030e,
    a9d5ac78e7ca194d8fc570d26640395ffd6e9367]
  cip/4.19-rt: [963e62364c8028090b64818ac455fbe40a52579e, 9324bd041d5c0a9c41238d390838778b9387030e,
    a9d5ac78e7ca194d8fc570d26640395ffd6e9367]
  cip/5.10: [4e2c7b297431457663a90d4186e666b61d5da86c, c87ef240a8bbbda5913fac1e84209d224c1aaf50,
    27acfd11ba179b746f55077edf9750f8f7cb1cb6]
  cip/5.10-rt: [4e2c7b297431457663a90d4186e666b61d5da86c, c87ef240a8bbbda5913fac1e84209d224c1aaf50,
    27acfd11ba179b746f55077edf9750f8f7cb1cb6]
  mainline: [3d0220f6861d713213b015b582e9f21e5b28d2e0, bb01a1bba579b4b1c5566af24d95f1767859771e,
    a7036191277f9fa68d92f2071ddc38c09b1e5ee5]
  openela/4.14: [73549ddbe5cd2ddc27617202b6e426aebd417514, 1dcebba3e4bd071c6647cad6f4a135b639725beb,
    6a87d309fefaabc18f694bd6d52bb3160557e4a9]
  stable/4.14: [73549ddbe5cd2ddc27617202b6e426aebd417514, 1dcebba3e4bd071c6647cad6f4a135b639725beb,
    6a87d309fefaabc18f694bd6d52bb3160557e4a9]
  stable/4.19: [963e62364c8028090b64818ac455fbe40a52579e, 9324bd041d5c0a9c41238d390838778b9387030e,
    a9d5ac78e7ca194d8fc570d26640395ffd6e9367]
  stable/5.10: [4e2c7b297431457663a90d4186e666b61d5da86c, c87ef240a8bbbda5913fac1e84209d224c1aaf50,
    27acfd11ba179b746f55077edf9750f8f7cb1cb6]
  stable/5.12: [9accd53bd479974c434554e3446149884890623a, 4dd2aaaddbcfd8e9f097512c745d69018f8e9801,
    f3ab9709b00ed389f870f6b20d323193bcf572c8]
  stable/5.4: [2768f9962231800dab70f5178041b4ff5028fc5d, 2b3cc41d500a74bb48358faf40b4a4ec6f03e25e,
    3173c7c807854a580c85f04193a6a25aeff3dd96]
  ubuntu/bionic: [5c82cd26b430dc13f042d5e6ef37c6a942f9b5fd, 24d2315554dd683d066a9bdc4a45544bbaa167e4,
    05ce8d029427ab610ad5f60ef59b8b4341a36462]
  ubuntu/focal: [46b0140a436cc5c0349f562baa94a13715b2ef33, 7a167a35898f56d742e207d3f2c2b76528de34a5,
    2fa9ab45c53e8b104ba8f7d3a953131cc818fcc0]
  ubuntu/groovy: [98f10c4969ffce655fbea3cdfe2050c149d12da8, ef118df7d2ad0c96b8bc3596c84e155371de06a9,
    2f2b401cd139cb5705a2327b3499b598b49fcba1]
