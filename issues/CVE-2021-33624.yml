description: Linux kernel BPF protection against speculative execution attacks can
  be bypassed to read arbitrary kernel memory
references:
- https://www.openwall.com/lists/oss-security/2021/06/21/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33624
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=d203b0fd863a2261e5d00b97f3d060c4c2a6db71
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=fe9a5ca7e370e613a9a75a13008a3845ea759d6e
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=9183671af6dbf60a1219371d4ed73e23f43b49db
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=973377ffe8148180b2651825b92ae91988141b05
- https://ubuntu.com/security/notices/USN-5091-1
- https://ubuntu.com/security/notices/USN-5092-1
- https://ubuntu.com/security/notices/USN-5092-2
- https://ubuntu.com/security/notices/USN-5091-2
- https://ubuntu.com/security/notices/USN-5115-1
- https://www.cve.org/CVERecord?id=CVE-2021-33624
comments:
  debian/bwh: |-
    I think this can be ignored. Privileged users can generally read
    kernel memory through kprobes/tracepoints. Unprivileged use of
    eBPF is now disabled by default in all Debian suites.
  debian/carnil: |-
    9183671af6db ("bpf: Fix leakage under speculation on
    mispredicted branches") is the main part of the fixes.
    The selftest fixes commit was included in later release as well
    in 5.10.57 but the CVE fixes covered already in 5.10.46.
  masami: |-
    The main patch 9183671af6dbf60a1219371d4ed73e23f43b49db fixes commit b2157399cc9898260d6031c5bfe45fe137c1fbe7
    which has been merged since 4.15-rc8 so 4.4 aren't affected this vulnerability.
  ubuntu/alexmurray: |-
    According to the oss-sec post
     9183671af6dbf60a1219371d4ed73e23f43b49db is the main patch which is needed
     but I suspect we should take all 4
  ubuntu/amurray: |-
    According to the oss-sec post
     9183671af6dbf60a1219371d4ed73e23f43b49db is the main patch which is needed
     but I suspect we should take all 4
reporters:
- Ofek Kirzner
- Adam Morrison
- Benedict Schlueter
- Piotr Krysiuk
fixed-by:
  cip/4.19: [0abc8c9754c953f5cd0ac7488c668ca8d53ffc90, c510c1845f7b54214b4117272e0d87dff8732af6,
    9df311b2e743642c5427ecf563c5050ceb355d1d, c15b387769446c37a892f958b169744dabf7ff23]
  cip/4.19-rt: [0abc8c9754c953f5cd0ac7488c668ca8d53ffc90, c510c1845f7b54214b4117272e0d87dff8732af6,
    9df311b2e743642c5427ecf563c5050ceb355d1d, c15b387769446c37a892f958b169744dabf7ff23]
  cip/5.10: [e9d271731d21647f8f9e9a261582cf47b868589a, 8c82c52d1de931532200b447df8b4fc92129cfd9,
    5fc6ed1831ca5a30fb0ceefd5e33c7c689e7627b, 30ea1c535291e88e41413464277fcf98a95cf8c6]
  cip/5.10-rt: [e9d271731d21647f8f9e9a261582cf47b868589a, 8c82c52d1de931532200b447df8b4fc92129cfd9,
    5fc6ed1831ca5a30fb0ceefd5e33c7c689e7627b, 30ea1c535291e88e41413464277fcf98a95cf8c6]
  debian/buster-security: ['version:debian/4.19.208-1']
  mainline: [d203b0fd863a2261e5d00b97f3d060c4c2a6db71, fe9a5ca7e370e613a9a75a13008a3845ea759d6e,
    9183671af6dbf60a1219371d4ed73e23f43b49db, 973377ffe8148180b2651825b92ae91988141b05]
  stable/4.19: [0abc8c9754c953f5cd0ac7488c668ca8d53ffc90, c510c1845f7b54214b4117272e0d87dff8732af6,
    9df311b2e743642c5427ecf563c5050ceb355d1d, c15b387769446c37a892f958b169744dabf7ff23]
  stable/5.10: [e9d271731d21647f8f9e9a261582cf47b868589a, 8c82c52d1de931532200b447df8b4fc92129cfd9,
    5fc6ed1831ca5a30fb0ceefd5e33c7c689e7627b, 30ea1c535291e88e41413464277fcf98a95cf8c6]
  stable/5.12: [408a4956acde24413f3c684912b1d3e404bed8e2, 68a1936e1812653b68c5b68e698d88fb35018835,
    4a99047ed51c98a09a537fe2c12420d815dfe296, e5e2010ac3e27efa1e6e830b250f491da82d51b4]
  stable/5.4: [283d742988f6b304f32110f39e189a00d4e52b92, d2f790327f83b457db357e7c66f942bc00d43462,
    fd568de5806f8859190e6305a1792ba8cb20de61, a0f66ddf05c2050e1b7f53256bd9c25c2bb3022b]
  ubuntu/focal: [eba4d3754dfde113a585666487c24ec437e1be3d, cb08c84e0a6ea7b8a11a50268925dc5ae88650c1,
    bcf38618e1b1a4e854e7c91bb85e725c5026ff7a, 2f81df62641ca85fcdd401cd077fed52bfb0ba9e]
ignore:
  cip/4.4: Not affected this version
  cip/4.4-rt: Not affected this version
  cip/4.4-st: Not affected this version
  debian/stretch-security: Too risky to backport, and mitigated by default
