description: Linux kernel BPF protection against speculative execution attacks can
  be bypassed to read arbitrary kernel memory
references:
- https://www.openwall.com/lists/oss-security/2021/06/21/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33624
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=d203b0fd863a2261e5d00b97f3d060c4c2a6db71
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=fe9a5ca7e370e613a9a75a13008a3845ea759d6e
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=9183671af6dbf60a1219371d4ed73e23f43b49db
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=973377ffe8148180b2651825b92ae91988141b05
comments:
  debian/carnil: |-
    9183671af6db ("bpf: Fix leakage under speculation on
    mispredicted branches") is the main part of the fixes.
    The selftest fixes commit was included in later release as well
    in 5.10.57 but the CVE fixes covered already in 5.10.46.
  ubuntu/amurray: |-
    According to the oss-sec post
     9183671af6dbf60a1219371d4ed73e23f43b49db is the main patch which is needed
     but I suspect we should take all 4
reporters:
- Ofek Kirzner
- Adam Morrison
- Benedict Schlueter
- Piotr Krysiuk
fixed-by:
  mainline: [d203b0fd863a2261e5d00b97f3d060c4c2a6db71, fe9a5ca7e370e613a9a75a13008a3845ea759d6e,
    9183671af6dbf60a1219371d4ed73e23f43b49db, 973377ffe8148180b2651825b92ae91988141b05]
  stable/5.10: [e9d271731d21647f8f9e9a261582cf47b868589a, 8c82c52d1de931532200b447df8b4fc92129cfd9,
    5fc6ed1831ca5a30fb0ceefd5e33c7c689e7627b]
  stable/5.12: [408a4956acde24413f3c684912b1d3e404bed8e2, 68a1936e1812653b68c5b68e698d88fb35018835,
    4a99047ed51c98a09a537fe2c12420d815dfe296, e5e2010ac3e27efa1e6e830b250f491da82d51b4]
  stable/5.4: [283d742988f6b304f32110f39e189a00d4e52b92, d2f790327f83b457db357e7c66f942bc00d43462,
    fd568de5806f8859190e6305a1792ba8cb20de61, a0f66ddf05c2050e1b7f53256bd9c25c2bb3022b]
