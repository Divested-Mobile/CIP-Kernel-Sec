description: 'bpf: Fix truncation handling for mod32 dst reg wrt zero'
references:
- https://www.openwall.com/lists/oss-security/2021/03/23/2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3444
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9b00f1b78809309163dda2d044d9e94a3c0248a3
- https://usn.ubuntu.com/usn/usn-4887-1
comments:
  debian/carnil: |-
    Introduced by 468f6eafa6c4 ("bpf: fix 32-bit ALU op
    verification") (4.15-rc5) but f6b1b3bf0d5f ("bpf: fix subprog
    verifier bypass by div/mod by 0 exception") (4.16-rc1) is
    necessary to exploit the issue.
    Will require as well e88b2c6e5a4d ("bpf: Fix 32 bit src
    register truncation on div/mod") as prerequisite.
  ubuntu/sbeattie: |-
    both f6b1b3bf0d5f681631a293cfe1ca934b81716f1e and
      468f6eafa6c4 are needed for a system to be vulnerable.
    e88b2c6e5a4d9ce30d75391e4d950da74bb2bd90 is likely needed as
      a prerequisite fix as well
reporters:
- De4dCr0w of 360 Alpha Lab
fixed-by:
  mainline: [9b00f1b78809309163dda2d044d9e94a3c0248a3]
  stable/5.10: [3320bae8c115863b6f17993c2b7970f7f419da57]
