description: eBPF RINGBUF map oversized allocation
references:
- https://www.openwall.com/lists/oss-security/2021/05/11/10
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=4b81ccebaeee885ab1aa1438133f2991e3a2b6ea
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=04ea3086c4d73da7009de1e84962a904139af219
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=98a34e93da83e50e197584c7c362668bf12c1d54
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3489
- https://usn.ubuntu.com/usn/usn-4948-1
- https://usn.ubuntu.com/usn/usn-4949-1
- https://usn.ubuntu.com/usn/usn-4950-1
- https://ubuntu.com/security/notices/USN-4948-1
- https://ubuntu.com/security/notices/USN-4949-1
- https://ubuntu.com/security/notices/USN-4950-1
- https://flatt.tech/assets/reports/210401_pwn2own/whitepaper.pdf
comments:
  debian/carnil: |-
    Introduced in 5.8-rc1 by 457f44363a88 ("bpf: Implement BPF ring
    buffer and verifier support for it").
  ubuntu/sbeattie: introduced in v5.8-rc1
reporters:
- Ryota Shiga
introduced-by:
  mainline: [457f44363a8894135c85b7a9afd2bd8196db24ab]
fixed-by:
  cip/5.10: [1ca284f0867079a34f52a6f811747695828166c6]
  cip/5.10-rt: [1ca284f0867079a34f52a6f811747695828166c6]
  mainline: [4b81ccebaeee885ab1aa1438133f2991e3a2b6ea]
  stable/5.10: [1ca284f0867079a34f52a6f811747695828166c6]
  stable/5.11: [646f2a9b0ecc57817352830d4efa409d89542e1d]
  stable/5.12: [53eb85cc663089f0eff42679f54ae915dcefc433]
  ubuntu/groovy: [9db9feb1c3241b57539ab99062542b359c83e9ed, abcc616635230904054f511bf99ec5b4bc819239]
