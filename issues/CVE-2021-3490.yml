description: eBPF bitwise ops ALU32 bounds tracking
references:
- https://www.openwall.com/lists/oss-security/2021/05/11/11
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=049c4e13714ecbca567b4d5f6d563f05d431c80e
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3490
- https://usn.ubuntu.com/usn/usn-4948-1
- https://usn.ubuntu.com/usn/usn-4949-1
- https://usn.ubuntu.com/usn/usn-4950-1
- https://ubuntu.com/security/notices/USN-4948-1
- https://ubuntu.com/security/notices/USN-4949-1
- https://ubuntu.com/security/notices/USN-4950-1
- https://github.com/chompie1337/Linux_LPE_eBPF_CVE-2021-3490
- https://www.cve.org/CVERecord?id=CVE-2021-3490
comments:
  debian/carnil: |-
    Introduced by 3f50f132d840 ("bpf: Verifier, do explicit ALU32
    bounds tracking") in 5.7-rc1 respectively the XOR version
    introduced in 2921c90d4718 ("bpf: Fix a verifier failure with
    xor") in 5.10-rc1.
  ubuntu/sbeattie: introduced in v5.7-rc1
  wens: Fix queued up in bpf tree as of 2021-05-12.
reporters:
- Manfred Paul
introduced-by:
  mainline: [3f50f132d8400e129fc9eb68b5020167ef80a244, 2921c90d471889242c24cff529043afb378937fa]
  ubuntu/groovy: [3f50f132d8400e129fc9eb68b5020167ef80a244, 66c2aceb5caa0a1fc2d41059ccaa94ea9a834dfd]
fixed-by:
  cip/5.10: [282bfc8848eaa195d5e994bb700f2c7afb7eb3e6]
  cip/5.10-rt: [282bfc8848eaa195d5e994bb700f2c7afb7eb3e6]
  mainline: [049c4e13714ecbca567b4d5f6d563f05d431c80e]
  stable/5.10: [282bfc8848eaa195d5e994bb700f2c7afb7eb3e6]
  stable/5.11: [3a0066086a338f99205b1c38c9fbefaeb5cd6d28]
  stable/5.12: [9fdd1d10daac186e21a77290f9d22b41e175e1b9]
  ubuntu/groovy: [66c2aceb5caa0a1fc2d41059ccaa94ea9a834dfd, bd1e67cf571b8f750ce2fc0edeb9c09c9d637fe9]
