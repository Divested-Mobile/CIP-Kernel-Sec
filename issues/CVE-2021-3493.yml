description: overlayfs fs caps privilege escalation
references:
- https://www.openwall.com/lists/oss-security/2021/04/16/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493
- https://usn.ubuntu.com/usn/usn-4915-1
- https://usn.ubuntu.com/usn/usn-4916-1
- https://usn.ubuntu.com/usn/usn-4917-1
- https://github.com/briskets/CVE-2021-3493
- https://ubuntu.com/security/notices/USN-4915-1
- https://ubuntu.com/security/notices/USN-4916-1
- https://ubuntu.com/security/notices/USN-4917-1
- https://www.cve.org/CVERecord?id=CVE-2021-3493
comments:
  debian/carnil: |-
    Debian ships as well a patch to allow enable unprivileged
    overlayfs mounts. Cf. #913880 present since 4.19.9-1 upload.
    One needs to explicitly load the module though with
    permit_mounts_in_userns (which will issue as well a security
    warning).
  ubuntu/sbeattie: |-
    issue is specific to Ubuntu or any other distribution that
      patched the kernel to allow unprivileged overlay mounts, prior to
      the 5.11 commit (459c7c565ac36b) that permits it upstream.
  wens: Introduced and fixed in v5.11-rc1.
introduced-by:
  mainline: [459c7c565ac36ba09ffbf24231147f408fde4203]
fixed-by:
  mainline: [7c03e2cda4a584cadc398e8f6641ca9988a39d52]
  ubuntu/bionic: ['version:4.15.0-142.146']
  ubuntu/focal: ['version:5.4.0-72.80']
  ubuntu/groovy: ['version:5.8.0-50.56']
  ubuntu/xenial: ['version:4.4.0-209.241']
