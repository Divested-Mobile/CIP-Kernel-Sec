description: Bluetooth CMTP Module Double Free Privilege Escalation Vulnerability
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2017077
- https://www.zerodayinitiative.com/advisories/ZDI-21-1223/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-34981
- https://git.kernel.org/linus/3cfdf8fcaafa62a4123f92eb0f4a72650da3a479
comments:
  debian/carnil: |-
    It is claimed in ZDI-21-1223 that the issue got fixed in
    5.10.42 but no references are added.
    The stable commits wrongly reference
    8da3a0b87f4f1c3a3bbc4bfb78cf68476e97d183 as upstream commit,
    while the commit in mainline is
    3cfdf8fcaafa62a4123f92eb0f4a72650da3a479 ?
  ubuntu/cascardo: |-
    to exploit this requires CAP_NET_ADMIN in the init namespace
      (init_ns): cmtp_add_connection is called from do_cmtp_sock_ioctl,
      with command CMTPCONNADD, which checks for capable(CAP_NET_ADMIN).
reporters:
- Ryota Shiga
fixed-by:
  debian/buster-security: ['version:debian/4.19.194-1']
  debian/stretch-security: ['version:debian/4.9.272-1']
  mainline: [3cfdf8fcaafa62a4123f92eb0f4a72650da3a479]
  stable/4.19: [f8be26b9950710fe50fb45358df5bd01ad18efb7]
  stable/4.4: [61a811e8f5229264b822361f8b23d7638fd8c914]
  stable/4.9: [77c559407276ed4a8854dafc4a5efc8608e51906]
  stable/5.10: [1b364f8ede200e79e25df0df588fcedc322518fb]
  stable/5.4: [fe201316ac36c48fc3cb2891dfdc8ab68058734d]
