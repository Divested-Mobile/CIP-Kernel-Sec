description: 'KVM: VMX: Don''t use vcpu->run->internal.ndata as an array index'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3501
- https://git.kernel.org/linus/04c4f2ee3f68c9a4bf1653d15f1a9a435ae33f7a
- https://ubuntu.com/security/notices/USN-4977-1
- https://ubuntu.com/security/notices/USN-4983-1
- https://www.cve.org/CVERecord?id=CVE-2021-3501
comments:
  debian/bwh: |-
    I have checked that internal.ndata was not used this way in earlier
    versions.
  debian/carnil: |-
    Commit fixes 1aa561b1a4c0 ("kvm: x86: Add "last CPU" to some
    KVM_EXIT information") introduced in 5.9-rc1, so need check if
    the vulnerability itself still would be present in earlier
    versions.
  wens: Introduced in v5.9-rc1; fixed in v5.12-rc8.
reporters:
- Reiji Watanabe
introduced-by:
  mainline: [1aa561b1a4c0ae2a9a9b9c21a84b5ca66b4775d8]
fixed-by:
  cip/5.10: [7f64753835a78c7d2cc2932a5808ef3b7fd4c050]
  cip/5.10-rt: [7f64753835a78c7d2cc2932a5808ef3b7fd4c050]
  mainline: [04c4f2ee3f68c9a4bf1653d15f1a9a435ae33f7a]
  stable/5.10: [7f64753835a78c7d2cc2932a5808ef3b7fd4c050]
  stable/5.11: [ce541d7b59566a0d94c7c99bfb5d34b050e6af70]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: ['version:5.4.0-26.30']
