description: eBPF 32-bit source register truncation on div/mod
references:
- https://www.openwall.com/lists/oss-security/2021/06/23/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3600
- https://git.kernel.org/linus/e88b2c6e5a4d9ce30d75391e4d950da74bb2bd90
- https://ubuntu.com/security/notices/USN-5003-1
comments:
  debian/carnil: |-
    Introduced by 68fda450a7df ("bpf: fix 32-bit divide by zero")
    in 4.15-rc9 (and was backported to 4.9.79). Though the specifc
    attach will not work on v4.9.y as pointer arithmetic is
    prohibited on those kernels.
  ubuntu/sbeattie: |-
    4.15 kernels the only ubuntu kernels that have not yet had
      the fix applied
    for 4.15 kernels, f6b1b3bf0d5f ("bpf: fix subprog verifier
      bypass by div/mod by 0 exception") is needed as a prerequisite but
      introduces CVE-2021-3444
fixed-by:
  stable/5.10: [1d16cc210fabd0a7ebf52d3025f81c2bde054a90]
