description: eBPF 32-bit source register truncation on div/mod
references:
- https://www.openwall.com/lists/oss-security/2021/06/23/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3600
- https://git.kernel.org/linus/e88b2c6e5a4d9ce30d75391e4d950da74bb2bd90
- https://ubuntu.com/security/notices/USN-5003-1
comments:
  debian/carnil: |-
    Introduced by 68fda450a7df ("bpf: fix 32-bit divide by zero")
    in 4.15-rc9 (and was backported to 4.9.79). Though the specifc
    attach will not work on v4.9.y as pointer arithmetic is
    prohibited on those kernels.
  ubuntu/cascardo: |-
    Commit f1174f77b50c is also necessary to exploit, and is
      not present on 4.4 kernels.
  ubuntu/sbeattie: |-
    4.15 kernels the only ubuntu kernels that have not yet had
      the fix applied
    for 4.15 kernels, f6b1b3bf0d5f ("bpf: fix subprog verifier
      bypass by div/mod by 0 exception") is needed as a prerequisite but
      introduces CVE-2021-3444
fixed-by:
  mainline: [e88b2c6e5a4d9ce30d75391e4d950da74bb2bd90]
  stable/5.10: [1d16cc210fabd0a7ebf52d3025f81c2bde054a90]
  stable/5.4: [78e2f71b89b22222583f74803d14f3d90cdf9d12]
  ubuntu/bionic: [4657e4b025dea92911ce604aa00e42533e230091, daffc40978a42a27e15f10279fa62ddf28b8f111,
    057c07614ae29b93fbc1b4a7dbcff2d9b2a70c1b]
  ubuntu/focal: [fb879541a1dfa646457a915a1c9fa6a1eb92ad33]
  ubuntu/groovy: [7412151b942868df262dd2f37cd5b00c53607240]
