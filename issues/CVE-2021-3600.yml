description: eBPF 32-bit source register truncation on div/mod
references:
- https://www.openwall.com/lists/oss-security/2021/06/23/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3600
- https://git.kernel.org/linus/e88b2c6e5a4d9ce30d75391e4d950da74bb2bd90
- https://kernel.ubuntu.com/git/ubuntu/ubuntu-bionic.git/commit/kernel/bpf/verifier.c?h=Ubuntu-4.15.0-147.151&id=057c07614ae29b93fbc1b4a7dbcff2d9b2a70c1b
- https://lore.kernel.org/stable/YSd1q9Llm1vsWbXT@mussarela/T/#t
- https://ubuntu.com/security/notices/USN-5003-1
- https://www.cve.org/CVERecord?id=CVE-2021-3600
comments:
  debian/bwh: |-
    For 4.9, commits f6b1b3bf0d5f "bpf: fix subprog verifier bypass by
    div/mod by 0 exception" and d405c7407a54 "bpf: allocate 0x06 to new
    eBPF instruction class JMP32" etc. need to be applied first.
  debian/carnil: |-
    Introduced by 68fda450a7df ("bpf: fix 32-bit divide by zero")
    in 4.15-rc9 (and was backported to 4.9.79). Though the specifc
    attack will not work on v4.9.y as pointer arithmetic is
    prohibited on those kernels.
  ubuntu/cascardo: |-
    Commit f1174f77b50c is also necessary to exploit, and is
      not present on 4.4 kernels.
  ubuntu/sbeattie: |-
    4.15 kernels the only ubuntu kernels that have not yet had
      the fix applied
    for 4.15 kernels, f6b1b3bf0d5f ("bpf: fix subprog verifier
      bypass by div/mod by 0 exception") is needed as a prerequisite but
      introduces CVE-2021-3444
introduced-by:
  cip/4.4: [02662601a231f8721930168ce71d84bcfb8d9a96]
  cip/4.4-rt: [02662601a231f8721930168ce71d84bcfb8d9a96]
  cip/4.4-st: [02662601a231f8721930168ce71d84bcfb8d9a96]
  mainline: [68fda450a7df51cff9e5a4d4a4d9d0d5f2589153]
  stable/4.14: [ca0a0967205b65a197dccb80688f3588cc14d745]
  stable/4.4: [02662601a231f8721930168ce71d84bcfb8d9a96]
  stable/4.9: [265d7657c9baf09d57eb386d0374e912e9649626]
  ubuntu/xenial: [83194a1b77e8d0c11b43fc6315e336edfa2b0452]
fixed-by:
  cip/4.19: [8313432df224d926590731ec3ace3e1bd7bc4a1a]
  cip/4.19-rt: [8313432df224d926590731ec3ace3e1bd7bc4a1a]
  cip/5.10: [1d16cc210fabd0a7ebf52d3025f81c2bde054a90]
  cip/5.10-rt: [1d16cc210fabd0a7ebf52d3025f81c2bde054a90]
  debian/buster-security: ['version:debian/4.19.208-1']
  debian/stretch-security: ['patch:stretch-security:bugfix/all/bpf-fix-32-bit-src-register-truncation-on-div-mod.patch']
  mainline: [e88b2c6e5a4d9ce30d75391e4d950da74bb2bd90]
  stable/4.19: [8313432df224d926590731ec3ace3e1bd7bc4a1a]
  stable/5.10: [1d16cc210fabd0a7ebf52d3025f81c2bde054a90]
  stable/5.4: [78e2f71b89b22222583f74803d14f3d90cdf9d12]
  ubuntu/bionic: [4657e4b025dea92911ce604aa00e42533e230091, daffc40978a42a27e15f10279fa62ddf28b8f111,
    057c07614ae29b93fbc1b4a7dbcff2d9b2a70c1b]
  ubuntu/focal: [fb879541a1dfa646457a915a1c9fa6a1eb92ad33]
  ubuntu/groovy: [7412151b942868df262dd2f37cd5b00c53607240]
ignore:
  debian/stretch-security: EOL
