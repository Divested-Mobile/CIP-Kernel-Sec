description: UAF in sco_send_frame function
references:
- https://www.openwall.com/lists/oss-security/2021/07/22/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3640
- https://bugzilla.suse.com/show_bug.cgi?id=1188172
- https://x-lore.kernel.org/all/20210810041410.142035-1-desmondcheongzx@gmail.com/
- https://x-lore.kernel.org/all/20210828161818.31141-1-tiwai@suse.de/
- https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=99c23da0eed4fd20cae8243f2b51e10e66aa0951
- https://x-lore.kernel.org/all/15f5a46.b79d9.17ba6802ccd.Coremail.linma@zju.edu.cn/
- https://x-lore.kernel.org/all/883dc4b7-d1a1-3d31-a5a8-8fa1791084b6@i-love.sakura.ne.jp/
comments:
  debian/carnil: |-
    Prerequisites before the "last piece for fixing CVE-2021-3640"
    are e04480920d1e ("Bluetooth: defer cleanup of resources in
    hci_unregister_dev()") and 734bc5ff7831 ("Bluetooth: avoid
    circular locks in sco_sock_connect"), ba316be1b6a0 ("Bluetooth:
    schedule SCO timeouts with delayed_work"), 27c24fda62b6
    ("Bluetooth: switch to lock_sock in SCO")
  masami: there is no fixed information as of 2021/07/26.
  ubuntu/sbeattie: Possibly addressed by Desmond Cheong Zhi Xi's patchset.
