description: UAF in sco_send_frame function
references:
- https://www.openwall.com/lists/oss-security/2021/07/22/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3640
- https://bugzilla.suse.com/show_bug.cgi?id=1188172
- https://x-lore.kernel.org/all/20210810041410.142035-1-desmondcheongzx@gmail.com/
- https://x-lore.kernel.org/all/20210828161818.31141-1-tiwai@suse.de/
- https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=99c23da0eed4fd20cae8243f2b51e10e66aa0951
- https://x-lore.kernel.org/all/15f5a46.b79d9.17ba6802ccd.Coremail.linma@zju.edu.cn/
- https://x-lore.kernel.org/all/883dc4b7-d1a1-3d31-a5a8-8fa1791084b6@i-love.sakura.ne.jp/
- https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/net/bluetooth/sco.c?id=99c23da0eed4fd20cae8243f2b51e10e66aa0951
- https://bugzilla.redhat.com/show_bug.cgi?id=1980646
- https://ubuntu.com/security/notices/USN-5265-1
- https://ubuntu.com/security/notices/USN-5267-1
- https://ubuntu.com/security/notices/USN-5268-1
- https://ubuntu.com/security/notices/USN-5267-3
- https://www.cve.org/CVERecord?id=CVE-2021-3640
comments:
  debian/carnil: |-
    Prerequisites before the "last piece for fixing CVE-2021-3640"
    are e04480920d1e ("Bluetooth: defer cleanup of resources in
    hci_unregister_dev()") and 734bc5ff7831 ("Bluetooth: avoid
    circular locks in sco_sock_connect"), ba316be1b6a0 ("Bluetooth:
    schedule SCO timeouts with delayed_work"), 27c24fda62b6
    ("Bluetooth: switch to lock_sock in SCO")
    For 5.15.y fixed as well in 5.15.3
  masami: |-
    there is no fixed information as of 2021/07/26.
    Fixed in bluetooth-next tree. commit 99c23da0eed4fd20cae8243f2b51e10e66aa0951.
  pavel: We are one patch away from fixing this 5.10, 27c24fda62b6 is needed.
  ubuntu/sbeattie: |-
    Possibly addressed by Desmond Cheong Zhi Xi's patchset.
    may need additional prerequisite commits
fixed-by:
  cip/4.19: [c1c913f797f3d2441310182ad75b7bd855a327ff, 3719acc161d5c1ce09912cc1c9eddc2c5faa3c66,
    3f7b869c1b44108a8cbf3e4a763ddac9df548d73, 728ff4b213cb6d66505e545ab820f3de5be1662a,
    48669c81a65628ef234cbdd91b9395952c7c27fe]
  cip/4.19-rt: [c1c913f797f3d2441310182ad75b7bd855a327ff, 3719acc161d5c1ce09912cc1c9eddc2c5faa3c66,
    3f7b869c1b44108a8cbf3e4a763ddac9df548d73, 728ff4b213cb6d66505e545ab820f3de5be1662a,
    48669c81a65628ef234cbdd91b9395952c7c27fe]
  cip/4.4: [f632f88fe209240f5cad853e33f74fda4d341004, d6ef8bb00aa65eceb413fc165a55086459863e38]
  cip/4.4-rt: [f632f88fe209240f5cad853e33f74fda4d341004, d6ef8bb00aa65eceb413fc165a55086459863e38]
  cip/4.4-st: [f632f88fe209240f5cad853e33f74fda4d341004, d6ef8bb00aa65eceb413fc165a55086459863e38]
  cip/5.10: [4dfba42604f08a505f1a1efc69ec5207ea6243de, f2f856b65ac4b77049c76c0e89ecd3a177e9fcd1,
    98d44b7be6f1bcfd4f824c5f8bc2b742f890879f, c20d8c197454068da758a83e09d93683f520d681,
    a1073aad497d0d071a71f61b721966a176d50c08]
  cip/5.10-rt: [4dfba42604f08a505f1a1efc69ec5207ea6243de, f2f856b65ac4b77049c76c0e89ecd3a177e9fcd1,
    98d44b7be6f1bcfd4f824c5f8bc2b742f890879f, c20d8c197454068da758a83e09d93683f520d681,
    a1073aad497d0d071a71f61b721966a176d50c08]
  debian/buster-security: ['version:debian/4.19.232-1']
  debian/stretch-security: ['version:debian/4.9.303-1']
  mainline: [99c23da0eed4fd20cae8243f2b51e10e66aa0951, e04480920d1eec9c061841399aa6f35b6f987d8b,
    734bc5ff783115aa3164f4e9dd5967ae78e0a8ab, 49d8a5606428ca0962d09050a5af81461ff90fbb,
    ba316be1b6a00db7126ed9a39f9bee434a508043, 27c24fda62b601d6f9ca5e992502578c4310876f]
  stable/4.19: [c1c913f797f3d2441310182ad75b7bd855a327ff, 3719acc161d5c1ce09912cc1c9eddc2c5faa3c66,
    3f7b869c1b44108a8cbf3e4a763ddac9df548d73, 728ff4b213cb6d66505e545ab820f3de5be1662a,
    48669c81a65628ef234cbdd91b9395952c7c27fe]
  stable/4.9: [9bbe312ebea40c9b586c2b07a0d0948ff418beca, 0e77f979a97d3d517fad0b51249ba6fb8ae2d365,
    2240cbbd0d710c3b07ef5380fb6a1dfaedaf980b]
  stable/5.10: [4dfba42604f08a505f1a1efc69ec5207ea6243de, f2f856b65ac4b77049c76c0e89ecd3a177e9fcd1,
    98d44b7be6f1bcfd4f824c5f8bc2b742f890879f, c20d8c197454068da758a83e09d93683f520d681,
    a1073aad497d0d071a71f61b721966a176d50c08]
  stable/5.14: [2c2b295af72e4e30d17556375e100ae65ac0b896, e04480920d1eec9c061841399aa6f35b6f987d8b,
    9ebb5a7757073da64d10a12621d0cedaca3aa215, db63399389bc3f6b0d146f8020ca243a6b700d9d,
    b657bba82ff6a007d84fd076bd73b11131726a2b]
  stable/5.15: [b990c219c4c9d4993ef65ea9db73d9497e70f697, e04480920d1eec9c061841399aa6f35b6f987d8b,
    734bc5ff783115aa3164f4e9dd5967ae78e0a8ab, 11080de0a75cba7e00c1060d60ea484615d7a3d3,
    ba316be1b6a00db7126ed9a39f9bee434a508043, 27c24fda62b601d6f9ca5e992502578c4310876f]
  stable/5.4: [d416020f1a9cc5f903ae66649b2c56d9ad5256ab, ff29fe26ab8679bc13a3f0bf5b2911535a1cfc35,
    0d563020b8a3b835afa5c902610de700808546ec, 6237a1685c28c93b6477db46fbf67b7f0a0139e6,
    37d7ae2b0578f2373674a755402ee722e96edc08]
  ubuntu/bionic: [579ccd1afb58d9e74c33993317304c90fef1355a]
  ubuntu/focal: [310f4a921b7a8c09f82b602b226014023264a2b9]
