description: UAF in sco_send_frame function
references:
- https://www.openwall.com/lists/oss-security/2021/07/22/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3640
- https://bugzilla.suse.com/show_bug.cgi?id=1188172
- https://x-lore.kernel.org/all/20210810041410.142035-1-desmondcheongzx@gmail.com/
- https://x-lore.kernel.org/all/20210828161818.31141-1-tiwai@suse.de/
- https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=99c23da0eed4fd20cae8243f2b51e10e66aa0951
- https://x-lore.kernel.org/all/15f5a46.b79d9.17ba6802ccd.Coremail.linma@zju.edu.cn/
- https://x-lore.kernel.org/all/883dc4b7-d1a1-3d31-a5a8-8fa1791084b6@i-love.sakura.ne.jp/
- https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/net/bluetooth/sco.c?id=99c23da0eed4fd20cae8243f2b51e10e66aa0951
- https://bugzilla.redhat.com/show_bug.cgi?id=1980646
comments:
  debian/carnil: |-
    Prerequisites before the "last piece for fixing CVE-2021-3640"
    are e04480920d1e ("Bluetooth: defer cleanup of resources in
    hci_unregister_dev()") and 734bc5ff7831 ("Bluetooth: avoid
    circular locks in sco_sock_connect"), ba316be1b6a0 ("Bluetooth:
    schedule SCO timeouts with delayed_work"), 27c24fda62b6
    ("Bluetooth: switch to lock_sock in SCO")
    For 5.15.y fixed as well in 5.15.3
  masami: |-
    there is no fixed information as of 2021/07/26.
    Fixed in bluetooth-next tree. commit 99c23da0eed4fd20cae8243f2b51e10e66aa0951.
  ubuntu/sbeattie: Possibly addressed by Desmond Cheong Zhi Xi's patchset.
  pavel: We are one patch away from fixing this 5.10, 27c24fda62b6 is needed.
fixed-by:
  mainline: [99c23da0eed4fd20cae8243f2b51e10e66aa0951,
            e04480920d1eec9c061841399aa6f35b6f987d8b,
            734bc5ff783115aa3164f4e9dd5967ae78e0a8ab,
            49d8a5606428ca0962d09050a5af81461ff90fbb,
            ba316be1b6a00db7126ed9a39f9bee434a508043,
            27c24fda62b601d6f9ca5e992502578c4310876f,
            734bc5ff783115aa3164f4e9dd5967ae78e0a8ab,
            ba316be1b6a00db7126ed9a39f9bee434a508043]
  stable/5.10: [4dfba42604f08a505f1a1efc69ec5207ea6243de,
               f2f856b65ac4b77049c76c0e89ecd3a177e9fcd1,
               98d44b7be6f1bcfd4f824c5f8bc2b742f890879f,
               c20d8c197454068da758a83e09d93683f520d681,
               a1073aad497d0d071a71f61b721966a176d50c08,
               98d44b7be6f1bcfd4f824c5f8bc2b742f890879f,
               a1073aad497d0d071a71f61b721966a176d50c08]
  stable/5.14: [2c2b295af72e4e30d17556375e100ae65ac0b896]
  stable/5.15: [b990c219c4c9d4993ef65ea9db73d9497e70f697]
  stable/5.4: [d416020f1a9cc5f903ae66649b2c56d9ad5256ab]
