description: 'crypto: ccp - fix resource leaks in ccp_run_aes_gcm_cmd()'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2000627
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3744
- https://www.openwall.com/lists/oss-security/2021/09/14/1
- https://seclists.org/oss-sec/2021/q3/164
- https://ubuntu.com/security/notices/USN-5139-1
- https://ubuntu.com/security/notices/USN-5140-1
- https://ubuntu.com/security/notices/USN-5161-1
- https://ubuntu.com/security/notices/USN-5162-1
- https://ubuntu.com/security/notices/USN-5163-1
- https://ubuntu.com/security/notices/USN-5164-1
- https://www.cve.org/CVERecord?id=CVE-2021-3744
comments:
  debian/bwh: |-
    Introduced in 4.12 by commit 36cf515b9bbe "crypto: ccp - Enable support
    for AES GCM on v5 CCPs".
  masami: |-
    This vunerability affects to AMD Cryptographic Coprocessor (CCP) driver.
    Vulnerability has been introduced since 4.12-rc1 so before 4.12 kernels
    aren't affected this vulnerability.
reporters:
- minihanshen(沈明航)
introduced-by:
  mainline: [36cf515b9bbe298e1ce7384620f0d4ec45ad3328]
fixed-by:
  cip/4.19: [710be7c42d2f724869e5b18b21998ceddaffc4a9]
  cip/4.19-rt: [710be7c42d2f724869e5b18b21998ceddaffc4a9]
  cip/5.10: [17ccc64e4fa5d3673528474bfeda814d95dc600a]
  cip/5.10-rt: [17ccc64e4fa5d3673528474bfeda814d95dc600a]
  debian/buster-security: ['version:debian/4.19.232-1']
  mainline: [505d9dcb0f7ddf9d075e729523a33d38642ae680]
  openela/4.14: [3707e37b3fcef4d5e9a81b9c2c48ba7248051c2a]
  stable/4.14: [3707e37b3fcef4d5e9a81b9c2c48ba7248051c2a]
  stable/4.19: [710be7c42d2f724869e5b18b21998ceddaffc4a9]
  stable/5.10: [17ccc64e4fa5d3673528474bfeda814d95dc600a]
  stable/5.14: [e450c422aa233e9f80515f2ee9164e33f158a472]
  stable/5.4: [24f3d2609114f1e1f6b487b511ce5fa36f21e0ae]
  ubuntu/bionic: [4adb7a2d241088b9bf0b08f1e4e5c93f3dd6da7b]
  ubuntu/focal: [f42078b398f35ebacd15d135a61aa005027bde06]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  stable/4.4: Not affected
  stable/4.9: Not affected
