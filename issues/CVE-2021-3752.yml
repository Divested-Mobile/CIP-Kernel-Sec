description: UAF in bluetooth
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3752
- https://www.openwall.com/lists/oss-security/2021/09/15/4
- https://bugzilla.suse.com/show_bug.cgi?id=1190023
- https://lore.kernel.org/lkml/20210714031733.1395549-1-bobo.shaobowang@huawei.com/
- https://lore.kernel.org/linux-bluetooth/D89E06B8-8B36-494B-BD2E-21815F562E90@holtmann.org/T/#t
- https://bugzilla.redhat.com/show_bug.cgi?id=1999544
- https://ubuntu.com/security/notices/USN-5265-1
- https://ubuntu.com/security/notices/USN-5267-1
- https://ubuntu.com/security/notices/USN-5268-1
- https://ubuntu.com/security/notices/USN-5267-3
- https://ubuntu.com/security/notices/USN-5505-1
- https://ubuntu.com/security/notices/USN-5513-1
- https://www.cve.org/CVERecord?id=CVE-2021-3752
comments:
  debian/carnil: |-
    With the presence of 3af70b39fa2d ("Bluetooth: check for zapped
    sk before connecting") in 5.13-rc1 (and 5.10.38, 4.19.191) this
    bug is not easy to trigger itself.
  masami: |-
    According to the suse bugzilla, commit 3af70b39fa2d415dc86c370e5b24ddb9fd
    in mainline makes harder to abuse this vulnarability. The patch "Bluetooth: fix use-after-free error in lock_sock_nested()"
    has been merged into bluetooth-next tree.
  ubuntu/sbeattie: |-
    this is more difficult to trigger due to the presence of
      3af70b39fa2d415dc86c370e5b24ddb9fdacbd6f
reporters:
- Likang Luo
fixed-by:
  cip/4.19: [72bb30165337b7bce77578ad151fbfab6c8e693c]
  cip/4.19-rt: [72bb30165337b7bce77578ad151fbfab6c8e693c]
  cip/4.4: [88aed7d67197d155260f09078835290adfa1debd]
  cip/4.4-rt: [88aed7d67197d155260f09078835290adfa1debd]
  cip/4.4-st: [88aed7d67197d155260f09078835290adfa1debd]
  cip/5.10: [c10465f6d6208db2e45a6dac1db312b9589b2583]
  cip/5.10-rt: [c10465f6d6208db2e45a6dac1db312b9589b2583]
  debian/buster-security: ['version:debian/4.19.232-1']
  debian/stretch-security: ['version:debian/4.9.303-1']
  mainline: [1bff51ea59a9afb67d2dd78518ab0582a54a472c]
  openela/4.14: [cd76d797a690969186c0c100e8a301c4480e4e7f]
  stable/4.14: [cd76d797a690969186c0c100e8a301c4480e4e7f]
  stable/4.19: [72bb30165337b7bce77578ad151fbfab6c8e693c]
  stable/4.4: [88aed7d67197d155260f09078835290adfa1debd]
  stable/4.9: [d19ea7da0eeb61be28ec05d8b8bddec3dde71610]
  stable/5.10: [c10465f6d6208db2e45a6dac1db312b9589b2583]
  stable/5.15: [7e22e4db95b04f09adcce18c75d27cbca8f53b99]
  stable/5.4: [67bd269a84ce29dfc543c1683a2553b4169f9a55]
  ubuntu/bionic: [74bf349003f7a93573a3c81386b2dc1aad7fcdb0]
  ubuntu/focal: [9d7bf5a8be35ea4d9aee6f85adf7d14b4bd4f4f6]
