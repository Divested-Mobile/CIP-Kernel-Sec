description: |-
  arch/powerpc/perf/core-book3s.c in the Linux kernel before 5.12.13, on
  systems with perf_event_paranoid=-1 and no specific PMU driver support
  registered, allows local users to cause a denial of service
  (perf_instruction_pointer NULL pointer dereference and OOPS) via a "perf
  record" command.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38200
- https://github.com/torvalds/linux/commit/60b7ed54a41b550d50caf7f2418db4a7e75b5bdc
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.12.13
- https://ubuntu.com/security/notices/USN-5070-1
- https://www.cve.org/CVERecord?id=CVE-2021-38200
comments:
  debian/carnil: |-
    Commit fixes 2ca13a4cc56c ("powerpc/perf: Use regs->nip when
    SIAR is zero") so might not affect earlier versions.
  masami: This CVE affects PowerPC architecture.
introduced-by:
  mainline: [2ca13a4cc56c920a6c9fc8ee45d02bccacd7f46c]
fixed-by:
  mainline: [60b7ed54a41b550d50caf7f2418db4a7e75b5bdc]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: No member uses PPC architecture
  cip/4.19-rt: No member uses PPC architecture
  cip/4.4: No member uses PPC archtiecture
  cip/4.4-rt: No member uses PPC architecture
  cip/5.10: No member uses PPC architecture
