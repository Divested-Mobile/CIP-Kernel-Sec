description: 'bpf, mips: Validate conditional branch offsets'
references:
- https://lore.kernel.org/bpf/20210915160437.4080-1-piotras@gmail.com/
- https://www.openwall.com/lists/oss-security/2021/09/15/5
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=37cb28ec7d3a36a5bace7063a3dba633ab110f8b
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-38300
- https://www.cve.org/CVERecord?id=CVE-2021-38300
comments:
  debian/bwh: 'Introduced in 3.16 by commit c6610de353da "MIPS: net: Add BPF JIT"'
  masami: This CVE only affects to mips architecture.
  ubuntu/sbeattie: |-
    MIPS only
    break entry may be newer than c6610de353da5ca6, introduction
      of ebpf jit for MIPS.
introduced-by:
  mainline: [36366e367ee93ced84fddb8fae6675e12985f5a4, c6610de353da5ca6eee5b8960e838a87a90ead0c]
  stable/5.4: [7ed040244595db01e765d58d3fdc2d3817f55934, c6610de353da5ca6eee5b8960e838a87a90ead0c]
  ubuntu/focal: [101ae36fa360017a9f14a26268ffc87495a9f64e, c6610de353da5ca6eee5b8960e838a87a90ead0c]
fixed-by:
  cip/4.19: [79f3a086dfc34887f9bbb0801768608b9470e942]
  cip/4.19-rt: [79f3a086dfc34887f9bbb0801768608b9470e942]
  cip/5.10: [c61736a994fe68b0e5498e4e84e1c9108dc41075]
  cip/5.10-rt: [c61736a994fe68b0e5498e4e84e1c9108dc41075]
  debian/buster-security: ['version:debian/4.19.232-1']
  mainline: [37cb28ec7d3a36a5bace7063a3dba633ab110f8b]
  stable/4.14: [3401bca8827ba4918b3d582bd2c27708d4b133fe]
  stable/4.19: [79f3a086dfc34887f9bbb0801768608b9470e942]
  stable/5.10: [c61736a994fe68b0e5498e4e84e1c9108dc41075]
  stable/5.14: [dbe853968d4dea820fccd9c7107a5d797fa30ff3]
  stable/5.4: [1a0fe45501a273ac52252448e43f975f0c18811e]
  ubuntu/bionic: [84999d2273ee33816241c4067a5db5d39186d0bf]
  ubuntu/focal: [427638fbdffc54c0bb848dec3d20e103bf120856]
ignore:
  cip/4.4: mips is not supported in CIP
  cip/4.4-rt: mips is not supported in CIP
  cip/4.4-st: mips is not supported in CIP
  debian/stretch-security: mips not supported in LTS
