description: Linux Kernel USB Gadget buffer overflow
references:
- https://www.openwall.com/lists/oss-security/2021/12/15/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39685
- https://github.com/szymonh/inspector-gadget
- https://ubuntu.com/security/notices/USN-5278-1
- https://ubuntu.com/security/notices/USN-5294-1
- https://ubuntu.com/security/notices/USN-5294-2
- https://ubuntu.com/security/notices/USN-5297-1
- https://ubuntu.com/security/notices/USN-5298-1
- https://ubuntu.com/security/notices/USN-5337-1
- https://ubuntu.com/security/notices/USN-5368-1
- https://ubuntu.com/security/notices/USN-5505-1
- https://ubuntu.com/security/notices/USN-5513-1
- https://www.cve.org/CVERecord?id=CVE-2021-39685
comments:
  debian/carnil: Fixed as well in 5.15.8 for 5.15.y.
  ubuntu/sbeattie: |-
    likely introduces subtle regression that needs
      f08adf5add9a ("USB: gadget: bRequestType is a bitfield, not a enum")
      to address
reporters:
- Szymon Heidrich
fixed-by:
  cip/4.19: [13e45e7a262dd96e8161823314679543048709b9, 32de5efd483db68f12233fbf63743a2d92f20ae4]
  cip/4.19-rt: [13e45e7a262dd96e8161823314679543048709b9, 32de5efd483db68f12233fbf63743a2d92f20ae4]
  cip/4.4: [93cd7100fe471c5f76fb942358de4ed70dbcaf35, af21211c327c4703c7681fa7286c4d660682e413]
  cip/4.4-rt: [93cd7100fe471c5f76fb942358de4ed70dbcaf35, af21211c327c4703c7681fa7286c4d660682e413]
  cip/4.4-st: [93cd7100fe471c5f76fb942358de4ed70dbcaf35, af21211c327c4703c7681fa7286c4d660682e413]
  cip/5.10: [7193ad3e50e596ac2192531c58ba83b9e6d2444b, e4de8ca013f06ad4a0bf40420a291c23990e4131]
  cip/5.10-rt: [7193ad3e50e596ac2192531c58ba83b9e6d2444b, e4de8ca013f06ad4a0bf40420a291c23990e4131]
  debian/buster-security: ['version:debian/4.19.232-1']
  debian/stretch-security: ['version:debian/4.9.303-1']
  mainline: [153a2d7e3350cc89d406ba2d35be8793a64c2038, 86ebbc11bb3f60908a51f3e41a17e3f477c2eaa3]
  openela/4.14: [e7c8afee149134b438df153b09af7fd928a8bc24, d8cd524ae4ec788011a14be17503fc224f260fe3]
  stable/4.14: [e7c8afee149134b438df153b09af7fd928a8bc24, d8cd524ae4ec788011a14be17503fc224f260fe3]
  stable/4.19: [13e45e7a262dd96e8161823314679543048709b9, 32de5efd483db68f12233fbf63743a2d92f20ae4]
  stable/4.4: [93cd7100fe471c5f76fb942358de4ed70dbcaf35, af21211c327c4703c7681fa7286c4d660682e413]
  stable/4.9: [d2ca6859ea96c6d4c6ad3d6873a308a004882419, e4de8ca013f06ad4a0bf40420a291c23990e4131]
  stable/5.10: [7193ad3e50e596ac2192531c58ba83b9e6d2444b, e4de8ca013f06ad4a0bf40420a291c23990e4131]
  stable/5.15: [36dfdf11af49d3c009c711fb16f5c6e7a274505d, 6eea4ace62fa6414432692ee44f0c0a3d541d97a]
  stable/5.4: [fd6de5a0cd42fc43810bd74ad129d98ab962ec6b, 9978777c5409d6c856cac1adf5930e3c84f057be]
  ubuntu/bionic: [5dc190b7241881252a65b1498297f92aa46bfdee, 92261b75a54a4d6f9ef3cb8e4d3a80f4466ddc80]
  ubuntu/focal: [82d1e1ca4dc0a57b04b551d21c63e3ad2ec6baa2, c53d3373a1fbf1350177afbf43dd151f6e3649e4]
