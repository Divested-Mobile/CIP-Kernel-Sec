description: 'bpf: fix panic due to oob in bpf_prog_test_run_skb'
references:
- https://source.android.com/security/bulletin/pixel/2022-03-01
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39711
- https://git.kernel.org/linus/6e6fddc78323533be570873abb728b7e0ba7e024
- https://www.cve.org/CVERecord?id=CVE-2021-39711
comments:
  debian/bwh: |-
    Introduced in 4.12 by commit 1cf1cae963c2 "bpf: introduce
    BPF_PROG_TEST_RUN command".
  masami: |-
    OOB bug in bpf BPF_PROG_TEST_RUN command.
    This bug was introduced by commit 1cf1cae
    ("bpf: introduce BPF_PROG_TEST_RUN command") which was merged
    at 4.12-rc1. This bug was fixed in v4.18-rc6.
introduced-by:
  mainline: [1cf1cae963c2e6032aebe1637e995bc2f5d330f4]
fixed-by:
  debian/buster-security: ['version:debian/4.18.6-1']
  mainline: [6e6fddc78323533be570873abb728b7e0ba7e024]
  openela/4.14: [20fdf274472998123a8d173ba4cb6282ff6b63bd]
  stable/4.14: [20fdf274472998123a8d173ba4cb6282ff6b63bd]
  ubuntu/bionic: [eb76bfd69e221729f50bfbdd1733e059946815da]
  ubuntu/focal: ['version:5.4.0-9.12']
