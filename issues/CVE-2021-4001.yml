description: 'bpf: Fix toctou on read-only map''s constant scalar tracking'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2025645
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=353050be4c19e102178ccc05988101887c25ae53
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4001
- https://git.kernel.org/linus/353050be4c19e102178ccc05988101887c25ae53
- https://ubuntu.com/security/notices/USN-5207-1
- https://ubuntu.com/security/notices/USN-5265-1
- https://ubuntu.com/security/notices/USN-5278-1
- https://ubuntu.com/security/notices/USN-6417-1
- https://www.cve.org/CVERecord?id=CVE-2021-4001
comments:
  debian/carnil: |-
    Commit fixes a23740ec43ba ("bpf: Track contents of read-only
    maps as scalars") introduced in 5.5-rc1.
    For 5.15.y series fixed in 5.15.5.
introduced-by:
  mainline: [a23740ec43ba022dbfd139d0fe3eff193216272b]
  stable/5.4: [812ee47ad76ec881ebde1e1764a0711e4b50db2e]
  ubuntu/focal: [b8e3620c71b712fb51dec62a193c9e93788c63ab]
fixed-by:
  cip/5.10: [33fe044f6a9e8977686a6a09f0bf33e5cc75257e]
  cip/5.10-rt: [33fe044f6a9e8977686a6a09f0bf33e5cc75257e]
  mainline: [353050be4c19e102178ccc05988101887c25ae53]
  stable/5.10: [33fe044f6a9e8977686a6a09f0bf33e5cc75257e]
  stable/5.15: [a5d1d3522232b4af1f5dee02d381e6fa86be8e2d]
  ubuntu/focal: [c17f325aca979233b33f2d8ad3579a2a1f335487]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.4: Not affected
  stable/4.9: Not affected
