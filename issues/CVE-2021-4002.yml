description: 'hugetlbfs: flush TLBs correctly after huge_pmd_unshare'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4002
- https://www.openwall.com/lists/oss-security/2021/11/25/1
- https://git.kernel.org/linus/a4a118f2eead1d6c49e00765de89878288d4b890
comments:
  debian/carnil: |-
    For 5.16-rc1 onwards only additionally there is 13e4ad2ce8df
    ("hugetlbfs: flush before unlock on
    move_hugetlb_page_tables()") to be applied.
introduced-by:
  mainline: [24669e58477e2752c1fbca9c1c988e9dd0d79d15]
fixed-by:
  mainline: [a4a118f2eead1d6c49e00765de89878288d4b890]
  stable/5.10: [40bc831ab5f630431010d1ff867390b07418a7ee]
  stable/5.15: [556d59293a2a94863797a7a50890992aa5e8db16]
  stable/5.4: [201340ca4eb748c52062c5e938826ddfbe313088]
  ubuntu/bionic: [e3e7086a2d3c318fe85e9d3dd4a7d90d82286fd1]
  ubuntu/focal: [bbe0decd2e46dc43aaeba9e52010b4e7b7c3b5d2]
