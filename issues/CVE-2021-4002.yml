description: 'hugetlbfs: flush TLBs correctly after huge_pmd_unshare'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4002
- https://www.openwall.com/lists/oss-security/2021/11/25/1
- https://git.kernel.org/linus/a4a118f2eead1d6c49e00765de89878288d4b890
- https://ubuntu.com/security/notices/USN-5206-1
- https://ubuntu.com/security/notices/USN-5207-1
- https://ubuntu.com/security/notices/USN-5208-1
- https://ubuntu.com/security/notices/USN-5209-1
- https://ubuntu.com/security/notices/USN-5210-1
- https://ubuntu.com/security/notices/USN-5211-1
- https://ubuntu.com/security/notices/USN-5218-1
comments:
  debian/carnil: |-
    For 5.16-rc1 onwards only additionally there is 13e4ad2ce8df
    ("hugetlbfs: flush before unlock on
    move_hugetlb_page_tables()") to be applied.
reporters:
- Nadav Amit
introduced-by:
  mainline: [24669e58477e2752c1fbca9c1c988e9dd0d79d15]
fixed-by:
  cip/4.19: [b0313bc7f5fbb6beee327af39d818ffdc921821a]
  cip/4.4: [8a8ae093b52ba76b650b493848d67e7b526c8751]
  cip/4.4-rt: [8a8ae093b52ba76b650b493848d67e7b526c8751]
  cip/5.10: [40bc831ab5f630431010d1ff867390b07418a7ee]
  mainline: [a4a118f2eead1d6c49e00765de89878288d4b890]
  stable/4.14: [7bf1f5cb5150b1a53f6ccaadc0bc77f8f33206c8]
  stable/4.19: [b0313bc7f5fbb6beee327af39d818ffdc921821a]
  stable/4.4: [8a8ae093b52ba76b650b493848d67e7b526c8751]
  stable/4.9: [8e80bf5d001594b037de04fb4fe89f34cfbcb3ba]
  stable/5.10: [40bc831ab5f630431010d1ff867390b07418a7ee]
  stable/5.15: [556d59293a2a94863797a7a50890992aa5e8db16]
  stable/5.4: [201340ca4eb748c52062c5e938826ddfbe313088]
  ubuntu/bionic: [e3e7086a2d3c318fe85e9d3dd4a7d90d82286fd1, af343472a91a769ae79d952c3b269fb8db59b82c,
    6d0743968c8595b543c0ffe68f3587df15d05ff3]
  ubuntu/focal: [bbe0decd2e46dc43aaeba9e52010b4e7b7c3b5d2, a341223a53311144fda301659ac1540233ea4683]
