description: |-
  kernel: kvm: mishandling of memory error during VCPU construction can lead
  to DoS
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4032
- https://access.redhat.com/security/cve/CVE-2021-4032
- https://bugzilla.redhat.com/show_bug.cgi?id=2027403
- https://bugzilla.suse.com/show_bug.cgi?id=1193187
- https://lkml.org/lkml/2021/9/8/587
- https://www.cve.org/CVERecord?id=CVE-2021-4032
comments:
  debian/carnil: |-
    Commit fixes (revert) a change in 5.15-rc1, 421221234ada ("KVM:
    x86: Open code necessary bits of kvm_lapic_set_base() at vCPU
    RESET").
  masami: |-
    According to the suce bugzilla, it was fixed by f7d8a19("Revert \"KVM: x86: Open code necessary bits of kvm_lapic_set_base() at vCPU RESET\"").
    This bug was introduced in 5.15-rc1 and fixed in 5.15-rc7. so before 5.15 kernels aren't affected this issue.
introduced-by:
  mainline: [421221234ada41b4a9f0beeb08e30b07388bd4bd]
fixed-by:
  mainline: [f7d8a19f9a056a05c5c509fa65af472a322abfee]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/5.10: Not affected
  stable/4.19: Not affected
  stable/4.4: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
