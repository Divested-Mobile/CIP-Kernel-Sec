description: 'kernel: Overflow of bmval[bmlen-1] in nfsd4_decode_bitmap function'
references:
- https://lore.kernel.org/linux-nfs/97860.1636837122@crash.local/
- https://lore.kernel.org/linux-nfs/163692036074.16710.5678362976688977923.stgit@klimt.1015granger.net/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4090
- https://bugzilla.redhat.com/show_bug.cgi?id=2025101
- https://git.kernel.org/linus/c0019b7db1d7ac62c711cda6b357a659d46428fe
- https://ubuntu.com/security/notices/USN-5217-1
- https://ubuntu.com/security/notices/USN-5265-1
- https://ubuntu.com/security/notices/USN-5362-1
- https://www.cve.org/CVERecord?id=CVE-2021-4090
comments:
  debian/carnil: |-
    Commit fixes d1c263a031e8 ("NFSD: Replace READ* macros in
    nfsd4_decode_fattr()") 5.15-rc1.
  masami: commit d1c263a031e8 was introduced in 5.11-rc1.
  ubuntu/sbeattie: reproducer in initial report email
introduced-by:
  cip/5.10: [57516a96cae8c0b5ee53e25d141a4f96cbb1000e]
  mainline: [d1c263a031e876ac3ca5223c728e4d98ed50b3c0]
  stable/5.10: [57516a96cae8c0b5ee53e25d141a4f96cbb1000e]
fixed-by:
  cip/5.10: [1abf3ec5587741cbc248c756a1b1bf933ad79506]
  mainline: [c0019b7db1d7ac62c711cda6b357a659d46428fe]
  stable/5.10: [1abf3ec5587741cbc248c756a1b1bf933ad79506]
  stable/5.15: [10c22d9519f3f5939de61a1500aa3a926b778d3a]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.4: Not affected
