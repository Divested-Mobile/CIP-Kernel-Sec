description: '[pNFS/flexfiles: fix incorrect size check in decode_nfs_fh()]'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2034342
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4157
- https://git.kernel.org/linus/ed34695e15aba74f45247f1ee2cf7e09d449f925
- https://lore.kernel.org/lkml/20210517140244.822185482@linuxfoundation.org/
- https://ubuntu.com/security/notices/USN-5413-1
- https://www.cve.org/CVERecord?id=CVE-2021-4157
comments:
  masami: |-
    This OOB write bug was introduced by commit d67ae82 ("pnfs/flexfiles:
    Add the FlexFile Layout Driver") which was merged at 4.0-rc1. A local attacker
    cloud do system crash or escalate privileges on the system.
introduced-by:
  mainline: [d67ae825a59d639e4d8b82413af84d854617a87e]
fixed-by:
  cip/4.19: [f27638a92f77d8107efbaf48a0d3bfa24da8cdad]
  cip/4.19-rt: [f27638a92f77d8107efbaf48a0d3bfa24da8cdad]
  cip/4.4: [0c5ccd5e2a2e291774618c24c459fa397fd1b7da]
  cip/4.4-rt: [0c5ccd5e2a2e291774618c24c459fa397fd1b7da]
  cip/4.4-st: [0c5ccd5e2a2e291774618c24c459fa397fd1b7da]
  cip/5.10: [1fbea60ea658ab887fb899532d783732b04e53e6]
  cip/5.10-rt: [1fbea60ea658ab887fb899532d783732b04e53e6]
  debian/buster-security: ['version:debian/4.19.194-1']
  debian/stretch-security: ['version:debian/4.9.272-1']
  mainline: [ed34695e15aba74f45247f1ee2cf7e09d449f925]
  openela/4.14: [40286f0852d2ecfa713438199557c706dc6a8db3]
  stable/4.14: [40286f0852d2ecfa713438199557c706dc6a8db3]
  stable/4.19: [f27638a92f77d8107efbaf48a0d3bfa24da8cdad]
  stable/4.4: [0c5ccd5e2a2e291774618c24c459fa397fd1b7da]
  stable/4.9: [c621f3654bba1096ec913d0942e27bd032bb6090]
  stable/5.10: [1fbea60ea658ab887fb899532d783732b04e53e6]
  stable/5.4: [89862bd77e9cf511628eb7a97fe7f8d246192eec]
  ubuntu/bionic: [055f618f909d4198aafbd2b2e0b279b06aa268e5]
  ubuntu/focal: [751bbdf1609d66f05c8bf6aac383b970107d1988]
  ubuntu/groovy: [e922258e27627cc7483ddc29756f563cded1bbd8]
