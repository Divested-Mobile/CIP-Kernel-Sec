description: 'bpf: Fix integer overflow in prealloc_elems_and_freelist()'
references:
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=30e29a9a2bc6a4888335a6ede968b75cd329657a
- https://lore.kernel.org/bpf/728b238e-a481-eb50-98e9-b0f430ab01e7@gmail.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41864
- https://github.com/torvalds/linux/commit/30e29a9a2bc6a4888335a6ede968b75cd329657a
- https://ubuntu.com/security/notices/USN-5139-1
- https://ubuntu.com/security/notices/USN-5140-1
- https://ubuntu.com/security/notices/USN-5208-1
- https://ubuntu.com/security/notices/USN-5209-1
- https://ubuntu.com/security/notices/USN-5210-1
- https://ubuntu.com/security/notices/USN-5218-1
comments:
  debian/carnil: |-
    Commit fixes 557c0c6e7df8 ("bpf: convert stackmap to pre-
    allocation").
    Fixed as well in 5.14.12 in the 5.14.y series.
  masami: Commit 557c0c6e7df8 has been merged since 4.6-rc1.
introduced-by:
  mainline: [557c0c6e7df8e14a46bd7560d193fa5bbc00a858]
fixed-by:
  cip/4.19: [078cdd572408176a3900a6eb5a403db0da22f8e0]
  cip/4.19-rt: [078cdd572408176a3900a6eb5a403db0da22f8e0]
  cip/5.10: [064faa8e8a9b50f5010c5aa5740e06d477677a89]
  cip/5.10-rt: [064faa8e8a9b50f5010c5aa5740e06d477677a89]
  debian/buster-security: ['version:debian/4.19.232-1']
  debian/stretch-security: ['version:debian/4.9.290-1']
  mainline: [30e29a9a2bc6a4888335a6ede968b75cd329657a]
  stable/4.14: [f34bcd10c4832d491049905d25ea3f46a410c426]
  stable/4.19: [078cdd572408176a3900a6eb5a403db0da22f8e0]
  stable/4.9: [4fd6663eb01bc3c73143cd27fefd7b8351bc6aa6]
  stable/5.10: [064faa8e8a9b50f5010c5aa5740e06d477677a89]
  stable/5.14: [3a1ac1e368bedae2777d9a7cfdc65df4859f7e71]
  stable/5.4: [b14f28126c51533bb329379f65de5b0dd689b13a]
  ubuntu/bionic: [64b6339b33d410b3b89b75904dad59edcff0eec9]
  ubuntu/focal: [099d292a80feae17dcdfc6ca7eab98cb835de699]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  stable/4.4: Not affected
