description: 'cgroup: Use open-time creds and namespace for migration perm checks'
references:
- https://lore.kernel.org/lkml/20211209214707.805617-1-tj@kernel.org/T/
- https://bugzilla.redhat.com/show_bug.cgi?id=2035652
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4197
comments:
  debian/carnil: Fixed as well in 5.15.14 for 5.15.y.
  masami: |-
    commit 1756d79 fixed commit 187fe84 ("cgroup: require write perm on common
    ancestor when moving processes on the default hierarchy") that was merged in 4.2-rc1 and
    commit e574576 fixd commit 5136f63 ("cgroup: implement "nsdelegate" mount option") that
    was merged in 4.13-rc1.
    Commit 1756d79 ("cgroup: Use open-time credentials for process migraton perm checks") was
    failed to apply to 4.4, 4.9, 4.14, 4.19, 5.4, and 5.10.
    Commit 0d2b595 ("cgroup: Allocate cgroup_file_ctx for kernfs_open_file->priv") was failed
    to apply to 4.14, 4.19, 5.4, and 5.10.
    Commit e574576 ("cgroup: Use open-time cgroup namespace for process migration perm checks")
    was failed to apply 4.14, 4.19, 5.4, 5.10.
fixed-by:
  mainline: [1756d7994ad85c2479af6ae5a9750b92324685af, 0d2b5955b36250a9428c832664f2079cbf723bec,
    e57457641613fef0d147ede8bd6a3047df588b95]
  stable/5.15: [c6ebc35298848accb5e50c37fdb2490cf4690c92, 50273128d640e8d21a13aec5f4bbce4802f17d7d,
    43fa0b3639c5fd48c96b19d645d0c7ff2327651a]
