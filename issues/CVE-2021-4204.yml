description: eBPF Improper Input Validation Vulnerability
references:
- https://www.openwall.com/lists/oss-security/2022/01/11/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4204
- https://ubuntu.com/security/notices/USN-5217-1
- https://ubuntu.com/security/notices/USN-5218-1
- https://git.launchpad.net/~ubuntu-kernel/ubuntu/+source/linux/+git/impish/commit/?id=53fb7741ff9d546174dbb585957b4f8b6afbdb83
- https://ubuntu.com/security/notices/USN-5219-1
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1956585
- https://www.openwall.com/lists/oss-security/2022/06/04/2
- https://github.com/tr3ee/CVE-2021-4204
- https://www.cve.org/CVERecord?id=CVE-2021-4204
comments:
  debian/carnil: |-
    Similar issue with CVE-2021-34866.
    To be checked, fixed as well with the refactoring in
    c25b2ae13603 ("bpf: Replace PTR_TO_XXX_OR_NULL with PTR_TO_XXX
    | PTR_MAYBE_NULL")?
    Introduced after 457f44363a88 ("bpf: Implement BPF ring buffer
    and verifier support for it") in 5.8-rc1.
    Fixed as well in 5.15.17 for 5.15.y.
    The main fix seems to be 64620e0a1e71 ("bpf: Fix out of bounds
    access for ringbuf helpers") but has pre-requisite work done.
  masami: |-
    This bug was affected from 5.8 or later. commit 457f4436 ("bpf: Implement BPF ring buffer and verifier support for it")
    introduced this issues.
reporters:
- tr3e wang
introduced-by:
  mainline: [457f44363a8894135c85b7a9afd2bd8196db24ab]
fixed-by:
  mainline: [be80a1d3f9dbe5aee79a325964f7037fe2d92f30, d400a6cf1c8a57cdf10f35220ead3284320d85ff,
    6788ab23508bddb0a9d88e104284922cb2c22b77, 64620e0a1e712a778095bd35cbb277dc2259281f,
    a672b2e36a648afb04ad3bda93b6bda947a479a5, 722e4db3ae0d52b2e3801280afbe19cf2d188e91,
    37c8d4807d1b8b521b30310dce97f6695dc2c2c6]
  ubuntu/focal: ['version:5.4.0-9.12']
