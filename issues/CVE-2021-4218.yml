description: 'sysctl: pass kernel pointers to ->proc_handler'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2048359
- https://bugs.centos.org/view.php?id=18395
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4218
- https://www.cve.org/CVERecord?id=CVE-2021-4218
comments:
  debian/bwh: |-
    This issue is specific to CentOS/RHEL. In mainline,
    xprtrdma always used copy_to_user() until the general
    conversion of sysctls to use a kernel buffer.
  masami: |-
    commit 3292739 ("sysctl: pass kernel pointers to ->proc_handler")
    was merged in 5.8-rc1.
introduced-by:
  mainline: [df971cd853c05778ae1175e8aeb80a04bb9d4be5]
fixed-by:
  mainline: [32927393dc1ccd60fb2bdc05b9e8e88753761469]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/5.10: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
  stable/5.16: Not affected
