description: |-
  An issue was discovered in aspeed_lpc_ctrl_mmap in
  drivers/soc/aspeed/aspeed-lpc-ctrl.c in the Linux kernel before 5.14.6.
  Local attackers able to access the Aspeed LPC control interface could
  overwrite memory in the kernel and potentially execute privileges, aka
  CID-b49a0e69a7b1. This occurs because a certain comparison uses values that
  are not memory sizes.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42252
- https://git.kernel.org/linus/b49a0e69a7b1a68c8d3f64097d06dabb770fec96
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b49a0e69a7b1a68c8d3f64097d06dabb770fec96
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.14.6
- https://ubuntu.com/security/notices/USN-5136-1
- https://ubuntu.com/security/notices/USN-5137-1
- https://ubuntu.com/security/notices/USN-5161-1
- https://ubuntu.com/security/notices/USN-5162-1
- https://www.cve.org/CVERecord?id=CVE-2021-42252
comments:
  masami: This bug has been introduced since 4.12-rc1.
  ubuntu/sbeattie: |-
    CONFIG_ASPEED_LPC_CTRL is only enabled on armhf platforms in
      Ubuntu
introduced-by:
  mainline: [6c4e976785011dfbe461821d0bfc58cfd60eac56]
fixed-by:
  cip/4.19: [9c8891b638319ddba9cfa330247922cd960c95b0]
  cip/4.19-rt: [9c8891b638319ddba9cfa330247922cd960c95b0]
  cip/5.10: [3fdf2feb6cbe76c6867224ed8527b356e805352c]
  cip/5.10-rt: [3fdf2feb6cbe76c6867224ed8527b356e805352c]
  debian/buster-security: ['version:debian/4.19.208-1']
  mainline: [b49a0e69a7b1a68c8d3f64097d06dabb770fec96]
  openela/4.14: [b1b55e4073d3da6119ecc41636a2994b67a2be37]
  stable/4.14: [b1b55e4073d3da6119ecc41636a2994b67a2be37]
  stable/4.19: [9c8891b638319ddba9cfa330247922cd960c95b0]
  stable/5.10: [3fdf2feb6cbe76c6867224ed8527b356e805352c]
  stable/5.14: [865f5ba9fdfc3ac6acabcac9630056ce99db600d]
  stable/5.4: [2712f29c44f18db826c7e093915a727b6f3a20e4]
  ubuntu/bionic: [48d6e192f82aa35f3a637ec7579deade77ed3d67]
  ubuntu/focal: [e166abc0c5baf28ecceca008e807ac6715fe0009]
