description: |-
  The check_alu_op() function in kernel/bpf/verifier.c in the Linux kernel
  through v5.16-rc5 did not properly update bounds while handling the mov32
  instruction, which allows local users to obtain potentially sensitive
  address information, aka a "pointer leak."
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45402
- https://git.kernel.org/linus/3cf2b61eb06765e27fec6799292d9fb46d0b7e60
- https://git.kernel.org/linus/b1a7288dedc6caf9023f2676b4f5ed34cf0d4029
- https://git.kernel.org/linus/e572ff80f05c33cd0cb4860f864f5c9c044280b6
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=b1a7288dedc6caf9023f2676b4f5ed34cf0d4029
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=3cf2b61eb06765e27fec6799292d9fb46d0b7e60
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=e572ff80f05c33cd0cb4860f864f5c9c044280b6
- https://ubuntu.com/security/notices/USN-5337-1
- https://ubuntu.com/security/notices/USN-5368-1
- https://www.cve.org/CVERecord?id=CVE-2021-45402
comments:
  debian/carnil: |-
    Commit fixes 3f50f132d840 ("bpf: Verifier, do explicit ALU32
    bounds tracking") in v5.7-rc1.
  ubuntu/sbeattie: add kernel tests in b1a7288dedc6caf9023f2676b4f5ed34cf0d4029
reporters:
- Kuee K1r0a
introduced-by:
  mainline: [3f50f132d8400e129fc9eb68b5020167ef80a244]
fixed-by:
  cip/5.10: [e2aad0b5f2cbf71a31d00ce7bb4dee948adff5a9, 279e0bf80d95184666c9d41361b1625c045d1dcb]
  cip/5.10-rt: [e2aad0b5f2cbf71a31d00ce7bb4dee948adff5a9, 279e0bf80d95184666c9d41361b1625c045d1dcb]
  mainline: [3cf2b61eb06765e27fec6799292d9fb46d0b7e60, e572ff80f05c33cd0cb4860f864f5c9c044280b6]
  stable/5.10: [e2aad0b5f2cbf71a31d00ce7bb4dee948adff5a9, 279e0bf80d95184666c9d41361b1625c045d1dcb]
  stable/5.15: [f77d7a35d4913e4ab27abb36016fbfc1e882a654, dbda060d50abbe91ca76010078742ca53264bfa6]
  ubuntu/focal: ['version:5.4.0-9.12']
