description: 'net: Make tcp_allowed_congestion_control readonly in non-init netns'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46912
- https://lore.kernel.org/linux-cve-announce/2024022708-CVE-2021-46912-d07b@gregkh/T/#u
- https://git.kernel.org/linus/97684f0970f6e112926de631fdd98d9693c7e5c1
- https://git.kernel.org/stable/c/35d7491e2f77ce480097cabcaf93ed409e916e12
- https://git.kernel.org/stable/c/1ccdf1bed140820240e383ba0accc474ffc7f006
- https://git.kernel.org/stable/c/97684f0970f6e112926de631fdd98d9693c7e5c1
comments:
  debian/carnil: |-
    Introduced in 9cb8e048e5d9 ("net/ipv4/sysctl: show tcp_{allowed,
    available}_congestion_control in non-initial netns"). Vulnerable versions:
    5.7-rc1.
  masami: |-
    Introduced by commit 31c4d2f: ("net: Ensure net namespace isolation of 
    sysctls") in 5.7-rc1. This commit is not backported to older stable kernels.
    Fixed in 5.12-rc8.
introduced-by:
  mainline: [9cb8e048e5d93825ec5e8dfb5b8df4987ea25745]
fixed-by:
  cip/5.10: [35d7491e2f77ce480097cabcaf93ed409e916e12]
  cip/5.10-rt: [35d7491e2f77ce480097cabcaf93ed409e916e12]
  mainline: [97684f0970f6e112926de631fdd98d9693c7e5c1]
  stable/5.10: [35d7491e2f77ce480097cabcaf93ed409e916e12]
  ubuntu/groovy: [aff8f2ae9c20f9ca0ecd77f54171bd8f779b19a3]
