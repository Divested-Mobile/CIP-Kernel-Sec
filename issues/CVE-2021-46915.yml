description: 'netfilter: nft_limit: avoid possible divide error in nft_limit_init'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46915
- https://lore.kernel.org/linux-cve-announce/2024022709-CVE-2021-46915-7ded@gregkh/T/#u
- https://git.kernel.org/linus/b895bdf5d643b6feb7c60856326dd4feb6981560
- https://git.kernel.org/stable/c/9065ccb9ec92c5120e7e97958397ebdb454f23d6
- https://git.kernel.org/stable/c/fadd3c4afdf3d4c21f4d138502f8b76334987e26
- https://git.kernel.org/stable/c/01fb1626b620cb37a65ad08e0f626489e8f042ef
- https://git.kernel.org/stable/c/dc1732baa9da5b68621586bf8636ebbc27dc62d2
- https://git.kernel.org/stable/c/1bb3ee4259936cc3b2d80a4a480bbb4868575071
- https://git.kernel.org/stable/c/b895bdf5d643b6feb7c60856326dd4feb6981560
- https://www.cve.org/CVERecord?id=CVE-2021-46915
comments:
  debian/carnil: |-
    Introduced in c26844eda9d4 ("netfilter: nf_tables: Fix nft limit burst
    handling")
    3e0f64b7dd31 ("netfilter: nft_limit: fix packet ratelimiting"). Vulnerable
    versions: 4.13 4.14.54 4.17.
  masami: "Introduced by commit c26844e (\"netfilter: nf_tables: Fix nft limit burst\
    \ \nhandling\") in 4.13 and 3e0f64b (\"netfilter: nft_limit: fix packet \nratelimiting\"\
    ) in 4.17. Fixed in 5.12-rc8. 4.4 is not affected."
introduced-by:
  mainline: [c26844eda9d4fdbd266660e3b3de2d0270e3a1ed, 3e0f64b7dd3149f75e8652ff1df56cffeedc8fc1]
  ubuntu/bionic: [c26844eda9d4fdbd266660e3b3de2d0270e3a1ed, 2a5976a5ff4a50464794e967d8bcc411868f2add]
fixed-by:
  cip/4.19: [fadd3c4afdf3d4c21f4d138502f8b76334987e26]
  cip/4.19-rt: [fadd3c4afdf3d4c21f4d138502f8b76334987e26]
  cip/5.10: [dc1732baa9da5b68621586bf8636ebbc27dc62d2]
  cip/5.10-rt: [dc1732baa9da5b68621586bf8636ebbc27dc62d2]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [b895bdf5d643b6feb7c60856326dd4feb6981560]
  stable/4.19: [fadd3c4afdf3d4c21f4d138502f8b76334987e26]
  stable/5.10: [dc1732baa9da5b68621586bf8636ebbc27dc62d2]
  stable/5.4: [01fb1626b620cb37a65ad08e0f626489e8f042ef]
  ubuntu/bionic: [2296fde280d58166824e2dc49ecca144bad38455]
  ubuntu/focal: [644a7d501c4440e461e601442bb7fe1f6974dead]
  ubuntu/groovy: [f964651564046d9a7802b6ef9e0878fcc53db2ba]
