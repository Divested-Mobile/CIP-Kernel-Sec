description: 'fs/mount_setattr: always cleanup mount_kattr'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46923
- https://lore.kernel.org/linux-cve-announce/2024022745-CVE-2021-46923-a1ec@gregkh/T/#u
- https://git.kernel.org/linus/012e332286e2bb9f6ac77d195f17e74b2963d663
- https://git.kernel.org/stable/c/47b5d0a7532d39e42a938f81e3904268145c341d
- https://git.kernel.org/stable/c/012e332286e2bb9f6ac77d195f17e74b2963d663
- https://www.cve.org/CVERecord?id=CVE-2021-46923
comments:
  debian/carnil: |-
    Introduced in 9caccd41541a ("fs: introduce MOUNT_ATTR_IDMAP"). Vulnerable
    versions: 5.12-rc1.
  masami: "Introduced by commit 9caccd4 (\"fs: introduce MOUNT_ATTR_IDMAP\") in \n\
    5.12-rc1-dontuse.\nThis commit is not backported to older stable kernels.\nFixed\
    \ in 5.16-rc8."
introduced-by:
  mainline: [9caccd41541a6f7d6279928d9f971f6642c361af]
fixed-by:
  mainline: [012e332286e2bb9f6ac77d195f17e74b2963d663]
  stable/5.15: [47b5d0a7532d39e42a938f81e3904268145c341d]
