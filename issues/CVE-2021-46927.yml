description: 'nitro_enclaves: Use get_user_pages_unlocked() call to handle mmap assert'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46927
- https://lore.kernel.org/linux-cve-announce/2024022749-CVE-2021-46927-ae70@gregkh/T/#u
- https://git.kernel.org/linus/3a0152b219523227c2a62a0a122cf99608287176
- https://git.kernel.org/stable/c/90d2beed5e753805c5eab656b8d48257638fe543
- https://git.kernel.org/stable/c/3a0152b219523227c2a62a0a122cf99608287176
- https://www.cve.org/CVERecord?id=CVE-2021-46927
comments:
  debian/carnil: |-
    Introduced in 5b78ed24e8ec ("mm/pagemap: add mmap_assert_locked() annotations
    to find_vma*()"). Vulnerable versions: 5.15-rc1.
  masami: "Introduced by commit 5b78ed2 (\"mm/pagemap: add mmap_assert_locked() annotations\
    \ \nto find_vma*()\") in 5.15-rc1.\nThis commit is not backported to older stable\
    \ kernels.\nFixed in 5.16-rc8."
introduced-by:
  mainline: [5b78ed24e8ec48602c1d6f5a188e58d000c81e2b]
fixed-by:
  mainline: [3a0152b219523227c2a62a0a122cf99608287176]
  stable/5.15: [90d2beed5e753805c5eab656b8d48257638fe543]
