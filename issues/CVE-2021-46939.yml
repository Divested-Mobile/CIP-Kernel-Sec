description: 'tracing: Restructure trace_clock_global() to never block'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46939
- https://lore.kernel.org/linux-cve-announce/20240227184057.2368370-4-gregkh@linuxfoundation.org/T/#u
- https://git.kernel.org/linus/aafe104aa9096827a429bc1358f8260ee565b7cc
- https://git.kernel.org/stable/c/91ca6f6a91f679c8645d7f3307e03ce86ad518c4
- https://git.kernel.org/stable/c/859b47a43f5a0e5b9a92b621dc6ceaad39fb5c8b
- https://git.kernel.org/stable/c/1fca00920327be96f3318224f502e4d5460f9545
- https://git.kernel.org/stable/c/d43d56dbf452ccecc1ec735cd4b6840118005d7c
- https://git.kernel.org/stable/c/c64da3294a7d59a4bf6874c664c13be892f15f44
- https://git.kernel.org/stable/c/a33614d52e97fc8077eb0b292189ca7d964cc534
- https://git.kernel.org/stable/c/6e2418576228eeb12e7ba82edb8f9500623942ff
- https://git.kernel.org/stable/c/2a1bd74b8186d7938bf004f5603f25b84785f63e
- https://git.kernel.org/stable/c/aafe104aa9096827a429bc1358f8260ee565b7cc
- https://www.cve.org/CVERecord?id=CVE-2021-46939
- https://ubuntu.com/security/notices/USN-6778-1
comments:
  debian/carnil: |-
    Introduced in b02414c8f045 ("ring-buffer: Fix recursion protection transitions
    between interrupt context") # started showing the problem
    14131f2f98ac3 ("tracing: implement trace_clock_*() APIs") # where the bug
    happened. Vulnerable versions: 2.6.30-rc1 4.4.244 4.9.244 4.14.207 4.19.156
    5.4.76 5.9.7 5.10-rc3.
  masami: "Introduced by commit b02414c (\"ring-buffer: Fix recursion protection transitions\n\
    between interrupt context\") # started showing the problem in 5.10-rc3 \nand 14131f2\
    \ (\"tracing: implement trace_clock_*() APIs\") in 2.6.30-rc1.\nThe commit b02414c\
    \ is backported to older stable kernels.\nFixed in 5.13-rc1."
introduced-by:
  cip/4.19: [b410d07e965a039dc67073889dab9ff01cee8402, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  cip/4.19-rt: [b410d07e965a039dc67073889dab9ff01cee8402, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  cip/4.4: [47f1d1fe0cfaddb87cedbf3e2929f6edfe20ed16, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  cip/4.4-rt: [47f1d1fe0cfaddb87cedbf3e2929f6edfe20ed16, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  cip/4.4-st: [47f1d1fe0cfaddb87cedbf3e2929f6edfe20ed16, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  mainline: [b02414c8f045ab3b9afc816c3735bc98c5c3d262, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  stable/4.19: [b410d07e965a039dc67073889dab9ff01cee8402, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  stable/5.4: [aef59b5e5bdfc800f0e7aec7e74a33e98bf142c0, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  ubuntu/bionic: [cd44d8ef77fe8869aa830cbeee5c1530e9b14df0, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  ubuntu/focal: [aa3e15c3a5790cd21257c09c25e7cc7c836bd545, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  ubuntu/groovy: [42fa636b474d041d17a0bbad248a89cae8d9160e, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
  ubuntu/xenial: [178ddd634e2c7fc95aef91e6c9a16e458bbc5ff9, 14131f2f98ac350ee9e73faed916d2238a8b6a0d]
fixed-by:
  cip/4.19: [d43d56dbf452ccecc1ec735cd4b6840118005d7c]
  cip/4.19-rt: [d43d56dbf452ccecc1ec735cd4b6840118005d7c]
  cip/4.4: [91ca6f6a91f679c8645d7f3307e03ce86ad518c4]
  cip/4.4-rt: [91ca6f6a91f679c8645d7f3307e03ce86ad518c4]
  cip/4.4-st: [91ca6f6a91f679c8645d7f3307e03ce86ad518c4]
  cip/5.10: [a33614d52e97fc8077eb0b292189ca7d964cc534]
  cip/5.10-rt: [a33614d52e97fc8077eb0b292189ca7d964cc534]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [aafe104aa9096827a429bc1358f8260ee565b7cc]
  stable/4.19: [d43d56dbf452ccecc1ec735cd4b6840118005d7c]
  stable/4.4: [91ca6f6a91f679c8645d7f3307e03ce86ad518c4]
  stable/5.10: [a33614d52e97fc8077eb0b292189ca7d964cc534]
  stable/5.4: [c64da3294a7d59a4bf6874c664c13be892f15f44]
  ubuntu/bionic: [a29acd21373ee3f2f1ab3d5696e5240f500ec5e7]
  ubuntu/focal: [237993d5c1a0768e620b7ab2211855bae84c4277]
  ubuntu/groovy: [96834bde1c04d012cf74969159afaa105b29cb8d]
