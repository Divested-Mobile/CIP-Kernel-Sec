description: 'tpm: efi: Use local variable for calculating final log size'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46951
- https://lore.kernel.org/linux-cve-announce/20240227184057.2368370-16-gregkh@linuxfoundation.org/T/#u
- https://git.kernel.org/linus/48cff270b037022e37835d93361646205ca25101
- https://git.kernel.org/stable/c/2f12258b5224cfaa808c54fd29345f3c1cbfca76
- https://git.kernel.org/stable/c/60a01ecc9f68067e4314a0b55148e39e5d58a51b
- https://git.kernel.org/stable/c/3818b753277f5ca0c170bf5b98e0a5a225542fcb
- https://git.kernel.org/stable/c/ac07c557ca12ec9276c0375517bac7ae5be4e50c
- https://git.kernel.org/stable/c/48cff270b037022e37835d93361646205ca25101
- https://www.cve.org/CVERecord?id=CVE-2021-46951
comments:
  debian/carnil: |-
    Introduced in 166a2809d65b ("tpm: Don't duplicate events from the final event
    log in the TCG2 log"). Vulnerable versions: 5.3-rc1.
  masami: |-
    Introduced by commit 166a280 ("tpm: Don't duplicate events from the final event
    log in the TCG2 log") in 5.3-rc1.
    This commit is not backported to older stable kernels.
    Fixed in 5.13-rc1.
introduced-by:
  mainline: [166a2809d65b282272c474835ec22c882a39ca1b]
fixed-by:
  cip/5.10: [60a01ecc9f68067e4314a0b55148e39e5d58a51b]
  cip/5.10-rt: [60a01ecc9f68067e4314a0b55148e39e5d58a51b]
  mainline: [48cff270b037022e37835d93361646205ca25101]
  stable/5.10: [60a01ecc9f68067e4314a0b55148e39e5d58a51b]
  stable/5.4: [2f12258b5224cfaa808c54fd29345f3c1cbfca76]
  ubuntu/focal: [367d073da90230780b349c6d49eea9cbf81a0539]
  ubuntu/groovy: [cc2e85c999d64ea34f342b89f71214c96f317f0a]
