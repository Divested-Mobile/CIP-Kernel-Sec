description: 'btrfs: fix race between transaction aborts and fsyncs leading to use-after-free'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46958
- https://lore.kernel.org/linux-cve-announce/2024022718-CVE-2021-46958-53ff@gregkh/T/#u
- https://git.kernel.org/linus/061dde8245356d8864d29e25207aa4daa0be4d3c
- https://git.kernel.org/stable/c/a4794be7b00b7eda4b45fffd283ab7d76df7e5d6
- https://git.kernel.org/stable/c/633f7f216663587f17601eaa1cf2ac3d5654874c
- https://git.kernel.org/stable/c/e2da98788369bfba1138bada72765c47989a4338
- https://git.kernel.org/stable/c/061dde8245356d8864d29e25207aa4daa0be4d3c
- https://www.cve.org/CVERecord?id=CVE-2021-46958
- https://lore.kernel.org/linux-cve-announce/2024022718-CVE-2021-46958-53ff@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit ef67963 ("btrfs: drop logs when we've aborted a transaction") in v5.7-rc4.
    Fixed in v5.13-rc1.
  debian/carnil: |-
    Introduced in ef67963dac255b ("btrfs: drop logs when we've aborted a
    transaction"). Vulnerable versions: 5.7-rc4.
  masami: |-
    Introduced by commit ef67963 ("btrfs: drop logs when we've aborted a
    transaction") in 5.7-rc4.
    This commit is not backported to older stable kernels.
    Fixed in 5.13-rc1.
introduced-by:
  mainline: [ef67963dac255b293e19815ea3d440567be4626f]
fixed-by:
  cip/5.10: [a4794be7b00b7eda4b45fffd283ab7d76df7e5d6]
  cip/5.10-rt: [a4794be7b00b7eda4b45fffd283ab7d76df7e5d6]
  mainline: [061dde8245356d8864d29e25207aa4daa0be4d3c]
  stable/5.10: [a4794be7b00b7eda4b45fffd283ab7d76df7e5d6]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: [9e20844997bddf4b089c873eb0abb6b6623f8017]
