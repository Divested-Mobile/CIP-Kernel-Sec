description: 'spi: Fix use-after-free with devm_spi_alloc_*'
references:
- https://lore.kernel.org/linux-cve-announce/2024022916-CVE-2021-46959-f517@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46959
comments:
  debian/carnil: |-
    Introduced in 5e844cc37a5c ("spi: Introduce device-managed SPI controller
    allocation"). Vulnerable versions: 4.4.248 4.9.248 4.14.212 4.19.163 5.4.80
    5.9.11 5.10-rc5.
  masami: |-
    Introduced by commit 5e844cc ("spi: Introduce device-managed SPI controller 
    allocation") in 5.10-rc5. This commit is backported to older stable kernels. 
    Fixed in 5.13-rc1.
introduced-by:
  cip/4.19: [234b432c7b6184b2d6c5ba2c55f0dd5023c0edf0]
  cip/4.19-rt: [234b432c7b6184b2d6c5ba2c55f0dd5023c0edf0]
  cip/4.4: [a4add022c1552b0d51a0b89a4781919d6ebac4f9]
  cip/4.4-rt: [a4add022c1552b0d51a0b89a4781919d6ebac4f9]
  cip/4.4-st: [a4add022c1552b0d51a0b89a4781919d6ebac4f9]
  mainline: [5e844cc37a5cbaa460e68f9a989d321d63088a89]
  stable/4.19: [234b432c7b6184b2d6c5ba2c55f0dd5023c0edf0]
  stable/5.4: [3e04a4976addbedcad326f47b0dd4efc570a1fac]
  ubuntu/bionic: [6efb1400fe49d7daf90f6f8a05c09db54fa6bdf2]
  ubuntu/focal: [f5f70b735cf33211bad614b8e6a4c1a68415b469]
  ubuntu/groovy: [e831fdb262c0123bd46a490d50b26b58397084ae]
  ubuntu/xenial: [b2ba23721142ecc93f7cfbd618d94d50e0bcd2b6]
fixed-by:
  cip/4.19: [28a5529068c51cdf0295ab1e11a99a3a909a03e4]
  cip/4.19-rt: [28a5529068c51cdf0295ab1e11a99a3a909a03e4]
  cip/4.4: [62bb2c7f2411a0045c24831f11ecacfc35610815]
  cip/4.4-rt: [62bb2c7f2411a0045c24831f11ecacfc35610815]
  cip/4.4-st: [62bb2c7f2411a0045c24831f11ecacfc35610815]
  cip/5.10: [c7fabe372a9031acd00498bc718ce27c253abfd1]
  cip/5.10-rt: [c7fabe372a9031acd00498bc718ce27c253abfd1]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [794aaf01444d4e765e2b067cba01cc69c1c68ed9]
  stable/4.19: [28a5529068c51cdf0295ab1e11a99a3a909a03e4]
  stable/5.10: [c7fabe372a9031acd00498bc718ce27c253abfd1]
  stable/5.4: [001c8e83646ad3b847b18f6ac55a54367d917d74]
  ubuntu/bionic: [9ade07bb382749e266da7bb23a2364d1cbc72f56]
  ubuntu/focal: [4069b553a1d984c247103130c7b62711df321ed2]
  ubuntu/groovy: [bdc8f012705183010b310592dbb84a3814eb000d]
