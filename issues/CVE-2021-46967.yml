description: 'vhost-vdpa: fix vm_flags for virtqueue doorbell mapping'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46967
- https://lore.kernel.org/linux-cve-announce/2024022720-CVE-2021-46967-c991@gregkh/T/#u
- https://git.kernel.org/linus/3a3e0fad16d40a2aa68ddf7eea4acdf48b22dd44
- https://git.kernel.org/stable/c/3b8b6399666a29daa30b0bb3f5c9e3fc81c5a6a6
- https://git.kernel.org/stable/c/940230a5c31e2714722aee04c521a21f484b4df7
- https://git.kernel.org/stable/c/93dbbf20e3ffad14f04227a0b7105f6e6f0387ce
- https://git.kernel.org/stable/c/3a3e0fad16d40a2aa68ddf7eea4acdf48b22dd44
- https://www.cve.org/CVERecord?id=CVE-2021-46967
- https://lore.kernel.org/linux-cve-announce/2024022720-CVE-2021-46967-c991@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit ddd89d0 ("vhost_vdpa: support doorbell mapping via mmap") in v5.8-rc1.
    Fixed in v5.13-rc1.
  debian/carnil: |-
    Introduced in ddd89d0a059d ("vhost_vdpa: support doorbell mapping via mmap").
    Vulnerable versions: 5.8-rc1.
  masami: "Introduced by commit ddd89d0 (\"vhost_vdpa: support doorbell mapping via\
    \ mmap\") \nin 5.8-rc1.\nThis commit is not backported to older stable kernels.\n\
    Fixed in 5.13-rc1."
introduced-by:
  mainline: [ddd89d0a059d8e9740c75a97e0efe9bf07ee51f9]
fixed-by:
  cip/5.10: [3b8b6399666a29daa30b0bb3f5c9e3fc81c5a6a6]
  cip/5.10-rt: [3b8b6399666a29daa30b0bb3f5c9e3fc81c5a6a6]
  mainline: [3a3e0fad16d40a2aa68ddf7eea4acdf48b22dd44]
  stable/5.10: [3b8b6399666a29daa30b0bb3f5c9e3fc81c5a6a6]
  ubuntu/focal: ['version:5.4.0-9.12']
  ubuntu/groovy: [db63446d1c489b576e9e0f6f2b3ee55c17e66ee4]
