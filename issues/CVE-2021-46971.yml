description: 'perf/core: Fix unconditional security_locked_down() call'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46971
- https://lore.kernel.org/linux-cve-announce/2024022721-CVE-2021-46971-9534@gregkh/T/#u
- https://git.kernel.org/linus/08ef1af4de5fe7de9c6d69f1e22e51b66e385d9b
- https://git.kernel.org/stable/c/b246759284d6a2bc5b6f1009caeeb3abce2ec9ff
- https://git.kernel.org/stable/c/4348d3b5027bc3ff6336368b6c60605d4ef8e1ce
- https://git.kernel.org/stable/c/f5809ca4c311b71bfaba6d13f4e39eab0557895e
- https://git.kernel.org/stable/c/c7b0208ee370b89d20486fae71cd9abb759819c1
- https://git.kernel.org/stable/c/08ef1af4de5fe7de9c6d69f1e22e51b66e385d9b
- https://www.cve.org/CVERecord?id=CVE-2021-46971
comments:
  debian/carnil: |-
    Introduced in b0c8fdc7fdb7 ("lockdown: Lock down perf when in confidentiality
    mode"). Vulnerable versions: 5.4-rc1.
  masami: "Introduced by commit b0c8fdc (\"lockdown: Lock down perf when in confidentiality\
    \ \nmode\") in 5.4-rc1. This commit is not backported to older stable kernels.\n\
    Fixed in 5.13-rc1."
introduced-by:
  mainline: [b0c8fdc7fdb77586c3d1937050925b960743306e]
fixed-by:
  cip/5.10: [4348d3b5027bc3ff6336368b6c60605d4ef8e1ce]
  cip/5.10-rt: [4348d3b5027bc3ff6336368b6c60605d4ef8e1ce]
  mainline: [08ef1af4de5fe7de9c6d69f1e22e51b66e385d9b]
  stable/5.10: [4348d3b5027bc3ff6336368b6c60605d4ef8e1ce]
  stable/5.4: [b246759284d6a2bc5b6f1009caeeb3abce2ec9ff]
  ubuntu/focal: [0906253151f36d8e7fafe2533a497ebbe4f32309]
  ubuntu/groovy: [0e931788e9f6c30fe17a972a334840dfda934525]
