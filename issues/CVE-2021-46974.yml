description: 'bpf: Fix masking negation logic upon negative dst register'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46974
- https://lore.kernel.org/linux-cve-announce/2024022721-CVE-2021-46974-0852@gregkh/T/#u
- https://git.kernel.org/linus/b9b34ddbe2076ade359cd5ce7537d5ed019e9807
- https://git.kernel.org/stable/c/4d542ddb88fb2f39bf7f14caa2902f3e8d06f6ba
- https://git.kernel.org/stable/c/0e2dfdc74a7f4036127356d42ea59388f153f42c
- https://git.kernel.org/stable/c/53e0db429b37a32b8fc706d0d90eb4583ad13848
- https://git.kernel.org/stable/c/2cfa537674cd1051a3b8111536d77d0558f33d5d
- https://git.kernel.org/stable/c/6eba92a4d4be8feb4dc33976abac544fa99d6ecc
- https://git.kernel.org/stable/c/7cf64d8679ca1cb20cf57d6a88bfee79a0922a66
- https://git.kernel.org/stable/c/b9b34ddbe2076ade359cd5ce7537d5ed019e9807
- https://www.cve.org/CVERecord?id=CVE-2021-46974
comments:
  debian/carnil: |-
    Introduced in 979d63d50c0c ("bpf: prevent out of bounds speculation on pointer
    arithmetic"). Vulnerable versions: 4.14.113 4.19.19 4.20.6 5.0-rc1.
  masami: |-
    Introduced by commit 979d63d ("bpf: prevent out of bounds speculation on
    pointer arithmetic") in 5.0-rc1.
    This commit is backported to 4.19. Linux 4.4 is not affected.
    Fixed in 5.13-rc1.
introduced-by:
  cip/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  cip/4.19-rt: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  mainline: [979d63d50c0c0f7bc537bf821e056cc9fe5abd38]
  stable/4.14: [ae03b6b1c880a03d4771257336dc3bca156dd51b]
  stable/4.19: [f92a819b4cbef8c9527d9797110544b2055a4b96]
  ubuntu/bionic: [010150ffa72a14d593933da6c4f1f336e2d1cdcf]
fixed-by:
  cip/4.19: [0e2dfdc74a7f4036127356d42ea59388f153f42c]
  cip/4.19-rt: [0e2dfdc74a7f4036127356d42ea59388f153f42c]
  cip/5.10: [2cfa537674cd1051a3b8111536d77d0558f33d5d]
  cip/5.10-rt: [2cfa537674cd1051a3b8111536d77d0558f33d5d]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [b9b34ddbe2076ade359cd5ce7537d5ed019e9807]
  stable/4.14: [4d542ddb88fb2f39bf7f14caa2902f3e8d06f6ba]
  stable/4.19: [0e2dfdc74a7f4036127356d42ea59388f153f42c]
  stable/5.10: [2cfa537674cd1051a3b8111536d77d0558f33d5d]
  stable/5.4: [53e0db429b37a32b8fc706d0d90eb4583ad13848]
  ubuntu/bionic: [0e6575f8f2bc3f34c1e72201b51fff230f5ffb01]
  ubuntu/focal: [a5c9dafc390c3d6a855b388089580c9c39ab4ab0]
  ubuntu/groovy: [2e15465fa0e2735f4959d1ba72774cb65ebfef10]
