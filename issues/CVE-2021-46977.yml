description: 'KVM: VMX: Disable preemption when probing user return MSRs'
references:
- https://lore.kernel.org/linux-cve-announce/2024022822-CVE-2021-46977-76be@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46977
- https://git.kernel.org/linus/5104d7ffcf24749939bea7fdb5378d186473f890
- https://git.kernel.org/stable/c/31f29749ee970c251b3a7e5b914108425940d089
- https://git.kernel.org/stable/c/5adcdeb57007ccf8ab7ac20bf787ffb6fafb1a94
- https://git.kernel.org/stable/c/e3ea1895df719c4ef87862501bb10d95f4177bed
- https://git.kernel.org/stable/c/5104d7ffcf24749939bea7fdb5378d186473f890
- https://www.cve.org/CVERecord?id=CVE-2021-46977
comments:
  debian/carnil: |-
    Introduced in 4be534102624 ("KVM: VMX: Initialize vmx->guest_msrs[] right after
    allocation"). Vulnerable versions: 5.5-rc1.
  masami: "Introduced by commit 4be5341 (\"KVM: VMX: Initialize vmx->guest_msrs[]\
    \ right after \nallocation\") in 5.5-rc1. This commit is not backported to older\
    \ stable kernels. \nFixed in 5.13-rc2."
introduced-by:
  mainline: [4be5341026246870818e28b53202b001426a5aec]
fixed-by:
  cip/5.10: [31f29749ee970c251b3a7e5b914108425940d089]
  cip/5.10-rt: [31f29749ee970c251b3a7e5b914108425940d089]
  mainline: [5104d7ffcf24749939bea7fdb5378d186473f890]
  stable/5.10: [31f29749ee970c251b3a7e5b914108425940d089]
  ubuntu/focal: ['version:5.4.0-9.12']
