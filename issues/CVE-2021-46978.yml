description: 'KVM: nVMX: Always make an attempt to map eVMCS after migration'
references:
- https://lore.kernel.org/linux-cve-announce/2024022822-CVE-2021-46978-3516@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46978
- https://git.kernel.org/linus/f5c7e8425f18fdb9bdb7d13340651d7876890329
- https://git.kernel.org/stable/c/c8bf64e3fb77cc19bad146fbe26651985b117194
- https://git.kernel.org/stable/c/200a45649ab7361bc80c70aebf7165b64f9a6c9f
- https://git.kernel.org/stable/c/bd0e8455b85b651a4c77de9616e307129b15aaa7
- https://git.kernel.org/stable/c/f5c7e8425f18fdb9bdb7d13340651d7876890329
comments:
  debian/carnil: |-
    Introduced in f2c7ef3ba955 ("KVM: nSVM: cancel KVM_REQ_GET_NESTED_STATE_PAGES
    on nested vmexit"). Vulnerable versions: 5.10.13 5.11-rc3.
  masami: |-
    Introduced by commit f2c7ef3 ("KVM: nSVM: cancel KVM_REQ_GET_NESTED_STATE_PAGES 
    on nested vmexit") in 5.11-rc3. This commit is backported to 5.10. Linux 5.4 
    and 4.x are not affected. Fixed in 5.13-rc2.
introduced-by:
  cip/5.10: [0faceb7d6dda6f370ff1fa0464d7180f7e5cb417]
  cip/5.10-rt: [0faceb7d6dda6f370ff1fa0464d7180f7e5cb417]
  mainline: [f2c7ef3ba9556d62a7e2bb23b563c6510007d55c]
  stable/5.10: [0faceb7d6dda6f370ff1fa0464d7180f7e5cb417]
fixed-by:
  cip/5.10: [c8bf64e3fb77cc19bad146fbe26651985b117194]
  cip/5.10-rt: [c8bf64e3fb77cc19bad146fbe26651985b117194]
  mainline: [f5c7e8425f18fdb9bdb7d13340651d7876890329]
  stable/5.10: [c8bf64e3fb77cc19bad146fbe26651985b117194]
