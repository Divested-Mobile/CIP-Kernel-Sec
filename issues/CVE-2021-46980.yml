description: 'usb: typec: ucsi: Retrieve all the PDOs instead of just the first 4'
references:
- https://lore.kernel.org/linux-cve-announce/2024022823-CVE-2021-46980-adda@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46980
- https://git.kernel.org/linus/1f4642b72be79757f050924a9b9673b6a02034bc
- https://git.kernel.org/stable/c/e5366bea0277425e1868ba20eeb27c879d5a6e2d
- https://git.kernel.org/stable/c/a453bfd7ef15fd9d524004d3ca7b05353a302911
- https://git.kernel.org/stable/c/5e9c6f58b01e6fdfbc740390c01f542a35c97e57
- https://git.kernel.org/stable/c/1f4642b72be79757f050924a9b9673b6a02034bc
- https://www.cve.org/CVERecord?id=CVE-2021-46980
comments:
  debian/carnil: |-
    Introduced in 992a60ed0d5e ("usb: typec: ucsi: register with power_supply
    class")
    4dbc6a4ef06d ("usb: typec: ucsi: save power data objects in PD mode").
    Vulnerable versions: 5.8-rc1.
  masami: "Introduced by commit 992a60e (\"usb: typec: ucsi: register with power_supply\
    \ \nclass\") in 5.8-rc1 and 4dbc6a4 (\"usb: typec: ucsi: save power data objects\
    \ \nin PD mode\") in 5.8-rc1. These commits are not backported to older stable\
    \ \nkernels. Fixed in 5.13-rc2."
introduced-by:
  mainline: [992a60ed0d5e312ce9a485c9e12097ac82ae4b3e, 4dbc6a4ef06d6a79ff91be6fc2e90f8660031ce0]
fixed-by:
  cip/5.10: [e5366bea0277425e1868ba20eeb27c879d5a6e2d]
  cip/5.10-rt: [e5366bea0277425e1868ba20eeb27c879d5a6e2d]
  mainline: [1f4642b72be79757f050924a9b9673b6a02034bc]
  stable/5.10: [e5366bea0277425e1868ba20eeb27c879d5a6e2d]
  ubuntu/groovy: [aa666880e2bfb043c0badd3c932b8237790b3a08]
