description: 'usb: dwc3: gadget: Free gadget structure only after freeing endpoints'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46986
- https://lore.kernel.org/linux-cve-announce/2024022824-CVE-2021-46986-1d6e@gregkh/T/#u
- https://git.kernel.org/linus/bb9c74a5bd1462499fe5ccb1e3c5ac40dcfa9139
- https://git.kernel.org/stable/c/1ea775021282d90e1d08d696b7ab54aa75d688e5
- https://git.kernel.org/stable/c/bc0cdd72493236fb72b390ad38ce581e353c143c
- https://git.kernel.org/stable/c/b4b8e9601d7ee8806d2687f081a42485d27674a1
- https://git.kernel.org/stable/c/bb9c74a5bd1462499fe5ccb1e3c5ac40dcfa9139
- https://www.cve.org/CVERecord?id=CVE-2021-46986
comments:
  debian/carnil: |-
    Introduced in e81a7018d93a ("usb: dwc3: allocate gadget structure
    dynamically"). Vulnerable versions: 5.10-rc1.
  masami: "Introduced by commit e81a701 (\"usb: dwc3: allocate gadget structure dynamically\"\
    ) \nin 5.10-rc1. This commit is not backported to older stable kernels. Fixed\
    \ in 5.13-rc2."
introduced-by:
  mainline: [e81a7018d93a7de31a3f121c9a7eecd0a5ec58b0]
fixed-by:
  cip/5.10: [1ea775021282d90e1d08d696b7ab54aa75d688e5]
  cip/5.10-rt: [1ea775021282d90e1d08d696b7ab54aa75d688e5]
  mainline: [bb9c74a5bd1462499fe5ccb1e3c5ac40dcfa9139]
  stable/5.10: [1ea775021282d90e1d08d696b7ab54aa75d688e5]
  ubuntu/focal: ['version:5.4.0-9.12']
