description: 'btrfs: fix deadlock when cloning inline extents and using qgroups'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46987
- https://lore.kernel.org/linux-cve-announce/2024022825-CVE-2021-46987-f73f@gregkh/T/#u
- https://git.kernel.org/linus/f9baa501b4fd6962257853d46ddffbc21f27e344
- https://git.kernel.org/stable/c/d5347827d0b4b2250cbce6eccaa1c81dc78d8651
- https://git.kernel.org/stable/c/96157707c0420e3d3edfe046f1cc797fee117ade
- https://git.kernel.org/stable/c/f9baa501b4fd6962257853d46ddffbc21f27e344
- https://www.cve.org/CVERecord?id=CVE-2021-46987
comments:
  debian/carnil: |-
    Introduced in " tag for the later commit to ease stable
    c53e9653605dbf ("btrfs: qgroup: try to flush qgroup space when we get
    -EDQUOT"). Vulnerable versions: 5.4.141 5.9-rc1.
  masami: "Introduced by commit c6887cd (\"Btrfs: don't do nocow check unless we have\
    \ \nto\") in 5.9-rc1. This commit is backported to 5.4. Linux 4.x is not \naffected.\
    \ Fixed in 5.9-rc1."
introduced-by:
  mainline: [c53e9653605dbf708f5be02902de51831be4b009]
  stable/5.4: [36af2de520cca7c37974cc4944b47850f6c460ee]
  ubuntu/focal: [16bde6be88af97ba308106a556172496f98a6768]
fixed-by:
  mainline: [f9baa501b4fd6962257853d46ddffbc21f27e344]
