description: 'userfaultfd: release page in error path to avoid BUG_ON'
references:
- https://lore.kernel.org/linux-cve-announce/2024022825-CVE-2021-46988-ae47@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46988
- https://git.kernel.org/linus/7ed9d238c7dbb1fdb63ad96a6184985151b0171c
- https://git.kernel.org/stable/c/319116227e52d49eee671f0aa278bac89b3c1b69
- https://git.kernel.org/stable/c/07c9b834c97d0fa3402fb7f3f3b32df370a6ff1f
- https://git.kernel.org/stable/c/b3f1731c6d7fbc1ebe3ed8eff6d6bec56d76ff43
- https://git.kernel.org/stable/c/140cfd9980124aecb6c03ef2e69c72d0548744de
- https://git.kernel.org/stable/c/ad53127973034c63b5348715a1043d0e80ceb330
- https://git.kernel.org/stable/c/2d59a0ed8b26b8f3638d8afc31f839e27759f1f6
- https://git.kernel.org/stable/c/7ed9d238c7dbb1fdb63ad96a6184985151b0171c
- https://www.cve.org/CVERecord?id=CVE-2021-46988
- https://lore.kernel.org/linux-cve-announce/2024022825-CVE-2021-46988-ae47@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit cb658a4 ("userfaultfd: shmem: avoid leaking blocks and used blocks in UFFDIO_COPY") in v4.11-rc1.
    Fixed in v5.13-rc2.
  debian/carnil: |-
    Introduced in cb658a453b93 ("userfaultfd: shmem: avoid leaking blocks and used
    blocks in UFFDIO_COPY"). Vulnerable versions: 4.11-rc1.
  masami: "Introduced by commit cb658a4 (\"userfaultfd: shmem: avoid leaking blocks\
    \ and \nused blocks in UFFDIO_COPY\") in 4.11-rc4. Linux 4.4 is not affected.\
    \ Fixed \nin 5.13-rc2."
introduced-by:
  mainline: [cb658a453b9327ce96ce5222c24d162b5b65b564]
fixed-by:
  cip/4.19: [07c9b834c97d0fa3402fb7f3f3b32df370a6ff1f]
  cip/4.19-rt: [07c9b834c97d0fa3402fb7f3f3b32df370a6ff1f]
  cip/5.10: [140cfd9980124aecb6c03ef2e69c72d0548744de]
  cip/5.10-rt: [140cfd9980124aecb6c03ef2e69c72d0548744de]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [7ed9d238c7dbb1fdb63ad96a6184985151b0171c]
  stable/4.19: [07c9b834c97d0fa3402fb7f3f3b32df370a6ff1f]
  stable/5.10: [140cfd9980124aecb6c03ef2e69c72d0548744de]
  stable/5.4: [b3f1731c6d7fbc1ebe3ed8eff6d6bec56d76ff43]
  ubuntu/bionic: [2bd30c8d42a5c67b6dc7c86fac9d0e9e98760540]
  ubuntu/focal: [3f05932aeacd455854770b2f3e13dcaebbd6a847]
  ubuntu/groovy: [809961170be97b88a84b8db276bdd5956995c7bb]
