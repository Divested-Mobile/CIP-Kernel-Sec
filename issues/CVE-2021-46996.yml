description: 'netfilter: nftables: Fix a memleak from userdata error path in new objects'
references:
- https://lore.kernel.org/linux-cve-announce/2024022827-CVE-2021-46996-0af4@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46996
- https://git.kernel.org/linus/85dfd816fabfc16e71786eda0a33a7046688b5b0
- https://git.kernel.org/stable/c/2c784a500f5edd337258b0fdb2f31bc9abde1a23
- https://git.kernel.org/stable/c/59fa98bfa1f4013d658d990cac88c87b46ff410c
- https://git.kernel.org/stable/c/dd3bebf515f336214a91994348a2b86b9a1d3d7f
- https://git.kernel.org/stable/c/85dfd816fabfc16e71786eda0a33a7046688b5b0
- https://www.cve.org/CVERecord?id=CVE-2021-46996
comments:
  debian/carnil: |-
    Introduced in b131c96496b3 ("netfilter: nf_tables: add userdata support for
    nft_object"). Vulnerable versions: 5.10-rc1.
  masami: "Introduced by commit b131c96 (\"netfilter: nf_tables: add userdata support\
    \ \nfor nft_object\") in 5.10-rc1. This commit is not backported to older \nstable\
    \ kernels. Fixed in 5.13-rc1."
introduced-by:
  mainline: [b131c96496b369c7b14125e7c50e89ac7cec8051]
fixed-by:
  cip/5.10: [2c784a500f5edd337258b0fdb2f31bc9abde1a23]
  cip/5.10-rt: [2c784a500f5edd337258b0fdb2f31bc9abde1a23]
  mainline: [85dfd816fabfc16e71786eda0a33a7046688b5b0]
  stable/5.10: [2c784a500f5edd337258b0fdb2f31bc9abde1a23]
  ubuntu/focal: ['version:5.4.0-9.12']
