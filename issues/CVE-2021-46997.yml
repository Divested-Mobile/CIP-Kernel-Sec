description: 'arm64: entry: always set GIC_PRIO_PSR_I_SET during entry'
references:
- https://lore.kernel.org/linux-cve-announce/2024022827-CVE-2021-46997-a93c@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-46997
- https://git.kernel.org/linus/4d6a38da8e79e94cbd1344aa90876f0f805db705
- https://git.kernel.org/stable/c/51524fa8b5f7b879ba569227738375d283b79382
- https://git.kernel.org/stable/c/e67a83f078005461b59b4c776e6b5addd11725fa
- https://git.kernel.org/stable/c/d8d52005f57bbb4a4ec02f647e2555d327135c68
- https://git.kernel.org/stable/c/4d6a38da8e79e94cbd1344aa90876f0f805db705
- https://www.cve.org/CVERecord?id=CVE-2021-46997
comments:
  debian/carnil: |-
    Introduced in 23529049c684 ("arm64: entry: fix non-NMI user<->kernel
    transitions")
    7cd1ea1010ac ("arm64: entry: fix non-NMI kernel<->kernel transitions")
    f0cd5ac1e4c5 ("arm64: entry: fix NMI {user, kernel}->kernel transitions")
    2a9b3e6ac69a ("arm64: entry: fix EL1 debug transitions"). Vulnerable versions:
    5.10-rc7.
  masami: "Introduced by commit 2352904 (\"arm64: entry: fix non-NMI user<->kernel\
    \ \ntransitions\") in 5.10-rc7 and 7cd1ea1 (\"arm64: entry: fix non-NMI \nkernel<->kernel\
    \ transitions\") in 5.10-rc7 and f0cd5ac (\"arm64: entry: fix NMI \n{user, kernel}->kernel\
    \ transitions\") in 5.10-rc7 and 2a9b3e6 (\"arm64: entry: \nfix EL1 debug transitions\"\
    ) in 5.10-rc7. Fixed in 5.13-rc1."
introduced-by:
  mainline: [23529049c68423820487304f244144e0d576e85a, 7cd1ea1010acbede7eb87b6abb6198921fb36957,
    f0cd5ac1e4c53cb691b3ed3cda1031e1c42153e2, 2a9b3e6ac69a8bf177d8496a11e749e2dc72fa22]
fixed-by:
  cip/5.10: [51524fa8b5f7b879ba569227738375d283b79382]
  cip/5.10-rt: [51524fa8b5f7b879ba569227738375d283b79382]
  mainline: [4d6a38da8e79e94cbd1344aa90876f0f805db705]
  stable/5.10: [51524fa8b5f7b879ba569227738375d283b79382]
  ubuntu/focal: ['version:5.4.0-9.12']
