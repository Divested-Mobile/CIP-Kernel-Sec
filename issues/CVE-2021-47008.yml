description: 'KVM: SVM: Make sure GHCB is mapped before updating'
references:
- https://lore.kernel.org/linux-cve-announce/2024022830-CVE-2021-47008-3dc3@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47008
- https://git.kernel.org/linus/a3ba26ecfb569f4aa3f867e80c02aa65f20aadad
- https://git.kernel.org/stable/c/fb9e14f4f8217a0980f8da2c8ff70dee058cbe47
- https://git.kernel.org/stable/c/fd722a57fe0b80133dacae4e1c852ee4212f9b2e
- https://git.kernel.org/stable/c/a3ba26ecfb569f4aa3f867e80c02aa65f20aadad
- https://www.cve.org/CVERecord?id=CVE-2021-47008
comments:
  debian/carnil: |-
    Introduced in f1c6366e3043 ("KVM: SVM: Add required changes to support
    intercepts under SEV-ES")
    647daca25d24 ("KVM: SVM: Add support for booting APs in an SEV-ES guest").
    Vulnerable versions: 5.11-rc1 5.11-rc3.
  masami: "Introduced by commit f1c6366 (\"KVM: SVM: Add required changes to support\
    \ \nintercepts under SEV-ES\") in 5.11-rc1 and 647daca (\"KVM: SVM: Add support\
    \ \nfor booting APs in an SEV-ES guest\") in 5.11-rc3. These commits are not \n\
    backported to older stable kernels. Fixed in 5.13-rc1."
introduced-by:
  mainline: [f1c6366e304328de301be362eca905a3503ff33b, 647daca25d24fb6eadc7b6cd680ad3e6eed0f3d5]
fixed-by:
  mainline: [a3ba26ecfb569f4aa3f867e80c02aa65f20aadad]
  ubuntu/focal: ['version:5.4.0-9.12']
