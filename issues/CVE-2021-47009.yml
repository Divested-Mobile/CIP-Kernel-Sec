description: 'KEYS: trusted: Fix memory leak on object td'
references:
- https://lore.kernel.org/linux-cve-announce/2024022830-CVE-2021-47009-3f56@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47009
- https://git.kernel.org/linus/83a775d5f9bfda95b1c295f95a3a041a40c7f321
- https://git.kernel.org/stable/c/31c9a4b24d86cbb36ff0d7a085725a3b4f0138c8
- https://git.kernel.org/stable/c/1c4031014106aff48e1e686e40101c31eab5d44c
- https://git.kernel.org/stable/c/3e24fbd37e72e8a67b74991970fecc82d14f57af
- https://git.kernel.org/stable/c/83a775d5f9bfda95b1c295f95a3a041a40c7f321
- https://www.cve.org/CVERecord?id=CVE-2021-47009
comments:
  debian/carnil: |-
    Introduced in 5df16caada3f ("KEYS: trusted: Fix incorrect handling of
    tpm_get_random()"). Vulnerable versions: 5.10.20 5.11.3 5.12-rc1.
  masami: "Introduced by commit 5df16ca (\"KEYS: trusted: Fix incorrect handling \n\
    of tpm_get_random()\") in 5.12-rc1-dontuse. This commit is not \nbackported to\
    \ older stable kernels. Fixed in 5.13-rc2."
introduced-by:
  cip/5.10: [9d83cc1a1e7f494aedee2aa108e801d11525fccf]
  cip/5.10-rt: [9d83cc1a1e7f494aedee2aa108e801d11525fccf]
  mainline: [5df16caada3fba3b21cb09b85cdedf99507f4ec1]
  stable/5.10: [9d83cc1a1e7f494aedee2aa108e801d11525fccf]
  ubuntu/groovy: [a9ee3ab9d05c556c5da7d3e877fbd58e85bf8df1]
fixed-by:
  cip/5.10: [31c9a4b24d86cbb36ff0d7a085725a3b4f0138c8]
  cip/5.10-rt: [31c9a4b24d86cbb36ff0d7a085725a3b4f0138c8]
  mainline: [83a775d5f9bfda95b1c295f95a3a041a40c7f321]
  stable/5.10: [31c9a4b24d86cbb36ff0d7a085725a3b4f0138c8]
  ubuntu/groovy: [19ba5b8a8597752c6c563f5975c30901c46e3ec4]
