description: 'net/sched: act_ct: fix wild memory access when clearing fragments'
references:
- https://lore.kernel.org/linux-cve-announce/2024022831-CVE-2021-47014-ffc7@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47014
- https://git.kernel.org/linus/f77bd544a6bbe69aa50d9ed09f13494cf36ff806
- https://git.kernel.org/stable/c/0648941f4c8bbf8b4b6c0b270889ae7aa769b921
- https://git.kernel.org/stable/c/f77bd544a6bbe69aa50d9ed09f13494cf36ff806
- https://www.cve.org/CVERecord?id=CVE-2021-47014
comments:
  debian/carnil: |-
    Introduced in ae372cb1750f ("net/sched: act_ct: fix restore the qdisc_skb_cb
    after defrag")
    7baf2429a1a9 ("net/sched: cls_flower add CT_FLAGS_INVALID flag support").
    Vulnerable versions: 5.7.12 5.8-rc7 5.12-rc1.
  masami: "Introudced by commit in ae372cb (\"net/sched: act_ct: fix restore the \n\
    qdisc_skb_cb after defrag\") in 5.8-rc7 and 7baf242 (\"net/sched: cls_flower \n\
    add CT_FLAGS_INVALID flag support\") in 5.12-rc1-dontuse. These commits are \n\
    not backported to older stable kernels. Fixed in 5.13-rc1. "
introduced-by:
  mainline: [ae372cb1750f6c95370f92fe5f5620e0954663ba, 7baf2429a1a965369b0ce44efb6315cdd515aa9c]
fixed-by:
  mainline: [f77bd544a6bbe69aa50d9ed09f13494cf36ff806]
