description: 'mtd: require write permissions for locking and badblock ioctls'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47055
- https://lore.kernel.org/linux-cve-announce/2024022950-CVE-2021-47055-6927@gregkh/T/#u
comments:
  debian/carnil: |-
    Introduced in f7e6b19bc764 ("mtd: properly check all write ioctls for
    permissions"). Vulnerable versions: 4.4.233 4.9.233 4.14.194 4.19.139 5.4.58
    5.7.15 5.8.1 5.9-rc1.
  masami: |-
    Introduced by commit f7e6b19 ("mtd: properly check all write ioctls for 
    permissions") in 5.9-rc1. This commit is backported to older stable kernels. 
    Fixed in 5.13-rc1.
introduced-by:
  cip/4.19: [ab1a602a9cea98aa37b2e6851b168d2a2633a58d]
  cip/4.19-rt: [ab1a602a9cea98aa37b2e6851b168d2a2633a58d]
  cip/4.4: [1c9f9125892a43901438bf704ada6b7019e2a884]
  cip/4.4-rt: [1c9f9125892a43901438bf704ada6b7019e2a884]
  cip/4.4-st: [1c9f9125892a43901438bf704ada6b7019e2a884]
  mainline: [f7e6b19bc76471ba03725fe58e0c218a3d6266c3]
  stable/4.19: [ab1a602a9cea98aa37b2e6851b168d2a2633a58d]
  stable/5.4: [9a53e8bd59d9f070505e51d3fd19606a270e6b93]
  ubuntu/bionic: [058aed7fd505e5bf1e97cc0da190a5b0474cfbcf]
  ubuntu/focal: [0ef2eb04dbe28a262e2e6a837a832b8b63bf7639]
  ubuntu/groovy: [46e202d48f68704f7786a7b83144c679ff095d6f]
  ubuntu/xenial: [d023d9cf8518db54767be86ac109d754533efd29]
fixed-by:
  cip/4.19: [75ed985bd6c8ac1d4e673e93ea9d96c9908c1d37]
  cip/4.19-rt: [75ed985bd6c8ac1d4e673e93ea9d96c9908c1d37]
  cip/4.4: [f4d28d8b9b0e7c4ae04214b8d7e0b0466ec6bcaf]
  cip/4.4-rt: [f4d28d8b9b0e7c4ae04214b8d7e0b0466ec6bcaf]
  cip/4.4-st: [f4d28d8b9b0e7c4ae04214b8d7e0b0466ec6bcaf]
  cip/5.10: [7b6552719c0ccbbea29dde4be141da54fdb5877e]
  cip/5.10-rt: [7b6552719c0ccbbea29dde4be141da54fdb5877e]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [1e97743fd180981bef5f01402342bb54bf1c6366]
  stable/4.19: [75ed985bd6c8ac1d4e673e93ea9d96c9908c1d37]
  stable/5.10: [7b6552719c0ccbbea29dde4be141da54fdb5877e]
  stable/5.4: [5880afefe0cb9b2d5e801816acd58bfe91a96981]
  ubuntu/bionic: [728434da3401040f1dfe96ef0f021f7025a6be3f]
  ubuntu/focal: [5b75d5d5b74b7a1268a4e6a67095a5638e824770]
  ubuntu/groovy: [123bfec9f6ba44d6bf0dac88dd219f445c40ddad]
