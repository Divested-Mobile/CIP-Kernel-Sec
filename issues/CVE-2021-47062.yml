description: 'KVM: SVM: Use online_vcpus, not created_vcpus, to iterate over vCPUs'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47062
- https://lore.kernel.org/linux-cve-announce/2024022953-CVE-2021-47062-ed39@gregkh/T/#u
- https://git.kernel.org/stable/c/bd0cced2ae93195668f983d443f7f17e8efd24d2
- https://git.kernel.org/stable/c/ba7bf5d6336aa9c0d977b161bfa420c56d46ee40
- https://git.kernel.org/stable/c/c36b16d29f3af5f32fc1b2a3401bf48f71cabee1
- https://git.kernel.org/linus/c36b16d29f3af5f32fc1b2a3401bf48f71cabee1
- https://www.cve.org/CVERecord?id=CVE-2021-47062
comments:
  debian/carnil: |-
    Introduced in ad73109ae7ec ("KVM: SVM: Provide support to launch and run an
    SEV-ES guest"). Vulnerable versions: 5.11-rc1.
  masami: "Introduced by commit ad73109 (\"KVM: SVM: Provide support to launch and\
    \ run \nan SEV-ES guest\") in 5.11-rc1. This commit is not backported to older\
    \ stable \nkernels. Fixed in 5.13-rc1."
introduced-by:
  mainline: [ad73109ae7ec30d5bfb76be108e304f9f0af4829]
fixed-by:
  mainline: [c36b16d29f3af5f32fc1b2a3401bf48f71cabee1]
  ubuntu/focal: ['version:5.4.0-9.12']
