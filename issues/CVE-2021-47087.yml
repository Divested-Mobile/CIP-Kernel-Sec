description: 'tee: optee: Fix incorrect page free bug'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47087
- https://git.kernel.org/stable/c/806142c805cacd098e61bdc0f72c778a2389fe4a
- https://git.kernel.org/stable/c/ad338d825e3f7b96ee542bf313728af2d19fe9ad
- https://git.kernel.org/stable/c/91e94e42f6fc49635f1a16d8ae3f79552bcfda29
- https://git.kernel.org/stable/c/18549bf4b21c739a9def39f27dcac53e27286ab5
- https://lore.kernel.org/linux-cve-announce/2024030413-CVE-2021-47087-4132@gregkh/
- https://git.kernel.org/linus/18549bf4b21c739a9def39f27dcac53e27286ab5
- https://www.cve.org/CVERecord?id=CVE-2021-47087
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit ec185dd ("optee: Fix memory leak when failing to register shm pages") in v5.14-rc5.
    Fixed in v5.16-rc7.
  debian/carnil: |-
    Introduced in ec185dd3ab25 ("optee: Fix memory leak when failing to register
    shm pages"). Vulnerable versions: 5.4.140 5.10.58 5.13.10 5.14-rc5.
introduced-by:
  cip/5.10: [1340dc3fb75ea69221f4f5dcb0cbace55ad0331c]
  cip/5.10-rt: [1340dc3fb75ea69221f4f5dcb0cbace55ad0331c]
  mainline: [ec185dd3ab257dc2a60953fdf1b6622f524cc5b7]
  stable/5.10: [1340dc3fb75ea69221f4f5dcb0cbace55ad0331c]
  stable/5.4: [3c712f14d8a9354a8807c15c64c8dd334499cc42]
  ubuntu/focal: [902f824b19916b242d6bebe08d7581d41d354bce]
fixed-by:
  cip/5.10: [ad338d825e3f7b96ee542bf313728af2d19fe9ad]
  cip/5.10-rt: [ad338d825e3f7b96ee542bf313728af2d19fe9ad]
  mainline: [18549bf4b21c739a9def39f27dcac53e27286ab5]
  stable/5.10: [ad338d825e3f7b96ee542bf313728af2d19fe9ad]
  stable/5.15: [91e94e42f6fc49635f1a16d8ae3f79552bcfda29]
  stable/5.4: [806142c805cacd098e61bdc0f72c778a2389fe4a]
  ubuntu/focal: [8da02c9bce511b5a98d45abce3024eab0a41b8b4]
