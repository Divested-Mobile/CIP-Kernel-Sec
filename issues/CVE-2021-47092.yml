description: 'KVM: VMX: Always clear vmx->fail on emulation_required'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47092
- https://git.kernel.org/stable/c/e4e4e7cb229821cd215031abc47efdab5486a67c
- https://git.kernel.org/stable/c/a80dfc025924024d2c61a4c1b8ef62b2fce76a04
- https://lore.kernel.org/linux-cve-announce/2024030414-CVE-2021-47092-36e2@gregkh/
- https://git.kernel.org/linus/a80dfc025924024d2c61a4c1b8ef62b2fce76a04
- https://www.cve.org/CVERecord?id=CVE-2021-47092
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c8607e4 ("KVM: x86: nVMX: don't fail nested VM entry on invalid guest state if !from_vmentry") in v5.15-rc4.
    Fixed in v5.16-rc7.
  debian/carnil: |-
    Introduced in c8607e4a086f ("KVM: x86: nVMX: don't fail nested VM entry on
    invalid guest state if !from_vmentry"). Vulnerable versions: 5.15-rc4.
introduced-by:
  mainline: [c8607e4a086fae05efe5bffb47c5199c65e7216e]
fixed-by:
  mainline: [a80dfc025924024d2c61a4c1b8ef62b2fce76a04]
  stable/5.15: [e4e4e7cb229821cd215031abc47efdab5486a67c]
