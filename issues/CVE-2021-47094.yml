description: 'KVM: x86/mmu: Don''t advance iterator after restart due to yielding'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47094
- https://git.kernel.org/stable/c/d884eefd75cc54887bc2e9e724207443525dfb2c
- https://git.kernel.org/stable/c/3a0f64de479cae75effb630a2e0a237ca0d0623c
- https://lore.kernel.org/linux-cve-announce/2024030414-CVE-2021-47094-8cc7@gregkh/
- https://git.kernel.org/linus/3a0f64de479cae75effb630a2e0a237ca0d0623c
- https://www.cve.org/CVERecord?id=CVE-2021-47094
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit faaf05b ("kvm: x86/mmu: Support zapping SPTEs in the TDP MMU") in v5.10-rc1.
    Introduced by commit 1af4a96 ("KVM: x86/mmu: Yield in TDU MMU iter even if no SPTES changed") in v5.12-rc1.
    Fixed in v5.16-rc7.
  debian/carnil: |-
    Introduced in faaf05b00aec ("kvm: x86/mmu: Support zapping SPTEs in the TDP
    MMU")
    1af4a96025b3 ("KVM: x86/mmu: Yield in TDU MMU iter even if no SPTES changed").
    Vulnerable versions: 5.10-rc1 5.10.30 5.11.14 5.12-rc1.
reporters:
- Ignat Korchagin
introduced-by:
  cip/5.10: [faaf05b00aecdb347ffd1d763d024394ec0329f8, 3c7a18440638b1c5a4645e2de1670cee32df7307]
  cip/5.10-rt: [faaf05b00aecdb347ffd1d763d024394ec0329f8, 3c7a18440638b1c5a4645e2de1670cee32df7307]
  mainline: [faaf05b00aecdb347ffd1d763d024394ec0329f8, 1af4a96025b33587ca953c7ef12a1b20c6e70412]
  stable/5.10: [faaf05b00aecdb347ffd1d763d024394ec0329f8, 3c7a18440638b1c5a4645e2de1670cee32df7307]
fixed-by:
  mainline: [3a0f64de479cae75effb630a2e0a237ca0d0623c]
  stable/5.15: [d884eefd75cc54887bc2e9e724207443525dfb2c]
