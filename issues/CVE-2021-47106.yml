description: 'netfilter: nf_tables: fix use-after-free in nft_set_catchall_destroy()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47106
- https://git.kernel.org/stable/c/9d558e5f0d6fdd0a568f73dceb0b40c4f5012e5a
- https://git.kernel.org/stable/c/0f7d9b31ce7abdbb29bf018131ac920c9f698518
- https://lore.kernel.org/linux-cve-announce/2024030445-CVE-2021-47106-fdff@gregkh/
- https://git.kernel.org/linus/0f7d9b31ce7abdbb29bf018131ac920c9f698518
- https://www.cve.org/CVERecord?id=CVE-2021-47106
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit aaa3104 ("netfilter: nftables: add catch-all set element support") in v5.13-rc1.
    Fixed in v5.16-rc7.
  debian/carnil: |-
    Introduced in aaa31047a6d2 ("netfilter: nftables: add catch-all set element
    support"). Vulnerable versions: 5.13-rc1.
introduced-by:
  mainline: [aaa31047a6d25da0fa101da1ed544e1247949b40]
fixed-by:
  mainline: [0f7d9b31ce7abdbb29bf018131ac920c9f698518]
  stable/5.15: [9d558e5f0d6fdd0a568f73dceb0b40c4f5012e5a]
  ubuntu/focal: ['version:5.4.0-9.12']
