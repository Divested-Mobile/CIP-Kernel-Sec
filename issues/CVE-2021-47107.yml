description: 'NFSD: Fix READDIR buffer overflow'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47107
- https://git.kernel.org/stable/c/eabc0aab98e5218ceecd82069b0d6fdfff5ee885
- https://git.kernel.org/stable/c/53b1119a6e5028b125f431a0116ba73510d82a72
- https://lore.kernel.org/linux-cve-announce/2024030445-CVE-2021-47107-7dda@gregkh/
- https://git.kernel.org/linus/53b1119a6e5028b125f431a0116ba73510d82a72
- https://bugzilla.redhat.com/show_bug.cgi?id=2267911
- https://bugzilla.suse.com/show_bug.cgi?id=1220965
- https://www.cve.org/CVERecord?id=CVE-2021-47107
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit f5dcccd ("NFSD: Update the NFSv2 READDIR entry encoder to use struct xdr_stream") in v5.13-rc1.
    Introduced by commit 7f87fc2 ("NFSD: Update NFSv3 READDIR entry encoders to use struct xdr_stream") in v5.13-rc1.
    Fixed in v5.16-rc7.
  debian/carnil: |-
    Introduced in f5dcccd647da ("NFSD: Update the NFSv2 READDIR entry encoder to
    use struct xdr_stream")
    7f87fc2d34d4 ("NFSD: Update NFSv3 READDIR entry encoders to use struct
    xdr_stream"). Vulnerable versions: 5.13-rc1.
reporters:
- Anatoly Trosinenko
introduced-by:
  mainline: [f5dcccd647da513a89f3b6ca392b0c1eb050b9fc, 7f87fc2d34d475225e78b7f5c4eabb121f4282b2]
  stable/5.10: [b8658c947d540cf5d135176354da5c8f2811efa0, 37aa5e64022243e721b8334122997881177a4cfc]
fixed-by:
  mainline: [53b1119a6e5028b125f431a0116ba73510d82a72]
  stable/5.10: [9e291a6a28d32545ed2fd959a8165144d1724df1]
  stable/5.15: [eabc0aab98e5218ceecd82069b0d6fdfff5ee885]
