description: 'NFS: Don''t corrupt the value of pg_bytes_written in nfs_do_recoalesce()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47166
- https://git.kernel.org/stable/c/e8b8418ce14ae66ee55179901edd12191ab06a9e
- https://git.kernel.org/stable/c/b291baae24f876acd5a5dd57d0bb2bbac8a68b0c
- https://git.kernel.org/stable/c/c757c1f1e65d89429db1409429436cf40d47c008
- https://git.kernel.org/stable/c/40f139a6d50c232c0d1fd1c5e65a845c62db0ede
- https://git.kernel.org/stable/c/785917316b25685c9b3a2a88f933139f2de75e33
- https://git.kernel.org/stable/c/7087db95c0a06ab201b8ebfac6a7ec1e34257997
- https://git.kernel.org/stable/c/2fe1cac336b55a1f79e603e9ce3552c3623e90eb
- https://git.kernel.org/stable/c/0d0ea309357dea0d85a82815f02157eb7fcda39f
- https://lore.kernel.org/linux-cve-announce/2024032535-CVE-2021-47166-6ab7@gregkh/
- https://www.cve.org/CVERecord?id=CVE-2021-47166
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit a7d42dd ("nfs: add mirroring support to pgio layer") in v4.0-rc1.
    Fixed in v5.13-rc4.
  debian/carnil: |-
    Introduced in a7d42ddb3099 ("nfs: add mirroring support to pgio layer").
    Vulnerable versions: 4.0-rc1 4.1.52 4.4.124 4.9.90.
introduced-by:
  mainline: [a7d42ddb3099727f58366fa006f850a219cce6c8]
fixed-by:
  cip/4.19: [40f139a6d50c232c0d1fd1c5e65a845c62db0ede]
  cip/4.19-rt: [40f139a6d50c232c0d1fd1c5e65a845c62db0ede]
  cip/4.4: [e8b8418ce14ae66ee55179901edd12191ab06a9e]
  cip/4.4-rt: [e8b8418ce14ae66ee55179901edd12191ab06a9e]
  cip/4.4-st: [e8b8418ce14ae66ee55179901edd12191ab06a9e]
  cip/5.10: [7087db95c0a06ab201b8ebfac6a7ec1e34257997]
  cip/5.10-rt: [7087db95c0a06ab201b8ebfac6a7ec1e34257997]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [0d0ea309357dea0d85a82815f02157eb7fcda39f]
  stable/4.19: [40f139a6d50c232c0d1fd1c5e65a845c62db0ede]
  stable/4.4: [e8b8418ce14ae66ee55179901edd12191ab06a9e]
  stable/5.10: [7087db95c0a06ab201b8ebfac6a7ec1e34257997]
  stable/5.4: [785917316b25685c9b3a2a88f933139f2de75e33]
  ubuntu/bionic: [764025592a82ac690d27de79ae52294692fca061]
  ubuntu/focal: [cd2ce7fbee9a81cd157de29c834ec9d4035396cf]
  ubuntu/groovy: [0b75a06a5d6cd10155e3742fe2d7c41fd6234f66]
