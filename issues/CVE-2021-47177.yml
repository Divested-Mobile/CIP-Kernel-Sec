description: 'iommu/vt-d: Fix sysfs leak in alloc_iommu()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47177
- https://git.kernel.org/stable/c/22da9f4978381a99f1abaeaf6c9b83be6ab5ddd8
- https://git.kernel.org/stable/c/2ec5e9bb6b0560c90d315559c28a99723c80b996
- https://git.kernel.org/stable/c/044bbe8b92ab4e542de7f6c93c88ea65cccd8e29
- https://git.kernel.org/stable/c/f01134321d04f47c718bb41b799bcdeda27873d2
- https://git.kernel.org/stable/c/ca466561eef36d1ec657673e3944eb6340bddb5b
- https://git.kernel.org/stable/c/0ee74d5a48635c848c20f152d0d488bf84641304
- https://lore.kernel.org/linux-cve-announce/2024032538-CVE-2021-47177-4d4a@gregkh/
- https://www.cve.org/CVERecord?id=CVE-2021-47177
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 39ab955 ("iommu: Add sysfs bindings for struct iommu_device") in v4.11-rc1.
    Fixed in v5.13-rc4.
  debian/carnil: |-
    Introduced in 39ab9555c2411 ("iommu: Add sysfs bindings for struct
    iommu_device"). Vulnerable versions: 4.11-rc1.
introduced-by:
  mainline: [39ab9555c24110671f8dc671311a26e5c985b592]
fixed-by:
  cip/4.19: [2ec5e9bb6b0560c90d315559c28a99723c80b996]
  cip/4.19-rt: [2ec5e9bb6b0560c90d315559c28a99723c80b996]
  cip/5.10: [f01134321d04f47c718bb41b799bcdeda27873d2]
  cip/5.10-rt: [f01134321d04f47c718bb41b799bcdeda27873d2]
  debian/buster-security: ['version:debian/4.19.194-1']
  mainline: [0ee74d5a48635c848c20f152d0d488bf84641304]
  stable/4.14: [22da9f4978381a99f1abaeaf6c9b83be6ab5ddd8]
  stable/4.19: [2ec5e9bb6b0560c90d315559c28a99723c80b996]
  stable/5.10: [f01134321d04f47c718bb41b799bcdeda27873d2]
  stable/5.4: [044bbe8b92ab4e542de7f6c93c88ea65cccd8e29]
  ubuntu/bionic: [4c7503419f0ac6eefbf1b9e2c0ad25e036299eaf]
  ubuntu/focal: [230d8266d7b5f85706a4d0d9bd9ab1a8966300e9]
  ubuntu/groovy: [28dbe5feb5b31198590c77b75b8c4c8a2d479cd1]
