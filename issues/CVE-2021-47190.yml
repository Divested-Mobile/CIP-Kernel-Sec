description: 'perf bpf: Avoid memory leak from perf_env__insert_btf()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47190
- https://git.kernel.org/stable/c/642fc22210a5e59d40b1e4d56d21ec3effd401f2
- https://git.kernel.org/stable/c/11589d3144bc4e272e0aae46ce8156162e99babc
- https://git.kernel.org/stable/c/ab7c3d8d81c511ddfb27823fb07081c96422b56e
- https://git.kernel.org/stable/c/4924b1f7c46711762fd0e65c135ccfbcfd6ded1f
- https://lore.kernel.org/linux-cve-announce/2024041034-CVE-2021-47190-0261@gregkh/
- https://git.kernel.org/linus/4924b1f7c46711762fd0e65c135ccfbcfd6ded1f
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 3792cb2 ("perf bpf: Save BTF in a rbtree in perf_env") in v5.1-rc2.
    Fixed in v5.16-rc1.
  debian/carnil: |-
    Introduced in 3792cb2ff43b1b19 ("perf bpf: Save BTF in a rbtree in perf_env").
    Vulnerable versions: 5.1-rc2.
introduced-by:
  mainline: [3792cb2ff43b1b193136a03ce1336462a827d792]
fixed-by:
  cip/5.10: [11589d3144bc4e272e0aae46ce8156162e99babc]
  cip/5.10-rt: [11589d3144bc4e272e0aae46ce8156162e99babc]
  mainline: [4924b1f7c46711762fd0e65c135ccfbcfd6ded1f]
  stable/5.10: [11589d3144bc4e272e0aae46ce8156162e99babc]
  stable/5.15: [ab7c3d8d81c511ddfb27823fb07081c96422b56e]
  stable/5.4: [642fc22210a5e59d40b1e4d56d21ec3effd401f2]
  ubuntu/focal: [67b6b215c23cf0de9a6b62758c1259db4319a0d7]
