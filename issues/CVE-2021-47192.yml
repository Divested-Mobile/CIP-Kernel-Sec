description: 'scsi: core: sysfs: Fix hang when device state is set via sysfs'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47192
- https://git.kernel.org/stable/c/edd783162bf2385b43de6764f2d4c6e9f4f6be27
- https://git.kernel.org/stable/c/a792e0128d232251edb5fdf42fb0f9fbb0b44a73
- https://git.kernel.org/stable/c/bcc0e3175a976b7fa9a353960808adb0bb49ead8
- https://git.kernel.org/stable/c/4edd8cd4e86dd3047e5294bbefcc0a08f66a430f
- https://lore.kernel.org/linux-cve-announce/2024041035-CVE-2021-47192-3d45@gregkh/
- https://git.kernel.org/linus/4edd8cd4e86dd3047e5294bbefcc0a08f66a430f
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit f0f82e2 ("scsi: core: Fix capacity set to zero after offlinining device") in v5.14-rc5.
    Fixed in v5.16-rc2.
  cip/masami: "Linux 4.19 and 5.4 both use get_unaligned_be32() to get alloc_len value\
    \ \nso they seem to be affected. Linux 4.4 calculates alloc_len value in the \n\
    resp_readcap16(). It might be nice to apply the fix."
  debian/carnil: |-
    Introduced in f0f82e2476f6 ("scsi: core: Fix capacity set to zero after
    offlinining device"). Vulnerable versions: 5.4.143 5.10.61 5.13.13 5.14-rc5.
introduced-by:
  cip/5.10: [711459514e297d748f15ba1f5292a3276c3d1dd0]
  cip/5.10-rt: [711459514e297d748f15ba1f5292a3276c3d1dd0]
  mainline: [f0f82e2476f6adb9c7a0135cfab8091456990c99]
  stable/5.10: [711459514e297d748f15ba1f5292a3276c3d1dd0]
  stable/5.4: [69aa1a1a569f5c6d554b59352130ef363342ed4c]
  ubuntu/focal: [7210443f4126092beabaff8cca4f900638d45585]
fixed-by:
  cip/5.10: [a792e0128d232251edb5fdf42fb0f9fbb0b44a73]
  cip/5.10-rt: [a792e0128d232251edb5fdf42fb0f9fbb0b44a73]
  mainline: [4edd8cd4e86dd3047e5294bbefcc0a08f66a430f]
  stable/5.10: [a792e0128d232251edb5fdf42fb0f9fbb0b44a73]
  stable/5.15: [bcc0e3175a976b7fa9a353960808adb0bb49ead8]
  stable/5.4: [edd783162bf2385b43de6764f2d4c6e9f4f6be27]
  ubuntu/focal: [3dac34f59bbc4912594d2425e650dc9f79d7253e]
