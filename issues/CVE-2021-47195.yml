description: 'spi: fix use-after-free of the add_lock mutex'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47195
- https://git.kernel.org/stable/c/37330f37f6666c7739a44b2b6b95b047ccdbed2d
- https://git.kernel.org/stable/c/6c53b45c71b4920b5e62f0ea8079a1da382b9434
- https://lore.kernel.org/linux-cve-announce/2024041035-CVE-2021-47195-38e8@gregkh/
- https://git.kernel.org/linus/6c53b45c71b4920b5e62f0ea8079a1da382b9434
- https://www.cve.org/CVERecord?id=CVE-2021-47195
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 6098475 ("spi: Fix deadlock when adding SPI controllers on SPI buses") in v5.15-rc6.
    Fixed in v5.16-rc2.
  debian/carnil: |-
    Introduced in 6098475d4cb4 ("spi: Fix deadlock when adding SPI controllers on
    SPI buses"). Vulnerable versions: 5.14.15 5.15-rc6.
introduced-by:
  mainline: [6098475d4cb48d821bdf453c61118c56e26294f0]
fixed-by:
  mainline: [6c53b45c71b4920b5e62f0ea8079a1da382b9434]
  stable/5.15: [37330f37f6666c7739a44b2b6b95b047ccdbed2d]
  ubuntu/focal: ['version:5.4.0-9.12']
