description: 'spi: fix use-after-free of the add_lock mutex'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47195
- https://git.kernel.org/stable/c/37330f37f6666c7739a44b2b6b95b047ccdbed2d
- https://git.kernel.org/stable/c/6c53b45c71b4920b5e62f0ea8079a1da382b9434
- https://lore.kernel.org/linux-cve-announce/2024041035-CVE-2021-47195-38e8@gregkh/
- https://git.kernel.org/linus/6c53b45c71b4920b5e62f0ea8079a1da382b9434
- https://www.cve.org/CVERecord?id=CVE-2021-47195
- https://git.kernel.org/stable/c/54c2c96eafcfd242e52e932ab54ace4784efe1dd
- https://git.kernel.org/stable/c/11eab327a2a8bd36c38afbff920ae1bd45588dd4
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 6098475 ("spi: Fix deadlock when adding SPI controllers on SPI buses") in v5.15-rc6.
    Fixed in v5.10.230.
  debian/carnil: |-
    Introduced in 6098475d4cb4 ("spi: Fix deadlock when adding SPI controllers on
    SPI buses"). Vulnerable versions: 5.14.15 5.15-rc6.
introduced-by:
  mainline: [6098475d4cb48d821bdf453c61118c56e26294f0]
  stable/5.10: [c8dce228db6f81dbc897a018dfc5c418e917cf64]
  stable/5.4: [aa3f3d7bef59583f2d3234173105a27ff61ef8fe]
  ubuntu/focal: [16e3feac8514fbb7cf6c8deb7d9b5e21a70e57c6]
fixed-by:
  mainline: [6c53b45c71b4920b5e62f0ea8079a1da382b9434]
  stable/5.10: [11eab327a2a8bd36c38afbff920ae1bd45588dd4]
  stable/5.15: [37330f37f6666c7739a44b2b6b95b047ccdbed2d]
  stable/5.4: [54c2c96eafcfd242e52e932ab54ace4784efe1dd]
  ubuntu/focal: ['version:5.4.0-9.12']
