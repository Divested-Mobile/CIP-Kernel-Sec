description: 'scsi: lpfc: Fix use-after-free in lpfc_unreg_rpi() routine'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47198
- https://git.kernel.org/stable/c/dbebf865b3239595c1d4dba063b122862583b52a
- https://git.kernel.org/stable/c/79b20beccea3a3938a8500acef4e6b9d7c66142f
- https://lore.kernel.org/linux-cve-announce/2024041036-CVE-2021-47198-2426@gregkh/
- https://git.kernel.org/linus/79b20beccea3a3938a8500acef4e6b9d7c66142f
- https://www.cve.org/CVERecord?id=CVE-2021-47198
comments:
  cip/cip-kernel-sec: There is no mention of the commit that introduced the bug in
    the CVE announcement.Fixed in v5.16-rc1.
  cip/masami: "The lpfc_reg_fab_ctrl_node() and lpfc_mbx_cmpl_fc_reg_login() were\
    \ introduced\nby commit fe83e3b9 (\"scsi: lpfc: Fix node handling for Fabric Controller\
    \ and \nDomain Controller\") in 5.14-rc1."
  debian/carnil: First introducing commit could not be determined.
introduced-by:
  mainline: [fe83e3b9b422ac8ece2359c7b7290efe7f0335a2]
fixed-by:
  mainline: [79b20beccea3a3938a8500acef4e6b9d7c66142f]
  stable/5.15: [dbebf865b3239595c1d4dba063b122862583b52a]
  ubuntu/focal: ['version:5.4.0-9.12']
