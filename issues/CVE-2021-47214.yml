description: 'hugetlb, userfaultfd: fix reservation restore on userfaultfd error'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-47214
- https://git.kernel.org/stable/c/b5069d44e2fbc4a9093d005b3ef0949add3dd27e
- https://git.kernel.org/stable/c/cc30042df6fcc82ea18acf0dace831503e60a0b7
- https://lore.kernel.org/linux-cve-announce/2024041005-CVE-2021-47214-59f9@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c7b1850 ("hugetlb: don't pass page cache pages to restore_reserve_on_error") in v5.14-rc7.
    Fixed in v5.16-rc2.
  debian/carnil: |-
    Introduced in c7b1850dfb41 ("hugetlb: don't pass page cache pages to
    restore_reserve_on_error"). Vulnerable versions: 5.13.13 5.14-rc7.
introduced-by:
  mainline: [c7b1850dfb41d0b4154aca8dbc04777fbd75616f]
fixed-by:
  mainline: [cc30042df6fcc82ea18acf0dace831503e60a0b7]
  stable/5.15: [b5069d44e2fbc4a9093d005b3ef0949add3dd27e]
