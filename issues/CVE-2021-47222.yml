description: 'net: bridge: fix vlan tunnel dst refcnt when egressing'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47222
- https://git.kernel.org/stable/c/42020f7f37a90d24b9551f5f7eba3f7c7c102968
- https://git.kernel.org/stable/c/84fc1c944e45ab317e2e70a0e7f76fa2a5e43b6e
- https://git.kernel.org/stable/c/79855be6445b6592bddb7bd7167083ec8cdbd73f
- https://git.kernel.org/stable/c/fc7fdd8c5c2ad2fe3e297698be9d4dbe4a4e0579
- https://git.kernel.org/stable/c/25053a8404ba17ca48f5553d487afc1882e9f56c
- https://git.kernel.org/stable/c/cfc579f9d89af4ada58c69b03bcaa4887840f3b3
- https://lore.kernel.org/linux-cve-announce/2024052136-CVE-2021-47222-f01c@gregkh/
- https://git.kernel.org/linus/cfc579f9d89af4ada58c69b03bcaa4887840f3b3
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 11538d0 ("bridge: vlan dst_metadata hooks in ingress and egress paths") in v4.11-rc1.
    Fixed in v5.13-rc7.
  debian/carnil: |-
    Introduced in 11538d039ac6 ("bridge: vlan dst_metadata hooks in ingress and
    egress paths"). Vulnerable versions: 4.11-rc1.
introduced-by:
  mainline: [11538d039ac6efcf4f1a6c536e1b87cd3668a9fd]
fixed-by:
  cip/4.19: [84fc1c944e45ab317e2e70a0e7f76fa2a5e43b6e]
  cip/4.19-rt: [84fc1c944e45ab317e2e70a0e7f76fa2a5e43b6e]
  cip/5.10: [fc7fdd8c5c2ad2fe3e297698be9d4dbe4a4e0579]
  cip/5.10-rt: [fc7fdd8c5c2ad2fe3e297698be9d4dbe4a4e0579]
  debian/buster-security: ['version:debian/4.19.208-1']
  mainline: [cfc579f9d89af4ada58c69b03bcaa4887840f3b3]
  openela/4.14: [42020f7f37a90d24b9551f5f7eba3f7c7c102968]
  stable/4.14: [42020f7f37a90d24b9551f5f7eba3f7c7c102968]
  stable/4.19: [84fc1c944e45ab317e2e70a0e7f76fa2a5e43b6e]
  stable/5.10: [fc7fdd8c5c2ad2fe3e297698be9d4dbe4a4e0579]
  stable/5.4: [79855be6445b6592bddb7bd7167083ec8cdbd73f]
  ubuntu/bionic: [798cb62eb8ca2236285a78f7fa45c6e77024cf03]
  ubuntu/focal: [f84a608524902a67d77e60c8d6adfb29c3af8035]
