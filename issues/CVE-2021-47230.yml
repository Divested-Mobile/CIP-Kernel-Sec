description: 'KVM: x86: Immediately reset the MMU context when the SMM flag is cleared'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47230
- https://git.kernel.org/stable/c/cbb425f62df9df7abee4b3f068f7ed6ffc3561e2
- https://git.kernel.org/stable/c/669a8866e468fd020d34eb00e08cb41d3774b71b
- https://git.kernel.org/stable/c/df9a40cfb3be2cbeb1c17bb67c59251ba16630f3
- https://git.kernel.org/stable/c/78fcb2c91adfec8ce3a2ba6b4d0dda89f2f4a7c6
- https://lore.kernel.org/linux-cve-announce/2024052138-CVE-2021-47230-e1ff@gregkh/
- https://git.kernel.org/linus/78fcb2c91adfec8ce3a2ba6b4d0dda89f2f4a7c6
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 9ec1949 ("KVM: x86: clear SMM flags before loading state while leaving SMM") in v5.1-rc6.
    Fixed in v5.13-rc7.
  debian/carnil: |-
    Introduced in 9ec19493fb86 ("KVM: x86: clear SMM flags before loading state
    while leaving SMM"). Vulnerable versions: 5.1-rc6.
introduced-by:
  mainline: [9ec19493fb86d6d5fbf9286b94ff21e56ef66376]
fixed-by:
  cip/5.10: [669a8866e468fd020d34eb00e08cb41d3774b71b]
  cip/5.10-rt: [669a8866e468fd020d34eb00e08cb41d3774b71b]
  mainline: [78fcb2c91adfec8ce3a2ba6b4d0dda89f2f4a7c6]
  stable/5.10: [669a8866e468fd020d34eb00e08cb41d3774b71b]
  stable/5.4: [cbb425f62df9df7abee4b3f068f7ed6ffc3561e2]
  ubuntu/focal: [de62f9771663a030480f09b8be9d93e2915b4be3]
