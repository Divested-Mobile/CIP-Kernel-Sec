description: 'usb: dwc3: gadget: Bail from dwc3_gadget_exit() if dwc->gadget is NULL'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47272
- https://git.kernel.org/stable/c/851dee5a5da56564a70290713aee665403bb0b24
- https://git.kernel.org/stable/c/4aad390363d2b9b3e92428dd34d27bb7ea8f1ee8
- https://git.kernel.org/stable/c/03715ea2e3dbbc56947137ce3b4ac18a726b2f87
- https://lore.kernel.org/linux-cve-announce/2024052151-CVE-2021-47272-607d@gregkh/
- https://git.kernel.org/linus/03715ea2e3dbbc56947137ce3b4ac18a726b2f87
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit e81a701 ("usb: dwc3: allocate gadget structure dynamically") in v5.10-rc1.
    Fixed in v5.13-rc6.
  debian/carnil: |-
    Introduced in e81a7018d93a ("usb: dwc3: allocate gadget structure
    dynamically"). Vulnerable versions: 5.10-rc1.
introduced-by:
  mainline: [e81a7018d93a7de31a3f121c9a7eecd0a5ec58b0]
fixed-by:
  cip/5.10: [851dee5a5da56564a70290713aee665403bb0b24]
  cip/5.10-rt: [851dee5a5da56564a70290713aee665403bb0b24]
  mainline: [03715ea2e3dbbc56947137ce3b4ac18a726b2f87]
  stable/5.10: [851dee5a5da56564a70290713aee665403bb0b24]
  ubuntu/focal: ['version:5.4.0-9.12']
