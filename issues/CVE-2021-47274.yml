description: 'tracing: Correct the length check which causes memory corruption'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47274
- https://git.kernel.org/stable/c/edcce01e0e50840a9aa6a70baed21477bdd2c9f9
- https://git.kernel.org/stable/c/2d598902799886d67947406f26ee8e5fd2ca097f
- https://git.kernel.org/stable/c/31ceae385556c37e4d286cb6378696448f566883
- https://git.kernel.org/stable/c/d63f00ec908b3be635ead5d6029cc94246e1f38d
- https://git.kernel.org/stable/c/43c32c22254b9328d7abb1c2b0f689dc67838e60
- https://git.kernel.org/stable/c/b16a249eca2230c2cd66fa1d4b94743bd9b6ef92
- https://git.kernel.org/stable/c/3e08a9f9760f4a70d633c328a76408e62d6f80a3
- https://lore.kernel.org/linux-cve-announce/2024052151-CVE-2021-47274-3867@gregkh/
- https://git.kernel.org/linus/3e08a9f9760f4a70d633c328a76408e62d6f80a3
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit b220c04 ("tracing: Check length before giving out the filter buffer") in v5.11.
    Fixed in v5.13-rc6.
  debian/carnil: |-
    Introduced in b220c049d519 ("tracing: Check length before giving out the filter
    buffer"). Vulnerable versions: 4.9.258 4.14.222 4.19.177 5.4.99 5.10.17 5.11.
introduced-by:
  cip/4.19: [0572fc6a510add9029b113239eaabf4b5bce8ec9]
  cip/4.19-rt: [0572fc6a510add9029b113239eaabf4b5bce8ec9]
  cip/5.10: [7c93d8cff582c459350d6f8906eea6e4cd60d959]
  cip/5.10-rt: [7c93d8cff582c459350d6f8906eea6e4cd60d959]
  mainline: [b220c049d5196dd94d992dd2dc8cba1a5e6123bf]
  stable/4.14: [e46d433754420b4d6513ca389403de88a0910279]
  stable/4.19: [0572fc6a510add9029b113239eaabf4b5bce8ec9]
  stable/4.9: [2e584b1a02eeb860e286d39bc408b25ebc5ec844]
  stable/5.10: [7c93d8cff582c459350d6f8906eea6e4cd60d959]
  stable/5.4: [a0997a86f5c0085e183ddee5fb72091d584d3d16]
  ubuntu/bionic: [35698cd27b61d321d0b5a396d0ac3cfa54f4c70e]
  ubuntu/focal: [fd74b8899fd11a8b05fd391c6ded35dcbfd04783]
  ubuntu/groovy: [d14e3bf0980efdb876495ff033a5b48adb55c4c0]
fixed-by:
  cip/4.19: [31ceae385556c37e4d286cb6378696448f566883]
  cip/4.19-rt: [31ceae385556c37e4d286cb6378696448f566883]
  cip/5.10: [43c32c22254b9328d7abb1c2b0f689dc67838e60]
  cip/5.10-rt: [43c32c22254b9328d7abb1c2b0f689dc67838e60]
  debian/buster-security: ['version:debian/4.19.208-1']
  mainline: [3e08a9f9760f4a70d633c328a76408e62d6f80a3]
  stable/4.14: [2d598902799886d67947406f26ee8e5fd2ca097f]
  stable/4.19: [31ceae385556c37e4d286cb6378696448f566883]
  stable/4.9: [edcce01e0e50840a9aa6a70baed21477bdd2c9f9]
  stable/5.10: [43c32c22254b9328d7abb1c2b0f689dc67838e60]
  stable/5.4: [d63f00ec908b3be635ead5d6029cc94246e1f38d]
  ubuntu/bionic: [22dd054987c86ee9664a57136062f408d60bbd6c]
  ubuntu/focal: [e8d0e27e53599085075f7d9f0ca67f3a063a6e8b]
  ubuntu/groovy: [4dc26ec29c61a8d06c8df5f4a1c2b6147d457577]
