description: 'spi: bcm2835: Fix out-of-bounds access with more than 4 slaves'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47282
- https://git.kernel.org/stable/c/b5502580cf958b094f3b69dfe4eece90eae01fbc
- https://git.kernel.org/stable/c/82a8ffba54d31e97582051cb56ba1f988018681e
- https://git.kernel.org/stable/c/01415ff85a24308059e06ca3e97fd7bf75648690
- https://git.kernel.org/stable/c/13817d466eb8713a1ffd254f537402f091d48444
- https://lore.kernel.org/linux-cve-announce/2024052154-CVE-2021-47282-edd8@gregkh/
- https://git.kernel.org/linus/13817d466eb8713a1ffd254f537402f091d48444
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 571e31f ("spi: bcm2835: Cache CS register value for ->prepare_message()") in v5.4-rc1.
    Fixed in v5.13-rc6.
  debian/carnil: |-
    Introduced in 571e31fa60b3 ("spi: bcm2835: Cache CS register value for
    ->prepare_message()"). Vulnerable versions: 5.4-rc1.
introduced-by:
  mainline: [571e31fa60b3697d5db26140e16d5c45c51c9815]
fixed-by:
  cip/5.10: [82a8ffba54d31e97582051cb56ba1f988018681e]
  cip/5.10-rt: [82a8ffba54d31e97582051cb56ba1f988018681e]
  mainline: [13817d466eb8713a1ffd254f537402f091d48444]
  stable/5.10: [82a8ffba54d31e97582051cb56ba1f988018681e]
  stable/5.4: [b5502580cf958b094f3b69dfe4eece90eae01fbc]
  ubuntu/focal: [945ee224de18e0df8ab06205e557de245f1da7d2]
  ubuntu/groovy: [b3cde88f5ad2b85d07ce354d861ce7e399987449]
