description: 'KVM: PPC: Fix kvm_arch_vcpu_ioctl vcpu_load leak'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47296
- https://git.kernel.org/stable/c/9bafc34dc4ad0cef18727c557f21ed3c3304df50
- https://git.kernel.org/stable/c/f38527f1890543cdfca8dfd06f75f9887cce6151
- https://git.kernel.org/stable/c/e14ef1095387f764d95614d3ec9e4d07c82a3533
- https://git.kernel.org/stable/c/a4a488915feaad38345cc01b80d52e8200ff5209
- https://git.kernel.org/stable/c/bc4188a2f56e821ea057aca6bf444e138d06c252
- https://lore.kernel.org/linux-cve-announce/2024052124-CVE-2021-47296-a208@gregkh/
- https://git.kernel.org/linus/bc4188a2f56e821ea057aca6bf444e138d06c252
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit b3cebfe ("KVM: PPC: Move vcpu_load/vcpu_put down to each ioctl case in kvm_arch_vcpu_ioctl") in v4.18-rc1.
    Fixed in v5.14-rc3.
  debian/carnil: |-
    Introduced in b3cebfe8c1ca ("KVM: PPC: Move vcpu_load/vcpu_put down to each
    ioctl case in kvm_arch_vcpu_ioctl"). Vulnerable versions: 4.18-rc1.
introduced-by:
  mainline: [b3cebfe8c1cadf1817939dcc3688a2504a69c662]
fixed-by:
  cip/4.19: [9bafc34dc4ad0cef18727c557f21ed3c3304df50]
  cip/4.19-rt: [9bafc34dc4ad0cef18727c557f21ed3c3304df50]
  cip/5.10: [e14ef1095387f764d95614d3ec9e4d07c82a3533]
  cip/5.10-rt: [e14ef1095387f764d95614d3ec9e4d07c82a3533]
  debian/buster-security: ['version:debian/4.19.208-1']
  mainline: [bc4188a2f56e821ea057aca6bf444e138d06c252]
  stable/4.19: [9bafc34dc4ad0cef18727c557f21ed3c3304df50]
  stable/5.10: [e14ef1095387f764d95614d3ec9e4d07c82a3533]
  stable/5.4: [f38527f1890543cdfca8dfd06f75f9887cce6151]
  ubuntu/focal: [b77e8525ea016962a265d0e4ec7d1dfc68f18e3c]
