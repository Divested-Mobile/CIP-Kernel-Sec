description: 'bpf, sockmap: Fix potential memory leak on unlikely error case'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47298
- https://git.kernel.org/stable/c/715f378f42909c401ec043f5150c4fdf57fb8889
- https://git.kernel.org/stable/c/6c508a1c6c62793dc6e6872cad4b200097bab7c9
- https://git.kernel.org/stable/c/7e6b27a69167f97c56b5437871d29e9722c3e470
- https://lore.kernel.org/linux-cve-announce/2024052125-CVE-2021-47298-22d6@gregkh/
- https://git.kernel.org/linus/7e6b27a69167f97c56b5437871d29e9722c3e470
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 4363023 ("bpf, sockmap: Avoid failures from skb_to_sgvec when skb has frag_list") in v5.10-rc5.
    Fixed in v5.14-rc3.
  debian/carnil: |-
    Introduced in 4363023d2668e ("bpf, sockmap: Avoid failures from skb_to_sgvec
    when skb has frag_list"). Vulnerable versions: 5.10-rc5.
introduced-by:
  mainline: [4363023d2668e621b0743db351a9555d6e6ea57e]
fixed-by:
  cip/5.10: [715f378f42909c401ec043f5150c4fdf57fb8889]
  cip/5.10-rt: [715f378f42909c401ec043f5150c4fdf57fb8889]
  mainline: [7e6b27a69167f97c56b5437871d29e9722c3e470]
  stable/5.10: [715f378f42909c401ec043f5150c4fdf57fb8889]
  ubuntu/focal: ['version:5.4.0-9.12']
