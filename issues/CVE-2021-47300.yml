description: 'bpf: Fix tail_call_reachable rejection for interpreter when jit failed'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47300
- https://git.kernel.org/stable/c/39f1735c8107ef43a53c4daf82f330d880488d8f
- https://git.kernel.org/stable/c/cbb086074dab631ac43f8645cbac1d7b148e05c4
- https://git.kernel.org/stable/c/5dd0a6b8582ffbfa88351949d50eccd5b6694ade
- https://lore.kernel.org/linux-cve-announce/2024052125-CVE-2021-47300-eee0@gregkh/
- https://git.kernel.org/linus/5dd0a6b8582ffbfa88351949d50eccd5b6694ade
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit ebf7d1f ("bpf, x64: rework pro/epilogue and tailcall handling in JIT") in v5.10-rc1.
    Introduced by commit e411901 ("bpf: allow for tailcalls in BPF subprograms for x64 JIT") in v5.10-rc1.
    Fixed in v5.14-rc3.
  debian/carnil: |-
    Introduced in ebf7d1f508a7 ("bpf, x64: rework pro/epilogue and tailcall
    handling in JIT")
    e411901c0b77 ("bpf: allow for tailcalls in BPF subprograms for x64 JIT").
    Vulnerable versions: 5.10-rc1.
introduced-by:
  mainline: [ebf7d1f508a73871acf3b2bfbfa1323a477acdb3, e411901c0b775a3ae7f3e2505f8d2d90ac696178]
fixed-by:
  cip/5.10: [39f1735c8107ef43a53c4daf82f330d880488d8f]
  cip/5.10-rt: [39f1735c8107ef43a53c4daf82f330d880488d8f]
  mainline: [5dd0a6b8582ffbfa88351949d50eccd5b6694ade]
  stable/5.10: [39f1735c8107ef43a53c4daf82f330d880488d8f]
  ubuntu/focal: ['version:5.4.0-9.12']
