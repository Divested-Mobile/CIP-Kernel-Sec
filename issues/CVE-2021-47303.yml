description: 'bpf: Track subprog poke descriptors correctly and fix use-after-free'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47303
- https://git.kernel.org/stable/c/a9f36bf3613c65cb587c70fac655c775d911409b
- https://git.kernel.org/stable/c/599148d40366bd5d1d504a3a8fcd65e21107e500
- https://git.kernel.org/stable/c/f263a81451c12da5a342d90572e317e611846f2c
- https://lore.kernel.org/linux-cve-announce/2024052126-CVE-2021-47303-72dc@gregkh/
- https://git.kernel.org/linus/f263a81451c12da5a342d90572e317e611846f2c
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit a748c69 ("bpf: propagate poke descriptors to subprograms") in v5.10-rc1.
    Fixed in v5.14-rc2.
  debian/carnil: |-
    Introduced in a748c6975dea3 ("bpf: propagate poke descriptors to subprograms").
    Vulnerable versions: 5.10-rc1.
introduced-by:
  mainline: [a748c6975dea325da540610c2ba9b5f332c603e6]
fixed-by:
  cip/5.10: [a9f36bf3613c65cb587c70fac655c775d911409b]
  cip/5.10-rt: [a9f36bf3613c65cb587c70fac655c775d911409b]
  mainline: [f263a81451c12da5a342d90572e317e611846f2c]
  stable/5.10: [a9f36bf3613c65cb587c70fac655c775d911409b]
