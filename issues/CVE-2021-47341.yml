description: 'KVM: mmio: Fix use-after-free Read in kvm_vm_ioctl_unregister_coalesced_mmio'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47341
- https://git.kernel.org/stable/c/f2ff9d03432fcb160e9f7d4be26174d89de2779a
- https://git.kernel.org/stable/c/679837dc0abaa2c6e2a7bcd86483e05eee1d5066
- https://git.kernel.org/stable/c/8d7c539316d652d217e5e82b89ee204c812a7061
- https://git.kernel.org/stable/c/069d44a24c0ff8f85adf49233aae7a8ca16f5c7e
- https://git.kernel.org/stable/c/23fa2e46a5556f787ce2ea1a315d3ab93cced204
- https://lore.kernel.org/linux-cve-announce/2024052137-CVE-2021-47341-f4e9@gregkh/
- https://git.kernel.org/linus/23fa2e46a5556f787ce2ea1a315d3ab93cced204
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 5d3c4c7 ("KVM: Stop looking for coalesced MMIO zones if the bus is destroyed", 2021-04-20) in v5.13-rc1.
    Fixed in v5.14-rc2.
  debian/carnil: |-
    Introduced in 5d3c4c79384a ("KVM: Stop looking for coalesced MMIO zones if the
    bus is destroyed", 2021-04-20). Vulnerable versions: 5.4.119 5.10.37 5.11.21
    5.12.4 5.13-rc1.
introduced-by:
  cip/5.10: [2a20592baff59c5351c5200ec667e1a2aa22af85]
  cip/5.10-rt: [2a20592baff59c5351c5200ec667e1a2aa22af85]
  mainline: [5d3c4c79384af06e3c8e25b7770b6247496b4417]
  stable/5.10: [2a20592baff59c5351c5200ec667e1a2aa22af85]
  stable/5.4: [7d1bc32d6477ff96a32695ea4be8144e4513ab2d]
  ubuntu/focal: [6205476b62587bfdc17f115b66fedb4532c9ee69]
  ubuntu/groovy: [a251d8e45d0a4099f9498c03c812aba189c01423]
fixed-by:
  cip/5.10: [679837dc0abaa2c6e2a7bcd86483e05eee1d5066]
  cip/5.10-rt: [679837dc0abaa2c6e2a7bcd86483e05eee1d5066]
  mainline: [23fa2e46a5556f787ce2ea1a315d3ab93cced204]
  stable/5.10: [679837dc0abaa2c6e2a7bcd86483e05eee1d5066]
  stable/5.4: [f2ff9d03432fcb160e9f7d4be26174d89de2779a]
  ubuntu/focal: [29a20044a540220867bb5cf7fe0a91ce98943b4f]
