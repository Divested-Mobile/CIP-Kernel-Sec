description: 'KVM: x86: Fix stack-out-of-bounds memory access from ioapic_write_indirect()'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47390
- https://git.kernel.org/stable/c/bebabb76ad9acca8858e0371e102fb60d708e25b
- https://git.kernel.org/stable/c/99a9e9b80f19fc63be005a33d76211dd23114792
- https://git.kernel.org/stable/c/2f9b68f57c6278c322793a06063181deded0ad69
- https://lore.kernel.org/linux-cve-announce/2024052146-CVE-2021-47390-5f20@gregkh/
- https://git.kernel.org/linus/2f9b68f57c6278c322793a06063181deded0ad69
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 7ee30bc ("KVM: x86: deliver KVM IOAPIC scan request to target vCPUs") in v5.5-rc1.
    Introduced by commit 9a2ae9f ("KVM: x86: Zero the IOAPIC scan request dest vCPUs bitmap") in v5.5-rc1.
    Fixed in v5.15-rc4.
  debian/carnil: |-
    Introduced in 7ee30bc132c6 ("KVM: x86: deliver KVM IOAPIC scan request to
    target vCPUs")
    9a2ae9f6b6bb ("KVM: x86: Zero the IOAPIC scan request dest vCPUs bitmap").
    Vulnerable versions: 5.5-rc1.
introduced-by:
  mainline: [7ee30bc132c683d06a6d9e360e39e483e3990708, 9a2ae9f6b6bbd3ef05d5e5977ace854e9b8f04b5]
fixed-by:
  cip/5.10: [bebabb76ad9acca8858e0371e102fb60d708e25b]
  cip/5.10-rt: [bebabb76ad9acca8858e0371e102fb60d708e25b]
  mainline: [2f9b68f57c6278c322793a06063181deded0ad69]
  stable/5.10: [bebabb76ad9acca8858e0371e102fb60d708e25b]
