description: 'x86/entry: Clear X86_FEATURE_SMAP when CONFIG_X86_SMAP=n'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47430
- https://git.kernel.org/stable/c/f2447f6587b8ffe42ba04d14ce67d429a1163e5e
- https://git.kernel.org/stable/c/4e9ec1c65da98c293f75d83755dfa5e03075a6d0
- https://git.kernel.org/stable/c/3958b9c34c2729597e182cc606cc43942fd19f7c
- https://lore.kernel.org/linux-cve-announce/2024052158-CVE-2021-47430-7b38@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 3c73b81 ("x86/entry, selftests: Further improve user entry sanity checks") in v5.8-rc4.
    Introduced by commit 662a022 ("x86/entry: Fix AC assertion") in v5.9-rc4.
    Fixed in v5.15-rc5.
  debian/carnil: |-
    Introduced in 3c73b81a9164 ("x86/entry, selftests: Further improve user entry
    sanity checks")
    662a0221893a ("x86/entry: Fix AC assertion"). Vulnerable versions: 5.8-rc4.
introduced-by:
  mainline: [3c73b81a9164d0c1b6379d6672d2772a9e95168e, 662a0221893a3d58aa72719671844264306f6e4b]
  ubuntu/groovy: [3c73b81a9164d0c1b6379d6672d2772a9e95168e, ba4940d932c4bd32a582b654cbeadb109e5981d7]
fixed-by:
  cip/5.10: [f2447f6587b8ffe42ba04d14ce67d429a1163e5e]
  cip/5.10-rt: [f2447f6587b8ffe42ba04d14ce67d429a1163e5e]
  mainline: [3958b9c34c2729597e182cc606cc43942fd19f7c]
  stable/5.10: [f2447f6587b8ffe42ba04d14ce67d429a1163e5e]
