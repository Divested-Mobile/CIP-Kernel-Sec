description: 'netfilter: nf_tables: skip netdev events generated on netns removal'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47452
- https://git.kernel.org/stable/c/90c7c58aa2bd02c65a4c63b7dfe0b16eab12cf9f
- https://git.kernel.org/stable/c/68a3765c659f809dcaac20030853a054646eb739
- https://lore.kernel.org/linux-cve-announce/2024052243-CVE-2021-47452-40cb@gregkh/
- https://git.kernel.org/linus/68a3765c659f809dcaac20030853a054646eb739
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 767d121 ("netfilter: nftables: fix possible UAF over chains from packet path in netns") in v5.11.
     Fixed in v5.15-rc7.
  debian/carnil: |-
    Introduced in 767d1216bff825 ("netfilter: nftables: fix possible UAF over
    chains from packet path in netns"). Vulnerable versions: 5.4.99 5.10.17 5.11.
introduced-by:
  cip/5.10: [0a0e5d47670b753d3dbf88f3c77a97a30864d9bd]
  cip/5.10-rt: [0a0e5d47670b753d3dbf88f3c77a97a30864d9bd]
  mainline: [767d1216bff82507c945e92fe719dff2083bb2f4]
  stable/5.10: [0a0e5d47670b753d3dbf88f3c77a97a30864d9bd]
  stable/5.4: [b110391d1e806167254d3c7ae5d637191d913175]
  ubuntu/focal: [9a76407c472ec66c3b0553620595aa8e9737897f]
  ubuntu/groovy: [c9c323b1bb00c2ea0a23f880d5cf121af459a2e4]
fixed-by:
  mainline: [68a3765c659f809dcaac20030853a054646eb739]
