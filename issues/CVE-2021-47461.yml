description: 'userfaultfd: fix a race between writeprotect and exit_mmap()'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47461
- https://git.kernel.org/stable/c/3cda4bfffd4f755645577aaa9e96a606657b4525
- https://git.kernel.org/stable/c/149958ecd0627a9f1e9c678c25c665400054cd6a
- https://git.kernel.org/stable/c/cb185d5f1ebf900f4ae3bf84cee212e6dd035aca
- https://lore.kernel.org/linux-cve-announce/2024052225-CVE-2021-47461-a472@gregkh/
- https://git.kernel.org/linus/cb185d5f1ebf900f4ae3bf84cee212e6dd035aca
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 63b2d41 ("userfaultfd: wp: add the writeprotect API to userfaultfd ioctl") in v5.7-rc1.
     Fixed in v5.15-rc7.
  debian/carnil: |-
    Introduced in 63b2d4174c4ad ("userfaultfd: wp: add the writeprotect API to
    userfaultfd ioctl"). Vulnerable versions: 5.7-rc1.
introduced-by:
  mainline: [63b2d4174c4ad1f40b48d7138e71bcb564c1fe03]
fixed-by:
  cip/5.10: [3cda4bfffd4f755645577aaa9e96a606657b4525]
  cip/5.10-rt: [3cda4bfffd4f755645577aaa9e96a606657b4525]
  mainline: [cb185d5f1ebf900f4ae3bf84cee212e6dd035aca]
  stable/5.10: [3cda4bfffd4f755645577aaa9e96a606657b4525]
  ubuntu/focal: ['version:5.4.0-9.12']
