description: 'cgroup: Fix memory leak caused by missing cgroup_bpf_offline'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47488
- https://git.kernel.org/stable/c/01599bf7cc2b49c3d2be886cb438647dc25446ed
- https://git.kernel.org/stable/c/b529f88d93884cf8ccafda793ee3d27b82fa578d
- https://git.kernel.org/stable/c/04f8ef5643bcd8bcde25dfdebef998aea480b2ba
- https://lore.kernel.org/linux-cve-announce/2024052240-CVE-2021-47488-9c35@gregkh/
- https://git.kernel.org/linus/04f8ef5643bcd8bcde25dfdebef998aea480b2ba
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 2b0d3d3 ("percpu_ref: reduce memory footprint of percpu_ref in fast path") in v5.10-rc1.
    Introduced by commit 4bfc0bb ("bpf: decouple the lifetime of cgroup_bpf from cgroup itself") in v5.3-rc1.
     Fixed in v5.15.
  debian/carnil: |-
    Introduced in 2b0d3d3e4fcf ("percpu_ref: reduce memory footprint of percpu_ref
    in fast path")
    4bfc0bb2c60e ("bpf: decouple the lifetime of cgroup_bpf from cgroup itself").
    Vulnerable versions: 5.3-rc1.
introduced-by:
  mainline: [2b0d3d3e4fcfb19d10f9a82910b8f0f05c56ee3e, 4bfc0bb2c60e2f4cc8eb60f03cf8dfa72336272a]
fixed-by:
  cip/5.10: [01599bf7cc2b49c3d2be886cb438647dc25446ed]
  cip/5.10-rt: [01599bf7cc2b49c3d2be886cb438647dc25446ed]
  mainline: [04f8ef5643bcd8bcde25dfdebef998aea480b2ba]
  stable/5.10: [01599bf7cc2b49c3d2be886cb438647dc25446ed]
