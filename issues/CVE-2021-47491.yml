description: 'mm: khugepaged: skip huge page collapse for special files'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47491
- https://git.kernel.org/stable/c/6d67b2a73b8e3a079c355bab3c1aef7d85a044b8
- https://git.kernel.org/stable/c/5fcb6fce74ffa614d964667110cf1a516c48c6d9
- https://git.kernel.org/stable/c/a4aeaa06d45e90f9b279f0b09de84bd00006e733
- https://lore.kernel.org/linux-cve-announce/2024052241-CVE-2021-47491-437d@gregkh/
- https://git.kernel.org/linus/a4aeaa06d45e90f9b279f0b09de84bd00006e733
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 99cb0db ("mm,thp: add read-only THP support for (non-shmem) FS") in v5.4-rc1.
     Fixed in v5.15.
  debian/carnil: |-
    Introduced in 99cb0dbd47a1 ("mm,thp: add read-only THP support for (non-shmem)
    FS"). Vulnerable versions: 5.4-rc1.
introduced-by:
  mainline: [99cb0dbd47a15d395bf3faa78dc122bc5efe3fc0]
fixed-by:
  cip/5.10: [6d67b2a73b8e3a079c355bab3c1aef7d85a044b8]
  cip/5.10-rt: [6d67b2a73b8e3a079c355bab3c1aef7d85a044b8]
  mainline: [a4aeaa06d45e90f9b279f0b09de84bd00006e733]
  stable/5.10: [6d67b2a73b8e3a079c355bab3c1aef7d85a044b8]
