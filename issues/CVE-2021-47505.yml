description: 'aio: fix use-after-free due to missing POLLFREE handling'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47505
- https://git.kernel.org/stable/c/321fba81ec034f88aea4898993c1bf15605c023f
- https://git.kernel.org/stable/c/4105e6a128e8a98455dfc9e6dbb2ab0c33c4497f
- https://git.kernel.org/stable/c/47ffefd88abfffe8a040bcc1dd0554d4ea6f7689
- https://git.kernel.org/stable/c/60d311f9e6381d779d7d53371f87285698ecee24
- https://git.kernel.org/stable/c/50252e4b5e989ce64555c7aef7516bdefc2fea72
- https://lore.kernel.org/linux-cve-announce/2024052452-CVE-2021-47505-427f@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 2c14fa8 ("aio: implement IOCB_CMD_POLL") in v4.18-rc1.
    Fixed in v5.16-rc5.
  debian/carnil: |-
    Introduced in 2c14fa838cbe ("aio: implement IOCB_CMD_POLL"). Vulnerable
    versions: 4.18-rc1.
introduced-by:
  mainline: [2c14fa838cbefc23cf1c73ca167ed85b274b2913]
fixed-by:
  cip/4.19: [321fba81ec034f88aea4898993c1bf15605c023f]
  cip/4.19-rt: [321fba81ec034f88aea4898993c1bf15605c023f]
  cip/5.10: [47ffefd88abfffe8a040bcc1dd0554d4ea6f7689]
  cip/5.10-rt: [47ffefd88abfffe8a040bcc1dd0554d4ea6f7689]
  debian/buster-security: ['version:debian/4.19.232-1']
  mainline: [50252e4b5e989ce64555c7aef7516bdefc2fea72]
  stable/4.19: [321fba81ec034f88aea4898993c1bf15605c023f]
  stable/5.10: [47ffefd88abfffe8a040bcc1dd0554d4ea6f7689]
  stable/5.15: [60d311f9e6381d779d7d53371f87285698ecee24]
  stable/5.4: [4105e6a128e8a98455dfc9e6dbb2ab0c33c4497f]
  ubuntu/focal: [f64c5cdc36170d0b0285beef145806a0eff1ccbc]
