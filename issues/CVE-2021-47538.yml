description: 'rxrpc: Fix rxrpc_local leak in rxrpc_lookup_peer()'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47538
- https://git.kernel.org/stable/c/913c24af2d13a3fd304462916ee98e298d56bdce
- https://git.kernel.org/stable/c/3e70e3a72d80b16094faccbe438cd53761c3503a
- https://git.kernel.org/stable/c/60f0b9c42cb80833a03ca57c1c8b078d716e71d1
- https://git.kernel.org/stable/c/9469273e616ca8f1b6e3773c5019f21b4c8d828c
- https://git.kernel.org/stable/c/beacff50edbd6c9659a6f15fc7f6126909fade29
- https://lore.kernel.org/linux-cve-announce/2024052438-CVE-2021-47538-5639@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 9ebedde ("rxrpc: rxrpc_peer needs to hold a ref on the rxrpc_local record") in v5.4-rc4.
    Fixed in v5.16-rc4.
  debian/carnil: |-
    Introduced in 9ebeddef58c4 ("rxrpc: rxrpc_peer needs to hold a ref on the
    rxrpc_local record"). Vulnerable versions: 4.19.82 5.3.9 5.4-rc4.
introduced-by:
  cip/4.19: [e8e51ce79c157188e209e5ea0afaf6b42dd76104]
  cip/4.19-rt: [e8e51ce79c157188e209e5ea0afaf6b42dd76104]
  mainline: [9ebeddef58c41bd700419cdcece24cf64ce32276]
  stable/4.19: [e8e51ce79c157188e209e5ea0afaf6b42dd76104]
fixed-by:
  cip/4.19: [913c24af2d13a3fd304462916ee98e298d56bdce]
  cip/4.19-rt: [913c24af2d13a3fd304462916ee98e298d56bdce]
  cip/5.10: [60f0b9c42cb80833a03ca57c1c8b078d716e71d1]
  cip/5.10-rt: [60f0b9c42cb80833a03ca57c1c8b078d716e71d1]
  debian/buster-security: ['version:debian/4.19.232-1']
  mainline: [beacff50edbd6c9659a6f15fc7f6126909fade29]
  stable/4.19: [913c24af2d13a3fd304462916ee98e298d56bdce]
  stable/5.10: [60f0b9c42cb80833a03ca57c1c8b078d716e71d1]
  stable/5.15: [9469273e616ca8f1b6e3773c5019f21b4c8d828c]
  stable/5.4: [3e70e3a72d80b16094faccbe438cd53761c3503a]
  ubuntu/focal: [939b003dec8a7f4afffe1497633931ba87aeac47]
