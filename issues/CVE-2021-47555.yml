description: 'net: vlan: fix underflow for the real_dev refcnt'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47555
- https://git.kernel.org/stable/c/5e44178864b38dd70b877985abd7d86fdb95f27d
- https://git.kernel.org/stable/c/6e800ee43218a56acc93676bbb3d93b74779e555
- https://git.kernel.org/stable/c/f7fc72a508cf115c273a7a29350069def1041890
- https://git.kernel.org/stable/c/01d9cc2dea3fde3bad6d27f464eff463496e2b00
- https://lore.kernel.org/linux-cve-announce/2024052443-CVE-2021-47555-3043@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 563bcba ("net: vlan: fix a UAF in 
    vlan_dev_real_dev()") in 5.16-rc1.
  debian/carnil: |-
    Introduced in 563bcbae3ba2 ("net: vlan: fix a UAF in vlan_dev_real_dev()").
    Vulnerable versions: 5.4.160 5.10.80 5.14.19 5.15.3 5.16-rc1.
introduced-by:
  mainline: [563bcbae3ba233c275c244bfce2efe12938f5363]
fixed-by:
  cip/5.10: [6e800ee43218a56acc93676bbb3d93b74779e555]
  cip/5.10-rt: [6e800ee43218a56acc93676bbb3d93b74779e555]
  mainline: [01d9cc2dea3fde3bad6d27f464eff463496e2b00]
  stable/5.10: [6e800ee43218a56acc93676bbb3d93b74779e555]
  stable/5.15: [f7fc72a508cf115c273a7a29350069def1041890]
  stable/5.4: [5e44178864b38dd70b877985abd7d86fdb95f27d]
  ubuntu/focal: [bc126fb3b27bbca690e684f7a9a97f51d6e225f2]
