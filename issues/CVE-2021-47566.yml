description: 'proc/vmcore: fix clearing user buffer by properly using clear_user()'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47566
- https://git.kernel.org/stable/c/a9e164bd160be8cbee1df70acb379129e3cd2e7c
- https://git.kernel.org/stable/c/33a7d698f30fa0b99d50569e9909d3baa65d8f6a
- https://git.kernel.org/stable/c/99d348b82bcb36171f24411d3f1a15706a2a937a
- https://git.kernel.org/stable/c/9ef384ed300d1bcfb23d0ab0b487d544444d4b52
- https://git.kernel.org/stable/c/fd7974c547abfb03072a4ee706d3a6f182266f89
- https://git.kernel.org/stable/c/a8a917058faf4abaec9fb614bb6d5f8fe3529ec6
- https://git.kernel.org/stable/c/7b3a34f08d11e7f05cd00b8e09adaa15192f0ad1
- https://git.kernel.org/stable/c/c1e63117711977cc4295b2ce73de29dd17066c82
- https://lore.kernel.org/linux-cve-announce/2024052453-CVE-2021-47566-12b8@gregkh/
- https://git.kernel.org/linus/c1e63117711977cc4295b2ce73de29dd17066c82
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 997c136 ("fs/proc/vmcore.c: add hook to read_from_oldmem() to check for non-ram pages") in v3.0-rc1.
    Fixed in v5.16-rc2.
  debian/carnil: |-
    Introduced in 997c136f518c ("fs/proc/vmcore.c: add hook to read_from_oldmem()
    to check for non-ram pages"). Vulnerable versions: 3.0-rc1.
introduced-by:
  mainline: [997c136f518c5debd63847e78e2a8694f56dcf90]
fixed-by:
  cip/4.19: [9ef384ed300d1bcfb23d0ab0b487d544444d4b52]
  cip/4.19-rt: [9ef384ed300d1bcfb23d0ab0b487d544444d4b52]
  cip/4.4: [a9e164bd160be8cbee1df70acb379129e3cd2e7c]
  cip/4.4-rt: [a9e164bd160be8cbee1df70acb379129e3cd2e7c]
  cip/4.4-st: [a9e164bd160be8cbee1df70acb379129e3cd2e7c]
  cip/5.10: [a8a917058faf4abaec9fb614bb6d5f8fe3529ec6]
  cip/5.10-rt: [a8a917058faf4abaec9fb614bb6d5f8fe3529ec6]
  debian/buster-security: ['version:debian/4.19.232-1']
  mainline: [c1e63117711977cc4295b2ce73de29dd17066c82]
  openela/4.14: [99d348b82bcb36171f24411d3f1a15706a2a937a]
  stable/4.14: [99d348b82bcb36171f24411d3f1a15706a2a937a]
  stable/4.19: [9ef384ed300d1bcfb23d0ab0b487d544444d4b52]
  stable/4.4: [a9e164bd160be8cbee1df70acb379129e3cd2e7c]
  stable/4.9: [33a7d698f30fa0b99d50569e9909d3baa65d8f6a]
  stable/5.10: [a8a917058faf4abaec9fb614bb6d5f8fe3529ec6]
  stable/5.15: [7b3a34f08d11e7f05cd00b8e09adaa15192f0ad1]
  stable/5.4: [fd7974c547abfb03072a4ee706d3a6f182266f89]
  ubuntu/bionic: [bcd352e52ae622c7b8b32ce343515599dd305068]
  ubuntu/focal: [a8aca2e066864642301b9a01f980e52922f902e9]
