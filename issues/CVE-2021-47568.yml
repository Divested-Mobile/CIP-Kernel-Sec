description: 'ksmbd: fix memleak in get_file_stream_info()'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47568
- https://git.kernel.org/stable/c/11e659827c3a2facb3a04e08cc97ff14d5091f51
- https://git.kernel.org/stable/c/178ca6f85aa3231094467691f5ea1ff2f398aa8d
- https://lore.kernel.org/linux-cve-announce/2024052453-CVE-2021-47568-bf15@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 34061d6 ("ksmbd: validate OutputBufferLength of QUERY_DIR, QUERY_INFO, IOCTL requests") in v5.15-rc7.
    Fixed in v5.16-rc3.
  debian/carnil: |-
    Introduced in 34061d6b76a4 ("ksmbd: validate OutputBufferLength of QUERY_DIR,
    QUERY_INFO, IOCTL requests"). Vulnerable versions: 5.15-rc7.
introduced-by:
  mainline: [34061d6b76a41b1e43c19e1e50d98e5d77f77d4e]
fixed-by:
  mainline: [178ca6f85aa3231094467691f5ea1ff2f398aa8d]
  stable/5.15: [11e659827c3a2facb3a04e08cc97ff14d5091f51]
