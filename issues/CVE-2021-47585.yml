description: 'btrfs: fix memory leak in __add_inode_ref()'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47585
- https://git.kernel.org/stable/c/005d9292b5b2e71a009f911bd85d755009b37242
- https://git.kernel.org/stable/c/493ff661d434d6bdf02e3a21adae04d7a0b4265d
- https://git.kernel.org/stable/c/f35838a6930296fc1988764cfa54cb3f705c0665
- https://lore.kernel.org/linux-cve-announce/2024061917-CVE-2021-47585-0a6a@gregkh/
- https://git.kernel.org/linus/f35838a6930296fc1988764cfa54cb3f705c0665
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit d3316c8 ("btrfs: Properly handle backref_in_log retval") in v5.5-rc1.
    Fixed in v5.16-rc6.
  debian/carnil: |-
    Introduced in d3316c8233bb ("btrfs: Properly handle backref_in_log retval").
    Vulnerable versions: 5.5-rc1.
introduced-by:
  mainline: [d3316c8233bb05e0dd855d30aac347bb8ad76ee4]
fixed-by:
  cip/5.10: [005d9292b5b2e71a009f911bd85d755009b37242]
  cip/5.10-rt: [005d9292b5b2e71a009f911bd85d755009b37242]
  mainline: [f35838a6930296fc1988764cfa54cb3f705c0665]
  stable/5.10: [005d9292b5b2e71a009f911bd85d755009b37242]
  stable/5.15: [493ff661d434d6bdf02e3a21adae04d7a0b4265d]
  ubuntu/focal: ['version:5.4.0-9.12']
