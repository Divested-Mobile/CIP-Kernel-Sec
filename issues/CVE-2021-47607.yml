description: 'bpf: Fix kernel address leakage in atomic cmpxchg''s r0 aux reg'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47607
- https://git.kernel.org/stable/c/f87a6c160ecc8c7b417d25f508d3f076fe346136
- https://git.kernel.org/stable/c/a82fe085f344ef20b452cd5f481010ff96b5c4cd
- https://lore.kernel.org/linux-cve-announce/2024061924-CVE-2021-47607-0fbd@gregkh/
- https://git.kernel.org/linus/a82fe085f344ef20b452cd5f481010ff96b5c4cd
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 5ffa255 ("bpf: Add instructions for atomic_[cmp]xchg") in v5.12-rc1.
    Fixed in v5.16-rc6.
  debian/carnil: |-
    Introduced in 5ffa25502b5a ("bpf: Add instructions for atomic_[cmp]xchg").
    Vulnerable versions: 5.12-rc1.
introduced-by:
  mainline: [5ffa25502b5ab3d639829a2d1e316cff7f59a41e]
fixed-by:
  mainline: [a82fe085f344ef20b452cd5f481010ff96b5c4cd]
  stable/5.15: [f87a6c160ecc8c7b417d25f508d3f076fe346136]
