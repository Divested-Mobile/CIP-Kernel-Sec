description: 'bpf: Fix kernel address leakage in atomic fetch'
references:
- https://www.cve.org/CVERecord?id=CVE-2021-47608
- https://git.kernel.org/stable/c/423628125a484538111c2c6d9bb1588eb086053b
- https://git.kernel.org/stable/c/7d3baf0afa3aa9102d6a521a8e4c41888bb79882
- https://lore.kernel.org/linux-cve-announce/2024061924-CVE-2021-47608-f4eb@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 37086bf ("bpf: Propagate stack bounds to registers in atomics w/ BPF_FETCH") in v5.12-rc1.
    Fixed in v5.16-rc6.
  debian/carnil: |-
    Introduced in 37086bfdc737 ("bpf: Propagate stack bounds to registers in
    atomics w/ BPF_FETCH"). Vulnerable versions: 5.12-rc1.
introduced-by:
  mainline: [37086bfdc737ea6f66bf68dcf16757004d68e1e1]
fixed-by:
  mainline: [7d3baf0afa3aa9102d6a521a8e4c41888bb79882]
  stable/5.15: [423628125a484538111c2c6d9bb1588eb086053b]
