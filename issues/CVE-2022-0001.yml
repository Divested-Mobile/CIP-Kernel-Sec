description: Sharing of branch predictor selectors between contexts on Intel CPUs
references:
- https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00598.html
- https://github.com/vusec/bhi-spectre-bhb
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0001
- https://www.vusec.net/projects/bhi-spectre-bhb/
- https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/branch-history-injection.html
- https://community.intel.com/t5/Blogs/Products-and-Solutions/Security/Chips-Salsa-Episode-12-March-2022-Security-Advisories/post/1365250
- https://intel.com/content/www/us/en/security-center/advisory/intel-sa-00598.html
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BHI
- https://ubuntu.com/security/notices/USN-5317-1
- https://ubuntu.com/security/notices/USN-5318-1
- https://ubuntu.com/security/notices/USN-5319-1
comments:
  debian/bwh: A.k.a. "Spectre BHB".  Details to be published in INTEL-SA-00598
  ubuntu/sbeattie: |-
    unprivileged eBPF was already disabled by default for 5.13
      and newer kernels
reporters:
- Enrico Barberis
- Pietro Frigo
- Marius Muench
- Herbert Bos
- Cristiano Giuffrida
fixed-by:
  debian/buster-security: ['patch:buster-security:bugfix/x86/bhb/0004-x86-speculation-Rename-RETPOLINE_AMD-to-RETPOLINE_LF.patch',
    'patch:buster-security:bugfix/x86/bhb/0005-x86-speculation-Add-eIBRS-Retpoline-options.patch',
    'patch:buster-security:bugfix/x86/bhb/0006-Documentation-hw-vuln-Update-spectre-doc.patch',
    'patch:buster-security:bugfix/x86/bhb/0007-x86-speculation-Include-unprivileged-eBPF-status-in-.patch',
    'patch:buster-security:bugfix/x86/bhb/0008-x86-speculation-Use-generic-retpoline-by-default-on-.patch',
    'patch:buster-security:bugfix/x86/bhb/0009-x86-speculation-Update-link-to-AMD-speculation-white.patch',
    'patch:buster-security:bugfix/x86/bhb/0010-x86-speculation-Warn-about-Spectre-v2-LFENCE-mitigat.patch',
    'patch:buster-security:bugfix/x86/bhb/0011-x86-speculation-Warn-about-eIBRS-LFENCE-Unprivileged.patch']
  debian/stretch-security: ['patch:stretch-security:bugfix/x86/bhb/0004-x86-speculation-Rename-RETPOLINE_AMD-to-RETPOLINE_LF.patch',
    'patch:stretch-security:bugfix/x86/bhb/0005-x86-speculation-Add-eIBRS-Retpoline-options.patch',
    'patch:stretch-security:bugfix/x86/bhb/0006-Documentation-hw-vuln-Update-spectre-doc.patch',
    'patch:stretch-security:bugfix/x86/bhb/0007-x86-speculation-Include-unprivileged-eBPF-status-in-.patch',
    'patch:stretch-security:bugfix/x86/bhb/0008-x86-speculation-Use-generic-retpoline-by-default-on-.patch',
    'patch:stretch-security:bugfix/x86/bhb/0009-x86-speculation-Update-link-to-AMD-speculation-white.patch',
    'patch:stretch-security:bugfix/x86/bhb/0010-x86-speculation-Warn-about-Spectre-v2-LFENCE-mitigat.patch',
    'patch:stretch-security:bugfix/x86/bhb/0011-x86-speculation-Warn-about-eIBRS-LFENCE-Unprivileged.patch']
  mainline: [d45476d9832409371537013ebdd8dc1a7781f97a, 1e19da8522c81bf46b335f84137165741e0d82b7,
    5ad3eb1132453b9795ce5fd4572b1c18b292cca9, 44a3918c8245ab10c6c9719dd12e7a8d291980d8,
    244d00b5dd4755f8df892c86cab35fb2cfd4f14b, e9b6013a7ce31535b04b02ba99babefe8a8599fa,
    eafd987d4a82c7bb5aa12f0e3b4f8f3dea93e678, 0de05d056afdb00eca8c7bbb0c79a3438daf700c]
  ubuntu/bionic: [27368716282ecd27466040fa691e3d03abbeeea3, 2b5c01933de5890a43908cc3a3ff51b7e7d6b41a,
    d2f6cede9507c2bf1ce5f86199cfb203219c7879, e4a31ee83d4f1778301dc586f0a33f098eb63189,
    b896631e6b40d0a850b7c7e4f620a2d68d11c599, 50719e729cbb3e565fb3bd54c56d6aeb0f07f90f]
  ubuntu/focal: [19a331785c9c85492046825bd9da75630edeb10e, 9c4cc911901c02a1beaaaa856e1bdecf8f55ad24,
    efbceec6286319de79360edef1728efbdaf3bfa1, 1143575721d8caa8211ddde3fca9707523e49659,
    53c643ff4e78f16beb4ec57904013c1366a9fb49]
