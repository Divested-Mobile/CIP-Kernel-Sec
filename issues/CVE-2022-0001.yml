description: Sharing of branch predictor selectors between contexts on Intel CPUs
references:
- https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00598.html
- https://github.com/vusec/bhi-spectre-bhb
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0001
- https://www.vusec.net/projects/bhi-spectre-bhb/
- https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/branch-history-injection.html
- https://community.intel.com/t5/Blogs/Products-and-Solutions/Security/Chips-Salsa-Episode-12-March-2022-Security-Advisories/post/1365250
- https://intel.com/content/www/us/en/security-center/advisory/intel-sa-00598.html
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BHI
- https://ubuntu.com/security/notices/USN-5317-1
- https://ubuntu.com/security/notices/USN-5318-1
- https://ubuntu.com/security/notices/USN-5319-1
- https://ubuntu.com/security/notices/USN-5362-1
comments:
  debian/bwh: A.k.a. "Spectre BHB".  Details to be published in INTEL-SA-00598
  ubuntu/sbeattie: |-
    unprivileged eBPF was already disabled by default for 5.13
      and newer kernels
reporters:
- Enrico Barberis
- Pietro Frigo
- Marius Muench
- Herbert Bos
- Cristiano Giuffrida
fixed-by:
  cip/4.19: [25440a8c77dd2fde6a8e9cfc0c616916febf408e, 3f66bedb96ff4c064a819e68499f79b38297ba26,
    7af95ef3ec6248696300fce5c68f6c8c4f50e4a4, 995629e1d8e6751936c6e2b738f70b392b0461de,
    d3cb3a6927222268a10b2f12dfb8c9444f7cc39e, c034d344e733a3ac574dd09e39e911a50025c607,
    8bfdba77595aee5c3e83ed1c9994c35d6d409605, 9711b12a3f4c0fc73dd257c1e467e6e42155a5f1]
  cip/4.19-rt: [25440a8c77dd2fde6a8e9cfc0c616916febf408e, 3f66bedb96ff4c064a819e68499f79b38297ba26,
    7af95ef3ec6248696300fce5c68f6c8c4f50e4a4, 995629e1d8e6751936c6e2b738f70b392b0461de,
    d3cb3a6927222268a10b2f12dfb8c9444f7cc39e, c034d344e733a3ac574dd09e39e911a50025c607,
    8bfdba77595aee5c3e83ed1c9994c35d6d409605, 9711b12a3f4c0fc73dd257c1e467e6e42155a5f1]
  cip/5.10: [f38774bb6e231d647d40ceeb8ddf9082eabde667, a6a119d647ad1f73067d3cffb43104df3f920bcc,
    071e8b69d7808d96f388d7c5ed606e75fd3d518d, afc2d635b5e18e2b33116d8e121ee149882e33eb,
    2fdf67a1d215574c31b1a716f80fa0fdccd401d7, e335384560d1e106b609e8febd7e0427075a8938,
    cc9e3e55bde71b2fac1494f503d5ffc560c7fb8d, d04937ae94903087279e4a016b7741cdee59d521]
  debian/buster-security: ['patch:buster-security:bugfix/x86/bhb/0004-x86-speculation-Rename-RETPOLINE_AMD-to-RETPOLINE_LF.patch',
    'patch:buster-security:bugfix/x86/bhb/0005-x86-speculation-Add-eIBRS-Retpoline-options.patch',
    'patch:buster-security:bugfix/x86/bhb/0006-Documentation-hw-vuln-Update-spectre-doc.patch',
    'patch:buster-security:bugfix/x86/bhb/0007-x86-speculation-Include-unprivileged-eBPF-status-in-.patch',
    'patch:buster-security:bugfix/x86/bhb/0008-x86-speculation-Use-generic-retpoline-by-default-on-.patch',
    'patch:buster-security:bugfix/x86/bhb/0009-x86-speculation-Update-link-to-AMD-speculation-white.patch',
    'patch:buster-security:bugfix/x86/bhb/0010-x86-speculation-Warn-about-Spectre-v2-LFENCE-mitigat.patch',
    'patch:buster-security:bugfix/x86/bhb/0011-x86-speculation-Warn-about-eIBRS-LFENCE-Unprivileged.patch']
  debian/stretch-security: ['patch:stretch-security:bugfix/x86/bhb/0004-x86-speculation-Rename-RETPOLINE_AMD-to-RETPOLINE_LF.patch',
    'patch:stretch-security:bugfix/x86/bhb/0005-x86-speculation-Add-eIBRS-Retpoline-options.patch',
    'patch:stretch-security:bugfix/x86/bhb/0006-Documentation-hw-vuln-Update-spectre-doc.patch',
    'patch:stretch-security:bugfix/x86/bhb/0007-x86-speculation-Include-unprivileged-eBPF-status-in-.patch',
    'patch:stretch-security:bugfix/x86/bhb/0008-x86-speculation-Use-generic-retpoline-by-default-on-.patch',
    'patch:stretch-security:bugfix/x86/bhb/0009-x86-speculation-Update-link-to-AMD-speculation-white.patch',
    'patch:stretch-security:bugfix/x86/bhb/0010-x86-speculation-Warn-about-Spectre-v2-LFENCE-mitigat.patch',
    'patch:stretch-security:bugfix/x86/bhb/0011-x86-speculation-Warn-about-eIBRS-LFENCE-Unprivileged.patch']
  mainline: [d45476d9832409371537013ebdd8dc1a7781f97a, 1e19da8522c81bf46b335f84137165741e0d82b7,
    5ad3eb1132453b9795ce5fd4572b1c18b292cca9, 44a3918c8245ab10c6c9719dd12e7a8d291980d8,
    244d00b5dd4755f8df892c86cab35fb2cfd4f14b, e9b6013a7ce31535b04b02ba99babefe8a8599fa,
    eafd987d4a82c7bb5aa12f0e3b4f8f3dea93e678, 0de05d056afdb00eca8c7bbb0c79a3438daf700c]
  stable/4.14: [35c13d13becb5b951ea0fc708dda03fe900cf879, 716c06c7196f2ff22777b5bb3c713094ec677a93,
    d2109c347ec237f6a4cf4d44336abdeeab82ec8f, 383973dc1a9dfc7baf12652b9e75498bef16aed9,
    85938688be23ecd36a06757096896b2779b80d97, 416ec8f017b368ab953f624b075a7b0ffd296b9e,
    2b871b5fedb85c1962ccab26c64bef9bf6f377d4, 38c557efd4cd5e59dee1d021009278b491523fee]
  stable/4.19: [25440a8c77dd2fde6a8e9cfc0c616916febf408e, 3f66bedb96ff4c064a819e68499f79b38297ba26,
    7af95ef3ec6248696300fce5c68f6c8c4f50e4a4, 995629e1d8e6751936c6e2b738f70b392b0461de,
    d3cb3a6927222268a10b2f12dfb8c9444f7cc39e, c034d344e733a3ac574dd09e39e911a50025c607,
    8bfdba77595aee5c3e83ed1c9994c35d6d409605, 9711b12a3f4c0fc73dd257c1e467e6e42155a5f1]
  stable/4.9: [a771511caa8e31cb5cac4fa39165ebbca3e62795, d0ba50275860b456ff570edf3dcc2db5d2eb9eb8,
    f9238d33710d74ac3dd668abaa53b2274f8e6fe6, 6481835a9a5b74e349e5c20ae8a9cb10a2e907fa,
    b6a1aec08a84ccb331ce526c051df074150cf3c5, 0db1c4307aded2c5e618654f9341a249e0c1051f,
    8edabefdc13294a9b15671937d165b948cf34d69, 0753760184745250e39018bb25ba77557390fe91]
  stable/5.10: [f38774bb6e231d647d40ceeb8ddf9082eabde667, a6a119d647ad1f73067d3cffb43104df3f920bcc,
    071e8b69d7808d96f388d7c5ed606e75fd3d518d, afc2d635b5e18e2b33116d8e121ee149882e33eb,
    2fdf67a1d215574c31b1a716f80fa0fdccd401d7, e335384560d1e106b609e8febd7e0427075a8938,
    cc9e3e55bde71b2fac1494f503d5ffc560c7fb8d, d04937ae94903087279e4a016b7741cdee59d521]
  stable/5.15: [f150b6fccf7fa0e7e7275f0785798547db832c7b, d7771f380c90e53a7b22f8e8a20b09c09e3583c7,
    eb459641775636c3b4382ecc43ba3d6aa16892d5, 316e4a16524a2d2ce321f57c1abe4df9ef90f950,
    a56566d7a957c34811384d6300a53a97be94cd20, 36fbbd78471c319a3a6f6402b99447c6d4686c69,
    074d7260463962b44a8b8a61dcdd6ef513022e88, bf048d1921b6cdc50bfc5a1b21b6fdd2d22e1fe1]
  stable/5.16: [56829c19c8171303faca18d6ab3511ecdf3e7e23, 9b629eeb33222615a367eee8f038db907a797d3f,
    227649a0a673da2c87c02c26c476a8599989a4d8, 6710bd548ec701bfedc175d145323cbf6930decb,
    1984feb9872b905420af97d471d60051b6dd5851, 23cc87c04704f7ed978c85a4ec5901719fd26580,
    19b78a9a32286216ec4aa64924d39ba5748b506d, db3eaccf6e16c2d15d3fc8dc7c430d7df7c7bcc4]
  stable/5.4: [41b50510e593541e2ee1537614652e91e71f6bf5, 96b3d45aeae03092637bd278ec4daadb48441906,
    327a4da9b0ef89628a1d2aa825ce709049a402f1, 1e47ab3df908bbe1b6114374003c7a070ef35f01,
    b1bacf22a847d21a12900bd6a1eacaecb5bca253, 865da3868b56a39b98003dcaa44cfbcdef0995fe,
    7c7702569422ed49d66917e163df81dba763e983, 6c1599fd1bf8782f2b368e9eacc55571a7c3dd54]
  ubuntu/bionic: [27368716282ecd27466040fa691e3d03abbeeea3, 2b5c01933de5890a43908cc3a3ff51b7e7d6b41a,
    d2f6cede9507c2bf1ce5f86199cfb203219c7879, e4a31ee83d4f1778301dc586f0a33f098eb63189,
    b896631e6b40d0a850b7c7e4f620a2d68d11c599, 50719e729cbb3e565fb3bd54c56d6aeb0f07f90f]
  ubuntu/focal: [19a331785c9c85492046825bd9da75630edeb10e, 9c4cc911901c02a1beaaaa856e1bdecf8f55ad24,
    efbceec6286319de79360edef1728efbdaf3bfa1, 1143575721d8caa8211ddde3fca9707523e49659,
    53c643ff4e78f16beb4ec57904013c1366a9fb49]
