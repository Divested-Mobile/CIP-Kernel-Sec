description: smb2_ioctl_query_info NULL Pointer Dereference
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2037386
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0168
- https://bugzilla.suse.com/show_bug.cgi?id=1197472
- https://starlabs.sg/advisories/22-0168/
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-6284-1
- https://ubuntu.com/security/notices/USN-6301-1
comments:
  debian/bwh: Bug was introduced in 5.4 by commit 0e90696dc2b3.
  debian/carnil: For 5.16.y fixed in 5.16.19 and for 5.17.y fixed in 5.17.2.
  masami: |-
    smb2_ioctl_query_info() was introduced by commit f5b05d6
    ("cifs: add IOCTL for QUERY_INFO passthrough to userspace")
    which was merged in 4.20-rc1.
    Commit d6f5e3 said bug was in smb2_ioctl_query_info(),
    so less than 4.20 kernels aren't affected by this bug.
  ubuntu/sbeattie: reproducers in git commits
reporters:
- Billy Jheng Bing Jhong
fixed-by:
  cip/5.10: [edefc4b2a8e8310eee8e2b1714709ad5b2a93928]
  cip/5.10-rt: [edefc4b2a8e8310eee8e2b1714709ad5b2a93928]
  mainline: [d6f5e358452479fa8a773b5c6ccc9e4ec5a20880]
  stable/5.10: [edefc4b2a8e8310eee8e2b1714709ad5b2a93928]
  stable/5.15: [39a4bf7d1a23dd172526c2fb0db480c5d5c63bd6]
  stable/5.16: [0f0ce73e7dad17084222da19989049ebfb8be541]
  stable/5.17: [49bef50e585d738e957060f669e872b4ad15eb87]
  ubuntu/focal: [1ced30150913a44b93914b231d910496c8d9810b]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
