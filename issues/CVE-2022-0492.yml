description: 'cgroup-v1: Require capabilities to set release_agent'
references:
- https://www.openwall.com/lists/oss-security/2022/02/04/1
- https://twitter.com/chompie1337/status/1489366167600906240
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0492
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=24f6008564183aa120d07c03d9289519c2fe02af
- https://ubuntu.com/security/notices/USN-5302-1
- https://ubuntu.com/security/notices/USN-5337-1
- https://ubuntu.com/security/notices/USN-5338-1
- https://ubuntu.com/security/notices/USN-5339-1
- https://ubuntu.com/security/notices/USN-5343-1
- https://ubuntu.com/security/notices/USN-5362-1
- https://ubuntu.com/security/notices/USN-5368-1
- https://ubuntu.com/security/notices/USN-5377-1
- https://www.cve.org/CVERecord?id=CVE-2022-0492
comments:
  debian/carnil: |-
    Fixed as well in 5.15.20 for 5.15.y and 5.16.6 for 5.16.y.
    Original fix will need a followup fix 467a726b754f ("cgroup-v1:
    Correct privileges check in release_agent writes")
  masami: |-
    Commit 24f6008 cannot be applied to 4.X series so 4.X series have their own fix.
    e.g. https://lore.kernel.org/stable/20220209191248.652388187@linuxfoundation.org
    4.X series use struct cgroup_namespace to get namespace object which was
    introduced at 4.6-rc1. So fixing 4.4 need the other way to get namespace
    object instead of struct cgroup_namespace.
reporters:
- Tabitha Sable
- Yiqi Sun
- Kevin Wang
introduced-by:
  mainline: [81a6a5cdd2c5cd70874b88afe524ab09e9e869af]
fixed-by:
  cip/4.19: [939f8b491887c27585933ea7dc5ad4123de58ff3]
  cip/4.19-rt: [939f8b491887c27585933ea7dc5ad4123de58ff3]
  cip/5.10: [1fc3444cda9a78c65b769e3fa93455e09ff7a0d3]
  cip/5.10-rt: [1fc3444cda9a78c65b769e3fa93455e09ff7a0d3]
  debian/buster-security: ['version:debian/4.19.232-1']
  debian/stretch-security: ['version:debian/4.9.303-1']
  mainline: [24f6008564183aa120d07c03d9289519c2fe02af]
  openela/4.14: [b391bb3554dd6e04b7a8ede975dbd3342526a045]
  stable/4.14: [b391bb3554dd6e04b7a8ede975dbd3342526a045]
  stable/4.19: [939f8b491887c27585933ea7dc5ad4123de58ff3]
  stable/4.9: [7e33a0ad792f04bad920c7197bda8cc2ea08d304]
  stable/5.10: [1fc3444cda9a78c65b769e3fa93455e09ff7a0d3]
  stable/5.15: [4b1c32bfaa02255a5df602b41587174004996477]
  stable/5.16: [9c9dbb954e618e3d9110f13cc02c5db1fb73ea5d]
  stable/5.4: [0e8283cbe4996ae046cd680b3ed598a8f2b0d5d8]
  ubuntu/bionic: [1261a25ca54d3ffb9c8d5ffc960c72595b480a9a]
  ubuntu/focal: [170c502053c26db76809243b3eecaaad607e54a1]
