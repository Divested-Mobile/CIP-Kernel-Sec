description: 'cgroup-v1: Require capabilities to set release_agent'
references:
- https://www.openwall.com/lists/oss-security/2022/02/04/1
- https://twitter.com/chompie1337/status/1489366167600906240
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0492
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=24f6008564183aa120d07c03d9289519c2fe02af
comments:
  debian/carnil: Fixed as well in 5.15.20 for 5.15.y and 5.16.6 for 5.16.y.
  masami: |-
    Commit 24f6008 cannot be applied to 4.X series so 4.X series have their own fix.
    e.g. https://lore.kernel.org/stable/20220209191248.652388187@linuxfoundation.org
    4.X series use struct cgroup_namespace to get namespace object which was
    introduced at 4.6-rc1. So fixing 4.4 need the other way to get namespace
    object instead of struct cgroup_namespace.
reporters:
- Tabitha Sable
introduced-by:
  mainline: [81a6a5cdd2c5cd70874b88afe524ab09e9e869af]
fixed-by:
  mainline: [24f6008564183aa120d07c03d9289519c2fe02af]
  stable/5.10: [1fc3444cda9a78c65b769e3fa93455e09ff7a0d3]
  stable/5.15: [4b1c32bfaa02255a5df602b41587174004996477]
  stable/5.16: [9c9dbb954e618e3d9110f13cc02c5db1fb73ea5d]
  stable/5.4: [0e8283cbe4996ae046cd680b3ed598a8f2b0d5d8]
