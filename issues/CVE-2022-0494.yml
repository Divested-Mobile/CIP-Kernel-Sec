description: 'block-map: add __GFP_ZERO flag for alloc_page in function bio_copy_kern'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2039448
- https://lore.kernel.org/all/20220216084038.15635-1-tcs.kernel@gmail.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0494
- https://git.kernel.org/linus/cc8f7fe1f5eab010191aa4570f27641876fa1267
- https://ubuntu.com/security/notices/USN-5381-1
comments:
  masami: |-
    A kernel information leak bug was found in bio_copy_kern(). An local attacker
    send SCSI_IOCTL_SEND_COMMAND cmd via scsi_ioctl(), there is a path to return
    uninialized buffer to user which cause kernel information leak.
    Its looks like earlier than 5.13 kernels may be affected by this issue.
fixed-by:
  cip/4.19: [18243d8479fd77952bdb6340024169d30b173a40]
  cip/5.10: [a439819f4797f0846c7cffa9475f44aef23c541f]
  mainline: [cc8f7fe1f5eab010191aa4570f27641876fa1267]
  stable/4.14: [4f3ea768c56e8dce55ae538f18b37420366c5c22]
  stable/4.19: [18243d8479fd77952bdb6340024169d30b173a40]
  stable/4.9: [d59073bedb7cf752b8cd4027dd0f67cf7ac4330f]
  stable/5.10: [a439819f4797f0846c7cffa9475f44aef23c541f]
  stable/5.15: [a1ba98731518b811ff90009505c1aebf6e400bc2]
  stable/5.16: [f8c61361a4f52c2a186269982587facc852dba62]
  stable/5.4: [c7337efd1d11acb6f84c68ffee57d3f312e87b24]
