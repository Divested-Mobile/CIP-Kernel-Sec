description: 'kernel: Linux ebpf logic vulnerability leads to critical memory read
  and write gaining root privileges'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2044578
- https://access.redhat.com/security/cve/CVE-2022-0500
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0500
- https://lore.kernel.org/bpf/20211217003152.48334-1-haoluo@google.com/
- https://lore.kernel.org/stable/20220216225209.2196865-1-haoluo@google.com/
- https://ubuntu.com/security/notices/USN-5518-1
- https://ubuntu.com/security/notices/USN-5564-1
- https://www.cve.org/CVERecord?id=CVE-2022-0500
comments:
  debian/bwh: |-
    Commit 34d3a78c681 references several commits from 5.10 as
    being fixed, so branches based on 5.10 are affected and older
    branches are probably not.
  debian/carnil: |-
    As of 2022-02-21 the RH bugzilla entry does not contain enough
    information to determine which commit(s) in 5.17-rc1 are meant
    to address the issue.
    Fixed as well in 5.16.11 for 5.16.y.
    Additionally we need to clarify the scope of CVE-2022-0500. The
    list of commits cover as well
    c25b2ae136039ffa820c26138ed4a5e5f3ab3841 which for older
    version addressed "bpf: Fix out of bounds access from invalid
    *_or_null type verification".
    https://bugzilla.redhat.com/show_bug.cgi?id=2044578#c13 is
    unaswered yet (as of 2022-02-23).
    https://lore.kernel.org/stable/20220216225209.2196865-1-haoluo@google.com/
    The fix for the specific CVE is patch 7/9 "bpf: Make
    per_cpu_ptr return rdonly PTR_TO_MEM".
  masami: |-
    OOB write bug was found in unrestricted eBPF usage by the BPF_BTF_LOAD.
    According to the https://lore.kernel.org/bpf/20211217003152.48334-1-haoluo@google.com/ ,
    commit 34d3a78 ("bpf: Make per_cpu_ptr return rdonly PTR_TO_MEM") is the main fix for
    this issue. This commit fixes commit 63d9b80, eaa6bcb, and 4976b71. These commits were
    merged since 5.10-rc1. So, stable 5.4, 4.19, 4.9, and 4.4 kernels are not included these
    commit.
  ubuntu/sbeattie: |-
    unprivileged eBPF has been disabled by default in Ubuntu
      kernels as of 2022-03-08, requires CAP_SYS_ADMIN or CAP_BPF
      privileges.
introduced-by:
  mainline: [63d9b80dcf2c67bc5ade61cbbaa09d7af21f43f1, eaa6bcb71ef6ed3dc18fc525ee7e293b06b4882b,
    4976b718c3551faba2c0616ef55ebeb74db1c5ca]
fixed-by:
  mainline: [20b2aff4bc15bda809f994761d5719827d66c0b4, 216e3cd2f28dbbf1fe86848e0e29e6693b9f0a20,
    34d3a78c681e8e7844b43d1a2f4671a04249c821, 3c4807322660d4290ac9062c034aed6b87243861,
    48946bd6a5d695c50b34546864b79c1f910a33c1, c25b2ae136039ffa820c26138ed4a5e5f3ab3841,
    cf9f2f8d62eca810afbd1ee6cc0800202b000e57]
  stable/5.15: [b453361384c2db1c703dacb806d5fd36aec4ceca, 2a77c58726aba893129a369ed3d2be004dda41cd,
    15166bb3000fc8b5faa8fa606eb25d300e6892ef, 3c141c82b95807473d77079936769e04a84e4ca3,
    d58a396fa6c98bde64772c1db715dfca32610597, 8d38cde47a7e17b646401fa92d916503caa5375e,
    b710f73704d61069b2f05358309290551e5a8732]
  stable/5.16: [e982070f8970bb62e69ed7c9cafff886ed200349, 4a6c35debbd46d796c81eb3ffcd6c747e76ec7a3,
    199cdd057eb747b36a193ecf96d2452e36643163, 5b33e437dc6a02e3298858ca8591096f36b1421d,
    bcd98af3eb7527f6ba39c976cbcf4454fa1106e1, 77459bc4d5e2c6f24db845780b4d9d60cf82d06a,
    6f6edc4211b379ef6de25d9182148c7ca26ffcfb]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
