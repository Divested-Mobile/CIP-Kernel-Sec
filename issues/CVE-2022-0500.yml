description: 'kernel: Linux ebpf logic vulnerability leads to critical memory read
  and write gaining root privileges'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2044578
- https://access.redhat.com/security/cve/CVE-2022-0500
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0500
- https://lore.kernel.org/bpf/20211217003152.48334-1-haoluo@google.com/
- https://lore.kernel.org/stable/20220216225209.2196865-1-haoluo@google.com/
comments:
  debian/carnil: |-
    As of 2022-02-21 the RH bugzilla entry does not contain enough
    information to determine which commit(s) in 5.17-rc1 are meant
    to address the issue.
  masami: |-
    OOB write bug was found in unrestricted eBPF usage by the BPF_BTF_LOAD.
    According to the https://lore.kernel.org/bpf/20211217003152.48334-1-haoluo@google.com/ ,
    commit 34d3a78 ("bpf: Make per_cpu_ptr return rdonly PTR_TO_MEM") is the main fix for
    this issue. This commit fixes commit 63d9b80, eaa6bcb, and 4976b71. These commits were
    merged since 5.10-rc1. So, stable 5.4, 4.19, 4.9, and 4.4 kernels are not included these
    commit.
introduced-by:
  maineline: [63d9b80dcf2c67bc5ade61cbbaa09d7af21f43f1, eaa6bcb71ef6ed3dc18fc525ee7e293b06b4882b,
    4976b718c3551faba2c0616ef55ebeb74db1c5ca]
fixed-by:
  mainline: [20b2aff4bc15bda809f994761d5719827d66c0b4, 216e3cd2f28dbbf1fe86848e0e29e6693b9f0a20,
    34d3a78c681e8e7844b43d1a2f4671a04249c821, 3c4807322660d4290ac9062c034aed6b87243861,
    48946bd6a5d695c50b34546864b79c1f910a33c1, c25b2ae136039ffa820c26138ed4a5e5f3ab3841,
    cf9f2f8d62eca810afbd1ee6cc0800202b000e57]
  stable/5.16: [e982070f8970bb62e69ed7c9cafff886ed200349, 4a6c35debbd46d796c81eb3ffcd6c747e76ec7a3,
    199cdd057eb747b36a193ecf96d2452e36643163, 5b33e437dc6a02e3298858ca8591096f36b1421d,
    bcd98af3eb7527f6ba39c976cbcf4454fa1106e1, 77459bc4d5e2c6f24db845780b4d9d60cf82d06a,
    6f6edc4211b379ef6de25d9182148c7ca26ffcfb]
