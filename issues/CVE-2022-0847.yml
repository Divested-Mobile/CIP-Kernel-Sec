description: 'lib/iov_iter: initialize "flags" in new pipe_buffer'
references:
- https://www.openwall.com/lists/oss-security/2022/03/07/1
- https://dirtypipe.cm4all.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0847
- https://ubuntu.com/security/notices/USN-5317-1
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/DirtyPipe
- https://ubuntu.com/security/notices/USN-5362-1
- https://www.cve.org/CVERecord?id=CVE-2022-0847
comments:
  debian/carnil: |-
    Only exploitable starting in 5.8-rc1 due to f6dd975583bd
    ("pipe: merge anon_pipe_buf*_ops"). The commit which landed in
    5.17-rc6 was still backported to all stable series.
  masami: |-
    Uninitialize bug was introduced since since 241699cd
    ("new iov_iter flavour: pipe-backed") that was merged at 4.9.
    The commit f6dd975583bd
    ("pipe: merge anon_pipe_buf*_ops") that was merged at 5.8-rc1
    made this bug becomes exploitable.
    4.4.y isn't affected by this issue.
    4.19 and 4.9 had uninitialized bug but they does not contain
    commit f6dd975583bd so that they are not exploitable.
  ubuntu/mdeslaur: |-
    The specific flaw exists in the bionic and focal, but is not
    currently exploitable due to lack of a flag that was introduced
    in kernel 5.8. The flaw will be fixed as part of the next round
    of bionic and focal kernel updates in case some other way of
    exploiting it is discovered in the future.
    The hardware enablement kernel for focal, linux-hwe-5.13, was
    updated to fix this issue in USN-5317-1.
reporters:
- Max Kellermann
introduced-by:
  mainline: [241699cd72a8489c9446ae3910ddd243e9b9061b]
fixed-by:
  cip/4.19: [d46c42d8d2742742eddf9290e72df4b563f2e301]
  cip/4.19-rt: [d46c42d8d2742742eddf9290e72df4b563f2e301]
  cip/5.10: [b19ec7afa9297d862ed86443e0164643b97250ab]
  cip/5.10-rt: [b19ec7afa9297d862ed86443e0164643b97250ab]
  mainline: [9d2231c5d74e13b2a0546fee6737ee4446017903]
  stable/4.14: [a162b11c975ef9a03a75027c04052906ed7710da]
  stable/4.19: [d46c42d8d2742742eddf9290e72df4b563f2e301]
  stable/4.9: [c460ef6e0596eb5ca844c45338c20f6023f1e43c]
  stable/5.10: [b19ec7afa9297d862ed86443e0164643b97250ab]
  stable/5.15: [114e9f141822e6977633d322c1b03e89bd209932]
  stable/5.16: [eddef98207d678f21261c2bd07da55938680df4e]
  stable/5.4: [87c575d2a238febe8a04241008f18252fe5d093d]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not exploitable
  cip/4.4: Not affected
  stable/4.4: Not affected
  stable/4.9: Not exploitable
