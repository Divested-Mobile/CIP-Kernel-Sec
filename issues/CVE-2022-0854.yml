description: swiotlb information leak with DMA_FROM_DEVICE
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2058395
- https://bugzilla.suse.com/show_bug.cgi?id=1196823
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0854
comments:
  debian/carnil: |-
    For 5.16.y fixed as well in 5.16.15.
    The initial fix commited to mainline which landed in 5.17-rc6
    was an old version and so made necessary to followup with a
    rework commit aa6f8dcbab47 ("swiotlb: rework "fix info leak
    with DMA_FROM_DEVICE"").
  masami: "Commit aa6f8dc fixes ddbd89d. commit ddbd89d was marged in 5.17-rc6.\n\
    Commit ddbd89d describes commit a45b599 (\"scsi: sg: allocate with __GFP_ZERO\
    \ in\nsg_build_indirect()\") in the bug flaw steps. The commit a45b599 was backported\n\
    to stable kernels(includes 4.4.y). So it seems as if stable kernels are\naffected\
    \ by this issue.  \nPatches were failed to apply to 4.9, 4.19, 5.4, and 5.10.\n\
    Also, kernel/dma/swiotlb.c and related files were moved from lib/ to kernel/dma/\n\
    since 4.18-rc2 by commit cf65a0f (\"dma-mapping: move all DMA mapping code to\
    \ \nkernel/dma\")."
introduced-by:
  mainline: [ddbd89deb7d32b1fbb879f48d68fda1a8ac58e8e]
  stable/5.15: [7403f4118ab94be837ab9d770507537a8057bc63]
  stable/5.16: [270475d6d2410ec66e971bf181afe1958dad565e]
fixed-by:
  mainline: [ddbd89deb7d32b1fbb879f48d68fda1a8ac58e8e, aa6f8dcbab473f3a3c7454b74caa46d36cdc5d13]
  stable/5.15: [7403f4118ab94be837ab9d770507537a8057bc63, 2c1f97af38be151527380796d31d3c9adb054bf9]
  stable/5.16: [270475d6d2410ec66e971bf181afe1958dad565e, 62b27d925655999350d0ea775a025919fd88d27f]
