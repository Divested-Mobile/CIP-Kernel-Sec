description: swiotlb information leak with DMA_FROM_DEVICE
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2058395
- https://bugzilla.suse.com/show_bug.cgi?id=1196823
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-0854
- https://ubuntu.com/security/notices/USN-5381-1
- https://www.cve.org/CVERecord?id=CVE-2022-0854
comments:
  debian/bwh: |-
    The second part (commit aa6f8dcbab47) was reverted and replaced by
    commit 901c7280ca0d "Reinstate some of "swiotlb: rework "fix info
    leak with DMA_FROM_DEVICE""" in 5.18-rc1. That was applied in 5.17.2
    but should probably be applied to other stable branches too.
  debian/carnil: |-
    For 5.16.y fixed as well in 5.16.15.
    The initial fix commited to mainline which landed in 5.17-rc6
    was an old version and so made necessary to followup with a
    rework commit aa6f8dcbab47 ("swiotlb: rework "fix info leak
    with DMA_FROM_DEVICE"").
    The second part of the fix was holded back for stable trees due to
    regression caused on at least some wireless drivers, cf.
    https://lore.kernel.org/stable/Yj7oXgoCdhWAwFQt@kroah.com/
  masami: "Commit aa6f8dc fixes ddbd89d. commit ddbd89d was marged in 5.17-rc6.\n\
    Commit ddbd89d describes commit a45b599 (\"scsi: sg: allocate with __GFP_ZERO\
    \ in\nsg_build_indirect()\") in the bug flaw steps. The commit a45b599 was backported\n\
    to stable kernels(includes 4.4.y). So it seems as if stable kernels are\naffected\
    \ by this issue.  \nPatches were failed to apply to 4.9, 4.19, 5.4, and 5.10.\n\
    Also, kernel/dma/swiotlb.c and related files were moved from lib/ to kernel/dma/\n\
    since 4.18-rc2 by commit cf65a0f (\"dma-mapping: move all DMA mapping code to\
    \ \nkernel/dma\")."
introduced-by:
  cip/4.19: [8d9ac1b6665c73f23e963775f85d99679fd8e192]
  cip/4.19-rt: [8d9ac1b6665c73f23e963775f85d99679fd8e192]
  cip/5.10: [d4d975e7921079f877f828099bb8260af335508f]
  cip/5.10-rt: [d4d975e7921079f877f828099bb8260af335508f]
  mainline: [ddbd89deb7d32b1fbb879f48d68fda1a8ac58e8e]
  openela/4.14: [971e5dadffd02beba1063e7dd9c3a82de17cf534]
  stable/4.14: [971e5dadffd02beba1063e7dd9c3a82de17cf534]
  stable/4.19: [8d9ac1b6665c73f23e963775f85d99679fd8e192]
  stable/4.9: [c132f2ba716b5ee6b35f82226a6e5417d013d753]
  stable/5.10: [d4d975e7921079f877f828099bb8260af335508f]
  stable/5.15: [7403f4118ab94be837ab9d770507537a8057bc63]
  stable/5.16: [270475d6d2410ec66e971bf181afe1958dad565e]
  stable/5.4: [6bfc5377a210dbda2a237f16d94d1bd4f1335026]
  ubuntu/bionic: [8ed26d03a5a58fc79c1392196a1a6c7eccd74809]
  ubuntu/focal: [b7d20fc13caf91f27a76719156d4c238dda402d8]
fixed-by:
  cip/4.19: [8d9ac1b6665c73f23e963775f85d99679fd8e192, 06cb238b0f7ac1669cb06390704c61794724c191]
  cip/4.19-rt: [8d9ac1b6665c73f23e963775f85d99679fd8e192, 06cb238b0f7ac1669cb06390704c61794724c191]
  cip/5.10: [d4d975e7921079f877f828099bb8260af335508f, f3f2247ac31cb71d1f05f56536df5946c6652f4a]
  cip/5.10-rt: [d4d975e7921079f877f828099bb8260af335508f, f3f2247ac31cb71d1f05f56536df5946c6652f4a]
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [ddbd89deb7d32b1fbb879f48d68fda1a8ac58e8e, aa6f8dcbab473f3a3c7454b74caa46d36cdc5d13]
  stable/4.19: [8d9ac1b6665c73f23e963775f85d99679fd8e192, 06cb238b0f7ac1669cb06390704c61794724c191]
  stable/4.9: [c132f2ba716b5ee6b35f82226a6e5417d013d753, fd97de9c7b973f46a6103f4170c5efc7b8ef8797]
  stable/5.10: [d4d975e7921079f877f828099bb8260af335508f, f3f2247ac31cb71d1f05f56536df5946c6652f4a]
  stable/5.15: [7403f4118ab94be837ab9d770507537a8057bc63, 2c1f97af38be151527380796d31d3c9adb054bf9]
  stable/5.16: [270475d6d2410ec66e971bf181afe1958dad565e, 62b27d925655999350d0ea775a025919fd88d27f]
  ubuntu/bionic: ['version:4.15.0-191.202']
  ubuntu/focal: ['version:5.4.0-126.142']
