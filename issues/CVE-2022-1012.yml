description: 'secure_seq: use the 64 bits of the siphash for port offset calculation'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2064604
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1012
- https://git.kernel.org/linus/b2d057560b8107c633b39aabe517ff9d93f285e3
comments:
  debian/carnil: |-
    Fixed in 5.17.9 for 5.17.y. For older series only one commit
    was applied so far (5.10.117, 4.19.244) and needs check what is
    actually needed.
    Does the backported commit help mitigating the issue? The fix
    is AFAIU not truncating to 32bit the output, but use the 64bits
    of SipHash for the port offset calculation.
    The main part seems to be b2d057560b81 ("secure_seq: use the 64
    bits of the siphash for port offset calculation") in 5.18-rc6
    which is backported to 5.10.119 as well.
  masami: |-
    A memory leak issue was found in secure_ipv4_port_ephemeral() and
    secure_ipv6_port_ephemeral().
    Commit 7cd23e5 ("secure_seq: use SipHash in place of MD5") is referenced
    to cause of this bug. This commit was merged in 4.11-rc1.
introduced-by:
  mainline: [7cd23e5300c1b95903859a8bdc084e79be66ce16]
fixed-by:
  mainline: [b2d057560b8107c633b39aabe517ff9d93f285e3, 9e9b70ae923baf2b5e8a0ea4fd0c8451801ac526,
    4dfa9b438ee34caca4e6a4e5e961641807367f6f, ca7af0402550f9a0b3316d5f1c30904e42ed257d,
    e9261476184be1abd486c9434164b2acbe0ed6c2, 4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5,
    e8161345ddbb66e449abde10d2fdce93f867eba9]
  stable/4.19: [abcf4e1277d169b82dd7ee290006487ed16016ce]
  stable/5.10: [d254309aab27fdcdc68e6bc9c663e51f3e7b37dc, a5c68f457fbf52c5564ca4eea03f84776ef14e41]
  stable/5.15: [1a8ee547da2b64d6a2aedbd38a691578eff14718, ff01554d8755bdbe2aec2e2cff322d95f328cb89,
    f41f6336bfc43500e4e94ada703cd5aebb91789e, b763fce193b42048444afd85d066b136288ad2c8,
    4a3eefa399e675c4a5239497832a72733281a20f, 952a238d779eea4ecb2f8deb5004c8f56be79bc9,
    f26c6f9404e1d6f3bfc9780ffba82a01a595d147]
  stable/5.17: [6976724355f5fdada89de528730f9a7b4928f2e3, 27003fa8b581098aa9768bc03f82d5654368cb02,
    3a8081f81323e1550c241157244318db166b660e, c2cef1db8f8aa81330fee4538a1158e1f6fd5bd1,
    01e16c23823a057667feb5cf26ba0c963fef6afd, e3ee7bb47d6509c3e8a3e96e5d8e3bf21549b6e8,
    5034cbb361e1c447911a15b1d3982d5df7aa17b9]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.9: Not affected
