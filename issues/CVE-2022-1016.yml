description: |-
  The nft_do_chain routine in net/netfilter/nf_tables_core.c does not
  initialize the register data that nf_tables expressions can read from-
  and write to. These expressions inherently exhibit side effects that
  can be used to determine the register data, which can contain kernel
  image pointers, module pointers, and allocation pointers depending on
  the code path taken to end up at nft_do_chain.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1016
- https://www.openwall.com/lists/oss-security/2022/03/28/5
reporters:
- David Bouman
comments:
  masami: |-
    Applying commit 4c905f to 4.4.y  has merge conflict but easy to fix.
introduced-by:
  mainline: [96518518cc417bb0a8c80b9fb736202e28acdf96]
fixed-by:
  mainline: [4c905f6740a365464e91467aa50916555b28213d]
  stable/4.14: [a3cc32863b175168283cb0a5fde08de6a1e27df9]
  stable/4.19: [88791b79a1eb2ba94e95d039243e28433583a67b]
  stable/4.9: [4d28522acd1c4415c85f6b33463713a268f68965]
  stable/5.10: [2c74374c2e88c7b7992bf808d9f9391f7452f9d9]
  stable/5.15: [fafb904156fbb8f1dd34970cd5223e00b47c33be]
  stable/5.16: [64f24c76dd0ce53d0fa3a0bfb9aeea507c769485]
  stable/5.17: [dd03640529204ef4b8189fbdea08217d8d98271f]
  stable/5.4: [06f0ff82c70241a766a811ae1acf07d6e2734dcb]
