description: |-
  The nft_do_chain routine in net/netfilter/nf_tables_core.c does not
  initialize the register data that nf_tables expressions can read from-
  and write to. These expressions inherently exhibit side effects that
  can be used to determine the register data, which can contain kernel
  image pointers, module pointers, and allocation pointers depending on
  the code path taken to end up at nft_do_chain.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1016
- https://www.openwall.com/lists/oss-security/2022/03/28/5
- https://ubuntu.com/security/notices/USN-5381-1
- https://ubuntu.com/security/notices/USN-5383-1
- https://ubuntu.com/security/notices/USN-5390-1
- https://ubuntu.com/security/notices/USN-5390-2
- https://ubuntu.com/security/notices/USN-5415-1
- http://blog.dbouman.nl/2022/04/02/How-The-Tables-Have-Turned-CVE-2022-1015-1016/
- https://ubuntu.com/security/notices/USN-5466-1
- https://ubuntu.com/security/notices/USN-6001-1
- https://ubuntu.com/security/notices/USN-6013-1
- https://ubuntu.com/security/notices/USN-6014-1
- https://www.cve.org/CVERecord?id=CVE-2022-1016
comments:
  debian/carnil: |-
    Exploitable starting from commit 96518518cc41 (original merge
    of nf_tables) in 3.13-rc1.
    Fixed as well in 5.17.1 for 5.17.y and 5.16.18 for 5.16.y.
  masami: Applying commit 4c905f to 4.4.y  has merge conflict but easy to fix.
reporters:
- David Bouman
introduced-by:
  mainline: [96518518cc417bb0a8c80b9fb736202e28acdf96]
fixed-by:
  cip/4.19: [88791b79a1eb2ba94e95d039243e28433583a67b]
  cip/4.19-rt: [88791b79a1eb2ba94e95d039243e28433583a67b]
  cip/4.4: [d90721416cde50f04a108331d524c69c7213be83]
  cip/4.4-rt: [d90721416cde50f04a108331d524c69c7213be83]
  cip/4.4-st: [d90721416cde50f04a108331d524c69c7213be83]
  cip/5.10: [2c74374c2e88c7b7992bf808d9f9391f7452f9d9]
  cip/5.10-rt: [2c74374c2e88c7b7992bf808d9f9391f7452f9d9]
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [4c905f6740a365464e91467aa50916555b28213d]
  openela/4.14: [a3cc32863b175168283cb0a5fde08de6a1e27df9]
  stable/4.14: [a3cc32863b175168283cb0a5fde08de6a1e27df9]
  stable/4.19: [88791b79a1eb2ba94e95d039243e28433583a67b]
  stable/4.9: [4d28522acd1c4415c85f6b33463713a268f68965]
  stable/5.10: [2c74374c2e88c7b7992bf808d9f9391f7452f9d9]
  stable/5.15: [fafb904156fbb8f1dd34970cd5223e00b47c33be]
  stable/5.16: [64f24c76dd0ce53d0fa3a0bfb9aeea507c769485]
  stable/5.17: [dd03640529204ef4b8189fbdea08217d8d98271f]
  stable/5.4: [06f0ff82c70241a766a811ae1acf07d6e2734dcb]
  ubuntu/bionic: [e7a5481ee8a53bd4ad444444d62276ec5bc272f6]
  ubuntu/focal: [aa613b08e993482ea17480ea66bcc59188f37e4b]
