description: 'io_uring: fix xa_alloc_cycle() error return value check'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=1997328
- https://bugzilla.suse.com/show_bug.cgi?id=1197393
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1043
- https://git.kernel.org/linus/a30f895ad3239f45012e860d4f94c1a388b36d14
- https://github.com/opensrcsec/same_type_object_reuse_exploits/blob/main/cve-2022-1043.c
comments:
  debian/carnil: |-
    Introduced by 61cf93700fe6 ("io_uring: Convert personality_idr
    to XArray") in 5.12-rc3 (got backported to 5.10.51).
  masami: This issue is affected to 5.6 to 5.14-rc6.
introduced-by:
  cip/5.10: [c5a50a220a41dbde66ec001f50a25f52cd0a00eb]
  cip/5.10-rt: [c5a50a220a41dbde66ec001f50a25f52cd0a00eb]
  mainline: [61cf93700fe6359552848ed5e3becba6cd760efa]
  stable/5.10: [c5a50a220a41dbde66ec001f50a25f52cd0a00eb]
fixed-by:
  cip/5.10: [695ab28a7fa107d0350ab19eba8ec89fac45a95d]
  cip/5.10-rt: [695ab28a7fa107d0350ab19eba8ec89fac45a95d]
  mainline: [a30f895ad3239f45012e860d4f94c1a388b36d14]
  stable/5.10: [695ab28a7fa107d0350ab19eba8ec89fac45a95d]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
