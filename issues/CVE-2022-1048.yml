description: race condition in snd_pcm_hw_free leading to use-after-free
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2066706
- https://lore.kernel.org/all/20220322170720.3529-1-tiwai@suse.de/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1048
- https://www.openwall.com/lists/oss-security/2022/03/28/4
- https://ubuntu.com/security/notices/USN-5381-1
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5560-1
- https://ubuntu.com/security/notices/USN-5560-2
- https://ubuntu.com/security/notices/USN-5562-1
- https://ubuntu.com/security/notices/USN-5582-1
- https://ubuntu.com/security/notices/USN-5856-1
- https://www.cve.org/CVERecord?id=CVE-2022-1048
comments:
  debian/bwh: |-
    At least some of these races seem to have been introduced in 2.6.9 when
    the PCM ioctl implementation started dropping the BKL.
  debian/carnil: Fixed as well in 5.16.18 for 5.16.y and 5.17.1 for 5.17.y.
reporters:
- Hu Jiahui
fixed-by:
  cip/4.19: [9cb6c40a6ebe4a0cfc9d6a181958211682cffea9, b3830197aa7413c65767cf5a1aa8775c83f0dbf7,
    47cef5937a43a412405ea54ad6e0a91d2890493e, e14dca613e0a6ddc2bf6e360f16936a9f865205b]
  cip/4.19-rt: [9cb6c40a6ebe4a0cfc9d6a181958211682cffea9, b3830197aa7413c65767cf5a1aa8775c83f0dbf7,
    47cef5937a43a412405ea54ad6e0a91d2890493e, e14dca613e0a6ddc2bf6e360f16936a9f865205b]
  cip/5.10: [0f6947f5f5208f6ebd4d76a82a4757e2839a23f8, 8527c8f052fb42091c6569cb928e472376a4a889,
    a38440f006974e693f92a1ea10f819eccc4dcc37, b560d670c87d7d40b3cf6949246fa4c7aa65a00a]
  cip/5.10-rt: [0f6947f5f5208f6ebd4d76a82a4757e2839a23f8, 8527c8f052fb42091c6569cb928e472376a4a889,
    a38440f006974e693f92a1ea10f819eccc4dcc37, b560d670c87d7d40b3cf6949246fa4c7aa65a00a]
  debian/buster-security: ['version:debian/4.19.249-1']
  mainline: [92ee3c60ec9fe64404dc035e7c41277d74aa26cb, dca947d4d26dbf925a64a6cfb2ddbc035e831a3d,
    3c3201f8c7bb77eb53b08a3ca8d9a4ddc500b4c0, 69534c48ba8ce552ce383b3dfdb271ffe51820c3]
  openela/4.14: [a42aa926843acca96c0dfbde2e835b8137f2f092, 73867cb2bc7dfa7fbd219e53a0b68d253d8fda09,
    a1d54f97da10f7eea4817d8aae09cf20c40fa111, e7786c445bb67a9a6e64f66ebd6b7215b153ff7d]
  stable/4.14: [a42aa926843acca96c0dfbde2e835b8137f2f092, 73867cb2bc7dfa7fbd219e53a0b68d253d8fda09,
    a1d54f97da10f7eea4817d8aae09cf20c40fa111, e7786c445bb67a9a6e64f66ebd6b7215b153ff7d]
  stable/4.19: [9cb6c40a6ebe4a0cfc9d6a181958211682cffea9, b3830197aa7413c65767cf5a1aa8775c83f0dbf7,
    47cef5937a43a412405ea54ad6e0a91d2890493e, e14dca613e0a6ddc2bf6e360f16936a9f865205b]
  stable/5.10: [0f6947f5f5208f6ebd4d76a82a4757e2839a23f8, 8527c8f052fb42091c6569cb928e472376a4a889,
    a38440f006974e693f92a1ea10f819eccc4dcc37, b560d670c87d7d40b3cf6949246fa4c7aa65a00a]
  stable/5.15: [33061d0fba51d2bf70a2ef9645f703c33fe8e438, 47711ff10c7e126702cfa725f6d86ef529d15a5f,
    cb6a39c5ebd0a125c420c5a10999813daaece019, 51fce708ab8986a9879ee5da946a2cc120f1036d]
  stable/5.16: [0090c13cbbdffd7da079ac56f80373a9a1be0bf8, 4d1b0ace2d56dc27cc4921eda7fae57f77f03eb5,
    e1ff3a347ed1531eec40a24c47eab15f0efbf835, a21d2f323b5a978dedf9ff1d50f101f85e39b3f2]
  stable/5.17: [1bbf82d9f961414d6c76a08f7f843ea068e0ab7b, dd2f8c684da3e226e5ec7a81c89ff5fd4a957a03,
    e9d05532252ec41d000021d3cf40f3a2084fd5f9, 5ed8f8e3c4e59d0396b9ccf2e639711e24295bb6]
  stable/5.4: [fbeb492694ce0441053de57699e1e2b7bc148a69, 08d1807f097a63ea00a7067dad89c1c81cb2115e,
    2a559eec81acf4836d190d32b1e965d0c587c7ae, 37b12c16beb6f6c1c3c678c1aacbc46525c250f7]
  ubuntu/bionic: [d6e444ae5f9e7cef17f8d64fc478d71d43b13b2f, fcb0e88531cab6cd9015a758a15526520a7e9bf3,
    59f2591d529a091818afbad688daf1140fb72031, 66e4a232d531ccdc8732a6d40cf25687117e3bee]
  ubuntu/focal: [6b605fd6a1e3dacf5f52692ba826cc7dee8cf00d, e1aeb964629190cd54a6c99e2d87cb3b90a584c9,
    083c44ac3283a576000a5312d1b9901dc1521d22, 280c3f222e76cb0eac1e56c86ea7d6a23a711bb8]
ignore:
  debian/stretch-security: EOL
