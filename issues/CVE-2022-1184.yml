description: use-after-free and memory errors in ext4 when mounting and operating
  on a corrupted image
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2070205
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1184
- https://lore.kernel.org/linux-ext4/20220428180355.15209-1-jack@suse.cz/T/#t
- https://lore.kernel.org/linux-ext4/20220518093143.20955-1-jack@suse.cz/T/#u
- https://bugzilla.suse.com/show_bug.cgi?id=1198577
- https://ubuntu.com/security/notices/USN-6221-1
- https://ubuntu.com/security/notices/USN-6252-1
- https://ubuntu.com/security/notices/USN-6284-1
- https://ubuntu.com/security/notices/USN-6301-1
- https://ubuntu.com/security/notices/USN-6312-1
- https://ubuntu.com/security/notices/USN-6314-1
- https://ubuntu.com/security/notices/USN-6331-1
- https://ubuntu.com/security/notices/USN-6337-1
- https://www.cve.org/CVERecord?id=CVE-2022-1184
comments:
  debian/carnil: |-
    Fixed as well in 5.17.14 for 5.17.y, 5.18.3 for 5.18.y.
    Ben, pelase double check if you agree on the triage. It is
    based on the additional information provided in the SUSE
    bugzilla.
    Turns out that 46c116b920eb ("ext4: verify dir block before
    splitting it") and 3ba733f879c2 ("ext4: avoid cycles in
    directory h-tree") are not the upstream fixes, but according to
    Lukas Czerner the following is needed:
    65f8ea4cd57d ("ext4: check if directory block is within
    i_size") to fix the CVE and additional as defensive measure
    b8a04fe77ef1 ("ext4: make sure ext4_append() always allocates
    new block").
    Fixed as well in 5.18.18 for 5.18.y and in 5.19.2 for 5.19.y.
    Second commit in 6.0.3 for 6.0.y.
  ubuntu/sbeattie: |-
    not clear if the first two commits are related to this
      CVE or are some other issue.
    last three commits are per suse bug; 61a1d87a324a ("ext4: fix
      check for block being out of directory size") is a fix for
      65f8ea4cd57d ("ext4: check if directory block is within i_size")
fixed-by:
  cip/4.19: [78398c2b2cc14f9a9c8592cf6d334c5a479ed611, b3ad9ff6f06c1dc6abf7437691c88ca3d6da3ac0]
  cip/4.19-rt: [78398c2b2cc14f9a9c8592cf6d334c5a479ed611, b3ad9ff6f06c1dc6abf7437691c88ca3d6da3ac0]
  cip/4.4: [e1924c6792f168f6b72519578b144726cddcba24]
  cip/4.4-rt: [e1924c6792f168f6b72519578b144726cddcba24]
  cip/4.4-st: [e1924c6792f168f6b72519578b144726cddcba24]
  cip/5.10: [da2f05919238c7bdc6e28c79539f55c8355408bb, ff4cafa51762da3824881a9000ca421d4b78b138]
  cip/5.10-rt: [da2f05919238c7bdc6e28c79539f55c8355408bb, ff4cafa51762da3824881a9000ca421d4b78b138]
  debian/buster-security: ['version:debian/4.19.249-1']
  mainline: [46c116b920ebec58031f0a78c5ea9599b0d2a371, 3ba733f879c2a88910744647e41edeefbc0d92b2]
  stable/4.14: [d27d3caddbeff10871982d5e25e6557be0fdc29a, 24b8206fec1db21d7e82f21f0b2ff5e5672cf5b3]
  stable/4.19: [78398c2b2cc14f9a9c8592cf6d334c5a479ed611, b3ad9ff6f06c1dc6abf7437691c88ca3d6da3ac0]
  stable/4.9: [93bbf0498ba20eadcd7132bd3cfdaff54eb72751]
  stable/5.10: [da2f05919238c7bdc6e28c79539f55c8355408bb, ff4cafa51762da3824881a9000ca421d4b78b138]
  stable/5.15: [ca17db384762be0ec38373a12460081d22a8b42d, 3a3ce941645407cd0b0b7f01ad9e2ea3770f46cc]
  stable/5.18: [298659c0e7074f774a794fc293df4014617b87be, 6084240bfc44bf265ab6ae7d96980469b05be0f1]
  stable/5.4: [17034d45ec443fb0e3c0e7297f9cd10f70446064, e157c8f87e8fac112d6c955e69a60cdb9bc80a60]
  ubuntu/bionic: [25ba0fea99e65a4d737ee67590ae776e88b64f79, bd56f1fb833c32d40319df8dd4a30f8d8a500b07]
  ubuntu/focal: [ac4e6be4174b03364fca4b6d47ae20968fda4180, cf5232cacd6a93120bcce916ec86ba759cdce559]
ignore:
  debian/stretch-security: EOL
