description: use-after-free in drivers/net/hamradio/6pack.c
references:
- https://www.openwall.com/lists/oss-security/2022/04/02/3
- https://bugzilla.redhat.com/show_bug.cgi?id=2070689
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1198
- https://marc.info/?i=c012878.3292f.17fe9417790.Coremail.duoming@zju.edu.cn
- https://github.com/torvalds/linux/commit/efe4186e6a1b54bf38b9e05450d43b0da1fd7739
- https://ubuntu.com/security/notices/USN-5467-1
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5515-1
comments:
  debian/bwh: |-
    I'm not sure how old this is but it seems to be present back to 4.9.
    This depeneds on commits 0b9111922b1f "hamradio: defer 6pack kfree
    after unregister_netdev" and 81b1d548d00b "hamradio: remove
    needs_free_netdev to avoid UAF", but those are *not* yet included
    in the stable backports.
  masami: "This bug looks exist in 5.10, 4.19, and 4.4 kernels. \nHowever, backpoting\
    \ this patch require to fix conflict."
reporters:
- Duoming Zhou
fixed-by:
  cip/4.19: [79e2f40c210a47f283bca352745068207798fbb9]
  cip/4.19-rt: [79e2f40c210a47f283bca352745068207798fbb9]
  cip/4.4: [8dc7b690f1efead0d71e9dba8c604c2d0db6a54a]
  cip/4.4-st: [8dc7b690f1efead0d71e9dba8c604c2d0db6a54a]
  cip/5.10: [f67a1400788f550d201c71aeaf56706afe57f0da]
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [efe4186e6a1b54bf38b9e05450d43b0da1fd7739]
  stable/4.14: [a2793cb58444d4411810cc555eb45b8f4a228018]
  stable/4.19: [79e2f40c210a47f283bca352745068207798fbb9]
  stable/4.9: [45d1a63bacf2b6ab27f9b11b5a2431e19d34d01f]
  stable/5.10: [f67a1400788f550d201c71aeaf56706afe57f0da]
  stable/5.15: [3eb18f8a1d02a9462a0e4903efc674ca3d0406d1]
  stable/5.16: [4356343fb70c899901bce33acedf4fede797d21f]
  stable/5.4: [28c8fd84bea13cbf238d7b19d392de2fcc31331c]
  ubuntu/bionic: [7f7144fba09c1490a99b970bb70a2f61a88a4933]
  ubuntu/focal: [953844c0db91126b9446092b9dcc206035fd694a]
