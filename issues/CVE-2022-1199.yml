description: Null pointer dereference and use-after-free in ax25_release()
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2070694
- https://www.openwall.com/lists/oss-security/2022/04/02/5
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1199
- https://marc.info/?l=oss-security&m=164888973827435
- https://github.com/torvalds/linux/commit/4e0f718daf97d47cf7dec122da1be970f145c809
- https://github.com/torvalds/linux/commit/7ec02f5ac8a5be5a3f20611731243dc5e1d9ba10
- https://github.com/torvalds/linux/commit/71171ac8eb34ce7fe6b3267dce27c313ab3cb3ac
comments:
  masami: |-
    Commit 7ec02f5 ("fix NPD bug in ax25_disconnect") changed releasing
    order to sock struct to avoid NULL pointer dereference if sk is NULL.
    However, commit 71171ac ("ax25: Fix NULL pointer dereference in
    ax25_kill_by_device") added NULL pointer check before releasing sock struct.
    So, it looks commit 7ec02f5 ("fix NPD bug in ax25_disconnect") is not
    needed to fix this CVE to older kernels.
reporters:
- Duoming Zhou
fixed-by:
  debian/buster-security: ['version:debian/4.19.235-1']
  mainline: [4e0f718daf97d47cf7dec122da1be970f145c809, 7ec02f5ac8a5be5a3f20611731243dc5e1d9ba10,
    71171ac8eb34ce7fe6b3267dce27c313ab3cb3ac]
  stable/4.19: [3072e72814de56f3c674650a8af98233ddf78b19, 5ab8de9377edde3eaf1de9872e2f01d43157cd6c]
  stable/4.9: [851901d339b2ba766ffcf754d37a6f52fa07cea2, cad71f1094834eb69f7ceec8100d300c26b43053]
  stable/5.10: [b9a229fd48bfa45edb954c75a57e3931a3da6c5f, e2201ef32f933944ee02e59205adb566bafcdf91]
