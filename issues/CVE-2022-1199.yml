description: Null pointer dereference and use-after-free in ax25_release()
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2070694
- https://www.openwall.com/lists/oss-security/2022/04/02/5
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1199
- https://marc.info/?l=oss-security&m=164888973827435
- https://github.com/torvalds/linux/commit/4e0f718daf97d47cf7dec122da1be970f145c809
- https://github.com/torvalds/linux/commit/7ec02f5ac8a5be5a3f20611731243dc5e1d9ba10
- https://github.com/torvalds/linux/commit/71171ac8eb34ce7fe6b3267dce27c313ab3cb3ac
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5514-1
- https://ubuntu.com/security/notices/USN-5515-1
- https://ubuntu.com/security/notices/USN-5539-1
- https://ubuntu.com/security/notices/USN-5541-1
- https://ubuntu.com/security/notices/USN-5650-1
comments:
  masami: |-
    Commit 7ec02f5 ("fix NPD bug in ax25_disconnect") changed releasing
    order to sock struct to avoid NULL pointer dereference if sk is NULL.
    However, commit 71171ac ("ax25: Fix NULL pointer dereference in
    ax25_kill_by_device") added NULL pointer check before releasing sock struct.
    So, it looks commit 7ec02f5 ("fix NPD bug in ax25_disconnect") is not
    needed to fix this CVE to older kernels.
reporters:
- Duoming Zhou
fixed-by:
  cip/4.19: [3072e72814de56f3c674650a8af98233ddf78b19, cb18d72179bf42a6ccd2b311739017b0ba9bc26e,
    5ab8de9377edde3eaf1de9872e2f01d43157cd6c]
  cip/4.19-rt: [3072e72814de56f3c674650a8af98233ddf78b19, cb18d72179bf42a6ccd2b311739017b0ba9bc26e,
    5ab8de9377edde3eaf1de9872e2f01d43157cd6c]
  cip/4.4: [e2493544866772247a1f9fb1c35de2e45ab47243, 0f8ac8dc8d00aeaac37257f19399e0dcb975efe9]
  cip/4.4-rt: [e2493544866772247a1f9fb1c35de2e45ab47243, 0f8ac8dc8d00aeaac37257f19399e0dcb975efe9]
  cip/4.4-st: [e2493544866772247a1f9fb1c35de2e45ab47243, 0f8ac8dc8d00aeaac37257f19399e0dcb975efe9]
  cip/5.10: [b9a229fd48bfa45edb954c75a57e3931a3da6c5f, 145ea8d213e8f46667cd904ae79d17f298750f00,
    e2201ef32f933944ee02e59205adb566bafcdf91]
  cip/5.10-rt: [b9a229fd48bfa45edb954c75a57e3931a3da6c5f, 145ea8d213e8f46667cd904ae79d17f298750f00,
    e2201ef32f933944ee02e59205adb566bafcdf91]
  debian/buster-security: ['version:debian/4.19.235-1', 'version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [4e0f718daf97d47cf7dec122da1be970f145c809, 7ec02f5ac8a5be5a3f20611731243dc5e1d9ba10,
    71171ac8eb34ce7fe6b3267dce27c313ab3cb3ac]
  stable/4.14: [a509dbde35fa51d140512cbcf50068a84fdb7aad, 0b0ae8b9813b84f73dfcdec197b6455844ae6bf1,
    d03aba820f1549c9f3b1d14bf48fa082663d22b5]
  stable/4.19: [3072e72814de56f3c674650a8af98233ddf78b19, 5ab8de9377edde3eaf1de9872e2f01d43157cd6c,
    cb18d72179bf42a6ccd2b311739017b0ba9bc26e]
  stable/4.9: [851901d339b2ba766ffcf754d37a6f52fa07cea2, cad71f1094834eb69f7ceec8100d300c26b43053]
  stable/5.10: [b9a229fd48bfa45edb954c75a57e3931a3da6c5f, e2201ef32f933944ee02e59205adb566bafcdf91,
    145ea8d213e8f46667cd904ae79d17f298750f00]
  stable/5.15: [4c958f0c5714812461da7785393315b35145ac8c, da6509fba636f7f8b2e902b1e4742fdbf1bf059f,
    46ad629e58ce3a88c924ff3c5a7e9129b0df5659]
  stable/5.4: [cfc8b37ef0418529e3719c2d128e59e74a3114b0, d2be5b563ef391f684592a28440067f4fa3735f4,
    0a64aea5fe023cf1e4973676b11f49038b1f045b]
  ubuntu/bionic: [ddbdf379f5a5fd4ef35d0aefaf542958fe23a605, 6708cb32a06a7ff0b8d8eeb0b225e97c4b989049,
    ec8f47cf7004a2580e4f4aaf203924995f8468ad]
  ubuntu/focal: [e4b3d1e4ea3638ebc246c36a2e6dff5869a91312, 78af8e43feaf34882733bcbe85ed06a3824bd9db,
    7417061052fae220279775630af7831a0ae323cb]
