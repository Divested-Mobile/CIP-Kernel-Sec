description: UAF caused by binding operation when ax25 device is detaching
references:
- https://www.openwall.com/lists/oss-security/2022/04/02/2
- https://bugzilla.redhat.com/show_bug.cgi?id=2071051
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1204
- https://marc.info/?i=20c5f3a.325bc.17fe90c96f4.Coremail.duoming@zju.edu.cn
- https://github.com/torvalds/linux/commit/d01ffb9eee4af165d83b08dd73ebdf9fe94a519b
- https://github.com/torvalds/linux/commit/87563a043cef044fed5db7967a75741cc16ad2b1
- https://github.com/torvalds/linux/commit/feef318c855a361a1eccd880f33e88c460eb63b4
- https://github.com/torvalds/linux/commit/9fd75b66b8f68498454d685dc4ba13192ae069b0
- https://github.com/torvalds/linux/commit/5352a761308397a0e6250fdc629bb3f615b94747
comments:
  debian/bwh: I'm not sure how old this is but it seems to be present back to 4.9.
  debian/carnil: Missing commits in 5.17.y series were addressed in 5.17.2.
  masami: |-
    It looks route cause is commit d01ffb ("ax25: add refcount in ax25_dev
    to avoid UAF bugs"). It was merged in 5.17-rc3. This commit isn't
    backported to stable kernels. So, stable kernels seem not be affected
    by this CVE.
reporters:
- Duoming Zhou
introduced-by:
  mainline: [d01ffb9eee4af165d83b08dd73ebdf9fe94a519b]
fixed-by:
  mainline: [d01ffb9eee4af165d83b08dd73ebdf9fe94a519b, 87563a043cef044fed5db7967a75741cc16ad2b1,
    feef318c855a361a1eccd880f33e88c460eb63b4, 9fd75b66b8f68498454d685dc4ba13192ae069b0,
    5352a761308397a0e6250fdc629bb3f615b94747]
  stable/5.17: [d01ffb9eee4af165d83b08dd73ebdf9fe94a519b, 87563a043cef044fed5db7967a75741cc16ad2b1,
    feef318c855a361a1eccd880f33e88c460eb63b4, 534156dd4ed768e30a43de0036f45dca7c54818f,
    01619aa347d35ac8b79751757784ec6f507a3215]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
  stable/5.16: Not affected
