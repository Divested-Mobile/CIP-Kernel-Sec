description: 'KVM: avoid NULL pointer dereference in kvm_dirty_ring_push'
references:
- https://www.openwall.com/lists/oss-security/2022/04/07/1
- https://www.spinics.net/lists/kvm/msg273052.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1263
comments:
  debian/bwh: |-
    Introduced in 5.11-rc1 by commit fb04a1eddb1a "KVM: X86: Implement
    ring-based dirty memory tracking". Fix is currently in next as
    commit 5593473a1e6c "KVM: avoid NULL pointer dereference in
    kvm_dirty_ring_push".
  debian/carnil: For 5.17.y fixed as well in 5.17.3
  masami: |-
    Added kvm_dirty_ring_free() in kvm_vcpu_destroy() was commit fb04a1e ("KVM:
    X86: Implement ring-based dirty memory tracking") that was merged in
    5.11-rc1. So, earlier than 5.11 kernels may not be affected by this
    vulnerability.
  ubuntu/sbeattie: PoC in oss-security post
reporters:
- Qiuhao Li
- Gaoning Pan
- Yongkang Jia
introduced-by:
  mainline: [fb04a1eddb1a65b6588a021bdc132270d5ae48bb]
fixed-by:
  mainline: [5593473a1e6c743764b08e3b6071cb43b5cfa6c4]
  stable/5.15: [226b4327ef5c88572fc12187193f1b5073c10837]
  stable/5.17: [e8d7f0dad29e634e26d4614cfbd081514c16e042]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
