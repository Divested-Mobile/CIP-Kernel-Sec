description: 'KVM: avoid NULL pointer dereference in kvm_dirty_ring_push'
references:
- https://www.openwall.com/lists/oss-security/2022/04/07/1
- https://www.spinics.net/lists/kvm/msg273052.html
comments:
  masami: |-
    Added kvm_dirty_ring_free() in kvm_vcpu_destroy() was commit fb04a1e ("KVM:
    X86: Implement ring-based dirty memory tracking") that was merged in
    5.11-rc1. So, earlier than 5.11 kernels may not be affected by this
    vulnerability.
introduced-by:
  mainline: [fb04a1eddb1a65b6588a021bdc132270d5ae48bb]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
