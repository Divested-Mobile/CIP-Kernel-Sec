description: concurrency use-after-free between drm_setmaster_ioctl and drm_mode_getresources
references:
- https://www.openwall.com/lists/oss-security/2022/04/12/3
- https://bugzilla.redhat.com/show_bug.cgi?id=2071022
- https://bugzilla.suse.com/show_bug.cgi?id=1197914
- https://www.openwall.com/lists/oss-security/2022/04/12/4
comments:
  debian/carnil: |-
    Not a problem on 5.15.y and newer, but the list of commits need
    to be isolated yet.
  masami: |-
    The reporter found this bug in 4.19.237. Kernel 5.15 and newer are already
    fixed (https://www.openwall.com/lists/oss-security/2022/04/12/4) but not
    described which commit(s) fixes this bug. According to the 
    PoC(https://www.openwall.com/lists/oss-security/2022/04/12/3), it needs to open /dev/dri/card0. 
    However, /dev/dri/card0's permission is following.
    crw-rw----+ 1 root video 226, 0 Apr 13 09:15 /dev/dri/card0
    So, attacker must have correct privilege to abuse this CVE.
