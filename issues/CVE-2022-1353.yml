description: 'af_key: add __GFP_ZERO flag for compose_sadb_supported in function pfkey_register'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2066819
- https://lore.kernel.org/all/20220321215240.490132-2-sashal@kernel.org/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1353
- https://git.kernel.org/linus/9a564bccb78a76740ea9d75a259942df8143d02c
- https://ubuntu.com/security/notices/USN-5467-1
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5500-1
- https://ubuntu.com/security/notices/USN-5505-1
- https://ubuntu.com/security/notices/USN-5513-1
- https://ubuntu.com/security/notices/USN-5515-1
- https://ubuntu.com/security/notices/USN-5541-1
- https://www.cve.org/CVERecord?id=CVE-2022-1353
comments:
  masami: |-
    An information leak bug was found in pfkey_register() in net/key/af_key.c.
    A local user unprivileged user can read internal kernel memory by this
    issue. Patch can be applied to 4.4 without any error.
    Patch hasn't been merged to 4.9 as of 2022/04/19.
fixed-by:
  cip/4.19: [693fe8af9a2625139de07bd1ae212a7d89c37795]
  cip/4.19-rt: [693fe8af9a2625139de07bd1ae212a7d89c37795]
  cip/4.4: [fcdd600eb847c684af4ee4e82696fdb7cdc2c525]
  cip/4.4-rt: [fcdd600eb847c684af4ee4e82696fdb7cdc2c525]
  cip/4.4-st: [fcdd600eb847c684af4ee4e82696fdb7cdc2c525]
  cip/5.10: [8d3f4ad43054619379ccc697cfcbdb2c266800d8]
  cip/5.10-rt: [8d3f4ad43054619379ccc697cfcbdb2c266800d8]
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [9a564bccb78a76740ea9d75a259942df8143d02c]
  openela/4.14: [fcdaaeb7eb5d52941ceb2fdcec0e2170c9bf3031]
  stable/4.14: [fcdaaeb7eb5d52941ceb2fdcec0e2170c9bf3031]
  stable/4.19: [693fe8af9a2625139de07bd1ae212a7d89c37795]
  stable/4.9: [7b0e01a9b7f2aaeb6fa73b35864b1d7dc6e795c4]
  stable/5.10: [8d3f4ad43054619379ccc697cfcbdb2c266800d8]
  stable/5.15: [d06ee4572fd916fbb34d16dc81eb37d1dff83446]
  stable/5.4: [ef388db2fe351230ff7194b37d507784bef659ec]
  ubuntu/bionic: [78d0b1c7e2786b6cea3c4a2fa064a55d15b20e83]
  ubuntu/focal: [55565bf254c4c3083b1ef43242529d5cd78c124e]
