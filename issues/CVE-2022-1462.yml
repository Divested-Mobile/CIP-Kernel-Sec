description: 'kernel: possible race condition in drivers/tty/tty_buffers.c'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2078466
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1462
- https://www.openwall.com/lists/oss-security/2022/05/27/2
- https://lore.kernel.org/all/20220601183426.GD2168@kadam/
- https://bugzilla.suse.com/show_bug.cgi?id=1198829
- https://ubuntu.com/security/notices/USN-6001-1
- https://ubuntu.com/security/notices/USN-6013-1
- https://ubuntu.com/security/notices/USN-6014-1
- https://www.cve.org/CVERecord?id=CVE-2022-1462
comments:
  debian/bwh: |-
    All branches affected because this was introduced by a fix that
    was also backported to stable.
  debian/carnil: |-
    As of 2022-05-26 not much details provided in RH bugzilla:
    descriptions reads as An out-of-bounds read flaw was found in
    the Linux kernelâ€™s TeleTYpe subsystem. The issue occurs in
    how a user triggers a race condition using ioctls TIOCSPTLCK
    and TIOCGPTPEER and TIOCSTI and TCXONC with leakage of memory
    in the flush_to_ldisc function. This flaw allows a local user
    to crash the system or read unauthorized random data from
    memory.
    Issue introduced by 71a174b39f10 ("pty: do tty_flip_buffer_push
    without port->lock in pty_write") in 5.10-rc1.
  masami: |-
    The reporter desciribes introduced commit which is commit
    b6da31b ("tty: Fix data race in
    tty_insert_flip_string_fixed_flag").
    All stable kernels and 4.4 kernel are affected by this
    bug.
  ubuntu/sbeattie: |-
    prequisite fix would be 716b10580283 ("tty: extract
      tty_flip_buffer_commit() from tty_flip_buffer_push()")
  ubuntu/seth-arnold: I didn't spot a fix anywhere
introduced-by:
  aosp/3.18: [6d9cd12792270773fab9e5a129daff328d61ef9e]
  cip/4.4: [6dbfa9b5ae65063cd61dc7fa11332e00bb794d8b]
  cip/4.4-rt: [6dbfa9b5ae65063cd61dc7fa11332e00bb794d8b]
  cip/4.4-st: [6dbfa9b5ae65063cd61dc7fa11332e00bb794d8b]
  mainline: [b6da31b2c07c46f2dcad1d86caa835227a16d9ff]
  openela/4.14: [deb1feaad03a78b545c949e54582ae57b3c56982]
  stable/3.18: [6d9cd12792270773fab9e5a129daff328d61ef9e]
  stable/4.14: [deb1feaad03a78b545c949e54582ae57b3c56982]
  stable/4.4: [6dbfa9b5ae65063cd61dc7fa11332e00bb794d8b]
  stable/4.9: [d83904cb2eb2c4d937eaf15032214b0578f25099]
  ubuntu/bionic: [f89e73d6f0fb5426fd90fc4922685de94bf7fbe0]
  ubuntu/xenial: [08d99ee7b2dceba3d9e17954a8eac1b667e99306]
fixed-by:
  cip/4.19: [eb059bf8c237fe41fbaed4a6cccacce687b83222]
  cip/4.19-rt: [eb059bf8c237fe41fbaed4a6cccacce687b83222]
  cip/4.4: [f6412965114ff68ba894b704883ebd9ecc396e1f]
  cip/4.4-rt: [f6412965114ff68ba894b704883ebd9ecc396e1f]
  cip/4.4-st: [f6412965114ff68ba894b704883ebd9ecc396e1f]
  cip/5.10: [08afa87f58d83dfe040572ed591b47e8cb9e225c]
  cip/5.10-rt: [08afa87f58d83dfe040572ed591b47e8cb9e225c]
  debian/buster-security: ['version:debian/4.19.260-1']
  debian/stretch-security: ['version:debian/4.9.240-1']
  mainline: [a501ab75e7624d133a5a3c7ec010687c8b961d23]
  openela/4.14: [e9274a2732e1de3ca36076126284b4e5ffe6d587]
  stable/4.14: [e9274a2732e1de3ca36076126284b4e5ffe6d587]
  stable/4.19: [eb059bf8c237fe41fbaed4a6cccacce687b83222]
  stable/4.9: [41ce14090db93fc2f0c8a27ce8a324b0192da7b5]
  stable/5.10: [08afa87f58d83dfe040572ed591b47e8cb9e225c]
  stable/5.15: [b2d1e4cd558cffec6bfe318f5d74e6cffc374d29]
  stable/5.4: [f7785092cb7f022f59ebdaa181651f7c877df132]
  ubuntu/bionic: [31a27b446620ddc6bd7ef986fbef99ad04692d86]
  ubuntu/focal: [38fa04d9c1028b84ac7742ba2a76f1d0abef5d11]
ignore:
  debian/stretch-security: EOL
