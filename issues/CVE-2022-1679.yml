description: Use-After-Free in ath9k_htc_probe_device() could cause an escalation
  of privileges
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2084125
- https://lore.kernel.org/lkml/87ilqc7jv9.fsf@kernel.org/t/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1679
- https://lore.kernel.org/lkml/f158608e209a6f45c76ec856474a796df93d9dcf.1652553719.git.paskripkin@gmail.com/T/#u
- https://lore.kernel.org/lkml/d57bbedc857950659bfacac0ab48790c1eda00c8.1655145743.git.paskripkin@gmail.com/
- https://git.kernel.org/pub/scm/linux/kernel/git/kvalo/ath.git/commit/?h=ath-next&id=0ac4827f78c7ffe8eef074bc010e7e34bc22f533
- https://ubuntu.com/security/notices/USN-5500-1
- https://ubuntu.com/security/notices/USN-5505-1
- https://ubuntu.com/security/notices/USN-5513-1
- https://ubuntu.com/security/notices/USN-5529-1
- https://ubuntu.com/security/notices/USN-5517-1
- https://ubuntu.com/security/notices/USN-5544-1
- https://ubuntu.com/security/notices/USN-5560-1
- https://ubuntu.com/security/notices/USN-5560-2
- https://ubuntu.com/security/notices/USN-5562-1
- https://ubuntu.com/security/notices/USN-5564-1
- https://ubuntu.com/security/notices/USN-5566-1
- https://ubuntu.com/security/notices/USN-5582-1
- https://www.cve.org/CVERecord?id=CVE-2022-1679
comments:
  debian/bwh: |-
    The patch says it fixes commit fb9987d0f748 "ath9k_htc: Support for
    AR9271 chipset." i.e. when the driver was added in 2.6.35.
  debian/carnil: Fixed as well in 5.18.18 for 5.18.y and 5.19.2 for 5.19.y.
  masami: "An UAF bug was found in ath9k_htc_probe_device() in the ath9k driver. \n\
    Patch is available but not merged into the mainline yet."
introduced-by:
  mainline: [fb9987d0f748c983bb795a86f47522313f701a08]
fixed-by:
  cip/4.19: [ab7a0ddf5f1cdec63cb21840369873806fc36d80]
  cip/4.19-rt: [ab7a0ddf5f1cdec63cb21840369873806fc36d80]
  cip/5.10: [eccd7c3e2596b574241a7670b5b53f5322f470e5]
  cip/5.10-rt: [eccd7c3e2596b574241a7670b5b53f5322f470e5]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [0ac4827f78c7ffe8eef074bc010e7e34bc22f533]
  openela/4.14: [62bc1ea5c7401d77eaf73d0c6a15f3d2e742856e]
  stable/4.14: [62bc1ea5c7401d77eaf73d0c6a15f3d2e742856e]
  stable/4.19: [ab7a0ddf5f1cdec63cb21840369873806fc36d80]
  stable/5.10: [eccd7c3e2596b574241a7670b5b53f5322f470e5]
  stable/5.15: [03ca957c5f7b55660957eda20b5db4110319ac7a]
  stable/5.19: [b66ebac40f64336ae2d053883bee85261060bd27]
  stable/5.4: [e9e21206b8ea62220b486310c61277e7ebfe7cec]
  ubuntu/bionic: [3d6c8425963f34f4e0f7156100efb29185a86338]
  ubuntu/focal: [44b588bcb216fd7600de8b2cafe15d114bcd3df2]
