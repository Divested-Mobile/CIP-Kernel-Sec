description: 'KVM: x86/mmu: fix NULL pointer dereference on guest INVPCID'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1789
- https://git.kernel.org/linus/9f46c187e2e680ecd9de7983e4d081c3391acc76
- https://www.openwall.com/lists/oss-security/2022/05/25/2
- https://ubuntu.com/security/notices/USN-5514-1
- https://ubuntu.com/security/notices/USN-5529-1
- https://ubuntu.com/security/notices/USN-5518-1
- https://ubuntu.com/security/notices/USN-5539-1
- https://ubuntu.com/security/notices/USN-5564-1
- https://www.cve.org/CVERecord?id=CVE-2022-1789
comments:
  debian/bwh: |-
    This appears to have been introduced in 5.8 by commit 5efac0741ce2
    "KVM: x86: introduce kvm_mmu_invalidate_gva", as before that
    the invlpg function pointer would not be set to NULL when paging
    was disabled.
  debian/carnil: Fixed in 5.17.12 for 5.17.y.
reporters:
- Yongkang Jia
introduced-by:
  mainline: [5efac0741ce238e0844d3f7af00198f81e84926a]
fixed-by:
  cip/5.10: [9b4aa0d80b18b9d19e62dd47d22e274ce92cdc95]
  cip/5.10-rt: [9b4aa0d80b18b9d19e62dd47d22e274ce92cdc95]
  mainline: [9f46c187e2e680ecd9de7983e4d081c3391acc76]
  stable/5.10: [9b4aa0d80b18b9d19e62dd47d22e274ce92cdc95]
  stable/5.15: [acd12d16528152b32fa09be2c5ef95047f69af05]
  stable/5.17: [19a66796d1f0dd4ce4b05f76d53ce1d0a7dc817d]
  ubuntu/focal: [e0754e3a11dc1dd5592e1174842daa5567858580]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
