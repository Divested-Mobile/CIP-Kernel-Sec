description: 'netfilter: nf_tables: disallow non-stateful expression in sets earlier'
references:
- https://www.openwall.com/lists/oss-security/2022/05/31/1
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/net/netfilter?id=520778042ccca019f3ffa136dd0ca565c486cedd
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1966
- https://git.kernel.org/linus/520778042ccca019f3ffa136dd0ca565c486cedd
- https://ubuntu.com/security/notices/USN-5465-1
- https://ubuntu.com/security/notices/USN-5466-1
- https://ubuntu.com/security/notices/USN-5467-1
- https://ubuntu.com/security/notices/USN-5468-1
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5470-1
- https://ubuntu.com/security/notices/USN-5471-1
comments:
  debian/carnil: For 5.17.y fixed in 5.17.13 and for 5.18.y fixed in 5.18.2
  masami: |-
    Introduced by commit 0b2d8a7 ("netfilter: nf_tables: add
    helper functions for expression handling") in 4.1-rc1.
reporters:
- Aaron Adams
introduced-by:
  mainline: [0b2d8a7b638b5034d2d68f6add8af94daaa1d4cd]
fixed-by:
  mainline: [520778042ccca019f3ffa136dd0ca565c486cedd]
  stable/5.10: [ea62d169b6e731e0b54abda1d692406f6bc6a696]
  stable/5.15: [f692bcffd1f2ce5488d24fbcb8eab5f351abf79d]
  stable/5.17: [d8db0465bcc4d4b54ecfb67b820ed26eb1440da7]
  stable/5.18: [8f44c83e51b4ca49c815f8dd0d9c38f497cdbcb0]
