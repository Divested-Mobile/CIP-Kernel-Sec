description: 'netfilter: nf_tables: sanitize nft_set_desc_concat_parse()'
references:
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=fecf31ee395b0295f2d7260aa29946b7605f7c85
- https://www.openwall.com/lists/oss-security/2022/06/02/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1972
- https://bugs.launchpad.net/bugs/1976363
- https://ubuntu.com/security/notices/USN-5468-1
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5470-1
- https://ubuntu.com/security/notices/USN-5471-1
- https://www.openwall.com/lists/oss-security/2022/08/06/6
- https://randorisec.fr/yet-another-bug-netfilter/
- https://github.com/randorisec/CVE-2022-1972-infoleak-PoC
comments:
  debian/carnil: |-
    Commit fixes f3a2181e16f1 ("netfilter: nf_tables: Support for
    sets with multiple ranged fields") in 5.6-rc1.
    Fixed for 5.17.y in 5.17.13 and for 5.18.y in 5.18.2
    CVE is a duplicate of CVE-2022-2078.
  masami: "An OOB write bug was found in the netfilter module.\nThis bug was introduced\
    \ by commit f3a2181 (\"netfilter: \nnf_tables: Support for sets with multiple\
    \ ranged fields\")\nin 5.6-rc1.\nThis commit wasn't backported to 5.4 and prior\
    \ kernels so\nthese kernels aren't affected by this vulnerability."
reporters:
- Ziming Zhang
introduced-by:
  mainline: [f3a2181e16f1dcbf5446ed43f6b5d9f56c459f85]
fixed-by:
  cip/5.10: [c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048]
  mainline: [fecf31ee395b0295f2d7260aa29946b7605f7c85]
  stable/5.10: [c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048]
  stable/5.15: [89ef50fe03a55feccf5681c237673a2f98161161]
  stable/5.17: [c88f3e3d243d701586239c5b69356ec2b1fd05f1]
  stable/5.18: [c9a46a3d549286861259c19af4747e12cfaeece9]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
