description: 'fanotify: Fix stale file descriptor in copy_event_to_user()'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2052312
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1998
- https://git.kernel.org/linus/ee12595147ac1fbfb5bcb23837e26dd58d94b15d
- https://seclists.org/oss-sec/2022/q1/99
- https://www.cve.org/CVERecord?id=CVE-2022-1998
comments:
  debian/carnil: |-
    CAP_SYS_ADMIN capability is required to exploit the issue.
    Issue introduced with f644bc449b37 ("fanotify: fix
    copy_event_to_user() fid error clean up") in 5.13-rc7 and was
    backported to 5.10.46 and 5.12.13.
introduced-by:
  cip/5.10: [ae1d3b989d19e4d8d4fee612a4d24ef992fcd25f]
  cip/5.10-rt: [ae1d3b989d19e4d8d4fee612a4d24ef992fcd25f]
  mainline: [f644bc449b37cc32d3ce7b36a88073873aa21bd5]
  stable/5.10: [ae1d3b989d19e4d8d4fee612a4d24ef992fcd25f]
fixed-by:
  cip/5.10: [7b4741644cf718c422187e74fb07661ef1d68e85]
  cip/5.10-rt: [7b4741644cf718c422187e74fb07661ef1d68e85]
  mainline: [ee12595147ac1fbfb5bcb23837e26dd58d94b15d]
  stable/5.10: [7b4741644cf718c422187e74fb07661ef1d68e85]
  stable/5.15: [60765e43e40fbf7a1df828116172440510fcc3e4]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.4: Not affected
