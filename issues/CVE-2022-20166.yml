description: 'drivers core: Use sysfs_emit and sysfs_emit_at for show(device *...)
  functions'
references:
- https://source.android.com/security/bulletin/pixel/2022-06-01
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-20166
- https://git.kernel.org/linus/aa838896d87af561a33ecefea1caa4c15a68bc47
- https://android.googlesource.com/kernel/common/+/37c7c8d4f0856ca30c2583adead91f42711f9c2f%5E%21/
- https://www.cve.org/CVERecord?id=CVE-2022-20166
comments:
  debian/bwh: |-
    Based on the Android backport of this, the specific case where a
    buffer overflow was possible must be in the name attribute of a
    wakeup_source.  This code was introduced in 5.4 by commit
    c8377adfa781 "PM / wakeup: Show wakeup sources stats in sysfs".
    If wakelocks are enabled (CONFIG_PM_WAKELOCKS=y) then user-space
    can create a wakeup_source with an arbitrary name.  However, we
    never enabled this.
  masami: |-
    The commit aa83889 ("drivers core: Use sysfs_emit and
    sysfs_emit_at for show(device *...) ……functions") was
    merged in 5.10-rc1.
    Thic commit isn't backported to 4.x kernels. So, if
    backporting commit CVE-2022-20166 to 4.x series,
    commit aa83889 is required.
fixed-by:
  cip/4.19: [3ce2cd63e8ee037644db0cbea65e6c40ab6cc178]
  cip/4.19-rt: [3ce2cd63e8ee037644db0cbea65e6c40ab6cc178]
  mainline: [aa838896d87af561a33ecefea1caa4c15a68bc47]
  stable/4.19: [3ce2cd63e8ee037644db0cbea65e6c40ab6cc178]
  stable/5.4: [9e9241d3345af3f2a78a5b60701a9cf0d15bf942]
  ubuntu/focal: [da7112bcb81839a737565adcef5187fc5e2d5573]
