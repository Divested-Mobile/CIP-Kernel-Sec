description: 'l2tp: fix race in pppol2tp_release with session object destroy'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-20567
- https://git.kernel.org/linus/d02ba2a6110c530a32926af8ad441111774d2893
- https://source.android.com/docs/security/bulletin/pixel/2022-12-01
- https://android.googlesource.com/kernel/common/+/d02ba2a6110c5
- https://bugzilla.redhat.com/show_bug.cgi?id=2174464
- https://bugzilla.suse.com/show_bug.cgi?id=1208850
- https://ubuntu.com/security/notices/USN-6700-1
- https://ubuntu.com/security/notices/USN-6700-2
- https://www.cve.org/CVERecord?id=CVE-2022-20567
comments:
  masami: |-
    Introdued by commit ee40fb2 ("l2tp: protect sock pointer of struct pppol2tp_session with RCU")
     in 4.15-rc1 and fixed in 4.16-rc5.
introduced-by:
  aosp/3.18: [fbc0a580debe4bd39a3e31c0aa9ed7612a8020f3]
  cip/4.4: [c2984681fe15cfb803a9132aaaf1140ab20a72c1]
  cip/4.4-rt: [c2984681fe15cfb803a9132aaaf1140ab20a72c1]
  cip/4.4-st: [c2984681fe15cfb803a9132aaaf1140ab20a72c1]
  mainline: [ee40fb2e1eb5bc0ddd3f2f83c6e39a454ef5a741]
  openela/4.14: [26f8819ddd10141ebe7bbce700fbab36bfa5f478]
  stable/4.14: [26f8819ddd10141ebe7bbce700fbab36bfa5f478]
  stable/4.4: [c2984681fe15cfb803a9132aaaf1140ab20a72c1]
  stable/4.9: [5803ecd7f6ac6f747582e775caa62ac9d0489261]
  ubuntu/xenial: [7b91551afc82049f165b7542de9f8923970ae200]
fixed-by:
  cip/4.4: [b241b0c3fd3be4567991634246582cb2f37baa14]
  cip/4.4-rt: [b241b0c3fd3be4567991634246582cb2f37baa14]
  cip/4.4-st: [b241b0c3fd3be4567991634246582cb2f37baa14]
  debian/buster-security: ['version:debian/4.15.11-1']
  mainline: [d02ba2a6110c530a32926af8ad441111774d2893]
  openela/4.14: [1819c764fe0f851942c2b3cf5dae516e7bbe69d8]
  stable/4.14: [1819c764fe0f851942c2b3cf5dae516e7bbe69d8]
  stable/4.9: [267b8fa3f5bf8ca6458670298a02f7438855bd80]
  ubuntu/bionic: [41e4f44abebc6cc6ba32ce2f0b796a2033284846]
  ubuntu/focal: ['version:5.4.0-135.152']
