description: Add several sanity checks for nft_set_desc_concat_parse()
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2078
- https://git.kernel.org/linus/fecf31ee395b0295f2d7260aa29946b7605f7c85
- https://bugzilla.redhat.com/show_bug.cgi?id=2096178
- https://ubuntu.com/security/notices/USN-5529-1
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=fecf31ee395b0295f2d7260aa29946b7605f7c85
- https://www.openwall.com/lists/oss-security/2022/06/02/1
- https://www.openwall.com/lists/oss-security/2022/08/06/6
- https://randorisec.fr/yet-another-bug-netfilter/
- https://github.com/randorisec/CVE-2022-1972-infoleak-PoC
- https://www.cve.org/CVERecord?id=CVE-2022-2078
comments:
  debian/carnil: |-
    Commit fixes f3a2181e16f1 ("netfilter: nf_tables: Support for
    sets with multiple ranged fields") in 5.6-rc1.
    Fixed for 5.17.y in 5.17.13 and for 5.18.y in 5.18.2
  masami: "A buffer overflow bug was found in nft_set_desc_concat_parse(). This bug\
    \ allows an attacker to system crash or possibly execute run code. \nThis issue\
    \ was introduced by commit f3a2181 (\"netfilter: nf_tables: Support for sets with\
    \ multiple ranged fields\") in 5.6-rc1. \nThis commit isn't backported to earlier\
    \ than 5.6 kernels."
  ubuntu/sbeattie: |-
    CVE-2022-1972 is a duplicate of this issue
    fixes ZDI-CAN-17464
introduced-by:
  mainline: [f3a2181e16f1dcbf5446ed43f6b5d9f56c459f85]
fixed-by:
  cip/5.10: [c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048]
  cip/5.10-rt: [c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048]
  mainline: [fecf31ee395b0295f2d7260aa29946b7605f7c85]
  stable/5.10: [c0aff1faf66b6b7a19103f83e6a5d0fdc64b9048]
  stable/5.15: [89ef50fe03a55feccf5681c237673a2f98161161]
  stable/5.18: [c9a46a3d549286861259c19af4747e12cfaeece9]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
