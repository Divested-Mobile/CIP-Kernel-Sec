description: 'KVM: NULL pointer dereference in kvm_irq_delivery_to_apic_fast()'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2069736
- https://www.openwall.com/lists/oss-security/2022/06/22/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2153
- https://access.redhat.com/security/cve/CVE-2022-2153
- https://git.kernel.org/pub/scm/virt/kvm/kvm.git/commit/?h=queue&id=00b5f37189d24ac3ed46cb7f11742094778c46c
- https://marc.info/?i=49bd403c.4d90.181899b3a76.Coremail.22021034@zju.edu.cn
comments:
  debian/carnil: |-
    Fixed as well in 5.16.19 for 5.16.y and 5.17.2 for 5.17.y. The
    last commit of the series was as well backported to 5.10.110,
    4.19.238 and 4.9.311.
    According to the oss-security reference the main fix seems to
    be pin-pointed at 00b5f37189d2 ("KVM: x86: Avoid theoretical
    NULL pointer dereference in kvm_irq_delivery_to_apic_fast()")
    which would not yet be included in 5.10.y and older.
  masami: "This vulnerability was introduced by commit 1e08ec4 (\"KVM:\noptimize apic\
    \ interrupt delivery\") that was merged in 3.7-rc1.\nThere is a NULL pointer dereference\
    \ bug in\nkvm_irq_delivery_to_apic_fast() that triggers local DoS. \nCommit 7ec37d1\
    \ (KVM: x86: Check lapic_in_kernel() before\nattempting to set a SynIC irq) and\
    \ commit 00b5f37(\"KVM:\nx86: Avoid theoretical NULL pointer dereference in\n\
    kvm_irq_delivery_to_apic_fast()\") are failed to apply to\n4.14, 4.19, 4.9, 5.4,\
    \ and 5.10."
introduced-by:
  mainline: [1e08ec4a130e2745d96df169e67c58df98a07311]
fixed-by:
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [7ec37d1cbe17d8189d9562178d8b29167fe1c31a, 00b5f37189d24ac3ed46cb7f11742094778c46ce,
    b1e34d325397a33d97d845e312d7cf2a8b646b44]
  stable/4.19: [2f4835b5188f3b73b2b048a761ae2553e845b027]
  stable/4.9: [95d51d058680766130098287f680474bc55f1679]
  stable/5.10: [09c771c45c1243e295470225aaee726693fdc242, ac7de8c2ba1292856fdd4a4c0764669b9607cf0a]
  stable/5.15: [569a229142e95610adc1041ae9ca1f417c4c6a3e, 0e5dbc0540baa89faf4c04ccc7e9c4fe6b1d7bf4,
    ba6e8c2df52047a32953588b49d9addbd843a098]
