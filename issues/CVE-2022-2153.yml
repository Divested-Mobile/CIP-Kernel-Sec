description: 'KVM: NULL pointer dereference in kvm_irq_delivery_to_apic_fast()'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2069736
- https://www.openwall.com/lists/oss-security/2022/06/22/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2153
- https://access.redhat.com/security/cve/CVE-2022-2153
- https://git.kernel.org/pub/scm/virt/kvm/kvm.git/commit/?h=queue&id=00b5f37189d24ac3ed46cb7f11742094778c46c
- https://marc.info/?i=49bd403c.4d90.181899b3a76.Coremail.22021034@zju.edu.cn
- https://ubuntu.com/security/notices/USN-5727-1
- https://ubuntu.com/security/notices/USN-5728-1
- https://ubuntu.com/security/notices/USN-5727-2
- https://ubuntu.com/security/notices/USN-5728-2
- https://ubuntu.com/security/notices/USN-5728-3
- https://ubuntu.com/security/notices/USN-5774-1
- https://www.cve.org/CVERecord?id=CVE-2022-2153
comments:
  debian/carnil: |-
    Fixed as well in 5.16.19 for 5.16.y and 5.17.2 for 5.17.y. The
    last commit of the series was as well backported to 5.10.110,
    4.19.238 and 4.9.311.
    According to the oss-security reference the main fix seems to
    be pin-pointed at 00b5f37189d2 ("KVM: x86: Avoid theoretical
    NULL pointer dereference in kvm_irq_delivery_to_apic_fast()")
    which would not yet be included in 5.10.y and older.
  masami: "This vulnerability was introduced by commit 1e08ec4 (\"KVM:\noptimize apic\
    \ interrupt delivery\") that was merged in 3.7-rc1.\nThere is a NULL pointer dereference\
    \ bug in\nkvm_irq_delivery_to_apic_fast() that triggers local DoS. \nCommit 7ec37d1\
    \ (KVM: x86: Check lapic_in_kernel() before\nattempting to set a SynIC irq) and\
    \ commit 00b5f37(\"KVM:\nx86: Avoid theoretical NULL pointer dereference in\n\
    kvm_irq_delivery_to_apic_fast()\") are failed to apply to\n4.14, 4.19, 4.9, 5.4,\
    \ and 5.10."
  ubuntu/sbeattie: PoC is attached to oss-security email.
introduced-by:
  mainline: [1e08ec4a130e2745d96df169e67c58df98a07311]
fixed-by:
  cip/4.19: [5cde0b9cc69fcbbf559674986c2d325ae4708036, b8127a0fd21d70ab42d8177f8bb97df74f503cc1,
    2f4835b5188f3b73b2b048a761ae2553e845b027]
  cip/4.19-rt: [5cde0b9cc69fcbbf559674986c2d325ae4708036, b8127a0fd21d70ab42d8177f8bb97df74f503cc1,
    2f4835b5188f3b73b2b048a761ae2553e845b027]
  cip/5.10: [4c85e207c1b58249ea521670df577324ad69442c, ac7de8c2ba1292856fdd4a4c0764669b9607cf0a,
    09c771c45c1243e295470225aaee726693fdc242]
  cip/5.10-rt: [4c85e207c1b58249ea521670df577324ad69442c, ac7de8c2ba1292856fdd4a4c0764669b9607cf0a,
    09c771c45c1243e295470225aaee726693fdc242]
  debian/buster-security: ['version:debian/4.19.249-1', 'version:debian/4.19.260-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [7ec37d1cbe17d8189d9562178d8b29167fe1c31a, 00b5f37189d24ac3ed46cb7f11742094778c46ce,
    b1e34d325397a33d97d845e312d7cf2a8b646b44]
  stable/4.14: [a4bd692a950ada6d9757dbb78a6aea129ff8a943, bcf0a450fbaabe7e14d71f885525805b4f86e855,
    3362843aa71898fc2850a90950debcef2897dd60]
  stable/4.19: [2f4835b5188f3b73b2b048a761ae2553e845b027, 5cde0b9cc69fcbbf559674986c2d325ae4708036,
    b8127a0fd21d70ab42d8177f8bb97df74f503cc1]
  stable/4.9: [95d51d058680766130098287f680474bc55f1679]
  stable/5.10: [09c771c45c1243e295470225aaee726693fdc242, ac7de8c2ba1292856fdd4a4c0764669b9607cf0a,
    4c85e207c1b58249ea521670df577324ad69442c]
  stable/5.15: [569a229142e95610adc1041ae9ca1f417c4c6a3e, 0e5dbc0540baa89faf4c04ccc7e9c4fe6b1d7bf4,
    ba6e8c2df52047a32953588b49d9addbd843a098]
  stable/5.4: [8fb5e77604442926db8b779fa590af7709d754e9, 8cdba919acefdd6fea5dd2b77a119f54fb88ce11,
    9e24d03dd4fee589da500861967d9fd9c0e6276d]
  ubuntu/bionic: [92dc9b6130b314b6b1d5e1501b759110c37aa480, 66d37d561b24b59f7804904d159532d78e2595f1,
    0d503f51ab5ab9d0714325738af1468d360dd417]
  ubuntu/focal: [0b53d14f2f2872f59c4eafcdeeda33cafcc214a4, aeb98f8aae7516774dd0ea3a76915e5d07367b30,
    bd45a776a654eaed6090a5668df6c29bd0e3dbdc]
