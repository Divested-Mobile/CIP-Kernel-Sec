description: 'KVM: VMX: Execute IBPB on emulated VM-exit when guest has IBRS'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2196
- https://git.kernel.org/linus/2e7eab81425ad6c875f2ed47c0ce01e78afc38a5
- https://ubuntu.com/security/notices/USN-5970-1
- https://ubuntu.com/security/notices/USN-5976-1
- https://ubuntu.com/security/notices/USN-5977-1
- https://ubuntu.com/security/notices/USN-5978-1
- https://ubuntu.com/security/notices/USN-5979-1
- https://ubuntu.com/security/notices/USN-5980-1
- https://ubuntu.com/security/notices/USN-5982-1
- https://ubuntu.com/security/notices/USN-5985-1
- https://ubuntu.com/security/notices/USN-5987-1
- https://ubuntu.com/security/notices/USN-6004-1
- https://ubuntu.com/security/notices/USN-6020-1
- https://ubuntu.com/security/notices/USN-6151-1
- https://www.cve.org/CVERecord?id=CVE-2022-2196
comments:
  debian/carnil: |-
    Commit fixes 5c911beff20a ("KVM: nVMX: Skip IBPB when switching
    between vmcs01 and vmcs02") in 5.8-rc1 (which got backported as
    well to 5.7.3, 5.6.19 and 5.4.47).
  masami: |-
    Introduced by commit 5c911be ("KVM: nVMX: Skip IBPB when switching between vmcs01 and vmcs02")
    in 5.8-rc1. This commit fixes commit 15d4507 ("KVM/x86: Add IBPB support") in 4.16-rc1.
    Commit 5c911be is not backported to 4.x kernels.
introduced-by:
  mainline: [5c911beff20aa8639e7a1f28988736c13e03ed54]
  stable/5.4: [64b8f33b2e1e687d465b5cb382e7bec495f1e026]
  ubuntu/focal: [509cd881e3658dd09deec8ca3b13768ebaebc7cd]
fixed-by:
  cip/5.10: [1b0cafaae8884726c597caded50af185ffc13349]
  cip/5.10-rt: [1b0cafaae8884726c597caded50af185ffc13349]
  cip/6.1: [63fada296062e91ad9f871970d4e7f19e21a6a15]
  cip/6.1-rt: [63fada296062e91ad9f871970d4e7f19e21a6a15]
  mainline: [2e7eab81425ad6c875f2ed47c0ce01e78afc38a5]
  stable/5.10: [1b0cafaae8884726c597caded50af185ffc13349]
  stable/5.15: [6b539a7dbb49250f92515c2ba60aea239efc9e35]
  stable/5.4: [f93a1a5bdcdd122aae0a3eab7a52c15b71fb725b]
  stable/6.1: [63fada296062e91ad9f871970d4e7f19e21a6a15]
  ubuntu/focal: [7474a19cab1af2c5b5fca7b552f713fedd8f533c]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
