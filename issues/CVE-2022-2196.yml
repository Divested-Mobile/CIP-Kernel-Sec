description: 'KVM: VMX: Execute IBPB on emulated VM-exit when guest has IBRS'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2196
- https://git.kernel.org/linus/2e7eab81425ad6c875f2ed47c0ce01e78afc38a5
comments:
  debian/carnil: |-
    Commit fixes 5c911beff20a ("KVM: nVMX: Skip IBPB when switching
    between vmcs01 and vmcs02") in 5.8-rc1 (which got backported as
    well to 5.7.3, 5.6.19 and 5.4.47).
  masami: |-
    Introduced by commit 5c911be ("KVM: nVMX: Skip IBPB when switching between vmcs01 and vmcs02")
    in 5.8-rc1. This commit fixes commit 15d4507 ("KVM/x86: Add IBPB support") in 4.16-rc1.
    Commit 5c911be is not backported to 4.x kernels.
introduced-by:
  mainline: [5c911beff20aa8639e7a1f28988736c13e03ed54]
  stable/5.4: [64b8f33b2e1e687d465b5cb382e7bec495f1e026]
  ubuntu/focal: [509cd881e3658dd09deec8ca3b13768ebaebc7cd]
fixed-by:
  mainline: [2e7eab81425ad6c875f2ed47c0ce01e78afc38a5]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
