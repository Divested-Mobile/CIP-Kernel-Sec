description: 'drm/vmwgfx: Fix stale file descriptors on failed usercopy'
references:
- https://www.openwall.com/lists/oss-security/2022/01/27/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22942
- https://www.openwall.com/lists/oss-security/2022/02/03/1
- https://ubuntu.com/security/notices/USN-5278-1
- https://ubuntu.com/security/notices/USN-5294-1
- https://ubuntu.com/security/notices/USN-5295-1
- https://ubuntu.com/security/notices/USN-5294-2
- https://ubuntu.com/security/notices/USN-5295-2
- https://ubuntu.com/security/notices/USN-5297-1
- https://ubuntu.com/security/notices/USN-5298-1
- https://ubuntu.com/security/notices/USN-5362-1
- https://github.com/opensrcsec/same_type_object_reuse_exploits/blob/main/cve-2022-22942-dc.c
- https://github.com/opensrcsec/same_type_object_reuse_exploits/blob/main/cve-2022-22942.c
- https://www.cve.org/CVERecord?id=CVE-2022-22942
comments:
  debian/carnil: |-
    Commit fixes c906965dee22 ("drm/vmwgfx: Add export fence to
    file descriptor support") in 4.14-rc1.
    Fixed in 5.16.4 for 5.16.y and 5.15.18 for 5.15.y.
introduced-by:
  mainline: [c906965dee22d5e95d0651759ba107b420212a9f]
fixed-by:
  cip/4.19: [0008a0c78fc33a84e2212a7c04e6b21a36ca6f4d]
  cip/4.19-rt: [0008a0c78fc33a84e2212a7c04e6b21a36ca6f4d]
  cip/5.10: [ae2b20f27732fe92055d9e7b350abc5cdf3e2414]
  cip/5.10-rt: [ae2b20f27732fe92055d9e7b350abc5cdf3e2414]
  debian/buster-security: ['version:debian/4.19.232-1']
  mainline: [a0f90c8815706981c483a652a6aefca51a5e191c]
  stable/4.14: [e8d092a62449dcfc73517ca43963d2b8f44d0516]
  stable/4.19: [0008a0c78fc33a84e2212a7c04e6b21a36ca6f4d]
  stable/5.10: [ae2b20f27732fe92055d9e7b350abc5cdf3e2414]
  stable/5.15: [6066977961fc6f437bc064f628cf9b0e4571c56c]
  stable/5.16: [1d833b27fb708d6fdf5de9f6b3a8be4bd4321565]
  stable/5.4: [84b1259fe36ae0915f3d6ddcea6377779de48b82]
  ubuntu/bionic: [423259354bc6bde121cacc8cdb71c716f0523ff3]
  ubuntu/focal: [032d0bcb1017de61659e6021f1ed43f0efd584eb]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  stable/4.4: Not affected
  stable/4.9: Not affected
