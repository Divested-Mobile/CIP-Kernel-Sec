description: 'bpf: Fix out of bounds access from invalid *_or_null type verification'
references:
- https://www.openwall.com/lists/oss-security/2022/01/13/1
- https://www.openwall.com/lists/oss-security/2022/01/18/2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23222
- http://www.openwall.com/lists/oss-security/2022/01/14/1
- http://www.openwall.com/lists/oss-security/2022/01/18/2
- https://www.debian.org/security/2022/dsa-5050
- https://ubuntu.com/security/notices/USN-5278-1
- https://ubuntu.com/security/notices/USN-5337-1
- https://ubuntu.com/security/notices/USN-5362-1
- https://ubuntu.com/security/notices/USN-5368-1
- https://github.com/tr3ee/CVE-2022-23222
- https://www.cve.org/CVERecord?id=CVE-2022-23222
comments:
  debian/carnil: |-
    For stable series in 5.10.y, 5.15.y and 5.16.y the commit "bpf:
    Fix out of bounds access from invalid *_or_null type
    verification" was backported for fixing the issue as the issue
    was fixed in mainline through the larger refactoring in
    c25b2ae136039ffa820c26138ed4a5e5f3ab3841.
    Fixed as well in 5.16.1 for 5.16.y, 5.15.15 for 5.15.y.
  masami: kernel 5.8 or later versions are affected.
  ubuntu/sbeattie: |-
    Ubuntu 21.10 / 5.13+ kernels disable unprivileged BPF by default.
    kernels 5.8 and older are not affected, priority high is for
      5.10 and 5.11 based kernels only
reporters:
- tr3e wang
fixed-by:
  cip/5.10: [35ab8c9085b0af847df7fac9571ccd26d9f0f513]
  cip/5.10-rt: [35ab8c9085b0af847df7fac9571ccd26d9f0f513]
  mainline: [c25b2ae136039ffa820c26138ed4a5e5f3ab3841]
  stable/5.10: [35ab8c9085b0af847df7fac9571ccd26d9f0f513]
  stable/5.15: [e8efe8369944c6199f124e3b50662ad05a048b60]
  stable/5.16: [931e56be527fb2672556e3c00c57ff2a5f5de43e]
  ubuntu/focal: ['version:5.4.0-9.12']
