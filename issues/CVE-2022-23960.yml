description: Arm cpus BHI problem
references:
- https://www.vusec.net/projects/bhi-spectre-bhb/
- https://github.com/vusec/bhi-spectre-bhb
- https://developer.arm.com/support/arm-security-updates/speculative-processor-vulnerability/spectre-bhb
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-23960
- https://developer.arm.com/documentation/ka004995/latest/
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BHI
- https://ubuntu.com/security/notices/USN-5317-1
- https://ubuntu.com/security/notices/USN-5318-1
- https://ubuntu.com/security/notices/USN-5362-1
comments:
  debian/carnil: |-
    Released as well in 5.16.14 for 5.16.y.
    For 4.19.y and 4.9.y the arm64 patches are not yet included in
    4.19.234 and 4.9.306.
  ubuntu/sbeattie: |-
    unprivileged eBPF was already disabled by default for 5.13
      and newer kernels
reporters:
- Enrico Barberis
- Pietro Frigo
- Marius Muench
- Herbert Bos
- Cristiano Giuffrida
fixed-by:
  cip/4.19: [dc64af755099d1e51fd64e99fe3a59b75595814a, 45c25917ceb7a5377883ef4c3a675276fba8a268,
    67e1f18a972be16363c6e88d7b29cde880774164, 99e14db3b711c27f93079ba9d7f2fff169916d5f,
    29db7e4b67fccf5e1fe28ec89f2add90ce74d77b, e8bfe29afc09ac77b347540a0f4c789e6530a436,
    87eccd56c52fcdd6c55b048d789da5c9c2e51ed3, 51acb81130d1feee7fd043760b75f5377ab8d4f0,
    266b1ef1368e06ac4c5a89eb9774ef2bbaa54e19, ebcdd80d0016c7445e8395cec99b9ce266a26001,
    af484e69b5e83095609d8b5c8abaf13a5460229e, f689fa53bb944873f75fe1584f446cae1aabd2c1,
    9e056623dfc538909ed2a914f70a66d68ec71ec3, 22fdfcf1c2cea8e6dc383d46cbbe59d476d24a96,
    901c0a20aa94d09a9328899e2dd69a8d43a3a920, 91429ed04ebe9dbec88f97c6fd136b722bc3f3c5,
    e18876b523d5f5fd8b8f34721f60a470caf20aa1, 5b5ca2608fbd6f250281b6a1d0d73613f250e6f1,
    7b012f6597e55a2ea4c7efe94b5d9a792b6e5757, a68912a3ae3413be5febcaa40e7e0ec1fd62adee,
    c20d551744797000c4af993f7d59ef8c69732949, 5f051d32b03f08a0507ac1afd7b9c0a30c8e5d59,
    a44e7ddb5822b943cd50c5ad6a2541fb445d58bd, ed5dec3fae86f20db52930e1d9a7cc38403994cc]
  cip/5.10: [b7f1e73c4ddf2044530091e69114a5fc1a1229d0, 46deb224680bb33c8e87440a7b909d16e5a7d7c5,
    29d9b56df1e18a8ff2e669b79e511163972a8b65, 3f9c958e3572b19b1cfb9d28eeb15be0a5d80193,
    302754d023a06171113e8fb20c7b2a18ebf9088f, dc5b630c0d532140e194997d350f587dbcc78bfb,
    7048a21086fb16ec67287a25b62e88b0cd17c8c3, 192023e6baf7cce7fb76ff3a5c24c55968c774ff,
    5242d6971e106be115d9dace9c1441f4a2e1cb25, d93b25a6654812e0511b71a6d4a207f6b1ce5dfe,
    bda89602814c69e6f027878209b0b9453133ada2, 5275fb5ea5f573ce1ecd2bf0bcd928abb916b43d,
    e55025063276fcf7b07e9340c38d70b04aa8a7b9, 8c691e5308c531deede16bef4f2d933d5f859ce7,
    73ee716a1f6356ca86d16d4ffc97fcfc7961d3ef, 26211252c1c104732a0fea6c37645f1b670587f5,
    49379552969acee3237387cc258848437e127d98, 3f21b7e355237aa2f8196ad44c2b7456a739518d,
    56cf5326bdf9c20de9a45e4a7a4c0ae16833e561, 1f63326a5211208e2c5868650e47f13a9072afde,
    13a807a0a080383ceab6c40e53c0228108423e51, e192c8baa69ac8a5585d61ac535aa1e5eb795e80,
    38c26bdb3cc53f219d6ab75ac1a95436f393c60f, 551717cf3b58f11311d10f70eb027d4b275135de,
    b65b87e718c33caa46d5246d8fbeda895aa9cf5b]
  cip/5.10-rt: [b7f1e73c4ddf2044530091e69114a5fc1a1229d0, 46deb224680bb33c8e87440a7b909d16e5a7d7c5,
    29d9b56df1e18a8ff2e669b79e511163972a8b65, 3f9c958e3572b19b1cfb9d28eeb15be0a5d80193,
    302754d023a06171113e8fb20c7b2a18ebf9088f, dc5b630c0d532140e194997d350f587dbcc78bfb,
    7048a21086fb16ec67287a25b62e88b0cd17c8c3, 192023e6baf7cce7fb76ff3a5c24c55968c774ff,
    5242d6971e106be115d9dace9c1441f4a2e1cb25, d93b25a6654812e0511b71a6d4a207f6b1ce5dfe,
    bda89602814c69e6f027878209b0b9453133ada2, 5275fb5ea5f573ce1ecd2bf0bcd928abb916b43d,
    e55025063276fcf7b07e9340c38d70b04aa8a7b9, 8c691e5308c531deede16bef4f2d933d5f859ce7,
    73ee716a1f6356ca86d16d4ffc97fcfc7961d3ef, 26211252c1c104732a0fea6c37645f1b670587f5,
    49379552969acee3237387cc258848437e127d98, 3f21b7e355237aa2f8196ad44c2b7456a739518d,
    56cf5326bdf9c20de9a45e4a7a4c0ae16833e561, 1f63326a5211208e2c5868650e47f13a9072afde,
    13a807a0a080383ceab6c40e53c0228108423e51, e192c8baa69ac8a5585d61ac535aa1e5eb795e80,
    38c26bdb3cc53f219d6ab75ac1a95436f393c60f, 551717cf3b58f11311d10f70eb027d4b275135de,
    b65b87e718c33caa46d5246d8fbeda895aa9cf5b]
  debian/buster-security: ['version:debian/4.19.235-1', 'version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [9dd78194a3722fa6712192cdd4f7032d45112a9a, 04e91b7324760a377a725e218b5ee783826d30f5,
    8d9d651ff2270a632e9dc497b142db31e8911315, b9baf5c8c5c356757f4f9d8180b5e9d234065bc3,
    25875aa71dfefd1959f07e626c4d285b88b27ac2, 4330e2c5c04c27bebf89d34e0bc14e6943413067,
    1b33d4860deaecf1d8eec3061b7e7ed7ab0bae8d, 5bdf3437603d4af87f9c7f424b0c8aeed2420745,
    d739da1694a0eaef0358a42b76904b611539b77b, 03aff3a77a58b5b52a77e00537a42090ad57b80b,
    c091fb6ae059cda563b2a4d93fdbc548ef34e1d6, 6c5bf79b69f911560fbf82214c0971af6e58e682,
    ed50da7764535f1e24432ded289974f2bf2b0c5a, 13d7a08352a83ef2252aeb464a5e08dfc06b5dfd,
    c47e4d04ba0f1ea17353d85d45f611277507e07a, a9c406e6462ff14956d690de7bbe5131a5677dc9,
    aff65393fa1401e034656e349abd655cfe272de0, ba2689234be92024e5635d30fe744f4853ad97db,
    b28a8eebe81c186fdb1a0078263b30576c8e1f42, bd09128d16fac3c34b80bd6a29088ac632e8ce09,
    dee435be76f4117410bbd90573a881fd33488f37, 558c303c9734af5a813739cd284879227f7297d2,
    a5905d6af492ee6a4a2205f0d550b3f931b03d03, 228a26b912287934789023b4132ba76065d9491c,
    58c9a5060cb7cd529d49c93954cdafe81c1d642a]
  stable/4.19: [dc64af755099d1e51fd64e99fe3a59b75595814a, 45c25917ceb7a5377883ef4c3a675276fba8a268,
    67e1f18a972be16363c6e88d7b29cde880774164, 99e14db3b711c27f93079ba9d7f2fff169916d5f,
    29db7e4b67fccf5e1fe28ec89f2add90ce74d77b, e8bfe29afc09ac77b347540a0f4c789e6530a436,
    87eccd56c52fcdd6c55b048d789da5c9c2e51ed3, 51acb81130d1feee7fd043760b75f5377ab8d4f0,
    266b1ef1368e06ac4c5a89eb9774ef2bbaa54e19, ebcdd80d0016c7445e8395cec99b9ce266a26001,
    af484e69b5e83095609d8b5c8abaf13a5460229e, f689fa53bb944873f75fe1584f446cae1aabd2c1,
    9e056623dfc538909ed2a914f70a66d68ec71ec3, 22fdfcf1c2cea8e6dc383d46cbbe59d476d24a96,
    901c0a20aa94d09a9328899e2dd69a8d43a3a920, 91429ed04ebe9dbec88f97c6fd136b722bc3f3c5,
    e18876b523d5f5fd8b8f34721f60a470caf20aa1, 5b5ca2608fbd6f250281b6a1d0d73613f250e6f1,
    7b012f6597e55a2ea4c7efe94b5d9a792b6e5757, a68912a3ae3413be5febcaa40e7e0ec1fd62adee,
    c20d551744797000c4af993f7d59ef8c69732949, 5f051d32b03f08a0507ac1afd7b9c0a30c8e5d59,
    a44e7ddb5822b943cd50c5ad6a2541fb445d58bd, ed5dec3fae86f20db52930e1d9a7cc38403994cc]
  stable/4.9: [b24d4041cfb6dab83f9edf40573375bd1365e619, dfea9912129157ba3c5a9d060e58df17fb688e72,
    964aafb29a07cb7cdea71ef41a75394e879f529c, da3dfb69bbc3fdfeb3e5930fe28bcd689751a594,
    48b1aa98e19d189703d518166ddb2520164b3164, 0a59e9cf1f29f446ab5a3dc91a23af8ca0cf5bea,
    6835855140dc7adecd5af713a17d488f93fd8226, a212d166a9d7c35e56ba11f15d6706eee3dd499b,
    ee04ed16acb65f7dfde8cb74ae774f4314c5c816, 99cbe345732d49d4626052908754259ac9222bb2,
    2ce6f5deed712c6768e5b19ac4e23d4aaa828ff4, 283bcb8f640ecc3e4a74f5084c15cdd9ce350951,
    1f7da613bf57d10b0ff6807b36bd7eda27482ab6, bd69a09d7d229303286a685f59b9033c384f72b1,
    944ecb18c729545ea73c53f9ee9b802637c549d0, ac965734ce0f87c194f0a666889a4f37436b2421,
    218ddd9cb91e7bc0bb69d53fc40f600b0b217a16, aee10c2dd01383a8a01111d647b6e17b9a3cc791,
    1451b7fe7a3689113e70d2936b92fa4d50e68371, 094a410426b4a5cbb0d68609050a15110124aeda,
    4dd8aae585a51a1d276911fe19096ad90144e9fe, df0448480b9c2f0a2f5a5055e04afa80bf0a5301,
    9396d5ede3df91cc71c70a7fb11826a10c34e775, 7815cbf19ac47ca0cc22b0d8aa25d6ec6ab2ad81]
  stable/5.10: [b7f1e73c4ddf2044530091e69114a5fc1a1229d0, 46deb224680bb33c8e87440a7b909d16e5a7d7c5,
    29d9b56df1e18a8ff2e669b79e511163972a8b65, 3f9c958e3572b19b1cfb9d28eeb15be0a5d80193,
    302754d023a06171113e8fb20c7b2a18ebf9088f, dc5b630c0d532140e194997d350f587dbcc78bfb,
    7048a21086fb16ec67287a25b62e88b0cd17c8c3, 192023e6baf7cce7fb76ff3a5c24c55968c774ff,
    5242d6971e106be115d9dace9c1441f4a2e1cb25, d93b25a6654812e0511b71a6d4a207f6b1ce5dfe,
    bda89602814c69e6f027878209b0b9453133ada2, 5275fb5ea5f573ce1ecd2bf0bcd928abb916b43d,
    e55025063276fcf7b07e9340c38d70b04aa8a7b9, 8c691e5308c531deede16bef4f2d933d5f859ce7,
    73ee716a1f6356ca86d16d4ffc97fcfc7961d3ef, 26211252c1c104732a0fea6c37645f1b670587f5,
    49379552969acee3237387cc258848437e127d98, 3f21b7e355237aa2f8196ad44c2b7456a739518d,
    56cf5326bdf9c20de9a45e4a7a4c0ae16833e561, 1f63326a5211208e2c5868650e47f13a9072afde,
    13a807a0a080383ceab6c40e53c0228108423e51, e192c8baa69ac8a5585d61ac535aa1e5eb795e80,
    38c26bdb3cc53f219d6ab75ac1a95436f393c60f, 551717cf3b58f11311d10f70eb027d4b275135de,
    b65b87e718c33caa46d5246d8fbeda895aa9cf5b, f3c12fc53e0a1fffbe102a9501c7bb6efdabbe99,
    fc8070a9c5ad3e0ac343532df7d4d2d709b173a8, 86171569312b5870aaedc74b4b28d444c0f72105,
    b19eaa004f2eeae94a4fcf5f0cadac35cc579a72, 7ae8127e412361025e7b4a0e6347ca9e8f3ed109,
    dbcfa98539531bff0d7e4d6087741702dfa50f06, 162aa002ec1a78e91cf2f0b8e7450e2770b2941f,
    97d8bdf33182494b7cb327ed555313d17d80c639]
  stable/5.15: [f02cab2bed1a3493a230e54d83ff117bc59f480e, 878ad97f745ebc6b135d87b6901dbe93d07745d3,
    2dca61693e6cb6d163e5ba2cf18f2c3270d7ec30, 576548846f1ee53a4d04fa5f91e6a088adbfe3f8,
    842f2d498ee1e75fc9bf78555ee5b59c894c071b, b7beeab84f02091124b176ba34c71a601762d1de,
    44adac5908ff712e0fee34e3472f884c17af8025, 368a1fd8c4a600ed8ae605afa27904f359a57161,
    479c9bb741bf6e1ac300d2f3c2797c7fbce117c0, 4a691bbf56a186f9df432b0bfd666dc2e82e4334,
    e25a9dced2bdbace585d613444f2cf317b84cda5, 2e09754a03a7e54eae6017d94fb9c265217288f1,
    be9c5526aad63ab0b13d72978206aec12ede9d76, a40472d463f9ab6f971850989aa5a21f704b5cfd,
    6895584a92eeaa0702afc47c9758b7fca6345fec, 517f988ee0500688ac23e011bc3bbbf502e76a23,
    ffb8a34c0fd81fdcf677bc8e9af251ea526e8c49, 50e700a117669e072fb9e47ff3ea49e4a8cacf04,
    cfd0c38125aa27a15617473d053897eb7967ab1c, d7066114dcd6a295122c5942791025e16a33f89f,
    8e55b9b0e76575e3755919820848b9ca53d82381, 4bbfd0c280254b273c564767021bb9b0f945148e,
    fb2bb2ec137c3a8afbd91c949d9384d9e8a913c9, 8979720ac64c70af1395ce78e5c6ffb546b43e0d,
    3317d21b84e91be72df14744040513a280b88946]
  stable/5.16: [f5eb0f1dcde4b7c2b5ee920ae53bcecaaba03947, 0f0fd6ef76dee10aae861c69635c42b1c427e577,
    21ceffd3628edfc775d33851cf56ea1d85c528fc, 9fd1d31810ccf6b4e4df8ccf2e68bbdcf528d186,
    680e356c1be19a7663d8077be12e0ab048430ebd, d1e3d6d26d9eab22548c3b7373ec12bbfecc765f,
    346793c01582f62f4a5536c325a3dfc627ca543a, 46af6fc4f7a22ada597982ff01db34fb4bdba6a3,
    7b63df956358d183c25178e970f6ed304cd0f659, 57e9a5fbd1f8b8ac5b7f849715fcdf5a32dda040,
    62cfcf8d06ca7786e781e1b60f57b67f43448868, 5da0c4bbae492434b534ffd39aac5d5610190491,
    dfb25997bdefca7a3cd69c1dea872ba52133d31f, e0077b0a66f14998c0d18508bf945a40a0d3ebab,
    984e7e3ebac334d7af0069a4d3636cf2338525df, 483fa5319f16b627e7873c1079e35ebbfb04cf45,
    448a95af1b7ae205eb762c2c1fb35b290cc3032e, d535ca624f6d439424aeeb0a3cc4a426cfd9a993,
    b9c29587c533faaa0aefeaaf7a4a4ff834975ba4, d4293ed32d390ce363d964a9216ce9ab0ff9d74c,
    f0567fc3fb835499eda68f20e30ce16f9b83d774, 0b2bf1b37b5ebd90e69e30d8c2d6e1cd0c1f37b4,
    e1e87704621efcf0310bd1543a8e6352156a43bd, 2df4d0aba0e673d37be14901e853d1d540b19bbd,
    80d1978b8062cbad01cbea2aec2a5aac8f61c366]
  ubuntu/bionic: ['version:4.15.0-184.194']
  ubuntu/focal: [7302d211cb423e0ed38617f4c454b5df27950113, 6d2f7833aa27939555f9b65810e0ba756f0efa4f,
    e3f412426e09b64651e4dedb25e7b8d92c2907c2, 0d9955120cd5b59c6082668fd235cdf77a33a880,
    e94dd5ce99f92685c5a18e38b06f733bfa053dd4, 2d5714a25b5e73007af7e56b92fa54442f4b59c9,
    d086631a4dc5b0317ad36b92f8edf9cf87282341, cd0d05880f1731fa5dbe1f42fe76d545fbd41259,
    28b733de076c79faea37bf7ac0795544b5c5e077, 9db353c8bb935b6fd858cebb5f68748b76e1e8d0,
    5ee7d50fd901ddba83083dc15168d328704b44c0, 38f08fd38848efa5707341a35d7d72f16b6f3e57,
    a7f2f049e1742c0a0e67c399b7321d3b58f72ec9, 45835468a6b3469bced184ab7d9677e00bb61d1f,
    81848e022c0be295c7eda45c4899578b0be12c41, fa2bfaa4ec0dc3b7b0a453c5de8d2a8c9ba63d13,
    b533d5f22a442b135bc9a085c0406f50b424b415, 87216f48c272d91428f4cd9f997adf3dc80c9b37,
    beb3ea209c9f42614d021d0289e647549ec995e9, 14d45ef5283009c10b952935ae404d9d725861a9,
    e4d6f3446d838b79d4bfb28f15ec72cfdd7793ec, 0d847a5bc8c20f3a3328f1b36ad80a7265d98d39,
    7bc57ede85b4d996e2e0ef2a4af372aebe457e99, 20e65fe02a26c93234e689e4bdb078ba70eeab9c]
