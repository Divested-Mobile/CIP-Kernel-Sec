description: 'ucount:  Make get_ucount a safe get_user replacement'
references:
- https://www.openwall.com/lists/oss-security/2022/01/29/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24122
- https://git.kernel.org/linus/f9d87929d451d3e649699d0f1d74f71f77ad38f5
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f9d87929d451d3e649699d0f1d74f71f77ad38f5
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c54b245d011855ea91c5beff07f1db74143ce614
- https://ubuntu.com/security/notices/USN-5278-1
- https://www.cve.org/CVERecord?id=CVE-2022-24122
comments:
  debian/carnil: |-
    Introduced in v5.14-rc1 with merge of d64696905554
    ("Reimplement RLIMIT_SIGPENDING on top of ucounts"),
    6e52a9f0532f ("Reimplement RLIMIT_MSGQUEUE on top of ucounts")
    and d7c9e99aee48 ("Reimplement RLIMIT_MEMLOCK on top of
    ucounts").
  masami: before 5.14 kernels are not affected
introduced-by:
  mainline: [d64696905554e919321e31afc210606653b8f6a4, 6e52a9f0532f912af37bab4caf18b57d1b9845f4,
    d7c9e99aee48e6bc0b427f3e3c658a6aba15001e]
fixed-by:
  mainline: [f9d87929d451d3e649699d0f1d74f71f77ad38f5]
  stable/5.15: [348a8501e6029f9308ea7675edfa645b5e669c9e]
  stable/5.16: [aec8904396dc6c34a104f42b02d50ca9de58ab13]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.4: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
