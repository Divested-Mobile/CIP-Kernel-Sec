description: |-
  An issue was discovered in fs/nfs/dir.c in the Linux kernel before 5.16.5.
  If an application sets the O_DIRECTORY flag, and tries to open a regular
  file, nfs_atomic_open() performs a regular lookup. If a regular file is
  found, ENOTDIR should occur, but the server instead returns uninitialized
  data in the file descriptor.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24448
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ac795161c93699d600db16c1a8cc23a65a1eceaf
- https://www.spinics.net/lists/stable/msg531976.html
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.16.5
- https://github.com/torvalds/linux/commit/ac795161c93699d600db16c1a8cc23a65a1eceaf
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2022-24448
- https://ubuntu.com/security/notices/USN-5302-1
- https://ubuntu.com/security/notices/USN-5383-1
- https://ubuntu.com/security/notices/USN-5384-1
- https://ubuntu.com/security/notices/USN-5385-1
- https://www.cve.org/CVERecord?id=CVE-2022-24448
reporters:
- Lyu Tao
introduced-by:
  mainline: [0dd2b474d0b69d58859399b1df7fdc699ea005d4]
fixed-by:
  cip/4.19: [b00b4c6faad0f21e443fb1584f7a8ea222beb0de]
  cip/4.19-rt: [b00b4c6faad0f21e443fb1584f7a8ea222beb0de]
  cip/5.10: [ce8c552b88ca25d775ecd0a0fbef4e0e03de9ed2]
  cip/5.10-rt: [ce8c552b88ca25d775ecd0a0fbef4e0e03de9ed2]
  mainline: [ac795161c93699d600db16c1a8cc23a65a1eceaf]
  stable/4.14: [516f348b759f6a92819820a3f56d678458e22cc8]
  stable/4.19: [b00b4c6faad0f21e443fb1584f7a8ea222beb0de]
  stable/4.9: [8788981e120694a82a3672e062fe4ea99446634a]
  stable/5.10: [ce8c552b88ca25d775ecd0a0fbef4e0e03de9ed2]
  stable/5.15: [4c36ca387af4a9b5d775e46a6cb9dc2d151bf057]
  stable/5.16: [f0583af88e7dd413229ea5e670a0db36fdf34ba2]
  stable/5.4: [0dfacee40021dcc0a9aa991edd965addc04b9370]
  ubuntu/bionic: [86e2be75602bc570f949e4f4699325b2020cb6aa]
  ubuntu/focal: [c45e9651e2abbea4aa5753e5d41011dbf452215a]
