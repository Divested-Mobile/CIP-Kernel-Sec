description: drivers/usb/gadget/legacy/inode.c mishandles dev->buf release
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-24958
- https://github.com/torvalds/linux/commit/501e38a5531efbd77d5c73c0ba838a889bfc1d74
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit?id=89f3594d0de58e8a57d92d497dea9fee3d4b9cda
- https://github.com/torvalds/linux/commit/89f3594d0de58e8a57d92d497dea9fee3d4b9cda
- https://ubuntu.com/security/notices/USN-5381-1
- https://ubuntu.com/security/notices/USN-5418-1
- https://ubuntu.com/security/notices/USN-5467-1
- https://ubuntu.com/security/notices/USN-5468-1
- https://ubuntu.com/security/notices/USN-5505-1
- https://ubuntu.com/security/notices/USN-5513-1
- https://www.cve.org/CVERecord?id=CVE-2022-24958
comments:
  debian/carnil: Fixed as well in 5.16.13 for 5.16.y series.
  masami: Commit 501e38a can be appied to 4.4 with bit modification.
fixed-by:
  cip/4.19: [70196d12856306a17ddc3eae0f022b9c1d748e52, 6b432b7b5a77e8bfd041da0ba00c98fa31097c4e]
  cip/4.19-rt: [70196d12856306a17ddc3eae0f022b9c1d748e52, 6b432b7b5a77e8bfd041da0ba00c98fa31097c4e]
  cip/4.4: [dd747d7d0d28fed32a37e294696ac230fa1faf73, 5e612c9b1f86a1d758f2927c4ffef83c0af0c676]
  cip/4.4-rt: [dd747d7d0d28fed32a37e294696ac230fa1faf73, 5e612c9b1f86a1d758f2927c4ffef83c0af0c676]
  cip/4.4-st: [dd747d7d0d28fed32a37e294696ac230fa1faf73, 5e612c9b1f86a1d758f2927c4ffef83c0af0c676]
  cip/5.10: [c13159a588818a1d2cd6519f4d3b6f7e17a9ffbd, fdd64084e405544c5c11841ca9261785c988e2a1]
  cip/5.10-rt: [c13159a588818a1d2cd6519f4d3b6f7e17a9ffbd, fdd64084e405544c5c11841ca9261785c988e2a1]
  debian/buster-security: ['version:debian/4.19.235-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [89f3594d0de58e8a57d92d497dea9fee3d4b9cda, 501e38a5531efbd77d5c73c0ba838a889bfc1d74]
  stable/4.14: [6936d1097e9cb891e1daaa8aab1b9c080f5e59a2, 70959fa1a003cb7c6ed2fd0e0f887125d08b8bf6]
  stable/4.19: [70196d12856306a17ddc3eae0f022b9c1d748e52, 6b432b7b5a77e8bfd041da0ba00c98fa31097c4e]
  stable/4.9: [be1bb345f180482b0e57768d967ef020d7cba592, e09100044e658fb7906494ed5109323ba64f3e7a]
  stable/5.10: [c13159a588818a1d2cd6519f4d3b6f7e17a9ffbd, fdd64084e405544c5c11841ca9261785c988e2a1]
  stable/5.15: [07de9a494b5ae41b9253411a8e9576d7fceedcc3, ab3656acb7b4f33a30970a920ed90f0db36d940b]
  stable/5.16: [9e5c16b2a9812cd250f0de0b77391c2d63adf2f2, 030b335a1dd1f306da6cee0514f22e602576389e]
  stable/5.4: [ba6fdd55b16677dcc1d7011270c140d2a37e5f35, 58b419d16e8791e16f8865463aa28bbcef726e26]
  ubuntu/bionic: [bca8489c53c257cd71a19b6207d69f6114065570, 969a22130ee186f8fd078a519b4af3d19e1b13e5]
  ubuntu/focal: [10600ada3a01e82b33922ea86cadd276c773d597, c13b68d6c6a41bf611856b39a4e1bf1d9832f374]
