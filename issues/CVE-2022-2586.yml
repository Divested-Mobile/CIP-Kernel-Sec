description: Linux kernel nf_tables cross-table reference UAF
references:
- https://lore.kernel.org/netfilter-devel/20220809170148.164591-1-cascardo@canonical.com/T/#t
- https://www.openwall.com/lists/oss-security/2022/08/09/5
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2586
- https://ubuntu.com/security/notices/USN-5557-1
- https://ubuntu.com/security/notices/USN-5560-1
- https://ubuntu.com/security/notices/USN-5560-2
- https://ubuntu.com/security/notices/USN-5562-1
- https://ubuntu.com/security/notices/USN-5564-1
- https://ubuntu.com/security/notices/USN-5565-1
- https://ubuntu.com/security/notices/USN-5566-1
- https://ubuntu.com/security/notices/USN-5567-1
- https://www.openwall.com/lists/oss-security/2022/08/18/1
- https://www.zerodayinitiative.com/advisories/ZDI-22-1118/
- https://ubuntu.com/security/notices/USN-5582-1
- https://www.openwall.com/lists/oss-security/2022/08/29/5
- https://www.cve.org/CVERecord?id=CVE-2022-2586
comments:
  debian/carnil: Fixed as well in 5.18.18 for 5.18.y and in 5.19.2 for 5.19.y.
  masami: |-
    This bug was introduced by commit 958bee14d071 ("netfilter:
    nf_tables: use new transaction infrastructure to handle sets")
    which was merged in 3.16-rc1. So, all stable kernels are
    affected by this vulnerability. 4.9 and 4.19 were failed to
    apply commit 470ee20.
  ubuntu/eslerm: CWE-416
  ubuntu/sbeattie: ZDI-CAN-17470
reporters:
- Team Orca of Sea Security (@seasecresponse) working with Trend Micro's Zero Day
  Initiative
introduced-by:
  mainline: [958bee14d0718ca7a5002c0f48a099d1d345812a]
fixed-by:
  cip/4.19: [77d3b5038b7462318f5183e2ad704b01d57215a2]
  cip/4.19-rt: [77d3b5038b7462318f5183e2ad704b01d57215a2]
  cip/4.4: [140fba22b65d4ab381f5857a720ccbf24ac402d4]
  cip/4.4-rt: [140fba22b65d4ab381f5857a720ccbf24ac402d4]
  cip/4.4-st: [140fba22b65d4ab381f5857a720ccbf24ac402d4]
  cip/5.10: [1a4b18b1ff11ba26f9a852019d674fde9d1d1cff]
  cip/5.10-rt: [1a4b18b1ff11ba26f9a852019d674fde9d1d1cff]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [470ee20e069a6d05ae549f7d0ef2bdbcee6a81b2]
  stable/4.19: [77d3b5038b7462318f5183e2ad704b01d57215a2]
  stable/5.10: [1a4b18b1ff11ba26f9a852019d674fde9d1d1cff]
  stable/5.15: [faafd9286f1355c76fe9ac3021c280297213330e]
  stable/5.18: [f4fa03410f7c5f5bd8f90e9c11e9a8c4b526ff6f]
  stable/5.19: [0d07039397527361850c554c192e749cfc879ea9]
  stable/5.4: [fab2f61cc3b0e441b1749f017cfee75f9bbaded7]
  ubuntu/bionic: [c3b0fa36cb3468c6d8389b871ea71be5385d2f6d, b9c8fa02d34eaa6c8f2cb49c0e4bedc35633b6c3]
  ubuntu/focal: [6a87d7de4f6d0cfa3adf221efb993c13235bdbee, 69959ca4d62a37c926e7dd4605e8201fc54801f5]
