description: 'io_uring/af_unix: defer registered files gc to io_uring release'
references:
- https://www.openwall.com/lists/oss-security/2022/10/18/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2602
- https://ubuntu.com/security/notices/USN-5691-1
- https://ubuntu.com/security/notices/USN-5692-1
- https://ubuntu.com/security/notices/USN-5693-1
- https://ubuntu.com/security/notices/USN-5700-1
- https://www.openwall.com/lists/oss-security/2022/10/27/3
- https://ubuntu.com/security/notices/USN-5752-1
- https://blog.hacktivesecurity.com/index.php/2022/12/21/cve-2022-2602-dirtycred-file-exploitation-applied-on-an-io_uring-uaf/
- https://www.cve.org/CVERecord?id=CVE-2022-2602
comments:
  debian/carnil: For 6.0.y fixed in 6.0.3.
  masami: UAF bug will cause local privilege escalation.
  ubuntu/eslerm: CWE-416
  ubuntu/sbeattie: ZDI-CAN-17428
reporters:
- Billy Jheng Bing Jhong working with Trend Micro's Zero Day Initiative
- David Bouman
introduced-by:
  mainline: [6b06314c47e141031be043539900d80d2c7ba10f]
fixed-by:
  cip/5.10: [c378c479c5175833bb22ff71974cda47d7b05401]
  cip/5.10-rt: [c378c479c5175833bb22ff71974cda47d7b05401]
  mainline: [0091bfc81741b8d3aeb3b7ab8636f911b2de6e80]
  stable/5.10: [c378c479c5175833bb22ff71974cda47d7b05401]
  stable/5.15: [813d8fe5d30388f73a21d3a2bf46b0a1fd72498c]
  stable/5.19: [b4293c01ee0d0ecdd3cb5801e13f62271144667a]
  stable/5.4: [04df9719df1865f6770af9bc7880874af0e594b2]
  stable/6.0: [75e94c7e8859e58aadc15a98cc9704edff47d4f2]
  ubuntu/focal: [8e7fcdd1373ff9af01ba875ac66ea44f6b0b9dac, 335ee58995f11ff99f9cd90ffd3500594735b072]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
