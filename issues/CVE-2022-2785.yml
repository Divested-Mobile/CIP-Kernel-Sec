description: |-
  There exists an arbitrary memory read within the Linux Kernel BPF -
  Constants provided to fill pointers in structs passed in to bpf_sys_bpf are
  not verified and can point anywhere, including memory not owned by BPF. An
  attacker with CAP_BPF can arbitrarily read memory from anywhere on the
  system. We recommend upgrading past commit 86f44fcec22c
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2785
- https://git.kernel.org/bpf/bpf/c/86f44fcec22c
- https://lore.kernel.org/bpf/20220816205517.682470-1-zhuyifei@google.com/T/#t
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=86f44fcec22ce2979507742bc53db8400e454f46
comments:
  debian/carnil: |-
    Introduced by b1d18a7574d0 ("bpf: Extend sys_bpf commands for
    bpf_syscall programs.") in 5.18-rc1.
  ubuntu/sbeattie: with unprivileged bpf disabled by default
introduced-by:
  mainline: [b1d18a7574d0df5eb4117c14742baf8bc2b9bb74]
fixed-by:
  mainline: [86f44fcec22ce2979507742bc53db8400e454f46]
  stable/5.19: [b429d0b9a7a0f3dddb1f782b72629e6353f292fd]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
  stable/5.4: Not affected
