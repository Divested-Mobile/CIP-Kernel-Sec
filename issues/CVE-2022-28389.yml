description: 'can: mcba_usb: mcba_usb_start_xmit(): fix double dev_kfree_skb in error
  path'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28389
- https://git.kernel.org/linus/04c9b00ba83594a29813d6b1fb8fdc93a3915174
- https://github.com/torvalds/linux/commit/04c9b00ba83594a29813d6b1fb8fdc93a3915174
- https://ubuntu.com/security/notices/USN-5416-1
- https://ubuntu.com/security/notices/USN-5467-1
- https://ubuntu.com/security/notices/USN-5469-1
- https://ubuntu.com/security/notices/USN-5515-1
- https://ubuntu.com/security/notices/USN-5541-1
comments:
  debian/bwh: The fix says this bug was present since the driver was added in 4.12.
  debian/carnil: |-
    For 5.16.y fixed as well in 5.16.19 and for 5.17.y fixed in
    5.17.2.
  masami: "This bug was introduced by commit 51f3baa (\"can: mcba_usb: Add support\
    \ \nfor Microchip CAN BUS Analyzer\") that was merged in 4.12-rc1. "
introduced-by:
  mainline: [51f3baad7de943780ce0c17bd7975df567dd6e14]
fixed-by:
  cip/4.19: [a8bba9fd73775e66b4021b18f2193f769ce48a59]
  cip/4.19-rt: [a8bba9fd73775e66b4021b18f2193f769ce48a59]
  cip/5.10: [0801a51d79389282c1271e623613b2e1886e071e]
  cip/5.10-rt: [0801a51d79389282c1271e623613b2e1886e071e]
  debian/buster-security: ['version:debian/4.19.249-1']
  mainline: [04c9b00ba83594a29813d6b1fb8fdc93a3915174]
  stable/4.14: [cdced1015a63a7f100b5867ebb9a40271f891411]
  stable/4.19: [a8bba9fd73775e66b4021b18f2193f769ce48a59]
  stable/5.10: [0801a51d79389282c1271e623613b2e1886e071e]
  stable/5.15: [37f07ad24866c6c1423b37b131c9a42414bcf8a1]
  stable/5.16: [f913412848defa326a155c47d026267624472190]
  stable/5.17: [42a4b0dfd365c4f77f96fd1f73a64b47ae443a38]
  stable/5.4: [2dfe9422d528630e2ce0d454147230cce113f814]
  ubuntu/bionic: [e3a286f1b14d4c7668948508feeb646cbe1e6c82]
  ubuntu/focal: [b882264cd2d5363349c6c35b31a72319ff8cc2b2]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.9: Not affected
