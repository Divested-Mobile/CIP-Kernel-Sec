description: 'SUNRPC: Ensure we flush any closed sockets before xs_xprt_free()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28893
- https://www.openwall.com/lists/oss-security/2022/04/11/3a
- https://www.openwall.com/lists/oss-security/2022/04/11/3
- https://www.openwall.com/lists/oss-security/2022/04/11/5
- https://github.com/torvalds/linux/commit/f00432063db1a0db484e85193eccc6845435b80e
- https://ubuntu.com/security/notices/USN-5544-1
- https://ubuntu.com/security/notices/USN-5562-1
- https://ubuntu.com/security/notices/USN-5564-1
- https://ubuntu.com/security/notices/USN-5566-1
- https://ubuntu.com/security/notices/USN-5582-1
- https://www.cve.org/CVERecord?id=CVE-2022-28893
comments:
  debian/carnil: For 5.17.y fixed in 5.17.3 and for 5.16.y fixed in 5.16.20.
  masami: |-
    This vulnerability was introduced by commit a73881c ("SUNRPC: Fix an Oops
    in udp_poll()") which was merged in 5.8-rc1. The commit a73881c fixes
    commit 0ffe86f("SUNRPC: Use poll() to fix up the socket requeue races")
    which was merged in 5.8-rc1.
    Commit 0ffe86f does not exist in less than 5.8 kernels so that thes
    kernels aren't affected by this issue.
reporters:
- Felix Fu
introduced-by:
  mainline: [a73881c96d73ee72b7dbbd38a6eeef66182a8ef7]
fixed-by:
  cip/5.10: [e68b60ae29de10c7bd7636e227164a8dbe305a82]
  cip/5.10-rt: [e68b60ae29de10c7bd7636e227164a8dbe305a82]
  mainline: [f00432063db1a0db484e85193eccc6845435b80e]
  stable/5.10: [e68b60ae29de10c7bd7636e227164a8dbe305a82]
  stable/5.15: [54f6834b283d9b4d070b0639d9ef5e1d156fe7b0]
  stable/5.16: [7a0921a23cae42e9fa5ce964f6907181b6dc80d8]
  stable/5.17: [d21287d8a4589dd8513038f887ece980fbc399cf]
  stable/5.4: [2f8f6c393b11b5da059b1fc10a69fc2f2b6c446a]
  ubuntu/focal: [3bf369151f44d39864d947a698514547e22c35d5]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
