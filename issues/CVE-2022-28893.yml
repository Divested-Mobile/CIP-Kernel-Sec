description: 'SUNRPC: Ensure we flush any closed sockets before xs_xprt_free()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28893
- https://www.openwall.com/lists/oss-security/2022/04/11/3a
comments:
  masami: |-
    This vulnerability was introduced by commit a73881c ("SUNRPC: Fix an Oops
    in udp_poll()") which was merged in 5.8-rc1. The commit a73881c fixes
    commit 0ffe86f("SUNRPC: Use poll() to fix up the socket requeue races")
    which was merged in 5.8-rc1.
    Commit 0ffe86f does not exist in less than 5.8 kernels so that thes
    kernels aren't affected by this issue.
introduced-by:
  mainline: [a73881c96d73ee72b7dbbd38a6eeef66182a8ef7]
fixed-by:
  mainline: [f00432063db1a0db484e85193eccc6845435b80e]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.19: Not affected
  stable/4.14: Not affected
