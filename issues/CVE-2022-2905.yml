description: 'bpf: Don''t use tnum_range on array range checking for poke descriptors'
references:
- https://lore.kernel.org/all/984b37f9fdf7ac36831d2137415a4a915744c1b6.1661462653.git.daniel@iogearbox.net/
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf.git/commit/?id=a657182a5c5150cdfacb6640aad1d2712571a409
- https://www.openwall.com/lists/oss-security/2022/08/26/1
- https://bugzilla.redhat.com/show_bug.cgi?id=2121800
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2905
- https://ubuntu.com/security/notices/USN-5729-1
- https://ubuntu.com/security/notices/USN-5729-2
- https://www.cve.org/CVERecord?id=CVE-2022-2905
comments:
  debian/carnil: |-
    Introduced by d2e4c1e6c294 ("bpf: Constant map key tracking for
    prog array pokes") in 5.5-rc1.
    Fixed as well in 5.19.6 for 5.19.y.
  masami: |-
    A slab-out-of-bound read bug wa found in bpf subsystem.
    Commit d2e4c1e6c294 it not backported to 4.4, 4.9, 4.14,
    4.19, and 5.4 kernels so these kernels aren't affected.
  ubuntu/sbeattie: |-
    unprivileged BPF is disabled by default in Ubuntu
      kernels; thus administrative privileges are required to exploit
      this unless a non-default configuration is used where the
      kernel.unprivileged_bpf_disabled sysctl has been set to 0.
reporters:
- Hsin-Wei Hung
introduced-by:
  mainline: [d2e4c1e6c2947269346054ac8937ccfe9e0bcc6b]
fixed-by:
  cip/5.10: [e8979807178434db8ceaa84dfcd44363e71e50bb]
  cip/5.10-rt: [e8979807178434db8ceaa84dfcd44363e71e50bb]
  mainline: [a657182a5c5150cdfacb6640aad1d2712571a409]
  stable/5.10: [e8979807178434db8ceaa84dfcd44363e71e50bb]
  stable/5.15: [4f672112f8665102a5842c170be1713f8ff95919]
  stable/5.19: [a36df92c7ff7ecde2fb362241d0ab024dddd0597]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
