description: |-
  drivers/infiniband/ulp/rtrs/rtrs-clt.c in the Linux kernel before 5.16.12
  has a double free related to rtrs_clt_dev_release.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29156
- https://github.com/torvalds/linux/commit/8700af2cc18c919b2a83e74e0479038fd113c15d
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.16.12
- https://ubuntu.com/security/notices/USN-5417-1
- https://www.cve.org/CVERecord?id=CVE-2022-29156
comments:
  debian/carnil: |-
    Issue introduced by eab098246625 ("RDMA/rtrs-clt: Refactor the
    failure cases in alloc_clt") in 5.12-rc1 but backported as well
    to 5.10.20 and 5.11.3.
  masami: "This vulnerability is introduced by commit eab0982 (\"RDMA/rtrs-clt:\n\
    Refactor the failure cases in alloc_clt\") which fixes commit 6a98d71\n(\"RDMA/rtrs:\
    \ client: main functionality\"). Commit eab0982 was merged in\n5.12-rc1-dontuse,\
    \ commmit 6a98d71 was merged in 5.8-rc1. \nThis driver was introduced in 5.8 so\
    \ less than 5.8 kernels aren't affected\nthis issue."
reporters:
- Miaoqian Lin
introduced-by:
  cip/5.10: [cb6d98b306556e7adc06099977953d7e0b4e2660]
  cip/5.10-rt: [cb6d98b306556e7adc06099977953d7e0b4e2660]
  mainline: [eab098246625e91c1cbd6e8f75b09e4c9c28a9fc]
  stable/5.10: [cb6d98b306556e7adc06099977953d7e0b4e2660]
  ubuntu/groovy: [4aee3fb9d7f8d9371290f6e14a21256c722a9559]
fixed-by:
  cip/5.10: [8260f1800f83e667f26c80baa7f0b9d92ae271d7]
  cip/5.10-rt: [8260f1800f83e667f26c80baa7f0b9d92ae271d7]
  mainline: [8700af2cc18c919b2a83e74e0479038fd113c15d]
  stable/5.10: [8260f1800f83e667f26c80baa7f0b9d92ae271d7]
  stable/5.15: [bf2cfad0c6e4b0d1b34d26420fddaf18dc25e56d]
  stable/5.16: [fa498059c631e94e91dcb6d78070909d8de56d99]
  ubuntu/focal: ['version:5.4.0-9.12']
