description: 'fs: fix UAF/GPF bug in nilfs_mdt_destroy'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2978
- https://lore.kernel.org/linux-fsdevel/20220816040859.659129-1-dzm91@hust.edu.cn/T/#u
- https://bugzilla.redhat.com/show_bug.cgi?id=2120664
- https://ubuntu.com/security/notices/USN-5650-1
- https://ubuntu.com/security/notices/USN-5693-1
- https://ubuntu.com/security/notices/USN-5727-1
- https://ubuntu.com/security/notices/USN-5728-1
- https://ubuntu.com/security/notices/USN-5729-1
- https://ubuntu.com/security/notices/USN-5727-2
- https://ubuntu.com/security/notices/USN-5728-2
- https://ubuntu.com/security/notices/USN-5729-2
- https://ubuntu.com/security/notices/USN-5728-3
- https://ubuntu.com/security/notices/USN-5774-1
- https://www.cve.org/CVERecord?id=CVE-2022-2978
comments:
  masami: |-
    A freeing uninitialized memory bug was found in
    nilfs_mdt_destroy(). This bug occurs in an error path.
    If allocating memory for inode is failed in inode_init_always(),
    it returns ENOMEM. Then nilfs_mdt_destroy() is called which
    frees uninialized data.
    It looks 4.4 kernel is affected by this bug too.
  ubuntu/sbeattie: unfixed upstream as of 2022/09/24
reporters:
- butt3rflyh4ck
- Hao Sun
- Jiacheng Xu
fixed-by:
  cip/4.19: [ec2aab115eb38ac4992ea2fcc2a02fbe7af5cf48]
  cip/4.19-rt: [ec2aab115eb38ac4992ea2fcc2a02fbe7af5cf48]
  cip/4.4: [802ba69f686ed47a8e591f5be8f8aa29556b732c]
  cip/4.4-rt: [802ba69f686ed47a8e591f5be8f8aa29556b732c]
  cip/4.4-st: [802ba69f686ed47a8e591f5be8f8aa29556b732c]
  cip/5.10: [1e555c3ed1fce4b278aaebe18a64a934cece57d8]
  cip/5.10-rt: [1e555c3ed1fce4b278aaebe18a64a934cece57d8]
  debian/buster-security: ['version:debian/4.19.269-1']
  mainline: [2e488f13755ffbb60f307e991b27024716a33b29]
  openela/4.14: [c0aa76b0f17f59dd9c9d3463550a2986a1d592e4]
  stable/4.14: [c0aa76b0f17f59dd9c9d3463550a2986a1d592e4]
  stable/4.19: [ec2aab115eb38ac4992ea2fcc2a02fbe7af5cf48]
  stable/4.9: [d1ff475d7c83289d0a7faef346ea3bbf90818bad]
  stable/5.10: [1e555c3ed1fce4b278aaebe18a64a934cece57d8]
  stable/5.15: [64b79e632869ad3ef6c098a4731d559381da1115]
  stable/5.4: [70e4f70d54e0225f91814e8610477d65f33cefe4]
  stable/6.0: [2a96b532098284ecf8e4849b8b9e5fc7a28bdee9]
  ubuntu/bionic: [ca28c0e73544c29afcabbda679df88f3f4474e04]
  ubuntu/focal: [25307c92bf879c79c523e165cb099a6559fac284]
