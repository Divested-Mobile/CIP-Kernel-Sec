description: Information leak through mispredicted returns on Intel processors
references:
- https://comsec.ethz.ch/research/microarch/retbleed/
- https://comsec.ethz.ch/wp-content/files/retbleed_sec22.pdf
- https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00702.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29901
- https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/advisory-guidance/return-stack-buffer-underflow.html
- https://community.intel.com/t5/Blogs/Products-and-Solutions/Security/Chips-Salsa-Episode-21-July-2022-Security-Advisories-Retbleed/post/1399055
- https://www.intel.com/content/www/us/en/developer/topic-technology/software-security-guidance/processors-affected-consolidated-product-cpu-model.html
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Retbleed
- https://xenbits.xen.org/xsa/advisory-407.html
comments:
  debian/bwh: |-
    Also known as "RETbleed", but is different from the AMD issue.
    Mitigations in order of preference: eIBRS in kernel, RSB-stuffing
    return thunk, or IBRS in kernel.
    Skylake and the other "lake" Âµarches are affected, except Icelake
    D and X.
reporters:
- Johannes Wikner
- Kaveh Razavi
fixed-by:
  mainline: [742ab6df974ae8384a2dd213db1a3a06cf6d8936, a883d624aed463c84c22596006e5a96f5b44db31,
    369ae6ffc41a3c1137cab697635a84d0cc7cdcea, 00e1533325fd1fb5459229fe37f235462649f668,
    0b53c374b9eff2255a386f1f1cfb9a928e52a5ae, 15e67227c49a57837108acfe1c80570e1bd9f962,
    d9e9d2300681d68a775c28de6aa6e5290ae17796, ee88d363d15617ff50ac24fab0ffec11113b2aeb,
    1f001e9da6bbf482311e45e48f53c2bd2179e59c, d77cfe594ad50e0bf95d457e02ccd578791b2a15,
    af2e140f34208a5dfb6b7a8ad2d56bda88f0524d, 15583e514eb16744b80be85dea0774ece153177d,
    0ee9073000e8791f8b134a8ded31bcc767f7f232, aa3d480315ba6c3025a60958e1981072ea37c3df,
    7c81c0c9210c9bfab2bae76aab2999de5bad27db, 951ddecf435659553ed15a9214e153a3af43a9a1,
    a149180fbcf336e97ce4eb2cdc13672727feb94d, 6b80b59b3555706508008f1f127b5412c89c7fd8,
    7fbf47c7ce50b38a64576b150e7011ae73d54669, e8ec1b6e08a2102d8755ccb06fa26d540f26a2fa,
    caa0ff24d5d0e02abce5e65c3d2b7f20a6617be5, 2dbb887e875b1de3ca8f40ddf26bcfe55798c609,
    c779bc1a9002fa474175b80e72b85c9bf628abb0, 7c693f54c873691a4b7da05c7e0f74e67745d144,
    166115c08a9b0b846b783088808a27d739be6e8d, 6ad0ad2bf8a67e27d1f9d006a1dabb0e1c360cc3,
    bf5835bcdb9635c97f85120dba9bfa21e111130f, 9bb2ec608a209018080ca262f771e6a9ff203b6f,
    b75b7f8ef1148be1b9321ffc2f6c19238904b438, d147553b64bad34d2f92cb7d8ba454ae95c3baac,
    3ebc170068885b6fc7bedda6c667bb2c4d533159, 0fe4aeea9c01baabecc8c3afc7889c809d939bc2,
    a09a6e2399ba0595c3042b3164f3ca68a3cff33e, d7caac991feeef1b871ee6988fd2c9725df09039,
    b2620facef4889fefcbf2e87284f34dcd4189bce, e6aa13622ea8283cc699cac5d018cc40a2ba2010,
    56aa4d221f1ee2c3a49b45b800778ec6e0ab73c5, bbb69e8bee1bd882784947095ffb2bfe0f7c9470,
    acac5e98ef8d638a411cfa2ee676c87e1973f126, 8faea26e611189e933ea2281975ff4dc7c1106b6,
    8bd200d23ec42d66ccd517a72dd0b9cc6132d2fd, bb06650634d3552c0f8557e9d16aa1a408040e28,
    fc02735b14fff8c6678b521d324ade27b1a3d4cf, bea7e31a5caccb6fe8ed989c065072354f0ecb52,
    9756bba28470722dacb79ffce554336dd1f6a6cd, 07853adc29a058c5fd143c14e5ac528448a72ed9,
    7a05bc95ed1c5a59e47aaade9fb4083c27de9e62, 26aae8ccbc1972233afd08fb3f368947c0314265,
    f43b9876e857c739d407bc56df288b0ebe1a9164, f54d45372c6ac9c993451de5e51312485f7d10bc,
    2c08b9b38f5b0f4a6c2d29be22b695e4ec4a556b, 2259da159fbe5dba8ac00b560cf00b6a6537fa18,
    697977d8415d61f3acbc4ee6d564c9dcf0309507, 4ad3278df6fe2b0852b00d5757fc2ccd8e92c26e,
    c27c753ea6fd1237f4f96abf8b623d7bab505513]
  stable/5.18: [e492002673b03c636d2297fb869d68ae545c41c4, e0ed7445cbb5a10bebec4f582894460453b3c0f6,
    079c71b6e380c40ee870bc59f176b36d93786db5, 7ce2011c8b28a44ae80d7081dc634eec174650ca,
    86fbd2844858c5aef57a28ebc3d53d298f37cc67, e0c27dc584f6395e57d67f5c60b3ee2347a45590,
    262941a05615d39d66dcf47909d6e67ea69d371d, eb84031e5c599a4b218ede3e10e7b5fd8ccc391a,
    0d15b9c30cb222d0e5ac2ff9ba7b93bd9af82d05, ebe3ceb43f5b5b88062ffd62c08d19a57f5fa44b,
    3525abdb3a63680b8623b0294bd9614b2352ccce, 2fc0ed17c526b032c1c416d77ebc491f446f1269,
    a302187fb8f6d2707aaadf5e8a558ff046378a80, a05146b2ac6ab1deff475a06441b825d176b320e,
    df777869fe2de25b60195561d3b674c9084aaeca, 9d75af6b406702b0af616cee49ae11ec0b2abe3a,
    64a98375f389bf695e2a2f199175b7a5ece44f45, a70ed95a0b0a15cfa86b1df4004d47f074de7de2,
    f88b40812b6b3d483fb5de11b72aeb0c2bb73c59, c85b5f77d3b224975d5caa329f28b22b7ea5addc,
    409586fb4a6e7b2331ecb4edec71e34e21750e05, 47e51d66d93d70d60e478cc81504deb0f4ff67ad,
    2c0d8e35807a6086542919e2d044cfa6683476de, e604d260c633926089e81f8e52c90c91bd797f12,
    fb32593f8f383e32bb82fd85cc3dd372c89566ac, 5a3037b4de4dd52504c0842aac5f9498b3d450af,
    7b2649892c7728d4ad662d75a887f8b43a209189, 6864df0932578931f13c8de5006975345f8cea0d,
    4a691f1e69163dcfb7b064a25a082071da0bb633, b75fada7f3cbbaf78beceb1bb71b67c2db3b473d,
    bbcfdf144d2d9394e3f4aa129463dec8f53bd3b1, 4c7f90f8a9554dd6a7e614529b3d7450a8dc84e2,
    a8a370f08eb55359980fe29165569333b1e0c54d, 80f8a9e9d530fec6094641b96fe3e5b5acb44830,
    3d6bdd768577847ae680b27bfb50c6de2037afe7, 3e89c42462722bbf778ac1e97236dca518fabbf9,
    ff110fe719555fd358ac9e0bd0ca549fae3e26e9, 8a95fadc8f3264dc98376d0de66ec59dd9eafb6f,
    7377eea29dbcad2ad042eee66df17c11b8421654, 43827446da732ed012c9008c429424f81e36331b,
    bcb9508413dc8a73cb8abd761a85dc5c6f9bd911, 245800423a576925d0bd571eacf09cc12e94a9ff,
    d58141112c9965092a0f39d354b22394882585b4, 48fe9931c7ddf18063aa0c8d16c3831f9d9a16c4,
    8c38306e2e9257af4af2819aa287a4711ff36329, afd743f6dde87296c6f3414706964c491bb85862,
    373e6942143b5ca27b24ee953ae450dd26a0dbfb, 409f6047a43315f2b9661149cb29d6f2ef2440fe,
    813423f90f0553c81c5fb4d531fc688a5d506b24, ee02cbcebb0985394910d8868c6eef49184b20f7,
    df6fc784e8db07b8fe5aa1c624411f381f3abeaa, e2fe046fe230c5159660257712566a849847cffa,
    845351c56ca069162433cf935afb2257a4c021d1, ffdd31e8db4e94f399e68727fadf776fc0a2d1ba,
    6461cc8f22a1266498290b122b56f040d51d9224]
