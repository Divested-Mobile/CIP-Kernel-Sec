description: 'ptrace: Check PTRACE_O_SUSPEND_SECCOMP permission on PTRACE_SEIZE'
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=2276
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-30594
- https://git.kernel.org/linus/ee1fee900537b5d9560e9f937402de5ddc8412f3
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.17.2
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=ee1fee900537b5d9560e9f937402de5ddc8412f3
- https://github.com/torvalds/linux/commit/ee1fee900537b5d9560e9f937402de5ddc8412f3
- https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1972740
- https://ubuntu.com/security/notices/USN-5442-1
- https://ubuntu.com/security/notices/USN-5443-1
- https://ubuntu.com/security/notices/USN-5442-2
- https://ubuntu.com/security/notices/USN-5443-2
- https://ubuntu.com/security/notices/USN-5465-1
- https://www.cve.org/CVERecord?id=CVE-2022-30594
comments:
  masami: "Missing permission check bug was found in seccomp module by using\nPTRACE_SEIZE\
    \ flag. This bug was introduced by commit 13c4a90 \n(\"seccomp: add ptrace options\
    \ for suspend/resume\") that was merged in\n4.3-rc1."
  ubuntu/sbeattie: PoC in the project zero post
reporters:
- Jann Horn
introduced-by:
  mainline: [13c4a90119d28cfcb6b5bdd820c233b86c2b0237]
fixed-by:
  cip/4.19: [b1f438f872dcda10a79e6aeaf06fd52dfb15a6ab]
  cip/4.19-rt: [b1f438f872dcda10a79e6aeaf06fd52dfb15a6ab]
  cip/4.4: [929d46ff6e73780261380d1de2e33ae00dcec00c]
  cip/4.4-rt: [929d46ff6e73780261380d1de2e33ae00dcec00c]
  cip/4.4-st: [929d46ff6e73780261380d1de2e33ae00dcec00c]
  cip/5.10: [5a41a3033a9344d7683340e3d83f5435ffb06501]
  cip/5.10-rt: [5a41a3033a9344d7683340e3d83f5435ffb06501]
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [ee1fee900537b5d9560e9f937402de5ddc8412f3]
  stable/4.14: [f1442ed84c43610ca8ab77deb9ca991e7354746c]
  stable/4.19: [b1f438f872dcda10a79e6aeaf06fd52dfb15a6ab]
  stable/4.9: [4f96b94a8342fac058117962f1a76fc7ebd1c245]
  stable/5.10: [5a41a3033a9344d7683340e3d83f5435ffb06501]
  stable/5.15: [b6d75218ff65f4d63c9cf4986f6c55666fb90a1a]
  stable/5.17: [4d51bbc8a3799febf50471eb6888b1b58e87111e]
  stable/5.4: [2458ecd21f29a3e5571d7d97764c043083deed5e]
  ubuntu/bionic: [655f7d572a3fe0d7fa418ad8e6b3148cb4a6da11]
  ubuntu/focal: [f23b457f19a6acc4c66ea3146343a181c39cdba9]
