description: Request to NVME_IOCTL_RESET and NVME_IOCTL_SUBSYS_RESET may cause a DOS
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2125341
- https://bugzilla.kernel.org/show_bug.cgi?id=214771
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3169
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=1e866afd4bcdd01a70a5eddb4371158d3035ce03
- https://ubuntu.com/security/notices/USN-5911-1
- https://ubuntu.com/security/notices/USN-5912-1
- https://ubuntu.com/security/notices/USN-5917-1
- https://ubuntu.com/security/notices/USN-5929-1
- https://ubuntu.com/security/notices/USN-5934-1
- https://ubuntu.com/security/notices/USN-5935-1
- https://ubuntu.com/security/notices/USN-5938-1
- https://ubuntu.com/security/notices/USN-5939-1
- https://ubuntu.com/security/notices/USN-5940-1
- https://ubuntu.com/security/notices/USN-5941-1
- https://ubuntu.com/security/notices/USN-5950-1
- https://ubuntu.com/security/notices/USN-5951-1
- https://ubuntu.com/security/notices/USN-5962-1
- https://ubuntu.com/security/notices/USN-6000-1
- https://www.cve.org/CVERecord?id=CVE-2022-3169
comments:
  debian/carnil: |-
    Is 23e085b2dead ("nvme: restrict management ioctls to admin")
    as well part of the fixes needed (is the preceeding commit to
    1e866afd4bcd ("nvme: ensure subsystem reset is single
    threaded"))?
    Fixed as well in 6.0.10 for 6.10.y.
  ubuntu/sbeattie: |-
    probably introduced more recently than b60503ba432b ("NVMe:
      New driver")
introduced-by:
  mainline: [b60503ba432b16fc84442a84e29a7aad2c0c363d]
fixed-by:
  cip/5.10: [023435a095d22bcbbaeea7e3a8c534b5c57d0d82]
  cip/5.10-rt: [023435a095d22bcbbaeea7e3a8c534b5c57d0d82]
  mainline: [1e866afd4bcdd01a70a5eddb4371158d3035ce03]
  stable/5.10: [023435a095d22bcbbaeea7e3a8c534b5c57d0d82]
  stable/5.15: [b1a27b2aad936746e6ef64c8a24bcb6dce6f926a]
  stable/5.4: [99c59256ea00ff7fab4914bb38e10a84850de514]
  stable/6.0: [0c2b1c56252bf19d3412137073c2c07e86f40ba1]
  ubuntu/focal: [d2b8a6c4a450c49174878f91ce2bc831e6e86a49]
