description: 'io_uring: disable polling pollfree files'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3176
- https://kernel.dance/#fc78b2fc21f10c4c9c4d5d659a685710ffa63659
- https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit?h=linux-5.4.y&id=fc78b2fc21f10c4c9c4d5d659a685710ffa63659
- https://ubuntu.com/security/notices/USN-5667-1
- https://ubuntu.com/security/notices/USN-5668-1
- https://ubuntu.com/security/notices/USN-5677-1
- https://ubuntu.com/security/notices/USN-5682-1
- https://ubuntu.com/security/notices/USN-5683-1
- https://ubuntu.com/security/notices/USN-5703-1
- https://ubuntu.com/security/notices/USN-5706-1
- https://www.cve.org/CVERecord?id=CVE-2022-3176
comments:
  debian/carnil: |-
    Introduced by 221c5eb233823 ("io_uring: add support for
    IORING_OP_POLL") 5.1-rc1.
    We need to investigate how this was fixed in mainline through
    refactorings likely?
    Consider it as fixed with 791f3465c4af ("io_uring: fix UAF due
    to missing POLLFREE handling") in 5.17-rc1.
reporters:
- Eric Biggers
introduced-by:
  mainline: [221c5eb2338232f7340386de1c43decc32682e58]
fixed-by:
  cip/5.10: [28d8d2737e82fc29ff9e788597661abecc7f7994]
  cip/5.10-rt: [28d8d2737e82fc29ff9e788597661abecc7f7994]
  mainline: [791f3465c4afde02d7f16cf7424ca87070b69396]
  stable/5.10: [28d8d2737e82fc29ff9e788597661abecc7f7994]
  stable/5.15: [e9d7ca0c4640cbebe6840ee3bac66a25a9bacaf5]
  stable/5.4: [fc78b2fc21f10c4c9c4d5d659a685710ffa63659]
  ubuntu/focal: [001edf94b6232281320d5552aeae3567e38390f2]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
