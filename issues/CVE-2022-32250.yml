description: |-
  net/netfilter/nf_tables_api.c in the Linux kernel through 5.18.1 allows a
  local user (able to create user/net namespaces) to escalate privileges to
  root because an incorrect NFT_STATEFUL_EXPR check leads to a
  use-after-free.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32250
- https://www.openwall.com/lists/oss-security/2022/05/31/1
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/net/netfilter?id=520778042ccca019f3ffa136dd0ca565c486cedd
- http://www.openwall.com/lists/oss-security/2022/06/03/1
- http://www.openwall.com/lists/oss-security/2022/06/04/1
comments:
  ubuntu/mdeslaur: possible dupe of CVE-2022-1966
introduced-by:
  mainline: [0b2d8a7b638b5034d2d68f6add8af94daaa1d4cd]
fixed-by:
  cip/5.10: [ea62d169b6e731e0b54abda1d692406f6bc6a696]
  mainline: [520778042ccca019f3ffa136dd0ca565c486cedd]
  stable/5.10: [ea62d169b6e731e0b54abda1d692406f6bc6a696]
  stable/5.15: [f692bcffd1f2ce5488d24fbcb8eab5f351abf79d]
  stable/5.17: [d8db0465bcc4d4b54ecfb67b820ed26eb1440da7]
  stable/5.18: [8f44c83e51b4ca49c815f8dd0d9c38f497cdbcb0]
  ubuntu/bionic: [cd093e8ad0e0ea2eb18d38e2400af881d0ec969c]
  ubuntu/focal: [40a4a01034fea467898ced9f5202cbe749f244a4]
