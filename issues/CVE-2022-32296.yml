description: 'tcp: increase source port perturb table to 2^16'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32296
- https://git.kernel.org/linus/4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.17.9
comments:
  masami: |-
    The INET_TABLE_PERTURB_SHIFT macro was introduced by
    commmit 190cc82 ("tcp: change source port randomizarion
    at connect() time") in 5.12-rc1-dontuse. This commit
    has been backported to 4.14, 4.19, and 5.10 so these
    kernels affected by this vulnerability.
    This backport was done recently.
fixed-by:
  mainline: [4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5]
  stable/5.15: [952a238d779eea4ecb2f8deb5004c8f56be79bc9]
  stable/5.17: [e3ee7bb47d6509c3e8a3e96e5d8e3bf21549b6e8]
