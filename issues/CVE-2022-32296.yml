description: 'tcp: increase source port perturb table to 2^16'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32296
- https://git.kernel.org/linus/4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.17.9
- https://bugzilla.redhat.com/show_bug.cgi?id=2096901
- https://bugzilla.redhat.com/show_bug.cgi?id=2064604
- https://lore.kernel.org/lkml/20220427065233.2075-1-w@1wt.eu/T/
- https://ubuntu.com/security/notices/USN-5616-1
- https://ubuntu.com/security/notices/USN-5622-1
- https://ubuntu.com/security/notices/USN-5623-1
- https://ubuntu.com/security/notices/USN-5630-1
- https://ubuntu.com/security/notices/USN-5639-1
- https://ubuntu.com/security/notices/USN-5647-1
- https://ubuntu.com/security/notices/USN-5654-1
- https://ubuntu.com/security/notices/USN-5660-1
- https://ubuntu.com/security/notices/USN-5669-1
- https://ubuntu.com/security/notices/USN-5669-2
comments:
  debian/bwh: This seems to be a duplicate of CVE-2022-1012.
  masami: |-
    The INET_TABLE_PERTURB_SHIFT macro was introduced by
    commmit 190cc82 ("tcp: change source port randomizarion
    at connect() time") in 5.12-rc1-dontuse. This commit
    has been backported to 4.14, 4.19, and 5.10 so these
    kernels affected by this vulnerability.
    This backport was done recently.
  ubuntu/sbeattie: this is likely a duplicate of CVE-2022-1012
reporters:
- Moshe Kol
- Amit Klein
- Yossi Gilad
fixed-by:
  cip/4.19: [514cd2859c5017fdc487165b093b328e24afe954]
  cip/4.19-rt: [514cd2859c5017fdc487165b093b328e24afe954]
  cip/4.4: [92decc8137fa51c7ab86edc2471ccebc8a9d76a2]
  cip/4.4-rt: [92decc8137fa51c7ab86edc2471ccebc8a9d76a2]
  cip/4.4-st: [92decc8137fa51c7ab86edc2471ccebc8a9d76a2]
  cip/5.10: [9429b75bc271b6f29e50dbb0ee0751800ff87dd9]
  debian/buster-security: ['version:debian/4.19.249-1']
  debian/stretch-security: ['version:debian/4.9.320-2']
  mainline: [4c2c8f03a5ab7cb04ec64724d7d176d00bcc91e5]
  stable/4.14: [9044e70fadec49482c3cb3c2f49e81825796ea6d]
  stable/4.19: [514cd2859c5017fdc487165b093b328e24afe954]
  stable/4.9: [3c78eea640f69e2198b69128173e6d65a0bcdc02]
  stable/5.10: [9429b75bc271b6f29e50dbb0ee0751800ff87dd9]
  stable/5.15: [952a238d779eea4ecb2f8deb5004c8f56be79bc9]
  stable/5.17: [e3ee7bb47d6509c3e8a3e96e5d8e3bf21549b6e8]
  stable/5.4: [c26e1addf15763ae404f4bbf131719a724e768ab]
  ubuntu/bionic: [64b7b4390e70dd74f61a5dcbb2b3a307ce4b8eeb]
  ubuntu/focal: [dfc76670c4ca1db1d4d31beabddbbc8f71a0c08c]
