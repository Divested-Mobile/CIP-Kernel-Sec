description: 'KVM: SVM: nested shutdown interception could lead to host crash'
references:
- https://lore.kernel.org/lkml/20221020093055.224317-5-mlevitsk@redhat.com/T/
- https://bugzilla.redhat.com/show_bug.cgi?id=2130278
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3344
- https://lore.kernel.org/lkml/20221103141351.50662-1-mlevitsk@redhat.com/
- https://lore.kernel.org/lkml/20221103141351.50662-3-mlevitsk@redhat.com/
- https://ubuntu.com/security/notices/USN-5911-1
- https://ubuntu.com/security/notices/USN-5912-1
- https://ubuntu.com/security/notices/USN-5929-1
- https://ubuntu.com/security/notices/USN-5935-1
- https://ubuntu.com/security/notices/USN-5938-1
- https://ubuntu.com/security/notices/USN-5941-1
- https://ubuntu.com/security/notices/USN-5950-1
- https://ubuntu.com/security/notices/USN-5962-1
- https://www.cve.org/CVERecord?id=CVE-2022-3344
comments:
  debian/bwh: |-
    The first two fixes seem to be needed only after commit 2fcf4876ada8
    "KVM: nSVM: implement on demand allocation of the nested state" in
    5.10. The last two are probably needed for 4.19 as well, though
    backporting them doesn't look straightforward.
  debian/carnil: Fixed as well in 6.0.11 for 6.0.y.
  ubuntu/sbeattie: it's possible only the first two commits are necessary
reporters:
- Maxim Levitsky
fixed-by:
  cip/5.10: [7e5cb13091e62b2ad2fe1d3a48753c7219a3e9f9]
  cip/5.10-rt: [7e5cb13091e62b2ad2fe1d3a48753c7219a3e9f9]
  mainline: [16ae56d7e0528559bf8dc9070e3bfd8ba3de80df, ed129ec9057f89d615ba0c81a4984a90345a1684,
    917401f26a6af5756d89b550a8e1bd50cf42b07e, f9697df251438b0798780900e8b43bdb12a56d64]
  stable/5.10: [7e5cb13091e62b2ad2fe1d3a48753c7219a3e9f9]
  stable/5.15: [3e87cb0caa25d667a9ca2fe15fef889e43ab8f95, 6425c590d0cc6914658a630a40b7f8226aa028c3]
  stable/6.0: [5ca2721b7d3ed4d3da6323a2ea7339f745866d83, d40ef0a511676bd65ca9acb295430c07af59ab85]
