description: |-
  rpmsg_virtio_add_ctrl_dev in drivers/rpmsg/virtio_rpmsg_bus.c in the Linux kernel
  before 5.18.4 has a double free.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34494
- https://git.kernel.org/linus/1680939e9ecf7764fba8689cfb3429c2fe2bb23c
- https://ubuntu.com/security/notices/USN-5529-1
- https://ubuntu.com/security/notices/USN-5517-1
- https://ubuntu.com/security/notices/USN-5623-1
- https://ubuntu.com/security/notices/USN-5624-1
- https://ubuntu.com/security/notices/USN-5633-1
- https://ubuntu.com/security/notices/USN-5635-1
- https://ubuntu.com/security/notices/USN-5640-1
- https://ubuntu.com/security/notices/USN-5644-1
- https://ubuntu.com/security/notices/USN-5648-1
- https://ubuntu.com/security/notices/USN-5655-1
- https://ubuntu.com/security/notices/USN-5683-1
- https://www.cve.org/CVERecord?id=CVE-2022-34494
comments:
  debian/carnil: |-
    Commit fixes c486682ae1e2 ("rpmsg: virtio: Register the
    rpmsg_char device") in 5.13-rc1.
  masami: |-
    This bug was introduced by commit c486682 ("rpmsg: virtio: Register
    the rpmsg_char device") which was merged in 5.13-rc1.
introduced-by:
  mainline: [c486682ae1e2b149add22f44cf413b3103e3ef39]
fixed-by:
  mainline: [1680939e9ecf7764fba8689cfb3429c2fe2bb23c]
  stable/5.15: [b94d40c792de7f0ceda6a2fd8a8dc0597eca6d22]
  stable/5.18: [d51720ac069d465101d937273acecde1f71ea411]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
