description: 'netfilter: nf_tables: stricter validation of element data'
references:
- https://www.openwall.com/lists/oss-security/2022/07/02/3
- https://lore.kernel.org/netfilter-devel/cd9428b6-7ffb-dd22-d949-d86f4869f452@randorisec.fr/T/#u
- https://git.kernel.org/pub/scm/linux/kernel/git/netdev/net.git/commit/?id=7e6bc1f6cabcd30aba0b11219d8e01b952eacbb6
- https://www.openwall.com/lists/oss-security/2022/07/03/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34918
- http://www.openwall.com/lists/oss-security/2022/07/05/1
- https://www.randorisec.fr/crack-linux-firewall/
- https://ubuntu.com/security/notices/USN-5540-1
- https://ubuntu.com/security/notices/USN-5544-1
- https://ubuntu.com/security/notices/USN-5545-1
- https://ubuntu.com/security/notices/USN-5560-1
- https://ubuntu.com/security/notices/USN-5560-2
- https://ubuntu.com/security/notices/USN-5562-1
- https://ubuntu.com/security/notices/USN-5564-1
- https://ubuntu.com/security/notices/USN-5566-1
comments:
  debian/carnil: |-
    Should be present since fdb9c405e35b ("netfilter: nf_tables:
    allow up to 64 bytes in the set element data area") in 5.8-rc1.
    Fixed as well in 5.18.11 for 5.18.y.
  masami: 4.x kernels are not affected by this issue.
reporters:
- Arthur Mongodin
introduced-by:
  mainline: [fdb9c405e35bdc6e305b9b4e20ebc141ed14fc81]
fixed-by:
  cip/5.10: [0a5e36dbcb448a7a8ba63d1d4b6ade2c9d3cc8bf]
  mainline: [7e6bc1f6cabcd30aba0b11219d8e01b952eacbb6]
  stable/5.10: [0a5e36dbcb448a7a8ba63d1d4b6ade2c9d3cc8bf]
  stable/5.15: [c1784d2075138992b00c17ab4ffc6d855171fe6d]
  stable/5.18: [6b7488071ea8ed6265a39afebd5a5920f6975d02]
  ubuntu/bionic: [bc1598c0b9c50c0ecbce46fcf9b7eda5572c78b4]
  ubuntu/focal: [5cdece622e8791cef7df251b76bfde4ae8a667d7]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
