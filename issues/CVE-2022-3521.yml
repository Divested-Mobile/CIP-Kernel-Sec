description: 'kcm: avoid potential race in kcm_tx_work'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3521
- https://git.kernel.org/linus/ec7eede369fe5b0d085ac51fdbb95184f87bfc6c
- https://ubuntu.com/security/notices/USN-5883-1
comments:
  debian/carnil: |-
    In Debian CONFIG_AF_KCM is not set (but there is a pending
    request for enablement in #1023958)
    Fixed as well in 6.0.10 for 6.10.y.
  masami: "Introduced by ab7ac4e (\"kcm: Kernel Connection Multiplexor\nmodule\")\
    \ in 4.6-rc1. kcm was introduced since 4.6 so \n4.4 kernel is not affected by\
    \ this issue."
introduced-by:
  mainline: [ab7ac4eb9832e32a09f4e8042705484d2fb0aad3]
fixed-by:
  cip/4.19: [23a0a5869749c7833772330313ae7aec6581ec60]
  cip/4.19-rt: [23a0a5869749c7833772330313ae7aec6581ec60]
  cip/5.10: [7deb7a9d33e4941c5ff190108146d3a56bf69e9d]
  cip/5.10-rt: [7deb7a9d33e4941c5ff190108146d3a56bf69e9d]
  debian/buster-security: ['version:debian/4.19.269-1']
  mainline: [ec7eede369fe5b0d085ac51fdbb95184f87bfc6c]
  stable/4.14: [381b6cb3f3e66b84db77028ac7d84f18d80f1153]
  stable/4.19: [23a0a5869749c7833772330313ae7aec6581ec60]
  stable/4.9: [fe3f79701fdaf8a087bc7043839e7f8b2e61b6fe]
  stable/5.10: [7deb7a9d33e4941c5ff190108146d3a56bf69e9d]
  stable/5.15: [27d706b0d394a907ff8c4f83ffef9d3e5817fa84]
  stable/5.4: [ad39d09190a545d0f05ae0a82900eee96c5facea]
  stable/6.0: [2526ac6b0f5a9b38e7e9073e37141cf78408078d]
  ubuntu/bionic: [2771357f8009ca30181c3c5b81a8dcbc585c88bf]
  ubuntu/focal: [8b060980830bfdb785c99779964343211de2c461]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
