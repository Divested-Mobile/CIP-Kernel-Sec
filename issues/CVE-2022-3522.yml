description: 'mm/hugetlb: use hugetlb_pte_stable in migration race check'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3522
- https://git.kernel.org/linus/f9bf6c03eca1077cae8de0e6d86427656fa42a9b
- https://www.cve.org/CVERecord?id=CVE-2022-3522
comments:
  debian/bwh: |-
    This seems to be a missed conversion in commit c64e912c865a
    "mm/hugetlb: handle pte markers in page faults" which was
    preparation for commit 60dfaad65aa9 "mm/hugetlb: allow uffd
    wr-protect none ptes".  That means nothing before 5.19 is
    affected.
  masami: |-
    Commit 2ea7ff1 ("mm/hugetlb: fix race condition of uffd
    missing/minor handling") in 6.1-rc1 added new function
    called hugetlb_pte_stable(). Commit f9bf6c0 requires
    commit 2ea7ff1.
fixed-by:
  mainline: [f9bf6c03eca1077cae8de0e6d86427656fa42a9b]
fix-depends-on:
  2ea7ff1e39cbe3753d3c649beb70f2cf861dca75: |-
    f9bf6c0 ("mm/hugetlb: use hugetlb_pte_stable in migration race
    check") needs hugetlb_pte_stable().
