description: 'x86: Clear .brk area at early boot'
references:
- https://github.com/sickcodes/security/blob/master/advisories/SICK-2022-128.md
- https://sick.codes/sick-2022-128
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36123
- https://github.com/torvalds/linux/commit/74a0032b8524ee2bd4443128c0bf9775928680b0
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.18.13
- https://github.com/torvalds/linux/commit/96e8fc5818686d4a1591bb6907e7fdb64ef29884
- https://bugzilla.suse.com/show_bug.cgi?id=CVE-2022-36123
comments:
  debian/carnil: |-
    Though 38fa5479b413 ("x86: Clear .brk area at early boot") was
    backported to various stable series, if I understand the report
    correctly the issue is only present for kernels which include
    8b87d8cec1b3 ("x86/entry,xen: Early rewrite of
    restore_regs_and_return_to_kernel()") 5.18-rc1.
    Ben, please double-check if the triage is correct.
  masami: |-
    Kernel is vulnerable if kernel contains commit 8b87d8c
    ("x86/entry,xen: Early rewrite of restore_regs_and_return_to_kernel()").
    This vulnerability was affected to Xen PV guest.
introduced-by:
  mainline: [8b87d8cec1b31ea710568ae49ba5f5146318da0d]
fixed-by:
  cip/4.19: [36e2f161fb01795722f2ff1a24d95f08100333dd]
  cip/4.4: [ceaf9e5feb820af7eac63550fc00b52fd39ebcd6]
  cip/4.4-st: [ceaf9e5feb820af7eac63550fc00b52fd39ebcd6]
  cip/5.10: [136d7987fcfdeca73ee3c6a29e48f99fdd0f4d87]
  mainline: [38fa5479b41376dc9d7f57e71c83514285a25ca0]
  stable/4.14: [a24eebede57ff42d5123cca948c5077ccddbffcb]
  stable/4.19: [36e2f161fb01795722f2ff1a24d95f08100333dd]
  stable/4.9: [b3d7c509bcbd4384d4964dcdf028b3c3e0adb7f7]
  stable/5.10: [136d7987fcfdeca73ee3c6a29e48f99fdd0f4d87]
  stable/5.15: [26bb7afc027ce6ac8ab6747babec674d55689ff0]
  stable/5.18: [2334bdfc2da469c9807767002a2831274b82c39a]
  stable/5.4: [a3c7c1a726a4c6b63b85e8c183f207543fd75e1b]
