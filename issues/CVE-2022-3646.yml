description: 'nilfs2: fix leak of nilfs_root in case of writer thread creation failure'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3646
- https://git.kernel.org/linus/d0d51a97063db4704a5ef6bc978dddab1636a306
- https://git.kernel.org/pub/scm/linux/kernel/git/bpf/bpf-next.git/commit/?id=d0d51a97063db4704a5ef6bc978dddab1636a306
- https://vuldb.com/?id.211961
- https://ubuntu.com/security/notices/USN-5791-1
- https://ubuntu.com/security/notices/USN-5792-1
- https://ubuntu.com/security/notices/USN-5793-1
- https://ubuntu.com/security/notices/USN-5791-2
- https://ubuntu.com/security/notices/USN-5792-2
- https://ubuntu.com/security/notices/USN-5793-2
- https://ubuntu.com/security/notices/USN-5791-3
- https://ubuntu.com/security/notices/USN-5793-3
- https://ubuntu.com/security/notices/USN-5793-4
- https://ubuntu.com/security/notices/USN-5815-1
- https://ubuntu.com/security/notices/USN-5854-1
- https://ubuntu.com/security/notices/USN-5861-1
- https://ubuntu.com/security/notices/USN-5862-1
- https://ubuntu.com/security/notices/USN-5865-1
- https://ubuntu.com/security/notices/USN-5877-1
- https://ubuntu.com/security/notices/USN-5883-1
- https://ubuntu.com/security/notices/USN-5919-1
- https://ubuntu.com/security/notices/USN-5924-1
- https://ubuntu.com/security/notices/USN-5975-1
- https://ubuntu.com/security/notices/USN-5976-1
- https://ubuntu.com/security/notices/USN-6001-1
- https://ubuntu.com/security/notices/USN-6007-1
- https://ubuntu.com/security/notices/USN-6013-1
- https://ubuntu.com/security/notices/USN-6014-1
- https://www.cve.org/CVERecord?id=CVE-2022-3646
comments:
  masami: |-
    Introduced by commit e912a5b ("nilfs2: use root object to get
    ifile") in v2.6.37-rc1.
  ubuntu/rodrigo-zaiden: |-
    USN-5975-1 first publication included esm/xenial linux-gcp
      version 4.15.0-1146.162~16.04.1 by mistake, please refer to USN-6007-1.
introduced-by:
  mainline: [e912a5b66837ee89fb025e67b5efeaa11930c2ce]
fixed-by:
  cip/4.19: [4b748ef0f2afadd31c914623daa610f26385a4dc]
  cip/4.19-rt: [4b748ef0f2afadd31c914623daa610f26385a4dc]
  cip/4.4: [684b9107f7b077c62ac514a1d9fdc6c28638d01f]
  cip/4.4-rt: [684b9107f7b077c62ac514a1d9fdc6c28638d01f]
  cip/4.4-st: [684b9107f7b077c62ac514a1d9fdc6c28638d01f]
  cip/5.10: [aad4c997857f1d4b6c1e296c07e4729d3f8058ee]
  cip/5.10-rt: [aad4c997857f1d4b6c1e296c07e4729d3f8058ee]
  debian/buster-security: ['version:debian/4.19.269-1']
  mainline: [d0d51a97063db4704a5ef6bc978dddab1636a306]
  stable/4.14: [a832de79d82ac8c9f445f99069e11b17c5d2224a]
  stable/4.19: [4b748ef0f2afadd31c914623daa610f26385a4dc]
  stable/4.9: [81fe58e4e7f61a1f5200898e7cd4c9748f83051f]
  stable/5.10: [aad4c997857f1d4b6c1e296c07e4729d3f8058ee]
  stable/5.15: [44b1ee304bac03f1b879be5afe920e3a844e40fc]
  stable/5.19: [4755fcd844240857b525f6e8d8b65ee140fe9570]
  stable/5.4: [b7e409d11db9ce9f8bc05fcdfa24d143f60cd393]
  stable/6.0: [9dc48a360e7b6bb16c48625f8f80ab7665bc9648]
  ubuntu/bionic: [dbd91f8518188dc5b38e723e3e9480e4204c1272]
  ubuntu/focal: [c2dab6158032dba34733231338e45e1106a6e4e1]
