description: kernel panic when sending nf_queue verdict with 1-byte nfta_payload attribute
references:
- https://marc.info/?l=netfilter-devel&m=165883202007292&w=2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36946
comments:
  debian/carnil: |-
    Introduced by 7af4cc3fa158 ("[NETFILTER]: Add "nfnetlink_queue"
    netfilter queue handler over nfnetlink")
    For 5.18.y fixed as well in 5.18.16.
  masami: |-
    A remote attacker to cause DoS when sending nf_queue verdict with
    1-byte nfta_payload attribute. In the nfqnl_mangle(), there was an
    insufficient data length check that will result a kernel panic.
introduced-by:
  mainline: [7af4cc3fa158ff1dda6e7451c7e6afa6b0bb85cb]
fixed-by:
  mainline: [99a63d36cb3ed5ca3aa6fcb64cffbeaf3b0fb164]
  stable/5.10: [440dccd80f627e0e11ceb0429e4cdab61857d17e]
  stable/5.15: [91c11008aab0282957b8b8ccb0707d90e74cc3b9]
  stable/5.18: [883c20911d6261fc651820b63a77327b8c020264]
  stable/5.4: [52be29e8b6455788a4d0f501bd87aa679ca3ba3c]
