description: kernel panic when sending nf_queue verdict with 1-byte nfta_payload attribute
references:
- https://marc.info/?l=netfilter-devel&m=165883202007292&w=2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36946
comments:
  debian/carnil: |-
    Introduced by 7af4cc3fa158 ("[NETFILTER]: Add "nfnetlink_queue"
    netfilter queue handler over nfnetlink")
  masami: |-
    A remote attacker to cause DoS when sending nf_queue verdict with
    1-byte nfta_payload attribute. In the nfqnl_mangle(), there was an
    insufficient data length check that will result a kernel panic.
introduced-by:
  mainline: [7af4cc3fa158ff1dda6e7451c7e6afa6b0bb85cb]
fixed-by:
  mainline: [99a63d36cb3ed5ca3aa6fcb64cffbeaf3b0fb164]
