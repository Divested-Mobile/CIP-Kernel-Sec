description: kernel panic when sending nf_queue verdict with 1-byte nfta_payload attribute
references:
- https://marc.info/?l=netfilter-devel&m=165883202007292&w=2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36946
- https://ubuntu.com/security/notices/USN-5580-1
- https://bugzilla.redhat.com/show_bug.cgi?id=2115278
- https://ubuntu.com/security/notices/USN-5590-1
- https://ubuntu.com/security/notices/USN-5621-1
- https://ubuntu.com/security/notices/USN-5622-1
- https://ubuntu.com/security/notices/USN-5623-1
- https://ubuntu.com/security/notices/USN-5624-1
- https://ubuntu.com/security/notices/USN-5630-1
- https://ubuntu.com/security/notices/USN-5633-1
- https://ubuntu.com/security/notices/USN-5634-1
- https://ubuntu.com/security/notices/USN-5635-1
- https://ubuntu.com/security/notices/USN-5639-1
- https://ubuntu.com/security/notices/USN-5640-1
- https://ubuntu.com/security/notices/USN-5644-1
- https://ubuntu.com/security/notices/USN-5647-1
- https://ubuntu.com/security/notices/USN-5648-1
- https://ubuntu.com/security/notices/USN-5650-1
- https://ubuntu.com/security/notices/USN-5652-1
- https://ubuntu.com/security/notices/USN-5654-1
- https://ubuntu.com/security/notices/USN-5655-1
- https://ubuntu.com/security/notices/USN-5660-1
- https://ubuntu.com/security/notices/USN-5683-1
comments:
  debian/carnil: |-
    Introduced by 7af4cc3fa158 ("[NETFILTER]: Add "nfnetlink_queue"
    netfilter queue handler over nfnetlink")
    For 5.18.y fixed as well in 5.18.16.
  masami: |-
    A remote attacker to cause DoS when sending nf_queue verdict with
    1-byte nfta_payload attribute. In the nfqnl_mangle(), there was an
    insufficient data length check that will result a kernel panic.
reporters:
- Domingo Dirutigliano
- Nicola Guerrera
introduced-by:
  mainline: [7af4cc3fa158ff1dda6e7451c7e6afa6b0bb85cb]
fixed-by:
  cip/4.19: [f295d365b30626f82423a923695274024016380e]
  cip/4.19-rt: [f295d365b30626f82423a923695274024016380e]
  cip/4.4: [2b429ea2f8f30c2443456d5df0b858b5bb547626]
  cip/4.4-rt: [2b429ea2f8f30c2443456d5df0b858b5bb547626]
  cip/4.4-st: [2b429ea2f8f30c2443456d5df0b858b5bb547626]
  cip/5.10: [440dccd80f627e0e11ceb0429e4cdab61857d17e]
  cip/5.10-rt: [440dccd80f627e0e11ceb0429e4cdab61857d17e]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [99a63d36cb3ed5ca3aa6fcb64cffbeaf3b0fb164]
  stable/4.14: [83636c64b796a7e44fa72f371777f803c1ef9e74]
  stable/4.19: [f295d365b30626f82423a923695274024016380e]
  stable/4.9: [3b3e2de462323d5fdeb85a3682334a4a3dd07400]
  stable/5.10: [440dccd80f627e0e11ceb0429e4cdab61857d17e]
  stable/5.15: [91c11008aab0282957b8b8ccb0707d90e74cc3b9]
  stable/5.18: [883c20911d6261fc651820b63a77327b8c020264]
  stable/5.4: [52be29e8b6455788a4d0f501bd87aa679ca3ba3c]
  ubuntu/bionic: [b25c156644ebcc92d2ff3db907bebd9bfe718953]
  ubuntu/focal: [bca42aaed1536e0e4290985f174ec7f068c0df4f]
