description: Double-free in split_2MB_gtt_entry when function intel_gvt_dma_map_guest_page
  failed
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2137979
- https://lore.kernel.org/all/20221007013708.1946061-1-zyytlz.wz@163.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3707
- https://ubuntu.com/security/notices/USN-5915-1
- https://ubuntu.com/security/notices/USN-6079-1
- https://ubuntu.com/security/notices/USN-6080-1
- https://ubuntu.com/security/notices/USN-6085-1
- https://ubuntu.com/security/notices/USN-6090-1
- https://ubuntu.com/security/notices/USN-6091-1
- https://ubuntu.com/security/notices/USN-6094-1
- https://ubuntu.com/security/notices/USN-6096-1
- https://ubuntu.com/security/notices/USN-6109-1
- https://ubuntu.com/security/notices/USN-6118-1
- https://ubuntu.com/security/notices/USN-6132-1
- https://ubuntu.com/security/notices/USN-6133-1
- https://ubuntu.com/security/notices/USN-6134-1
- https://ubuntu.com/security/notices/USN-6222-1
- https://ubuntu.com/security/notices/USN-6256-1
- https://www.cve.org/CVERecord?id=CVE-2022-3707
comments:
  masami: |-
    Intel GVT-g graphics driver was introduced in 4.8-rc1.
    Kernel 4.4 doesn't contain it.
    Commit b901b252 ("drm/i915/gvt: Add 2M huge gtt support") was
    introduced in 4.19-rc1.
  ubuntu/sbeattie: unfixed upstream as of 2022/11/28
reporters:
- Zheng Wang
introduced-by:
  mainline: [b901b252b6cf5cecc612059ccf05d974a9085c58]
fixed-by:
  cip/4.19: [c5245a6cf83ca5c4b68d643f8b31ed0eb127126e]
  cip/4.19-rt: [c5245a6cf83ca5c4b68d643f8b31ed0eb127126e]
  cip/5.10: [3d743415c6fb092167df6c23e9c7e9f6df7db625]
  cip/5.10-rt: [3d743415c6fb092167df6c23e9c7e9f6df7db625]
  cip/6.1: [1022519da69d99d455c58ca181a6c499c562c70e]
  cip/6.1-rt: [1022519da69d99d455c58ca181a6c499c562c70e]
  debian/buster-security: ['version:debian/4.19.282-1']
  mainline: [4a61648af68f5ba4884f0e3b494ee1cabc4b6620]
  stable/4.19: [c5245a6cf83ca5c4b68d643f8b31ed0eb127126e]
  stable/5.10: [3d743415c6fb092167df6c23e9c7e9f6df7db625]
  stable/5.15: [0d3d5099a50badadad6837edda00e42149b2f657]
  stable/5.4: [787ef0db014085df8691e5aeb58ab0bb081e5ff0]
  stable/6.0: [bb84f2e119accfc65d5fa6ebe31751cdc3bca9fb]
  stable/6.1: [1022519da69d99d455c58ca181a6c499c562c70e]
  ubuntu/focal: [bf3f45470f8144fe08c6279ab4966acfc5d047a8]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
