description: An invalid pipe direction in the mceusb driver cause the kernel to DOS
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2140985
- https://lore.kernel.org/all/CAB7eexLLApHJwZfMQ=X-PtRhw0BgO+5KcSMS05FNUYejJXqtSA@mail.gmail.com/
- https://lore.kernel.org/all/E1obysd-009Grw-He@www.linuxtv.org/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3903
- https://bugzilla.suse.com/show_bug.cgi?id=1205220
- https://ubuntu.com/security/notices/USN-6001-1
- https://ubuntu.com/security/notices/USN-6013-1
- https://ubuntu.com/security/notices/USN-6014-1
- https://ubuntu.com/security/notices/USN-6027-1
- https://ubuntu.com/security/notices/USN-6029-1
- https://ubuntu.com/security/notices/USN-6030-1
- https://ubuntu.com/security/notices/USN-6031-1
- https://ubuntu.com/security/notices/USN-6093-1
- https://ubuntu.com/security/notices/USN-6222-1
- https://ubuntu.com/security/notices/USN-6256-1
- https://www.cve.org/CVERecord?id=CVE-2022-3903
comments:
  debian/carnil: |-
    Apparently the fix was already done in 6.0-rc4 with 608e58a0f461
    ("media: mceusb: Use new usb_control_msg_*() routines") but
    then changes lost and redone in 6.1-rc2. The former was
    backported to various stable series. I'm not sure what happened
    here.
reporters:
- Rondreis
introduced-by:
  mainline: [66e89522aff70fb2701ba8f6845fdcd365dd2ade]
fixed-by:
  cip/5.10: [587f793c64d99d92be8ef01c4c69d885a3f2edb6]
  cip/5.10-rt: [587f793c64d99d92be8ef01c4c69d885a3f2edb6]
  mainline: [41fd1cb6151439b205ac7611883d85ae14250172]
  stable/5.10: [587f793c64d99d92be8ef01c4c69d885a3f2edb6]
  ubuntu/bionic: [e6103f4e7e58967189f7bdcd1b40277926732971, 176477dd99903ff600cd9e89228665e015f54799,
    a25252f7a46cd7969de854f6bd5254c154c4e297, 26de3f10d5ae47a79bea90c4d8e750e9c2123d31]
  ubuntu/focal: [a0724ab81703370100af16d71dec512577b0a462, fdd648aee4456a21a5b1f57e70bbc1f90ea32d3c,
    1701b7bda57a0478f89c0d35fd17abcc65ee9b33, 82048e1167d7e23b76d4180e310f04ed1ce2ea59]
fix-depends-on:
  719b8f2850d3d9b863cc5e4f08e9ef0206e45b26: |-
    Commit 41fd1cb ("media: mceusb: Use new usb_control_msg_*() routines")
    uses usb_control_msg_recv() and usb_control_msg_send() these functions
    are introduced in 5.10-rc1.
