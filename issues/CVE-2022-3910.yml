description: Improper update of reference count in io_uring leads to use-after-free
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2022-3910
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3910
- https://git.kernel.org/linus/fc7222c3a9f56271fba02aabbfbae999042f1679
- https://kernel.dance/#fc7222c3a9f56271fba02aabbfbae999042f1679
- https://github.com/torvalds/linux/commit/fc7222c3a9f56271fba02aabbfbae999042f1679
- https://ubuntu.com/security/notices/USN-5793-1
- https://ubuntu.com/security/notices/USN-5793-2
comments:
  debian/carnil: |-
    Commit fixes aa184e8671f0 ("io_uring: don't attempt to IOPOLL
    for MSG_RING requests") in 5.18.
  masami: |-
    Introduced by aa184e8 ("io_uring: don't attempt to IOPOLL for MSG_RING requests")
    which fixes 3f1d52a ("io_uring: defer msg-ring file validity check until command issue").
    Commit 3f1d52a was merged in 5.18-rc1 that is not backported to stable kernels.
    This vulnerability was fixed in v6.0-rc6.
introduced-by:
  mainline: [aa184e8671f0f911fc2fb3f68cd506e4d7838faa]
fixed-by:
  mainline: [fc7222c3a9f56271fba02aabbfbae999042f1679]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
