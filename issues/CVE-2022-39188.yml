description: unmap_mapping_range() race with munmap() on VM_PFNMAP mappings leads
  to stale TLB entry
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=2329
- https://lore.kernel.org/stable/CAG48ez3SEqOPcPCYGHVZv4iqEApujD5VtM3Re-tCKLDEFdEdbg@mail.gmail.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39188
- https://git.kernel.org/linus/b67fbebd4cf980aecbcc750e1462128bffe8ae15
- https://github.com/torvalds/linux/commit/b67fbebd4cf980aecbcc750e1462128bffe8ae15
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=b67fbebd4cf980aecbcc750e1462128bffe8ae15
- https://lore.kernel.org/stable/CAG48ez2sDEaDpiHBQJcDqPtvpCYK1JjLD=Jp8rE9ODnFW-MbRg@mail.gmail.com/
- https://lore.kernel.org/stable/20220915142519.2941949-1-jannh@google.com/
- https://lore.kernel.org/stable/20220831191348.3388208-1-jannh@google.com/T/#u
- https://ubuntu.com/security/notices/USN-5728-1
- https://ubuntu.com/security/notices/USN-5728-2
- https://ubuntu.com/security/notices/USN-5728-3
- https://ubuntu.com/security/notices/USN-5790-1
- https://ubuntu.com/security/notices/USN-5792-1
- https://ubuntu.com/security/notices/USN-5792-2
- https://ubuntu.com/security/notices/USN-5877-1
- https://ubuntu.com/security/notices/USN-5791-1
- https://ubuntu.com/security/notices/USN-5791-2
- https://ubuntu.com/security/notices/USN-5791-3
- https://ubuntu.com/security/notices/USN-5815-1
- https://ubuntu.com/security/notices/USN-6001-1
- https://ubuntu.com/security/notices/USN-6013-1
- https://ubuntu.com/security/notices/USN-6014-1
comments:
  debian/carnil: |-
    For stable series an isolated backport is needed.
    Turns out that the original backport for stable series is botched, cf.
    https://lore.kernel.org/stable/CAG48ez2sDEaDpiHBQJcDqPtvpCYK1JjLD=Jp8rE9ODnFW-MbRg@mail.gmail.com/
  masami: |-
    Patch title "mm: Fix TLB flush for not-first PFNMAP mappings in unmap_region()"
    fixes an issue when backporting upstream commit b67fbeb.
  ubuntu/rodrigo-zaiden: |-
    for 5.4 kernels, two follow up commits are needed. in
     upstream they are: b67fbebd4cf9 and b67fbebd4cf98, they were adjusted in
     ubuntu kernel to match the needs.
  ubuntu/sbeattie: for backports, see JannH's post to the stable list
reporters:
- Jann Horn
fixed-by:
  cip/4.19: [c3b1e88f14e7f442e2ddcbec94527eec84ac0ca3]
  cip/4.19-rt: [c3b1e88f14e7f442e2ddcbec94527eec84ac0ca3]
  cip/4.4: [cf29096b529b6a45b2d0c16e431ca94ef5682fda]
  cip/4.4-rt: [cf29096b529b6a45b2d0c16e431ca94ef5682fda]
  cip/4.4-st: [cf29096b529b6a45b2d0c16e431ca94ef5682fda]
  cip/5.10: [895428ee124ad70b9763259308354877b725c31d]
  cip/5.10-rt: [895428ee124ad70b9763259308354877b725c31d]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [b67fbebd4cf980aecbcc750e1462128bffe8ae15]
  stable/4.14: [b8a54a2a45feacbc96065e5d6b9a1cbee2aa1e9d]
  stable/4.19: [c3b1e88f14e7f442e2ddcbec94527eec84ac0ca3, 56fa5f3dd44a05a5eacd75ae9d00c5415046d371]
  stable/4.9: [390f33a95419f7fa1254ba6b6feeabde480732f9]
  stable/5.10: [895428ee124ad70b9763259308354877b725c31d, 891f03f688de8418f44b32b88f6b4faed5b2aa81]
  stable/5.15: [3ffb97fce282df03723995f5eed6a559d008078e]
  stable/5.4: [c9c5501e815132530d741ec9fdd22657f91656bc]
  ubuntu/bionic: [df66961e3821f7945be2c1fb3a1d0b4143b02641]
  ubuntu/focal: [f27e0b080ca2449b979964105b44de51d79e145a]
