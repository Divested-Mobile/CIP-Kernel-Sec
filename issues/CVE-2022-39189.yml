description: KVM instruction emulation doesn't clear KVM_VCPU_PREEMPTED, breaking
  guest's TLB flushing
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=2309
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39189
- https://git.kernel.org/linus/6cd88243c7e03845a450795e134b488fc2afb736
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6cd88243c7e03845a450795e134b488fc2afb736
- https://github.com/torvalds/linux/commit/6cd88243c7e03845a450795e134b488fc2afb736
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.18.17
comments:
  debian/carnil: Fixed as well in 5.18.17 for 5.18.y.
  masami: |-
    The KVM_FEATURE_PV_TLB_FLUSH feature was introduced by commit
    858a43a ("KVM: X86: use paravirtualized TLB Shootdown") was
    merged in 4.16-rc1. Therefore, 4.4, 4.9, and 4.14 are not
    affected.
reporters:
- Jann Horn
fixed-by:
  mainline: [6cd88243c7e03845a450795e134b488fc2afb736]
  stable/5.15: [92343314d34e04da0923cefd3be67521d706fa35]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.9: Not affected
