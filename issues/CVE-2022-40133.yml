description: |-
  A use-after-free(UAF) vulnerability was found in function
  'vmw_execbuf_tie_context' in drivers/gpu/vmxgfx/vmxgfx_execbuf.c in Linux
  kernel's vmwgfx driver with device file '/dev/dri/renderD128 (or Dxxx)'.
  This flaw allows a local attacker with a user account on the system to gain
  privilege, causing a denial of service(DoS).
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40133
- https://bugzilla.openanolis.cn/show_bug.cgi?id=2075
- https://bugzilla.redhat.com/show_bug.cgi?id=2133453
- https://bugzilla.suse.com/show_bug.cgi?id=1203329
- https://www.cve.org/CVERecord?id=CVE-2022-40133
comments:
  debian/bwh: |-
    Probably introduced in 4.20 by commit e8c66efbfe3a "drm/vmwgfx: Make
    user resource lookups reference-free during validation".
  debian/carnil: |-
    According to Zack Rusin fixed conceptually via a309c7194e8a
    ("drm/vmwgfx: Remove rcu locks from user resources")
  masami: |-
    drivers/gpu/vmxgfx/vmxgfx_execbuf.c not found in the mainline.
    It may be drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c instead.
    It was introduced by commit e14c02e ("drm/vmwgfx: Look up
    objects without taking a reference") in 4.20-rc1.
  ubuntu/sbeattie: |-
    drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c
    unfixed upstream as of 2023.01.10
introduced-by:
  mainline: [e14c02e6b6990e9f6ee18a214a22ac26bae1b25e]
fixed-by:
  cip/6.1: [7ac9578e45b20e3f3c0c8eb71f5417a499a7226a]
  cip/6.1-rt: [7ac9578e45b20e3f3c0c8eb71f5417a499a7226a]
  mainline: [a309c7194e8a2f8bd4539b9449917913f6c2cd50]
  stable/6.1: [7ac9578e45b20e3f3c0c8eb71f5417a499a7226a]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
