description: 'efi: capsule-loader: Fix use-after-free in efi_capsule_write'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40307
- https://git.kernel.org/linus/9cb636b5f6a8cc6d1b50809ec8f8d33ae0c84c95
- https://github.com/torvalds/linux/commit/9cb636b5f6a8cc6d1b50809ec8f8d33ae0c84c95
comments:
  debian/carnil: For 5.19.y fixed as well in 5.19.9.
  masami: |-
    Applying patch to 4.9 was failed
    (https://lore.kernel.org/stable/166265645917687@kroah.com/).
    Commit 65117f1 ("efi: Add misc char driver interface to update EFI
    firmware") was merged in 4.7-rc1.
    4.4.y-cip and linux-4.4.y-rt have this commit but 4.4.y-st doesn't.
introduced-by:
  cip/4.4: [2fe033c12fb5fba6e897bef3762981f6735cfba3]
  cip/4.4-rt: [2fe033c12fb5fba6e897bef3762981f6735cfba3]
  mainline: [65117f1aa1b2d145fd5ca376bde642794d0aae1b]
fixed-by:
  cip/4.19: [021805af5bedeafc76c117fc771c100b358ab419]
  cip/5.10: [918d9c4a4bdf5205f2fb3f64dddfb56c9a1d01d6]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [9cb636b5f6a8cc6d1b50809ec8f8d33ae0c84c95]
  stable/4.14: [233d5c4d18971feee5fc2f33f00b63d8205cfc67]
  stable/4.19: [021805af5bedeafc76c117fc771c100b358ab419]
  stable/5.10: [918d9c4a4bdf5205f2fb3f64dddfb56c9a1d01d6]
  stable/5.15: [dd291e070be0eca8807476b022bda00c891d9066]
  stable/5.19: [d46815a8f26ca6db2336106a148265239f73b0af]
  stable/5.4: [8028ff4cdbb3f20d3c1c04be33a83bab0cb94997]
ignore:
  cip/4.4-st: Not affected
