description: 'l2tp: missing lock when clearing sk_user_data can lead to NULL pointer
  dereference'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2134528
- https://lore.kernel.org/all/20220810102848.282778-1-jakub@cloudflare.com/t
- https://lore.kernel.org/all/20220815130107.149345-1-jakub@cloudflare.com/t
- https://lore.kernel.org/all/20220823101459.211986-1-jakub@cloudflare.com/t
- https://lore.kernel.org/all/20221114191619.124659-1-jakub@cloudflare.com/t
- https://lore.kernel.org/netdev/20221119130317.39158-1-jakub@cloudflare.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4129
- https://lore.kernel.org/netdev/20221121085426.21315-1-jakub@cloudflare.com/t
- https://ubuntu.com/security/notices/USN-6025-1
- https://ubuntu.com/security/notices/USN-6027-1
- https://ubuntu.com/security/notices/USN-6040-1
- https://ubuntu.com/security/notices/USN-6057-1
- https://ubuntu.com/security/notices/USN-6079-1
- https://ubuntu.com/security/notices/USN-6091-1
comments:
  masami: |-
    Introduced by commit b68777d54fac ("l2tp: Serialize access to sk_user_data with sk_callback_lock") in 6.1-rc6.
    It fixes commit 3557baa ("[L2TP]: PPP over L2TP driver core") in 2.6.23-rc1.
    Commit b68777d54fac is not backported to stable kernels.
reporters:
- Haowei Yan
introduced-by:
  mainline: [3557baabf28088f49bdf72a048fd33ab62e205b1]
fixed-by:
  cip/5.10: [e34a965f771f1977f172593c73e373036c765724, 5b209b8c99d487a1c32983981bf3552980fda591]
  cip/5.10-rt: [e34a965f771f1977f172593c73e373036c765724, 5b209b8c99d487a1c32983981bf3552980fda591]
  mainline: [b68777d54fac21fc833ec26ea1a2a84f975ab035, af295e854a4e3813ffbdef26dbb6a4d6226c3ea1]
  stable/5.10: [e34a965f771f1977f172593c73e373036c765724, 5b209b8c99d487a1c32983981bf3552980fda591]
  stable/5.15: [87d9205d9a57dfc1f39f840b32e38475c3f523f6, 22c7d45ca3d7672f0b209783726d7559a2343f21]
  stable/5.4: [7188c37f3c2527086aa46cbb37060fa73b144c65, 4fd6a6b1019e56ece1886d854a87051ffc86957f]
  ubuntu/focal: [adb1459193d58983027ca77a3d5ad44b6a639c13, 5f6cf3b381ad36634aeb01a54f8a4c7512c88e31]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/6.0: Not affected
