description: 'l2tp: missing lock when clearing sk_user_data can lead to NULL pointer
  dereference'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2134528
- https://lore.kernel.org/all/20220810102848.282778-1-jakub@cloudflare.com/t
- https://lore.kernel.org/all/20220815130107.149345-1-jakub@cloudflare.com/t
- https://lore.kernel.org/all/20220823101459.211986-1-jakub@cloudflare.com/t
- https://lore.kernel.org/all/20221114191619.124659-1-jakub@cloudflare.com/t
- https://lore.kernel.org/netdev/20221119130317.39158-1-jakub@cloudflare.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4129
- https://lore.kernel.org/netdev/20221121085426.21315-1-jakub@cloudflare.com/t
comments:
  masami: |-
    Introduced by commit b68777d54fac ("l2tp: Serialize access to sk_user_data with sk_callback_lock") in 6.1-rc6.
    It fixes commit 3557baa ("[L2TP]: PPP over L2TP driver core") in 2.6.23-rc1.
    Commit b68777d54fac is not backported to stable kernels.
introduced-by:
  mainline: [3557baabf28088f49bdf72a048fd33ab62e205b1]
fixed-by:
  mainline: [b68777d54fac21fc833ec26ea1a2a84f975ab035, af295e854a4e3813ffbdef26dbb6a4d6226c3ea1]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
  stable/5.4: Not affected
  stable/6.0: Not affected
