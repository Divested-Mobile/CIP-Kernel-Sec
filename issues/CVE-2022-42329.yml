description: 'xen/netback: don''t call kfree_skb() with interrupts disabled'
references:
- https://www.openwall.com/lists/oss-security/2022/12/06/2
- https://xenbits.xen.org/xsa/advisory-424.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42329
- https://git.kernel.org/linus/74e7e1efdad45580cc3839f2a155174cf158f9b5
- https://xenbits.xenproject.org/xsa/advisory-424.txt
comments:
  masami: |-
    Introduced by commit be81992 ("xen/netback: don't queue unlimited number of packages")
     in v5.16-rc7. This commit fixes f48da8b ("xen-netback: fix unlimited guest Rx
     internal queue and carrier flapping") in 3.18-rc3.
    Commit be81992 is not backported to 4.4 kernel because drivers/net/xen-netback/rx.c isn't present in 4.4.
    However, 4.9, 4.19, 5.4, 5.10, 5.15 are affected.
    CVE-2022-42328 and CVE-2022-42329 have same root cause also fixed by same commit.
introduced-by:
  cip/4.19: [c9f17e92917fd5786be872626a3928979ecc4c39]
  cip/4.19-rt: [c9f17e92917fd5786be872626a3928979ecc4c39]
  cip/4.4: [0928efb09178e01d3dc8e8849aa1c807436c3c37]
  cip/4.4-rt: [0928efb09178e01d3dc8e8849aa1c807436c3c37]
  cip/4.4-st: [0928efb09178e01d3dc8e8849aa1c807436c3c37]
  cip/5.10: [88f20cccbeec9a5e83621df5cc2453b5081454dc]
  mainline: [be81992f9086b230623ae3ebbc85ecee4d00a3d3]
  stable/4.14: [9bebb2eedf679b3be4acaa20efda97f32c999d74]
  stable/4.19: [c9f17e92917fd5786be872626a3928979ecc4c39]
  stable/4.9: [b4226b387436315e7f57465c15335f4f4b5b075d]
  stable/5.10: [88f20cccbeec9a5e83621df5cc2453b5081454dc]
  stable/5.15: [bd926d189210cd1d5b4e618e45898053be6b4b3b]
  stable/5.4: [0d99b3c6bd39a0a023e972d8f912fd47698bbbb8]
  ubuntu/bionic: [48f47afec273d21906db5fccbe0d41bd098802fe]
  ubuntu/focal: [31dfdff62305712a41b08b1a081e65e64ffa0809]
fixed-by:
  cip/4.19: [d3e1b6151d5d40bedabea129f5873a83b9390b62]
  cip/4.19-rt: [d3e1b6151d5d40bedabea129f5873a83b9390b62]
  cip/4.4: [1be5374a46f599423f5e891190f9f18989b079a8]
  cip/4.4-st: [1be5374a46f599423f5e891190f9f18989b079a8]
  cip/5.10: [83632fc41449c480f2d0193683ec202caaa186c9]
  debian/buster-security: ['version:debian/4.19.269-1']
  mainline: [74e7e1efdad45580cc3839f2a155174cf158f9b5]
  stable/4.14: [2b81c566ab5724976de59ad7787e204f7938ae27]
  stable/4.19: [d3e1b6151d5d40bedabea129f5873a83b9390b62]
  stable/4.9: [b41eab5790ac8ceed2b940f7acc5b3698c824644]
  stable/5.10: [83632fc41449c480f2d0193683ec202caaa186c9]
  stable/5.15: [5d0fa6fc8899fe842329c0109f8ddd01144b1ed8]
  stable/5.4: [50e1ab7e638f1009d953658af8f6b2d7813a7883]
  stable/6.0: [3fb02db125bbcf8163e9e30d2824b4adf13f06cb]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
