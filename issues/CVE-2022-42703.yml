description: anon_vma UAF through bogus merge of VMAs caused by double-reuse of leaf
  anon_vma because of ->degree misinterpretation
references:
- https://bugs.chromium.org/p/project-zero/issues/detail?id=2351
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-42703
- https://git.kernel.org/linus/2555283eb40df89945557273121e9393ef9b542b
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=2555283eb40df89945557273121e9393ef9b542b
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.7
- https://github.com/torvalds/linux/commit/2555283eb40df89945557273121e9393ef9b542b
- https://ubuntu.com/security/notices/USN-5728-1
- https://ubuntu.com/security/notices/USN-5728-2
- https://ubuntu.com/security/notices/USN-5728-3
- https://ubuntu.com/security/notices/USN-5755-1
- https://ubuntu.com/security/notices/USN-5756-1
- https://ubuntu.com/security/notices/USN-5757-1
- https://ubuntu.com/security/notices/USN-5757-2
- https://ubuntu.com/security/notices/USN-5758-1
- https://ubuntu.com/security/notices/USN-5756-2
- https://ubuntu.com/security/notices/USN-5755-2
- https://googleprojectzero.blogspot.com/2022/12/exploiting-CVE-2022-42703-bringing-back-the-stack-attack.html
- https://ubuntu.com/security/notices/USN-5773-1
- https://ubuntu.com/security/notices/USN-5756-3
- https://ubuntu.com/security/notices/USN-5774-1
- https://ubuntu.com/security/notices/USN-5779-1
- https://ubuntu.com/security/notices/USN-5789-1
- https://ubuntu.com/security/notices/USN-5916-1
- https://www.cve.org/CVERecord?id=CVE-2022-42703
comments:
  masami: CIP's 4.4 kernels can apply c24ca0f17 without modification.
reporters:
- Jann Horn
introduced-by:
  aosp/3.18: [3f1618006bca4f51fd1f6766cab88bb499af06b7]
  mainline: [7a3ef208e662f4b63d43a23f61a64a129c525bbc]
  stable/3.18: [3f1618006bca4f51fd1f6766cab88bb499af06b7]
  stable/3.4: [0b4f2ae74a52418cd880d9249e65fc935f02e89a]
fixed-by:
  cip/4.19: [6dbfc25d68d922736381988d64156a649ccf7bf1]
  cip/4.19-rt: [6dbfc25d68d922736381988d64156a649ccf7bf1]
  cip/4.4: [63c0af50bed3549ec7642a40ba6599c769871099]
  cip/4.4-rt: [63c0af50bed3549ec7642a40ba6599c769871099]
  cip/4.4-st: [63c0af50bed3549ec7642a40ba6599c769871099]
  cip/5.10: [98f401d36396134c0c86e9e3bd00b6b6b028b521]
  cip/5.10-rt: [98f401d36396134c0c86e9e3bd00b6b6b028b521]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [2555283eb40df89945557273121e9393ef9b542b]
  openela/4.14: [978a70601bdc4c32de4003d3beef4dfa23fff1e0]
  stable/4.14: [978a70601bdc4c32de4003d3beef4dfa23fff1e0]
  stable/4.19: [6dbfc25d68d922736381988d64156a649ccf7bf1]
  stable/4.9: [c24ca0f172905d593ad8ab276b0992bb74353a8d]
  stable/5.10: [98f401d36396134c0c86e9e3bd00b6b6b028b521]
  stable/5.15: [c18a209b56e37b2a60414f714bd70b084ef25835]
  stable/5.19: [7877eaa1131147b4d6a063962f3aac0ab1b8ea1c]
  stable/5.4: [2fe3eee48899a890310177d54537d5b8e255eb31]
  ubuntu/bionic: [e163f1e74c9d27181d3a5ee1c179fb7ccf77bcb3]
  ubuntu/focal: [4fc642c259785d128e7672d9213afde75b0e55c9]
