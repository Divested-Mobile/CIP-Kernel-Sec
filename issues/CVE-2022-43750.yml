description: 'usb: mon: make mmapped memory read only'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-43750
- https://bugzilla.suse.com/show_bug.cgi?id=1204653
- https://syzkaller.appspot.com/bug?id=2eb1f35d6525fa4a74d75b4244971e5b1411c95a
- https://git.kernel.org/linus/a659daf63d16aa883be42f3f34ff84235c302198
- https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.0.1
- https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=a659daf63d16aa883be42f3f34ff84235c302198
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.19.15
- https://github.com/torvalds/linux/commit/a659daf63d16aa883be42f3f34ff84235c302198
- https://ubuntu.com/security/notices/USN-5758-1
comments:
  masami: "When user space application writing data via mmap(2) to \n/dev/usbmon,\
    \ it can corrupt usb monitor's internal memory. \nThat result will be system crash,\
    \ use-after-free, and etc.\nCommit a659daf (\"usb: mon: make mmapped memory read\
    \ only\")\ndisallows /dev/usbmon devices with VM_WRITE. Therefore, it\nwill break\
    \ an existing user application if it uses mmap(2)\nwith VM_WRITE flag. This issue\
    \ was introduced by\ncommit 6f23ee1 (\"USB: add binary API to usbmon\") in\n2.6.21-rc1\
    \ so 4.4 will be affected."
reporters:
- Syzbot
introduced-by:
  mainline: [6f23ee1fefdc1f80bd8a3ab04a1c41ab2dec14c9]
fixed-by:
  cip/4.19: [bf7e2cee3899ede4c7c6548f28159ee3775fb67f]
  cip/4.19-rt: [bf7e2cee3899ede4c7c6548f28159ee3775fb67f]
  cip/5.10: [1b257f97fec43d7a8a4c9ada8538d14421861b0a]
  mainline: [a659daf63d16aa883be42f3f34ff84235c302198]
  stable/4.14: [b29f76fcf2db6615b416d98e28c7d81eff4c89a2]
  stable/4.19: [bf7e2cee3899ede4c7c6548f28159ee3775fb67f]
  stable/4.9: [1b5ad3786a2f2cdbfed34071aa467f80e4903a0b]
  stable/5.10: [1b257f97fec43d7a8a4c9ada8538d14421861b0a]
  stable/5.15: [5ff80339cdc3143b89eee2ad91ae44b4dbf65ad1]
  stable/5.4: [21446ad9cb9844b90d7d8e73d8fff03160e51ebc]
  stable/6.0: [08e2c70e549b77f5f3af9c76da00779d5756f997]
  ubuntu/bionic: [3283f9131bcfa0756a69a6fa539e2226cc664f24]
  ubuntu/focal: [4b8e48c21a4c53f232513dbb13b0b4f68b5fb9ba]
