description: Linux kernel stack-based buffer overflow in __do_proc_dointvec
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4378
- https://www.openwall.com/lists/oss-security/2022/12/09/1
- https://marc.info/?l=oss-security&m=167060228526317
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=bce9332220bd677d83b19d21502776ad555a0e73
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=e6cfaf34be9fcd1a8285a294e18986bfc41a409c
- https://ubuntu.com/security/notices/USN-5799-1
- https://ubuntu.com/security/notices/USN-5803-1
- https://ubuntu.com/security/notices/USN-5809-1
- https://ubuntu.com/security/notices/USN-5814-1
- https://ubuntu.com/security/notices/USN-5831-1
- https://ubuntu.com/security/notices/USN-5832-1
- https://ubuntu.com/security/notices/USN-5860-1
- https://ubuntu.com/security/notices/USN-5877-1
- https://ubuntu.com/security/notices/USN-5879-1
- https://ubuntu.com/security/notices/USN-5883-1
- https://ubuntu.com/security/notices/USN-5917-1
- https://ubuntu.com/security/notices/USN-5919-1
- https://ubuntu.com/security/notices/USN-5920-1
- https://www.cve.org/CVERecord?id=CVE-2022-4378
comments:
  masami: This bug was affected all stable kernels. It seems as if 4.4 is affected
    too.
reporters:
- Kyle Zeng
fixed-by:
  cip/4.19: [a9c309fb49ffe3203f948973fd27b8f64f7f30c4, fe84d7f0cb66d150de094fba461f0cb5d5b12c85]
  cip/4.19-rt: [a9c309fb49ffe3203f948973fd27b8f64f7f30c4, fe84d7f0cb66d150de094fba461f0cb5d5b12c85]
  cip/4.4: [6c728f23eddeee38a32a48270966faf68df23bcb]
  cip/4.4-rt: [6c728f23eddeee38a32a48270966faf68df23bcb]
  cip/4.4-st: [6c728f23eddeee38a32a48270966faf68df23bcb]
  cip/5.10: [9ba389863ac63032d4b6ffad2c90a62cd78082ee, 4aa32aaef6c1b5e39ae2508ec596bd7b67871043]
  cip/5.10-rt: [9ba389863ac63032d4b6ffad2c90a62cd78082ee, 4aa32aaef6c1b5e39ae2508ec596bd7b67871043]
  debian/buster-security: ['version:debian/4.19.269-1']
  mainline: [bce9332220bd677d83b19d21502776ad555a0e73, e6cfaf34be9fcd1a8285a294e18986bfc41a409c]
  stable/4.14: [dad6ca557f640b032ed5de9c0136e5628fba1253, 4f4ff21bbcaeda6c061a25c8c2dfac3f27a1fb34]
  stable/4.19: [a9c309fb49ffe3203f948973fd27b8f64f7f30c4, fe84d7f0cb66d150de094fba461f0cb5d5b12c85]
  stable/4.9: [6e3644aca0bcb572e461ace04d7045beeebb4aaa, 32646215df00b5dbc79bbeb4df69189fc2a0b234]
  stable/5.10: [9ba389863ac63032d4b6ffad2c90a62cd78082ee, 4aa32aaef6c1b5e39ae2508ec596bd7b67871043]
  stable/5.15: [48642f94311b0cf9667aa6833f9f5e3a87d2a0ce, 3eb9213f66127fbccd56dd4d36c4b47f3302dbf7]
  stable/5.4: [0390da0565ade35f9c2bedcb57ab64c61b40045b, dd3124a051a1c0397e82bc240f4db9987ef52b3d]
  stable/6.0: [fdf2c95f28bf197bfab421d21e8c697d4f149ea1, e04220518841708f68e7746232e3e54daef464a3]
  ubuntu/bionic: [96347192165a5580d97e7cdaa7c43122c7dd0dfb, 8968bf1588b001419d419889755a3ebd8e7971d9]
  ubuntu/focal: ['version:5.4.0-9.12']
