description: 'NFSD: fix use-after-free in __nfs42_ssc_open()'
references:
- https://www.openwall.com/lists/oss-security/2022/12/14/3
- https://lore.kernel.org/all/1670885411-10060-1-git-send-email-dai.ngo@oracle.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4379
- https://ubuntu.com/security/notices/USN-5911-1
- https://ubuntu.com/security/notices/USN-5912-1
- https://ubuntu.com/security/notices/USN-5913-1
- https://ubuntu.com/security/notices/USN-5914-1
- https://ubuntu.com/security/notices/USN-5915-1
- https://ubuntu.com/security/notices/USN-5929-1
- https://ubuntu.com/security/notices/USN-5935-1
- https://ubuntu.com/security/notices/USN-5938-1
- https://ubuntu.com/security/notices/USN-5941-1
- https://ubuntu.com/security/notices/USN-5950-1
- https://ubuntu.com/security/notices/USN-5962-1
- https://www.cve.org/CVERecord?id=CVE-2022-4379
comments:
  debian/bwh: |-
    The vulnerable code is conditional on CONFIG_NFSD_V4_2_INTER_SSC
    which we don't yet enable.
  debian/carnil: Fixed in 6.1.3 as well for 6.1.y.
  masami: "Patch removes calling nfsd4_interssc_disconnect() in nfs42_ssc_open() and\
    \ nfsd4_copy(). \nIt also removes nfsd4_interssc_disconnect(). the nfsd4_interssc_disconnect()\
    \ was add by \ncommit ce0887ac (\"NFSD add nfs4 inter ssc to nfsd4_copy\") in\
    \ 5.6-rc1. \nSo, it looks less than 5.6 kernels aren't affected by this issue."
  ubuntu/cascardo: |-
    prioritizing as Medium as nfsd parameter inter_copy_offload_enable
      is off by default.
reporters:
- Xingyuan Mo
- Gengjia Chen
introduced-by:
  mainline: [ce0887ac96d35c7105090e166bb0807dc0a0e838]
fixed-by:
  cip/5.10: [01e4c9c03de8a9f8839cb7342bc4bccf9104efe5]
  cip/5.10-rt: [01e4c9c03de8a9f8839cb7342bc4bccf9104efe5]
  cip/6.1: [650b69b17cfd79f51476d93c2c63bfb73280a77a]
  cip/6.1-rt: [650b69b17cfd79f51476d93c2c63bfb73280a77a]
  mainline: [75333d48f92256a0dec91dbf07835e804fc411c0]
  stable/5.10: [01e4c9c03de8a9f8839cb7342bc4bccf9104efe5]
  stable/5.15: [ec5b7814353532243e8a9147d232a32549174909]
  stable/6.1: [650b69b17cfd79f51476d93c2c63bfb73280a77a]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/4.9: Not affected
  stable/5.4: Not affected
