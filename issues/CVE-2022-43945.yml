description: A buffer overflow bug was found in nfsd
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-43945
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f90497a16e434c2211c66e3de8e77b17868382b8
comments:
  debian/bwh: |-
    The affected code was changed in 5.12, 5.13, and 5.15.
    It's not yet clear to me whether earlier versions are also
    affected.
  debian/carnil: Fixed in 5.19.17 for 5.19.y and in 6.0.3 for 6.0.y.
  masami: |-
    nfsd3_proc_read() and nfsd_proc_read() changed to set argp->count value adding extra min_t() macro.
      nfsd_init_dirlist_pages() and nfsd3_init_dirlist_pages() changed process of setting buf->buflen value.
      However, 4.4, 4.19, 5.10 uses different way to set these values. So, even if these kernels are vulnerable, it needs different way to fix.
fixed-by:
  mainline: [00b4492686e0497fdb924a9d4c8f6f99377e176c, 640f87c190e0d1b2a0fcb2ecf6d2cd53b1c41991,
    401bc1f90874280a80b93f23be33a0e7e2d1f912, fa6be9cc6e80ec79892ddf08a8c10cabab9baf38]
  stable/5.15: [dc7f225090c29a5f3b9419b1af32846a201555e7, 071a076fd1b763aa6fe478efa047e0a549ba9c22,
    2be9331ca6061bc6ea32247266f45b8b21030244, 75d9de25a6f833dd0701ca546ac926cabff2b5af]
  stable/6.0: [f59c74df82f6ac9d2ea4e01aa3ae7c6c4481652d, 279274e31270c28b86feffe5e166d4088f22317b,
    1868332032eccbab8c1878a0d918193058c0a905, 309f29361b6bfae96936317376f1114568c5de19]
