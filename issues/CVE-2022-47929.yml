description: |-
  In the Linux kernel before 6.1.6, a NULL pointer dereference bug in the
  traffic control subsystem allows an unprivileged user to trigger a denial
  of service (system crash) via a crafted traffic control configuration that
  is set up with "tc qdisc" and "tc class" commands. This affects qdisc_graft
  in net/sched/sch_api.c.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47929
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=96398560f26aa07e8f2969d73c8197e6a6d10407
- https://tldp.org/HOWTO/Traffic-Control-HOWTO/components.html
- https://www.spinics.net/lists/netdev/msg555705.html
- https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.1.6
- https://ubuntu.com/security/notices/USN-5915-1
- https://ubuntu.com/security/notices/USN-5917-1
- https://ubuntu.com/security/notices/USN-5924-1
- https://ubuntu.com/security/notices/USN-5927-1
- https://ubuntu.com/security/notices/USN-5934-1
- https://ubuntu.com/security/notices/USN-5939-1
- https://ubuntu.com/security/notices/USN-5940-1
- https://ubuntu.com/security/notices/USN-5951-1
- https://ubuntu.com/security/notices/USN-5975-1
- https://ubuntu.com/security/notices/USN-5981-1
- https://ubuntu.com/security/notices/USN-5984-1
- https://ubuntu.com/security/notices/USN-5991-1
comments:
  masami: |-
    Introduced by commit d66d6c3 ("net: sched: register noqueue qdisc")
    in 4.3-rc1. This fix uses NL_SET_ERR_MSG macro to create error message
    which was merged in 4.12-rc1. Kernel 4.4 doesn't have this macro.
introduced-by:
  mainline: [d66d6c3152e8d5a6db42a56bf7ae1c6cae87ba48]
fixed-by:
  cip/4.19: [0195d5ad539382a83e1bfaab51b93b8685f0b7c7]
  cip/4.19-rt: [0195d5ad539382a83e1bfaab51b93b8685f0b7c7]
  cip/4.4: [e6f2bae11168b7fd376f3e76908fedec009f84f5]
  cip/4.4-rt: [e6f2bae11168b7fd376f3e76908fedec009f84f5]
  cip/4.4-st: [e6f2bae11168b7fd376f3e76908fedec009f84f5]
  cip/5.10: [9f7bc28a6b8afc2274e25650511555e93f45470f]
  cip/5.10-rt: [9f7bc28a6b8afc2274e25650511555e93f45470f]
  mainline: [96398560f26aa07e8f2969d73c8197e6a6d10407]
  stable/4.14: [4574e32cbf652d7efcaa6076558752f770b01757]
  stable/4.19: [0195d5ad539382a83e1bfaab51b93b8685f0b7c7]
  stable/5.10: [9f7bc28a6b8afc2274e25650511555e93f45470f]
  stable/5.15: [04941c1d5bb59d64165e09813de2947bdf6f4f28]
  stable/5.4: [9b83ec63d0de7b1f379daa1571e128bc7b9570f8]
  stable/6.1: [e8988e878af693ac13b0fa80ba2e72d22d68f2dd]
  ubuntu/bionic: [f495857037dfe6b08ec97d60b85f02297182c1c2]
  ubuntu/focal: [05c4e9fa64cb05db1f4a87498678c0dcf2f543fa]
