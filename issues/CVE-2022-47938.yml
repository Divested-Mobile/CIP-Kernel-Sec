description: |-
  This vulnerability allows remote attackers to create a
  denial-of-service condition on affected installations of Linux
  Kernel. Authentication is required to exploit this
  vulnerability.
  .
  The specific flaw exists within the handling of
  SMB2_TREE_CONNECT commands. The issue results from the lack of
  proper validation of user-supplied data, which can result in a
  read past the end of an allocated buffer. An attacker can
  leverage this vulnerability to create a denial-of-service
  condition on the system.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47938
- https://www.zerodayinitiative.com/advisories/ZDI-22-1689/
- https://www.openwall.com/lists/oss-security/2022/12/23/10
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-17818/
- https://www.cve.org/CVERecord?id=CVE-2022-47938
comments:
  masami: 'Introduced by commit e2f3448 ("cifsd: add server-side procedures for SMB3")
    in 5.15-rc1.'
  ubuntu/sbeattie: |-
    needs ksmbd-tools installed to enable the service, which is
      not installed by default.
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [824d4f64c20093275f72fc8101394d75ff6a249e]
  stable/5.15: [577619605556a90e64abc759ca3ad9d86bf51176]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
