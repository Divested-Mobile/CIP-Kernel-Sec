description: |-
  This vulnerability allows remote attackers to execute arbitrary code on
  affected installations of Linux Kernel. Authentication is not required
  to exploit this vulnerability, but only systems with ksmbd enabled are
  vulnerable.
  .
  The specific flaw exists within the processing of SMB2_TREE_DISCONNECT
  commands. The issue results from the lack of validating the existence
  of an object prior to performing operations on the object. An attacker
  can leverage this vulnerability to execute code in the context of the
  kernel.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47939
- https://www.zerodayinitiative.com/advisories/ZDI-22-1690/
- https://www.openwall.com/lists/oss-security/2022/12/23/10
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-17816
- https://www.cve.org/CVERecord?id=CVE-2022-47939
comments:
  masami: 'Introduced by commit e2f3448 ("cifsd: add server-side procedures for SMB3")
    in 5.15-rc1.'
  ubuntu/sbeattie: |-
    needs ksmbd-tools installed to enable the service, which is
      not installed by default.
reporters:
- Arnaud Gatignol
- Quentin Minster
- Florent Saudel
- Guillaume Teissier
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [cf6531d98190fa2cf92a6d8bbc8af0a4740a223c]
  stable/5.15: [a54c509c32adba9d136f2b9d6a075e8cae1b6d27]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
