description: |-
  This vulnerability allows remote attackers to disclose sensitive
  information on affected installations of Linux Kernel. Authentication
  is required to exploit this vulnerability.
  .
  The specific flaw exists within the handling of SMB2_WRITE commands.
  The issue results from the lack of proper validation of user-supplied
  data, which can result in a read past the end of an allocated buffer.
  An attacker can leverage this in conjunction with other vulnerabilities
  to execute arbitrary code in the context of the kernel.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47940
- https://www.zerodayinitiative.com/advisories/ZDI-22-1691/
- https://www.openwall.com/lists/oss-security/2022/12/23/10
- https://ubuntu.com/security/notices/USN-5851-1
- https://ubuntu.com/security/notices/USN-5860-1
comments:
  masami: 'Introduced by commit e2f3448 ("cifsd: add server-side procedures for SMB3")
    in 5.15-rc1.'
  ubuntu/sbeattie: |-
    to be vulnerable, needs ksmbd-tools installed to enable
      the ksmbd service, which is not installed by default.
reporters:
- Arnaud Gatignol
- Quentin Minster
- Florent Saudel
- Guillaume Teissier
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [158a66b245739e15858de42c0ba60fcf3de9b8e6]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
