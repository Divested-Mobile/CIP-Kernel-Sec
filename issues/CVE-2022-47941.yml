description: |-
  This vulnerability allows remote attackers to create a
  denial-of-service condition on affected installations of Linux Kernel.
  Authentication is not required to exploit this vulnerability.
  .
  The specific flaw exists within the handling of SMB2_NEGOTIATE
  commands. The issue results from the lack of memory release after its
  effective lifetime. An attacker can leverage this vulnerability to
  create a denial-of-service condition on the system.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47941
- https://www.zerodayinitiative.com/advisories/ZDI-22-1687/
- https://www.openwall.com/lists/oss-security/2022/12/23/10
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-17815/
- https://www.cve.org/CVERecord?id=CVE-2022-47941
comments:
  masami: 'Introduced by commit e2f3448 ("cifsd: add server-side procedures for SMB3")
    in 5.15-rc1.'
  ubuntu/sbeattie: |-
    needs ksmbd-tools installed to enable the service, which is
      not installed by default.
reporters:
- Arnaud Gatignol
- Quentin Minster
- Florent Saudel
- Guillaume Teissier
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [aa7253c2393f6dcd6a1468b0792f6da76edad917]
  stable/5.15: [dd4e4c811898410e6a3ae3b63207b7c542860907]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
