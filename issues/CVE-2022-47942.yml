description: |-
  This vulnerability allows remote attackers to execute arbitrary code on
  affected installations of Linux Kernel. Authentication is required to
  exploit this vulnerability.
  .
  The specific flaw exists within the handling of file attributes. The
  issue results from the lack of proper validation of the length of
  user-supplied data prior to copying it to a heap-based buffer. An
  attacker can leverage this vulnerability to execute code in the context
  of the kernel.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47942
- https://www.zerodayinitiative.com/advisories/ZDI-22-1688/
- https://www.openwall.com/lists/oss-security/2022/12/23/10
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-17771/
- https://www.cve.org/CVERecord?id=CVE-2022-47942
comments:
  masami: 'Introduced by commit e2f3448 ("cifsd: add server-side procedures for SMB3")
    in 5.15-rc1.'
  ubuntu/sbeattie: |-
    needs ksmbd-tools installed to enable the service, which is
       not installed by default.
reporters:
- Arnaud Gatignol
- Quentin Minster
- Florent Saudel
- Guillaume Teissier
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [8f0541186e9ad1b62accc9519cc2b7a7240272a7]
  stable/5.15: [cb69d4d6f709f87c94afa28ae64c501576692171]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
