description: |-
  This vulnerability allows remote attackers to disclose sensitive
  information on affected installations of Linux Kernel. Authentication
  is required to exploit this vulnerability.
  .
  The specific flaw exists within the handling of SMB2_WRITE commands.
  The issue results from the lack of proper validation of user-supplied
  data, which can result in a read past the end of an allocated buffer.
  An attacker can leverage this in conjunction with other vulnerabilities
  to execute arbitrary code in the context of the kernel.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-47943
- https://www.openwall.com/lists/oss-security/2022/12/23/1
- https://www.zerodayinitiative.com/advisories/ZDI-22-1691/
- https://www.cve.org/CVERecord?id=CVE-2022-47943
comments:
  masami: 'Introduced by commit e2f3448 ("cifsd: add server-side procedures for SMB3")
    in 5.15-rc1.'
  ubuntu/sbeattie: |-
    to be vulnerable, need ksmbd-tools installed to enable
      the ksmbd service, which is not installed by default.
reporters:
- Arnaud Gatignol
- Quentin Minster
- Florent Saudel
- Guillaume Teissier
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [ac60778b87e45576d7bfdbd6f53df902654e6f09]
  stable/5.15: [c76b216753c9eb2950a091037c9976f389e73529]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
