description: 'netfilter: nf_tables: fix nft_counters_enabled underflow at nf_tables_addchain()'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48643
- https://git.kernel.org/stable/c/710e3f526bd23a0d33435dedc52c3144de284378
- https://git.kernel.org/stable/c/91aa52652f4b37089aff3cb53e83049d826fef6d
- https://git.kernel.org/stable/c/8bcad2a931313aeba076b76922d5813ef97d0a91
- https://git.kernel.org/stable/c/921ebde3c0d22c8cba74ce8eb3cc4626abff1ccd
- https://lore.kernel.org/linux-cve-announce/2024042856-CVE-2022-48643-7d4b@gregkh/
- https://git.kernel.org/linus/921ebde3c0d22c8cba74ce8eb3cc4626abff1ccd
comments:
  cip/masami: "This bug was introduced by commit 43eb8949 (\"netfilter: nf_tables:\
    \ do not \nleave chain stats enabled on error\") in Fixed in 6.0-rc3. Fixed in\
    \ 6.0-rc7."
  debian/carnil: |-
    Introduced in 43eb8949cfdffa76 ("netfilter: nf_tables: do not leave chain stats
    enabled on error"). Vulnerable versions: 5.10.140 5.15.64 5.19.6 6.0-rc3.
introduced-by:
  cip/5.10: [c907dfe4eaca9665694a0340de1458a093abe354]
  cip/5.10-rt: [c907dfe4eaca9665694a0340de1458a093abe354]
  mainline: [43eb8949cfdffa764b92bc6c54b87cbe5b0003fe]
  stable/5.10: [c907dfe4eaca9665694a0340de1458a093abe354]
  stable/5.15: [6d7ddee503951641f3ec6f0e3269446970bbcdab]
fixed-by:
  cip/5.10: [710e3f526bd23a0d33435dedc52c3144de284378]
  cip/5.10-rt: [710e3f526bd23a0d33435dedc52c3144de284378]
  mainline: [921ebde3c0d22c8cba74ce8eb3cc4626abff1ccd]
  stable/5.10: [710e3f526bd23a0d33435dedc52c3144de284378]
  stable/5.15: [91aa52652f4b37089aff3cb53e83049d826fef6d]
