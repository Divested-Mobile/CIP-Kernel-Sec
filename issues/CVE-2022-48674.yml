description: 'erofs: fix pcluster use-after-free on UP platforms'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48674
- https://git.kernel.org/stable/c/8ddd001cef5e82d19192e6861068463ecca5f556
- https://git.kernel.org/stable/c/94c34faaafe7b55adc2d8d881db195b646959b9e
- https://git.kernel.org/stable/c/2f44013e39984c127c6efedf70e6b5f4e9dcf315
- https://lore.kernel.org/linux-cve-announce/2024050318-CVE-2022-48674-b876@gregkh/
- https://git.kernel.org/linus/2f44013e39984c127c6efedf70e6b5f4e9dcf315
- https://ubuntu.com/security/notices/USN-6951-1
- https://ubuntu.com/security/notices/USN-6953-1
- https://ubuntu.com/security/notices/USN-6951-2
- https://ubuntu.com/security/notices/USN-6951-3
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 73f5c66 ("staging: erofs: fix `erofs_workgroup_{try_to_freeze, unfreeze}'") in v5.0-rc1.
    Fixed in v6.0-rc5.
  debian/carnil: |-
    Introduced in 73f5c66df3e2 ("staging: erofs: fix
    `erofs_workgroup_{try_to_freeze, unfreeze}'"). Vulnerable versions: 4.19.26
    4.20.13 5.0-rc1.
introduced-by:
  cip/4.19: [08ec9e6892cc792d7f8fe4d13bd8a0e91fb23488]
  cip/4.19-rt: [08ec9e6892cc792d7f8fe4d13bd8a0e91fb23488]
  mainline: [73f5c66df3e26ab750cefcb9a3e08c71c9f79cad]
  stable/4.19: [08ec9e6892cc792d7f8fe4d13bd8a0e91fb23488]
fixed-by:
  mainline: [2f44013e39984c127c6efedf70e6b5f4e9dcf315]
  stable/5.15: [8ddd001cef5e82d19192e6861068463ecca5f556]
  ubuntu/focal: [a52a5da08bb308b4bcecbfd7f0c4ec125b142a5b]
