description: 'nvme-tcp: fix UAF when detecting digest errors'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48686
- https://git.kernel.org/stable/c/19816a0214684f70b49b25075ff8c402fdd611d3
- https://git.kernel.org/stable/c/5914fa32ef1b7766fea933f9eed94ac5c00aa7ff
- https://git.kernel.org/stable/c/13c80a6c112467bab5e44d090767930555fc17a5
- https://git.kernel.org/stable/c/c3eb461aa56e6fa94fb80442ba2586bd223a8886
- https://git.kernel.org/stable/c/160f3549a907a50e51a8518678ba2dcf2541abea
- https://lore.kernel.org/linux-cve-announce/2024050342-CVE-2022-48686-5e8e@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 3f2304f ("nvme-tcp: add NVMe over TCP host driver") in v5.0-rc1.
    Fixed in v6.0-rc5.
  debian/carnil: |-
    Introduced in 3f2304f8c6d6 ("nvme-tcp: add NVMe over TCP host driver").
    Vulnerable versions: 5.0-rc1.
introduced-by:
  mainline: [3f2304f8c6d6ed97849057bd16fee99e434ca796]
fixed-by:
  cip/5.10: [5914fa32ef1b7766fea933f9eed94ac5c00aa7ff]
  cip/5.10-rt: [5914fa32ef1b7766fea933f9eed94ac5c00aa7ff]
  mainline: [160f3549a907a50e51a8518678ba2dcf2541abea]
  stable/5.10: [5914fa32ef1b7766fea933f9eed94ac5c00aa7ff]
  stable/5.15: [13c80a6c112467bab5e44d090767930555fc17a5]
  stable/5.4: [19816a0214684f70b49b25075ff8c402fdd611d3]
  ubuntu/focal: [30596d4ce78ad96206d93d1cc511073b56efa89e]
