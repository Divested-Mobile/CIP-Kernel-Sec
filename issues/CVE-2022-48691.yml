description: 'netfilter: nf_tables: clean up hook list when offload flags check fails'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48691
- https://git.kernel.org/stable/c/910891a2a44cdc49efcc4fe7459c1085ba00d0f4
- https://git.kernel.org/stable/c/1ce55ec5cb7c573c983dffbe290b8d17caf1f157
- https://git.kernel.org/stable/c/94ed8eeb8d9aeb00e4f4e19b83a2e28b6442fbc5
- https://git.kernel.org/stable/c/77972a36ecc4db7fc7c68f0e80714263c5f03f65
- https://lore.kernel.org/linux-cve-announce/2024050346-CVE-2022-48691-5f16@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit d54725c ("netfilter: nf_tables: support for multiple devices per netdev hook") in v5.5-rc1.
    Fixed in v6.0-rc5.
  debian/carnil: |-
    Introduced in d54725cd11a5 ("netfilter: nf_tables: support for multiple devices
    per netdev hook"). Vulnerable versions: 5.5-rc1.
introduced-by:
  mainline: [d54725cd11a57c30f650260cfb0a92c268bdc3e0]
fixed-by:
  cip/5.10: [910891a2a44cdc49efcc4fe7459c1085ba00d0f4]
  cip/5.10-rt: [910891a2a44cdc49efcc4fe7459c1085ba00d0f4]
  mainline: [77972a36ecc4db7fc7c68f0e80714263c5f03f65]
  stable/5.10: [910891a2a44cdc49efcc4fe7459c1085ba00d0f4]
  stable/5.15: [1ce55ec5cb7c573c983dffbe290b8d17caf1f157]
  ubuntu/focal: ['version:5.4.0-9.12']
