description: 'bpf: Use VM_MAP instead of VM_ALLOC for ringbuf'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48714
- https://git.kernel.org/linus/b293dcc473d22a62dc6d78de2b15e4f49515db56
- https://git.kernel.org/stable/c/6304a613a97d6dcd49b93fbad31e9f39d1e138d6
- https://git.kernel.org/stable/c/5e457aeab52a5947619e1f18047f4d2f3212b3eb
- https://git.kernel.org/stable/c/d578933f6226d5419af9306746efa1c693cbaf9c
- https://git.kernel.org/stable/c/b293dcc473d22a62dc6d78de2b15e4f49515db56
- https://lore.kernel.org/linux-cve-announce/2024062054-CVE-2022-48714-726f@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 457f443 ("bpf: Implement BPF ring buffer and verifier support for it") in v5.8-rc1.
    Fixed in v5.17-rc3.
  debian/carnil: |-
    Introduced in 457f44363a88 ("bpf: Implement BPF ring buffer and verifier
    support for it"). Vulnerable versions: 5.8-rc1.
introduced-by:
  mainline: [457f44363a8894135c85b7a9afd2bd8196db24ab]
fixed-by:
  cip/5.10: [6304a613a97d6dcd49b93fbad31e9f39d1e138d6]
  cip/5.10-rt: [6304a613a97d6dcd49b93fbad31e9f39d1e138d6]
  mainline: [b293dcc473d22a62dc6d78de2b15e4f49515db56]
  stable/5.10: [6304a613a97d6dcd49b93fbad31e9f39d1e138d6]
  stable/5.15: [5e457aeab52a5947619e1f18047f4d2f3212b3eb]
  ubuntu/focal: ['version:5.4.0-9.12']
