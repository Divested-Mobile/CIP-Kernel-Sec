description: 'net/smc: Forward wakeup to smc socket waitqueue after fallback'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48721
- https://git.kernel.org/linus/341adeec9adad0874f29a0a1af35638207352a39
- https://git.kernel.org/stable/c/0ef6049f664941bc0f75828b3a61877635048b27
- https://git.kernel.org/stable/c/504078fbe9dd570d685361b57784a6050bc40aaa
- https://git.kernel.org/stable/c/341adeec9adad0874f29a0a1af35638207352a39
- https://lore.kernel.org/linux-cve-announce/2024062056-CVE-2022-48721-3959@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 2153bd1 ("net/smc: Transfer remaining wait queue entries during fallback") in v5.16-rc2.
    Fixed in v5.17-rc3.
  debian/carnil: |-
    Introduced in 2153bd1e3d3d ("net/smc: Transfer remaining wait queue entries
    during fallback"). Vulnerable versions: 5.4.164 5.10.84 5.15.7 5.16-rc2.
introduced-by:
  cip/5.10: [ff6eeb627898c179aac421af5d6515d3f50b84df]
  cip/5.10-rt: [ff6eeb627898c179aac421af5d6515d3f50b84df]
  mainline: [2153bd1e3d3dbf6a3403572084ef6ed31c53c5f0]
  stable/5.10: [ff6eeb627898c179aac421af5d6515d3f50b84df]
  stable/5.15: [fb92e025baa73e99250b79ab64f4e088d2888993]
  stable/5.4: [d6e981ec9491be5ec46d838b1151e7edefe607f5]
  ubuntu/focal: [ef48e7dac2b4a5bc18855a91dc28ceaf0b75fe16]
fixed-by:
  mainline: [341adeec9adad0874f29a0a1af35638207352a39]
  stable/5.15: [0ef6049f664941bc0f75828b3a61877635048b27]
