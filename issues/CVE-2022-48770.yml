description: 'bpf: Guard against accessing NULL pt_regs in bpf_get_task_stack()'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48770
- https://git.kernel.org/linus/b992f01e66150fc5e90be4a96f5eb8e634c8249e
- https://git.kernel.org/stable/c/ff6bdc205fd0a83bd365405d4e31fb5905826996
- https://git.kernel.org/stable/c/0bcd484587b3b3092e448d27dc369e347e1810c3
- https://git.kernel.org/stable/c/b82ef4985a6d05e80f604624332430351df7b79a
- https://git.kernel.org/stable/c/b992f01e66150fc5e90be4a96f5eb8e634c8249e
- https://lore.kernel.org/linux-cve-announce/2024062011-CVE-2022-48770-34e0@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit fa28dcb ("bpf: Introduce helper bpf_get_task_stack()") in v5.9-rc1.
    Fixed in v5.17-rc2.
  debian/carnil: |-
    Introduced in fa28dcb82a38f8 ("bpf: Introduce helper bpf_get_task_stack()").
    Vulnerable versions: 5.9-rc1.
introduced-by:
  mainline: [fa28dcb82a38f8e3993b0fae9106b1a80b59e4f0]
fixed-by:
  cip/5.10: [ff6bdc205fd0a83bd365405d4e31fb5905826996]
  cip/5.10-rt: [ff6bdc205fd0a83bd365405d4e31fb5905826996]
  mainline: [b992f01e66150fc5e90be4a96f5eb8e634c8249e]
  stable/5.10: [ff6bdc205fd0a83bd365405d4e31fb5905826996]
  stable/5.15: [0bcd484587b3b3092e448d27dc369e347e1810c3]
  ubuntu/focal: ['version:5.4.0-9.12']
