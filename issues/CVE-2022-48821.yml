description: 'misc: fastrpc: avoid double fput() on failed usercopy'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48821
- https://git.kernel.org/stable/c/4e6fd2b5fcf8e7119305a6042bd92e7f2b9ed215
- https://git.kernel.org/stable/c/a5ce7ee5fcc07583159f54ab4af5164de00148f5
- https://git.kernel.org/stable/c/e4382d0a39f9a1e260d62fdc079ddae5293c037d
- https://git.kernel.org/stable/c/76f85c307ef9f10aa2cef1b1d5ee654c1f3345fc
- https://git.kernel.org/stable/c/46963e2e0629cb31c96b1d47ddd89dc3d8990b34
- https://lore.kernel.org/linux-cve-announce/2024071650-CVE-2022-48821-5c97@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 6cffd79 ("misc: fastrpc: Add support for dmabuf exporter") in v5.1-rc1.
    Fixed in v5.17-rc4.
  debian/carnil: |-
    Introduced in 6cffd79504ce ("misc: fastrpc: Add support for dmabuf exporter").
    Vulnerable versions: 5.1-rc1.
introduced-by:
  mainline: [6cffd79504ce040f460831030d3069fa1c99bb71]
fixed-by:
  cip/5.10: [a5ce7ee5fcc07583159f54ab4af5164de00148f5]
  cip/5.10-rt: [a5ce7ee5fcc07583159f54ab4af5164de00148f5]
  mainline: [46963e2e0629cb31c96b1d47ddd89dc3d8990b34]
  stable/5.10: [a5ce7ee5fcc07583159f54ab4af5164de00148f5]
  stable/5.15: [e4382d0a39f9a1e260d62fdc079ddae5293c037d]
  stable/5.4: [4e6fd2b5fcf8e7119305a6042bd92e7f2b9ed215]
  ubuntu/focal: [7265984172e46f529fcfb840d93d9f54bed26512]
