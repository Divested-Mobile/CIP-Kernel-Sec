description: 'usb: f_fs: Fix use-after-free for epfile'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48822
- https://git.kernel.org/stable/c/32048f4be071f9a6966744243f1786f45bb22dc2
- https://git.kernel.org/stable/c/cfe5f6fd335d882bcc829a1c8a7d462a455c626e
- https://git.kernel.org/stable/c/c9fc422c9a43e3d58d246334a71f3390401781dc
- https://git.kernel.org/stable/c/0042178a69eb77a979e36a50dcce9794a3140ef8
- https://git.kernel.org/stable/c/72a8aee863af099d4434314c4536d6c9a61dcf3c
- https://git.kernel.org/stable/c/3e078b18753669615301d946297bafd69294ad2c
- https://git.kernel.org/stable/c/ebe2b1add1055b903e2acd86b290a85297edc0b3
- https://lore.kernel.org/linux-cve-announce/2024071650-CVE-2022-48822-48d1@gregkh/
- https://git.kernel.org/linus/ebe2b1add1055b903e2acd86b290a85297edc0b3
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit a9e6f83 ("usb: gadget: f_fs: stop sleeping in ffs_func_eps_disable") in v4.9-rc3.
    Fixed in v5.17-rc4.
  debian/carnil: |-
    Introduced in a9e6f83c2df1 ("usb: gadget: f_fs: stop sleeping in
    ffs_func_eps_disable"). Vulnerable versions: 4.8.10 4.9-rc3.
introduced-by:
  mainline: [a9e6f83c2df199187a5248f824f31b6787ae23ae]
fixed-by:
  cip/4.19: [cfe5f6fd335d882bcc829a1c8a7d462a455c626e]
  cip/4.19-rt: [cfe5f6fd335d882bcc829a1c8a7d462a455c626e]
  cip/5.10: [0042178a69eb77a979e36a50dcce9794a3140ef8]
  cip/5.10-rt: [0042178a69eb77a979e36a50dcce9794a3140ef8]
  mainline: [ebe2b1add1055b903e2acd86b290a85297edc0b3]
  openela/4.14: [32048f4be071f9a6966744243f1786f45bb22dc2]
  stable/4.14: [32048f4be071f9a6966744243f1786f45bb22dc2]
  stable/4.19: [cfe5f6fd335d882bcc829a1c8a7d462a455c626e]
  stable/5.10: [0042178a69eb77a979e36a50dcce9794a3140ef8]
  stable/5.15: [72a8aee863af099d4434314c4536d6c9a61dcf3c]
  stable/5.4: [c9fc422c9a43e3d58d246334a71f3390401781dc]
  ubuntu/bionic: [35ec571baffbf604755c678e0c21ccc73ac7f792]
  ubuntu/focal: [45ef1a960a6c65c85a4254c2f16007bdb51bcafe]
