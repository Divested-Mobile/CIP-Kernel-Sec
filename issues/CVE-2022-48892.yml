description: 'sched/core: Fix use-after-free bug in dup_user_cpus_ptr()'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48892
- https://git.kernel.org/stable/c/b22faa21b6230d5eccd233e1b7e0026a5002b287
- https://git.kernel.org/stable/c/7b5cc7fd1789ea5dbb942c9f8207b076d365badc
- https://git.kernel.org/stable/c/87ca4f9efbd7cc649ff43b87970888f2812945b8
- https://lore.kernel.org/linux-cve-announce/2024082110-CVE-2022-48892-3458@gregkh/
- https://git.kernel.org/linus/87ca4f9efbd7cc649ff43b87970888f2812945b8
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 07ec77a ("sched: Allow task CPU affinity to be restricted on asymmetric systems") in v5.15-rc1.
    Introduced by commit 851a723 ("sched: Always clear user_cpus_ptr in do_set_cpus_allowed()") in v6.2-rc1.
    Fixed in v6.2-rc4.
  debian/carnil: |-
    Introduced in 07ec77a1d4e8 ("sched: Allow task CPU affinity to be restricted on
    asymmetric systems")
    851a723e45d1 ("sched: Always clear user_cpus_ptr in do_set_cpus_allowed()").
    Vulnerable versions: 5.15-rc1.
introduced-by:
  mainline: [07ec77a1d4e82526e1588979fff2f024f8e96df2, 851a723e45d1c4c8f6f7b0d2cfbc5f53690bb4e9]
fixed-by:
  cip/6.1: [7b5cc7fd1789ea5dbb942c9f8207b076d365badc]
  cip/6.1-rt: [7b5cc7fd1789ea5dbb942c9f8207b076d365badc]
  mainline: [87ca4f9efbd7cc649ff43b87970888f2812945b8]
  stable/5.15: [b22faa21b6230d5eccd233e1b7e0026a5002b287]
  stable/6.1: [7b5cc7fd1789ea5dbb942c9f8207b076d365badc]
  ubuntu/focal: ['version:5.4.0-9.12']
