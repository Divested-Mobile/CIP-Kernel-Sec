description: 'btrfs: prevent copying too big compressed lzo segment'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48923
- https://git.kernel.org/stable/c/8df508b7a44cd8110c726057cd28e8f8116885eb
- https://git.kernel.org/stable/c/e326bd06cdde46df952361456232022298281d16
- https://git.kernel.org/stable/c/741b23a970a79d5d3a1db2d64fa2c7b375a4febb
- https://lore.kernel.org/linux-cve-announce/2024082219-CVE-2022-48923-9db1@gregkh/
- https://git.kernel.org/linus/741b23a970a79d5d3a1db2d64fa2c7b375a4febb
comments:
  cip/cip-kernel-sec: There is no mention of the commit that introduced the bug in
    the CVE announcement.Fixed in v5.17-rc6.
  cip/masami: |-
    It looks 4.4 uses different logic to decompress data in the lzo_decompress_biovec.
    It may not be affected to 4.4.
  debian/carnil: First introducing commit could not be determined.
  ubuntu/bjamison: |-
    The break commit is where 'copy_compressed_segment' is introduced without
     validating 'seg_len'.
introduced-by:
  mainline: [a6e66e6f8c1b685e11b778bef614480a9c1a5278]
fixed-by:
  mainline: [741b23a970a79d5d3a1db2d64fa2c7b375a4febb]
  stable/5.15: [8df508b7a44cd8110c726057cd28e8f8116885eb]
  ubuntu/focal: ['version:5.4.0-9.12']
