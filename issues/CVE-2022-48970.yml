description: 'af_unix: Get user_ns from in_skb in unix_diag_get_exact().'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48970
- https://git.kernel.org/stable/c/c66d78aee55dab72c92020ebfbebc464d4f5dd2a
- https://git.kernel.org/stable/c/575a6266f63dbb3b8eb1da03671451f0d81b8034
- https://git.kernel.org/stable/c/5c014eb0ed6c8c57f483e94cc6e90f34ce426d91
- https://git.kernel.org/stable/c/9c1d6f79a2c7b8221dcec27defc6dc461052ead4
- https://git.kernel.org/stable/c/b3abe42e94900bdd045c472f9c9be620ba5ce553
- https://lore.kernel.org/linux-cve-announce/2024102144-CVE-2022-48970-7c96@gregkh/
- https://git.kernel.org/linus/b3abe42e94900bdd045c472f9c9be620ba5ce553
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit cae9910 ("net: Add UNIX_DIAG_UID to Netlink UNIX socket diagnostics.") in v5.3-rc1.
    Fixed in v6.1.
  debian/carnil: |-
    Introduced in cae9910e7344 ("net: Add UNIX_DIAG_UID to Netlink UNIX socket
    diagnostics."). Vulnerable versions: 5.3-rc1.
introduced-by:
  mainline: [cae9910e73446cac68a54e3a7b02aaa12b689026]
fixed-by:
  cip/5.10: [575a6266f63dbb3b8eb1da03671451f0d81b8034]
  cip/5.10-rt: [575a6266f63dbb3b8eb1da03671451f0d81b8034]
  mainline: [b3abe42e94900bdd045c472f9c9be620ba5ce553]
  stable/5.10: [575a6266f63dbb3b8eb1da03671451f0d81b8034]
  stable/5.15: [5c014eb0ed6c8c57f483e94cc6e90f34ce426d91]
  stable/5.4: [c66d78aee55dab72c92020ebfbebc464d4f5dd2a]
  ubuntu/focal: [c3c731819737e268150d354f4a5573b01258d611]
