description: 'char: tpm: Protect tpm_pm_suspend with locks'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-48997
- https://git.kernel.org/stable/c/d699373ac5f3545243d3c73a1ccab77fdef8cec6
- https://git.kernel.org/stable/c/4e0d6c687c925e27fd4bc78a2721d10acf5614d6
- https://git.kernel.org/stable/c/571b6bbbf54d835ea6120f65575cb55cd767e603
- https://git.kernel.org/stable/c/25b78bf98b07ff5aceb9b1e24f72ec0236c5c053
- https://git.kernel.org/stable/c/23393c6461422df5bf8084a086ada9a7e17dc2ba
- https://lore.kernel.org/linux-cve-announce/2024102149-CVE-2022-48997-cd65@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit e891db1 ("tpm: turn on TPM on suspend for TPM 1.x") in v5.1-rc5.
    Fixed in v6.1-rc8.
  debian/carnil: |-
    Introduced in e891db1a18bf ("tpm: turn on TPM on suspend for TPM 1.x").
    Vulnerable versions: 5.1-rc5.
introduced-by:
  mainline: [e891db1a18bf11e02533ec2386b796cfd8d60666]
fixed-by:
  cip/5.10: [4e0d6c687c925e27fd4bc78a2721d10acf5614d6]
  cip/5.10-rt: [4e0d6c687c925e27fd4bc78a2721d10acf5614d6]
  mainline: [23393c6461422df5bf8084a086ada9a7e17dc2ba]
  stable/5.10: [4e0d6c687c925e27fd4bc78a2721d10acf5614d6]
  stable/5.15: [571b6bbbf54d835ea6120f65575cb55cd767e603]
  stable/5.4: [d699373ac5f3545243d3c73a1ccab77fdef8cec6]
  ubuntu/focal: [bcc5550ac86f87a24e6bc4b3401c4458fe8d5464]
