description: 'iommu/vt-d: Fix PCI device refcount leak in has_external_pci()'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-49000
- https://git.kernel.org/stable/c/10ed7655a17f6a3eaecd1293830488259ccd5723
- https://git.kernel.org/stable/c/b6eea8b2e858a20ad58ac62dc2de90fea2413f94
- https://git.kernel.org/stable/c/17f67414718e6aba123335a33b7d15aa594fff34
- https://git.kernel.org/stable/c/afca9e19cc720bfafc75dc5ce429c185ca93f31d
- https://lore.kernel.org/linux-cve-announce/2024102150-CVE-2022-49000-2c9c@gregkh/
- https://git.kernel.org/linus/afca9e19cc720bfafc75dc5ce429c185ca93f31d
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 89a6079 ("iommu/vt-d: Force IOMMU on for platform opt in hint") in v5.0-rc1.
    Fixed in v6.1-rc8.
  debian/carnil: |-
    Introduced in 89a6079df791 ("iommu/vt-d: Force IOMMU on for platform opt in
    hint"). Vulnerable versions: 5.0-rc1.
introduced-by:
  mainline: [89a6079df791aeace2044ea93be1b397195824ec]
  ubuntu/bionic: [3ccaabd3ccc47318482385b9f5bc0e5d740c5272]
fixed-by:
  cip/5.10: [10ed7655a17f6a3eaecd1293830488259ccd5723]
  cip/5.10-rt: [10ed7655a17f6a3eaecd1293830488259ccd5723]
  mainline: [afca9e19cc720bfafc75dc5ce429c185ca93f31d]
  stable/5.10: [10ed7655a17f6a3eaecd1293830488259ccd5723]
  stable/5.15: [b6eea8b2e858a20ad58ac62dc2de90fea2413f94]
