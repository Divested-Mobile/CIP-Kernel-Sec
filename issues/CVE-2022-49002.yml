description: 'iommu/vt-d: Fix PCI device refcount leak in dmar_dev_scope_init()'
references:
- https://www.cve.org/CVERecord?id=CVE-2022-49002
- https://git.kernel.org/stable/c/d47bc9d7bcdbb9adc9703513d964b514fee5b0bf
- https://git.kernel.org/stable/c/71c4a621985fc051ab86d3a86c749069a993fcb2
- https://git.kernel.org/stable/c/876d7bfb89273997056220029ff12b1c2cc4691d
- https://git.kernel.org/stable/c/cbdd83bd2fd67142b03ce9dbdd1eab322ff7321f
- https://git.kernel.org/stable/c/a5c65cd56aed027f8a97fda8b691caaeb66d115e
- https://git.kernel.org/stable/c/bdb613ef179ad4bb9d56a2533e9b30e434f1dfb7
- https://git.kernel.org/stable/c/2a8f7b90681472948de172dbbf5a54cd342870aa
- https://git.kernel.org/stable/c/4bedbbd782ebbe7287231fea862c158d4f08a9e3
- https://lore.kernel.org/linux-cve-announce/2024102150-CVE-2022-49002-5b24@gregkh/
- https://git.kernel.org/linus/4bedbbd782ebbe7287231fea862c158d4f08a9e3
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 2e45528 ("iommu/vt-d: Unify the way to process DMAR device scope array") in v3.15-rc1.
    Fixed in v6.1-rc8.
  debian/carnil: |-
    Introduced in 2e4552893038 ("iommu/vt-d: Unify the way to process DMAR device
    scope array"). Vulnerable versions: 3.15-rc1.
introduced-by:
  mainline: [2e45528930388658603ea24d49cf52867b928d3e]
fixed-by:
  cip/4.19: [876d7bfb89273997056220029ff12b1c2cc4691d]
  cip/4.19-rt: [876d7bfb89273997056220029ff12b1c2cc4691d]
  cip/4.4: [c47bafffc6e5365d64cc384a3415c793fff5481e]
  cip/4.4-rt: [c47bafffc6e5365d64cc384a3415c793fff5481e]
  cip/4.4-st: [c47bafffc6e5365d64cc384a3415c793fff5481e]
  cip/5.10: [a5c65cd56aed027f8a97fda8b691caaeb66d115e]
  cip/5.10-rt: [a5c65cd56aed027f8a97fda8b691caaeb66d115e]
  mainline: [4bedbbd782ebbe7287231fea862c158d4f08a9e3]
  stable/4.19: [876d7bfb89273997056220029ff12b1c2cc4691d]
  stable/5.10: [a5c65cd56aed027f8a97fda8b691caaeb66d115e]
  stable/5.15: [bdb613ef179ad4bb9d56a2533e9b30e434f1dfb7]
  stable/5.4: [cbdd83bd2fd67142b03ce9dbdd1eab322ff7321f]
  ubuntu/bionic: [e1c803113a0499e27ec3849d676bb8e55c8af828]
  ubuntu/focal: [c4e1df82d419b8660a9624c0040850ab73161c35]
