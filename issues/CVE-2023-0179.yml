description: 'netfilter: nft_payload: incorrect arithmetics when fetching VLAN header
  bits'
references:
- https://www.openwall.com/lists/oss-security/2023/01/13/2
- https://www.openwall.com/lists/oss-security/2023/01/13/4
- https://groups.google.com/g/syzkaller/c/YRNDJBsJn_s?pli=1
- https://patchwork.ozlabs.org/project/netfilter-devel/patch/20230111212251.193032-4-pablo@netfilter.org/
- https://git.kernel.org/pub/scm/linux/kernel/git/netfilter/nf.git/commit/?id=696e1a48b1a1b01edad542a1ef293665864a4dd0
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0179
- https://ubuntu.com/security/notices/USN-5856-1
- https://ubuntu.com/security/notices/USN-5857-1
- https://ubuntu.com/security/notices/USN-5858-1
- https://ubuntu.com/security/notices/USN-5859-1
- https://ubuntu.com/security/notices/USN-5911-1
- https://ubuntu.com/security/notices/USN-5912-1
- https://ubuntu.com/security/notices/USN-5915-1
- https://ubuntu.com/security/notices/USN-5929-1
- https://ubuntu.com/security/notices/USN-5935-1
- https://ubuntu.com/security/notices/USN-5938-1
- https://ubuntu.com/security/notices/USN-5941-1
- https://ubuntu.com/security/notices/USN-5950-1
- https://ubuntu.com/security/notices/USN-5962-1
comments:
  debian/carnil: Fixed as well in 6.1.7 for 6.1.y.
  masami: |-
    Introduced by commit f6ae9f1 ("netfilter: nft_payload: add C-VLAN support")
    in 5.5-rc1
reporters:
- Davide Ornaghi
introduced-by:
  mainline: [f6ae9f120dada00abfb47313364c35118469455f]
fixed-by:
  cip/5.10: [550efeff989b041f3746118c0ddd863c39ddc1aa]
  cip/5.10-rt: [550efeff989b041f3746118c0ddd863c39ddc1aa]
  cip/6.1: [76ef74d4a379faa451003621a84e3498044e7aa3]
  mainline: [696e1a48b1a1b01edad542a1ef293665864a4dd0]
  stable/5.10: [550efeff989b041f3746118c0ddd863c39ddc1aa]
  stable/5.15: [a8acfe2c6fb99f9375a9325807a179cd8c32e6e3]
  stable/6.1: [76ef74d4a379faa451003621a84e3498044e7aa3]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.4: Not affected
