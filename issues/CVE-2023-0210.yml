description: 'ksmbd: check nt_len to be at least CIFS_ENCPWD_SIZE in ksmbd_decode_ntlmssp_auth_blob'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0210
- https://www.openwall.com/lists/oss-security/2023/01/04/1
- https://git.kernel.org/linus/797805d81baa814f76cf7bdab35f86408a79d707
- https://ubuntu.com/security/notices/USN-5915-1
- https://ubuntu.com/security/notices/USN-5982-1
- https://ubuntu.com/security/notices/USN-5987-1
- https://ubuntu.com/security/notices/USN-6004-1
- https://ubuntu.com/security/notices/USN-6079-1
- https://ubuntu.com/security/notices/USN-6091-1
- https://ubuntu.com/security/notices/USN-6096-1
comments:
  debian/carnil: For 6.1.y fixed in 6.1.5.
  masami: "This vulnerability was introudced by commit e2f3448 (\"cifsd: add \nserver-side\
    \ procedures for SMB3\") in 5.15-rc1. \nLess than 5.15 kernels are not affected\
    \ by this issue."
  ubuntu/sbeattie: |-
    needs ksmbd-tools installed to enable the service, which is
      not installed by default.
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  mainline: [797805d81baa814f76cf7bdab35f86408a79d707]
  stable/5.15: [e32f867b37da7902685c9a106bef819506aa1a92]
  stable/6.0: [1e7ed525c60d8d51daf2700777071cd0dfb6f807]
  stable/6.1: [5e7d97dbae25ab4cb0ac1b1b98aebc4915689a86]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
