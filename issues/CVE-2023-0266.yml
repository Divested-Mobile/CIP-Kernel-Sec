description: 'ALSA: pcm: Move rwsem lock inside snd_ctl_elem_read to prevent UAF'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0266
- https://git.kernel.org/linus/56b88b50565cd8b946a2d00b0c83927b7ebb055e
- https://ubuntu.com/security/notices/USN-5915-1
- https://ubuntu.com/security/notices/USN-5917-1
- https://ubuntu.com/security/notices/USN-5924-1
- https://ubuntu.com/security/notices/USN-5927-1
- https://ubuntu.com/security/notices/USN-5934-1
- https://ubuntu.com/security/notices/USN-5939-1
- https://ubuntu.com/security/notices/USN-5940-1
- https://ubuntu.com/security/notices/USN-5951-1
- https://ubuntu.com/security/notices/USN-5970-1
- https://ubuntu.com/security/notices/USN-5975-1
- https://ubuntu.com/security/notices/USN-5979-1
- https://ubuntu.com/security/notices/USN-5981-1
- https://ubuntu.com/security/notices/USN-5982-1
- https://ubuntu.com/security/notices/USN-5984-1
- https://ubuntu.com/security/notices/USN-5987-1
- https://ubuntu.com/security/notices/USN-5991-1
- https://ubuntu.com/security/notices/USN-6000-1
- https://ubuntu.com/security/notices/USN-6004-1
comments:
  debian/carnil: |-
    Commit fixes 1fa4445f9adf ("ALSA: control - introduce
    snd_ctl_notify_one() helper") in 5.13-rc1.
    Fixed as well in 6.1.6 for 6.1.y.
  ubuntu/sbeattie: |-
    the fix commit claims that the issues is only present in 5.13
      and newer, but it's not clear why, from both the history of the
      snd_ctl_elem_read() path and the compat path.
introduced-by:
  mainline: [1fa4445f9adf19a3028ce0e8f375bac75214fc10]
fixed-by:
  mainline: [56b88b50565cd8b946a2d00b0c83927b7ebb055e]
  stable/4.19: [5b2ea7e91352165054c5b3f8e5442cd31c3e73f9]
  stable/5.10: [df02234e6b87d2a9a82acd3198e44bdeff8488c6]
  stable/5.15: [26350c21bc5e97a805af878e092eb8125843fe2c]
  stable/6.1: [d6ad4bd1d896ae1daffd7628cd50f124280fb8b1]
  ubuntu/focal: [45618e2819e817f359547c2406dc84507bd01527]
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
