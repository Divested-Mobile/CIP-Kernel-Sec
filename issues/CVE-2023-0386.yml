description: 'ovl: fail on invalid uid/gid mapping at copy up'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2159505
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-0386
- https://git.kernel.org/linus/4f11ada10d0ad3fd53e2bd67806351de63a4f9c3
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=4f11ada10d0a
- https://ubuntu.com/security/notices/USN-6025-1
- https://ubuntu.com/security/notices/USN-6040-1
- https://ubuntu.com/security/notices/USN-6043-1
- https://ubuntu.com/security/notices/USN-6057-1
- https://ubuntu.com/security/notices/USN-6071-1
- https://ubuntu.com/security/notices/USN-6072-1
- https://github.com/chenaotian/CVE-2023-0386
- https://ubuntu.com/security/notices/USN-6134-1
- https://www.cve.org/CVERecord?id=CVE-2023-0386
comments:
  debian/carnil: |-
    Issue different from CVE-2021-3847.
    Only exploitable after commit 459c7c565ac3 "ovl: unprivieged
    mounts" in 5.11-rc1, or if the Debian-specific module parameter
    permit_mounts_in_userns is enabled.
  masami: |-
    Introduced by commit 459c7c5 ("ovl: unprivieged mounts")
    in 5.11-rc1.
introduced-by:
  mainline: [459c7c565ac36ba09ffbf24231147f408fde4203]
fixed-by:
  cip/6.1: [42fea1c35254c49cce07c600d026cbc00c6d3c81]
  cip/6.1-rt: [42fea1c35254c49cce07c600d026cbc00c6d3c81]
  debian/buster-security: ['patch:buster-security:bugfix/all/ovl-fail-on-invalid-uid-gid-mapping-at-copy-up.patch']
  mainline: [4f11ada10d0ad3fd53e2bd67806351de63a4f9c3]
  stable/5.15: [e91308e63710574c4b6a0cadda3e042a3699666e]
  stable/6.1: [42fea1c35254c49cce07c600d026cbc00c6d3c81]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.4: Not affected
