description: 'net: avoid double iput when sock_alloc_file fails'
references:
- https://www.openwall.com/lists/oss-security/2023/03/13/2
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1032
- http://www.openwall.com/lists/oss-security/2023/03/13
- https://ubuntu.com/security/notices/USN-5977-1
- https://ubuntu.com/security/notices/USN-6024-1
- https://ubuntu.com/security/notices/USN-6033-1
- https://www.cve.org/CVERecord?id=CVE-2023-1032
comments:
  debian/carnil: |-
    Commit fixes da214a475f8b ("net: add __sys_socket_file()") in
    5.19-rc1.
  masami: 'Introduced by commit da214a4 ("net: add __sys_socket_file()") in 5.19-rc1.'
  ubuntu/eslerm: CWE-415
reporters:
- Thadeu Cascardo
introduced-by:
  mainline: [da214a475f8bd1d3e9e7a19ddfeb4d1617551bab]
fixed-by:
  cip/6.1: [7c7570791b15c3b78e3229ae97825e7eb869c7da]
  cip/6.1-rt: [7c7570791b15c3b78e3229ae97825e7eb869c7da]
  mainline: [649c15c7691e9b13cbe9bf6c65c365350e056067]
  stable/6.1: [7c7570791b15c3b78e3229ae97825e7eb869c7da]
  stable/6.2: [cb6aedc1fd9d808d7319db2f953f4886dd46c627]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
  stable/5.4: Not affected
