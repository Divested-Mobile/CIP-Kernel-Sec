description: |-
  In nf_tables_updtable, if nf_tables_table_enable returns an error,
  nft_trans_destroy is called to free the transaction object.
  nft_trans_destroy() calls list_del(), but the transaction was never placed
  on a list -- the list head is all zeroes, this results in a NULL pointer
  dereference.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1095
- https://git.kernel.org/linus/580077855a40741cf511766129702d97ff02f4d9
- https://github.com/torvalds/linux/commit/580077855a40741cf511766129702d97ff02f4d9
- https://bugzilla.redhat.com/show_bug.cgi?id=2173973
- https://ubuntu.com/security/notices/USN-6001-1
- https://ubuntu.com/security/notices/USN-6013-1
- https://ubuntu.com/security/notices/USN-6014-1
- https://ubuntu.com/security/notices/USN-6031-1
comments:
  masami: |-
    Introduced by commit 55dd6f9 ("netfilter: nf_tables: use new
    transaction infrastructure to handle table") in 3.16-rc1.
reporters:
- Mingi Cho
introduced-by:
  mainline: [55dd6f93076bb82aa8911191125418dcfcbf2c9b]
fixed-by:
  cip/4.19: [d3f409c375490a86d342eae1d0f6271d12dc19d0]
  cip/4.19-rt: [d3f409c375490a86d342eae1d0f6271d12dc19d0]
  cip/4.4: [a985d2049498488a064c148334aeec1970933544]
  cip/4.4-rt: [a985d2049498488a064c148334aeec1970933544]
  cip/4.4-st: [a985d2049498488a064c148334aeec1970933544]
  cip/5.10: [80977126bc20309f7f7bae6d8621356b393e8b41]
  cip/5.10-rt: [80977126bc20309f7f7bae6d8621356b393e8b41]
  debian/buster-security: ['version:debian/4.19.260-1']
  mainline: [580077855a40741cf511766129702d97ff02f4d9]
  stable/4.14: [49d57fb1fd44b9d3422f096d3b1b6415685d7364]
  stable/4.19: [d3f409c375490a86d342eae1d0f6271d12dc19d0]
  stable/4.9: [ef6b262e551da27579e7ac255928394176353115]
  stable/5.10: [80977126bc20309f7f7bae6d8621356b393e8b41]
  stable/5.15: [8a2df34b5bf652566f2889d9fa321f3b398547ef]
  stable/5.4: [a452bc3deb23bf93f8a13d3e24611b7ef39645dc]
  ubuntu/bionic: [dd1b519efc7d5a928510e36f9627edae1a0eeae7]
  ubuntu/focal: [c98b969e567a1a544f0ba2a892e5ce2fdb3334f4]
