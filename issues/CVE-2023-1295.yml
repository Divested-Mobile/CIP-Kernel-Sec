description: |-
  A time-of-check to time-of-use issue exists in io_uring subsystem's
  IORING_OP_CLOSE operation in the Linux kernel's versions 5.6 - 5.11
  (inclusive), which allows a local user to elevate their privileges to root.
  Introduced in b5dba59e0cf7e2cc4d3b3b1ac5fe81ddf21959eb, patched in
  9eac1904d3364254d622bf2c771c4f85cd435fc2, backported to stable in
  788d0824269bef539fe31a785b1517882eafed93.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1295
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b5dba59e0cf7e2cc4d3b3b1ac5fe81ddf21959eb
- https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=788d0824269bef539fe31a785b1517882eafed93
- https://kernel.dance/788d0824269bef539fe31a785b1517882eafed93
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9eac1904d3364254d622bf2c771c4f85cd435fc2
- https://kernel.dance/9eac1904d3364254d622bf2c771c4f85cd435fc2
- https://kernel.dance/#9eac1904d3364254d622bf2c771c4f85cd435fc2
- https://kernel.dance/#788d0824269bef539fe31a785b1517882eafed93
comments:
  masami: |-
    Introduced by commit b5dba59 (io_uring: add support for IORING_OP_CLOSE)
    in 5.6-rc1. So before 5.6 kernels are not affected.
introduced-by:
  mainline: [b5dba59e0cf7e2cc4d3b3b1ac5fe81ddf21959eb]
fixed-by:
  mainline: [9eac1904d3364254d622bf2c771c4f85cd435fc2]
  stable/5.10: [788d0824269bef539fe31a785b1517882eafed93]
  ubuntu/focal: ['version:5.4.0-9.12']
