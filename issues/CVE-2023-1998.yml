description: 'x86/speculation: Allow enabling STIBP with legacy IBRS'
references:
- https://github.com/google/security-research/security/advisories/GHSA-mj4w-6495-6crx
- https://kernel.dance/#6921ed9049bc7457f66c1596c5b78aec0dae4a9d
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-1998
- https://git.kernel.org/linus/6921ed9049bc7457f66c1596c5b78aec0dae4a9d
- https://bugzilla.redhat.com/show_bug.cgi?id=2187257
- https://bugzilla.suse.com/show_bug.cgi?id=1210506
- https://ubuntu.com/security/notices/USN-6033-1
- https://ubuntu.com/security/notices/USN-6171-1
- https://ubuntu.com/security/notices/USN-6172-1
- https://ubuntu.com/security/notices/USN-6185-1
- https://ubuntu.com/security/notices/USN-6187-1
- https://ubuntu.com/security/notices/USN-6207-1
- https://ubuntu.com/security/notices/USN-6222-1
- https://ubuntu.com/security/notices/USN-6223-1
- https://ubuntu.com/security/notices/USN-6256-1
- https://www.cve.org/CVERecord?id=CVE-2023-1998
- https://ubuntu.com/security/notices/USN-6739-1
- https://ubuntu.com/security/notices/USN-6740-1
comments:
  masami: |-
    Introduced by commit Z7c693f5 ("x86/speculation: Add spectre_v2=ibrs option to support Kernel IBRS")
    in 5.19-rc7. This commit is not backported to 4.4 kernels.
reporters:
- Jos√© Oliveira
- Rodrigo Branco
introduced-by:
  cip/4.19: [c1493b60fd131c0c1558a8f71192fbebe7ed998f]
  cip/4.19-rt: [c1493b60fd131c0c1558a8f71192fbebe7ed998f]
  cip/5.10: [dabc2a1b406ae0ff5286c91f7519b3e20ec2aa63]
  cip/5.10-rt: [dabc2a1b406ae0ff5286c91f7519b3e20ec2aa63]
  mainline: [7c693f54c873691a4b7da05c7e0f74e67745d144]
  stable/4.14: [b57fd0a7dd80d9f3a864cfa96c640d7f9e6d617c]
  stable/4.19: [c1493b60fd131c0c1558a8f71192fbebe7ed998f]
  stable/5.10: [dabc2a1b406ae0ff5286c91f7519b3e20ec2aa63]
  stable/5.15: [347d0bf6b0c020ca0284b3fd96652470e06bd084]
  stable/5.4: [2d4ce2d72c3b46f20929fa7d1c8af5d5250ccfc7]
  ubuntu/bionic: [3671ea211e53e70cdb5986e7038797ef85b7aa00]
  ubuntu/focal: [dda50281d1247427c41280051edee759c030849f]
fixed-by:
  cip/4.19: [10543fb3c9b019e45e2045f08f46fdf526add593]
  cip/4.19-rt: [10543fb3c9b019e45e2045f08f46fdf526add593]
  cip/5.10: [abfed855f05863d292de2d0ebab4656791bab9c8]
  cip/5.10-rt: [abfed855f05863d292de2d0ebab4656791bab9c8]
  cip/6.1: [08d87c87d6461d16827c9b88d84c48c26b6c994a]
  cip/6.1-rt: [08d87c87d6461d16827c9b88d84c48c26b6c994a]
  debian/buster-security: ['version:debian/4.19.282-1']
  mainline: [6921ed9049bc7457f66c1596c5b78aec0dae4a9d]
  stable/4.14: [03bc360ce8896ef53ebcef83cccd9f24d9815160]
  stable/4.19: [10543fb3c9b019e45e2045f08f46fdf526add593]
  stable/5.10: [abfed855f05863d292de2d0ebab4656791bab9c8]
  stable/5.15: [e7f1ddebd9f5b12de40bc37db9243957678f1448]
  stable/5.4: [34c1b60e7a80404056c03936dd9c2438da2789d4]
  stable/6.1: [08d87c87d6461d16827c9b88d84c48c26b6c994a]
  stable/6.2: [ead3c8e54d28fa1d5454b1f8a21b96b4a969b1cb]
  ubuntu/focal: [f06a1eb3754b293d23c897d9b7a4b69476c6948f]
