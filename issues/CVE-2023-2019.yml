description: 'netdevsim: fib: Fix reference count leak on route deletion failure'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2189137
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-17811/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2019
- https://git.kernel.org/linus/180a6a3ee60a7cb69ed1232388460644f6a21f00
- https://github.com/torvalds/linux/commit/180a6a3ee60a
- https://www.cve.org/CVERecord?id=CVE-2023-2019
comments:
  masami: |-
    It introduced by commit 0ae3eb7 ("netdevsim: fib: Perform the route
    programming in a non-atomic context") in 5.12-rc1dontuse.
    This patch is not backported to older stable kernels so before 5.12
    kernels are not affected by this issue.
introduced-by:
  mainline: [0ae3eb7b4611207e140e9772398b9f88b72d6839]
fixed-by:
  mainline: [180a6a3ee60a7cb69ed1232388460644f6a21f00]
  stable/5.15: [f671cf48f383fccba313346eddb4bd6bcbdb55a4]
  ubuntu/focal: ['version:5.4.0-9.12']
