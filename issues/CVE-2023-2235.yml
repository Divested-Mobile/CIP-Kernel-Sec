description: |-
  A use-after-free vulnerability in the Linux Kernel Performance Events
  system can be exploited to achieve local privilege escalation.
  The perf_group_detach function did not check the event's siblings'
  attach_state before calling add_event_to_groups(), butÂ remove_on_exec made
  it possible to call list_del_event() on before detaching from their group,
  making it possible to use a dangling pointer causing a use-after-free
  vulnerability.
  We recommend upgrading past commit
  fd0815f632c24878e325821943edccc7fde947a2.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2235
- https://git.kernel.org/linus/fd0815f632c24878e325821943edccc7fde947a2
- https://kernel.dance/fd0815f632c24878e325821943edccc7fde947a2
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=fd0815f632c24878e325821943edccc7fde947a2
- https://bugzilla.redhat.com/show_bug.cgi?id=2192589
- https://ubuntu.com/security/notices/USN-6175-1
- https://ubuntu.com/security/notices/USN-6186-1
comments:
  debian/carnil: |-
    Commit fixes 2e498d0a74e5 ("perf: Add support for event removal
    on exec") in 5.13-rc1.
  masami: |-
    Introduced by commit 2e498d0 ("perf: Add support for event removal on exec")
    in 5.13-rc1.
  ubuntu/cascardo: |-
    Ubuntu kernels enable SECURITY_PERF_EVENTS_RESTRICT which sets
     kernel.perf_event_paranoid >= 2 and so disables unprivileged users from
     using perf by default. As such in their default configuration, Ubuntu
     kernels are not able to be exploited by this flaw to achieve local
     privilege escalation.
introduced-by:
  mainline: [2e498d0a74e5b88a6689ae1b811f247f91ff188e]
fixed-by:
  cip/6.1: [529546ea2834ce58aa075837d57918740accf713]
  cip/6.1-rt: [529546ea2834ce58aa075837d57918740accf713]
  mainline: [fd0815f632c24878e325821943edccc7fde947a2]
  stable/5.15: [de3ef7ba684a25313c4b7405d007ab22912ef95a]
  stable/6.1: [529546ea2834ce58aa075837d57918740accf713]
  stable/6.2: [2c6d1b32838d8cf0114dfdbbb93f4d808e498760]
  ubuntu/focal: ['version:5.4.0-9.12']
