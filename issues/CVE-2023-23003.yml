description: 'perf expr: Fix missing check for return value of hashmap__new()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23003
- https://git.kernel.org/linus/0a515a06c5ebfa46fee3ac519e418f801e718da4
- https://cdn.kernel.org/pub/linux/kernel/v5.x/ChangeLog-5.16
- https://github.com/torvalds/linux/commit/0a515a06c5ebfa46fee3ac519e418f801e718da4
- https://www.cve.org/CVERecord?id=CVE-2023-23003
comments:
  debian/bwh: |-
    This is user-space code, and the result of the missing check
    would be a segfault.  I don't see any security impact.
  masami: 'Introduced by commit cb94a02 ("perf metric: Restructure struct expr_parse_ctx.")
    in 5.16-rc1.'
introduced-by:
  mainline: [cb94a02e7494c001fa8b5a4c5e16693fafd98530]
fixed-by:
  mainline: [0a515a06c5ebfa46fee3ac519e418f801e718da4]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: Not affected
  cip/4.19-rt: Not affected
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
  cip/5.10: Not affected
  cip/5.10-rt: Not affected
  debian/buster-security: Not a security issue
  stable/4.14: Not affected
  stable/4.19: Not affected
  stable/5.10: Not affected
  stable/5.15: Not affected
  stable/5.4: Not affected
