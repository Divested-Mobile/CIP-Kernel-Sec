description: |-
  Due to a vulnerability in the io_uring subsystem, it is possible to leak
  kernel memory information to the user process. timens_install calls
  current_is_single_threaded to determine if the current process is
  single-threaded, but this call does not consider io_uring's io_worker
  threads, thus it is possible to insert a time namespace's vvar page to
  process's memory space via a page fault. When this time namespace is
  destroyed, the vvar page is also freed, but not removed from the process'
  memory, and a next page allocated by the kernel will be still available
  from the user-space process and can leak memory contents via this
  (read-only) use-after-free vulnerability. We recommend upgrading past
  version 5.10.161 or commit 788d0824269bef539fe31a785b1517882eafed93
  https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/io_uring
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-23586
- https://kernel.dance/#788d0824269bef539fe31a785b1517882eafed93
- https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/io_uring?h=linux-5.10.y&id=788d0824269bef539fe31a785b1517882eafed93
- https://www.linuxkernelcves.com/cves/CVE-2022-20424
- https://www.cve.org/CVERecord?id=CVE-2023-23586
comments:
  debian/carnil: |-
    Unclear if this is just a duplicate of CVE-2023-0240. Track it
    as different for now. The only CVE record references available
    are identical, but with different description of the issue.
  masami: It is linux 5.10.y bug
  ubuntu/mdeslaur: possibly a dupe of CVE-2023-0240
  ubuntu/sbeattie: |-
    according to linuxkernelcves, fixed by 4379bf8bd70b
      ("io_uring: remove io_identity"), but also they ave the CVE marked
      as rejected / withdrawn. This would also indicate it is a likely
      duplicate of CVE-2022-1786.
fixed-by:
  cip/5.10: [788d0824269bef539fe31a785b1517882eafed93]
  cip/5.10-rt: [788d0824269bef539fe31a785b1517882eafed93]
  mainline: [4379bf8bd70b5de6bba7d53015b0c36c57a634ee]
  stable/5.10: [788d0824269bef539fe31a785b1517882eafed93]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/4.19: never
  cip/4.19-rt: never
  cip/4.4: never
  cip/4.4-rt: never
  cip/4.4-st: never
  stable/4.14: never
  stable/4.19: never
  stable/5.4: never
