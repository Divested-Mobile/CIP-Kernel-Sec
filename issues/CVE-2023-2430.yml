description: 'io_uring/msg_ring: fix missing lock on overflow for IOPOLL'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2192175
- https://groups.google.com/g/syzkaller/c/T04q4HMUCdA/m/qVaOqv2RAAAJ
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2430
- https://lore.kernel.org/io-uring/Y8krlYa52%2F0YGqkg@ip-172-31-85-199.ec2.internal/
- https://git.kernel.org/linus/e12d7a46f65ae4b7d58a5e0c1cbfa825cf8d830d
- https://groups.google.com/g/syzkaller/c/T04q4HMUCdA/m/qVaOqv2RAAAJ?pli=1
- https://ubuntu.com/security/notices/USN-6192-1
- https://ubuntu.com/security/notices/USN-6194-1
- https://ubuntu.com/security/notices/USN-6235-1
- https://www.cve.org/CVERecord?id=CVE-2023-2430
comments:
  debian/bwh: |-
    The two instances of the bug were introduced in 6.0 by commit
    e6130eba8a84 "io_uring: add support for passing fixed file
    descriptors" and in 6.2-rc1 by commit 6d043ee1164c "io_uring:
    do msg_ring in target task via tw".
reporters:
- Xingyuan Mo
- Gengjia Chen
introduced-by:
  mainline: [4f57f06ce2186c31c3da52386125dc57b1cd6f96]
fixed-by:
  mainline: [e12d7a46f65ae4b7d58a5e0c1cbfa825cf8d830d]
  stable/6.1: [22a406b3629a10979916ea7cace47858410117b5]
  ubuntu/focal: ['version:5.4.0-9.12']
ignore:
  cip/linux-4.19: io_uring feature does not exist
  cip/linux-4.19-rt: io_uring feature does not exist
  cip/linux-4.4: io_uring feature does not exist
  cip/linux-4.4-rt: io_uring feature does not exist
  cip/linux-4.4-st: io_uring feature does not exist
  stable/4.14: io_uring feature does not exist
  stable/4.19: io_uring feature does not exist
