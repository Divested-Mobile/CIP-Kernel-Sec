description: 'Bluetooth: hci_conn_cleanup function has double free'
references:
- https://www.openwall.com/lists/oss-security/2023/03/28/2
- https://lore.kernel.org/lkml/20230309074645.74309-1-wzhmmmmm@gmail.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28464
- https://bugzilla.redhat.com/show_bug.cgi?id=2177759
- https://bugzilla.suse.com/show_bug.cgi?id=1209052
- https://lore.kernel.org/linux-bluetooth/20230330220332.1035910-1-luiz.dentz@gmail.com/
- https://syzkaller.appspot.com/bug?id=1bb51491ca5df96a5f724899d1dbb87afda61419
- https://www.cve.org/CVERecord?id=CVE-2023-28464
comments:
  debian/bwh: |-
    Introduced in 6.3 by commit 0f00cd322d22 "Bluetooth: Free
    potentially unfreed SCO connection" and backported to 6.1.25.
    Since the fix was also backported in 6.1.25, neither sid nor
    6.1-upstream-stable was ever affected.
  debian/carnil: |-
    Upstream commit a85fb91e3d72 ("Bluetooth: Fix double free in
    hci_conn_cleanup") in 6.7-rc1 and backported to 6.6.3, 6.5.13,
    6.1.64, 5.10.202 and 4.19.300 as well claim to fix the CVE.
    Unclear if this is a followup fix needed to completely fix the
    CVE, thus for now not considering it for tracking the fixed
    version. The fix will be pulled in the next round of updates
    anyway.
  masami: It looks as if all LTS kernels are affected.
  ubuntu/sbeattie: |-
    both the introducing commit 0f00cd322d22 ("Bluetooth:
      Free potentially unfreed SCO connection") and the fixing commit
      5dc7d23e167e ("Bluetooth: hci_conn: Fix possible UAF") were pulled
      into the upstream stable v6.2.12 kernel, so 6.2.y kernel users
      were never affected by this issue.
    Upstream commit a85fb91e3d72 ("Bluetooth: Fix double free
      in hci_conn_cleanup") (6.7-rc1) also claims to fix this CVE,
      not clear if this is a typo or was a followup fix, because the
      original was incomplete.
reporters:
- Zhenghan Wang
introduced-by:
  cip/6.1: [4290d89ae93438ee1430da3fc7bf528e7950db74]
  cip/6.1-rt: [4290d89ae93438ee1430da3fc7bf528e7950db74]
  mainline: [0f00cd322d22d4441de51aa80bcce5bb6a8cbb44]
  stable/6.1: [4290d89ae93438ee1430da3fc7bf528e7950db74]
  stable/6.2: [ac9f4bac140f89e996bc97c8989dd1ba324ea39b]
fixed-by:
  cip/6.1: [8c4b65f6c707bc07cbcd871667b5056821c5685d]
  cip/6.1-rt: [8c4b65f6c707bc07cbcd871667b5056821c5685d]
  mainline: [5dc7d23e167e2882ef118456ceccd57873e876d8]
  stable/6.1: [8c4b65f6c707bc07cbcd871667b5056821c5685d]
  stable/6.2: [dba0f922d57408fdbd32b9964fcca1d3f1acc9c2]
  ubuntu/focal: ['version:5.4.0-9.12']
