description: 'net: tls: fix possible race condition between do_tls_getsockopt_conf()
  and do_tls_setsockopt_conf()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28466
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit?id=49c47cc21b5b7a3d8deb18fc57b0aa2ab1286962
- https://bugzilla.redhat.com/show_bug.cgi?id=2179000
- https://bugzilla.suse.com/show_bug.cgi?id=1209366
- https://ubuntu.com/security/notices/USN-6033-1
- https://ubuntu.com/security/notices/USN-6175-1
- https://ubuntu.com/security/notices/USN-6186-1
- https://ubuntu.com/security/notices/USN-6284-1
- https://ubuntu.com/security/notices/USN-6300-1
- https://ubuntu.com/security/notices/USN-6301-1
- https://ubuntu.com/security/notices/USN-6311-1
- https://ubuntu.com/security/notices/USN-6312-1
- https://ubuntu.com/security/notices/USN-6314-1
- https://ubuntu.com/security/notices/USN-6331-1
- https://ubuntu.com/security/notices/USN-6332-1
comments:
  debian/carnil: |-
    source-wise affecting all suites, but we enable CONFIG_TLS only
    since bookworm.
  masami: 'Introduced by commit 3c4d755 ("tls: kernel TLS support") in 4.13-rc1.'
introduced-by:
  mainline: [3c4d7559159bfe1e3b94df3a657b2cda3a34e218]
fixed-by:
  cip/5.10: [1fde5782f187daa05919d2bebd872df8ebcc00d1]
  cip/5.10-rt: [1fde5782f187daa05919d2bebd872df8ebcc00d1]
  cip/6.1: [14c17c673e1bba08032d245d5fb025d1cbfee123]
  cip/6.1-rt: [14c17c673e1bba08032d245d5fb025d1cbfee123]
  mainline: [49c47cc21b5b7a3d8deb18fc57b0aa2ab1286962]
  stable/5.10: [1fde5782f187daa05919d2bebd872df8ebcc00d1]
  stable/5.15: [0b54d75aa43a1edebc8a3770901f5c3557ee0daa]
  stable/5.4: [754838aa02050ff3d8675bef79d172097218ea71]
  stable/6.1: [14c17c673e1bba08032d245d5fb025d1cbfee123]
  stable/6.2: [5231fa057bb0e52095591b303cf95ebd17bc62ce]
  ubuntu/focal: [62c63e95f71f677784ef667766cf7e42cd567f15]
ignore:
  cip/4.4: Not affected
  cip/4.4-rt: Not affected
  cip/4.4-st: Not affected
