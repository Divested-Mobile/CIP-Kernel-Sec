description: 'KVM: nVMX: add missing consistency checks for CR0 and CR4'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30456
- https://git.kernel.org/linus/112e66017bff7f2837030f34c2bc19501e9212d5
- https://github.com/torvalds/linux/commit/112e66017bff7f2837030f34c2bc19501e9212d5
- https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.2.8
- https://bugzilla.suse.com/show_bug.cgi?id=1210294
- https://ubuntu.com/security/notices/USN-6033-1
comments:
  masami: "The nested_vmx_check_guest_state() in arch/x86/kvm/vmx/nested.c was first\n\
    introduced by commit 55d2375 (\"KVM: nVMX: Move nested code to dedicated files\"\
    )\nin 5.0-rc1. That time the function name was check_vmentry_prereqs().  \nThen\
    \ check_vmentry_prereqs() was renamed to nested_vmx_check_vmentry_prereqs()\n\
    by commit 16322a3 (\"KVM: nVMX: Prepend \"nested_vmx_\" to check_vmentry_{pre,post}reqs()\"\
    ).  \nFinally, the nested_vmx_check_vmentry_prereqs() was renamed to nested_vmx_check_host_state().\n\
    Before 5.0-rc1, vulnerable code is not found so they are not affected by this\
    \ issue."
reporters:
- Reima Ishii
introduced-by:
  mainline: [384bb783275145b70d769acf4c687957d1c61802]
fixed-by:
  cip/4.19: [495adb06518bb10f50e1aa1a1dbd5daa47d118f2]
  cip/5.10: [c54974ccaff73525462e278602dfe4069877cfaa]
  mainline: [112e66017bff7f2837030f34c2bc19501e9212d5]
  stable/4.19: [495adb06518bb10f50e1aa1a1dbd5daa47d118f2]
  stable/5.10: [c54974ccaff73525462e278602dfe4069877cfaa]
  stable/5.15: [9c2f09add608a505f0e5fb694805f4766801583f]
  stable/5.4: [65e4c9a6d0c9a8c81ce75576869d46fff5d7964f]
  stable/6.1: [4bba9c8adec804f03d12dc762e50d083ee88b6b0]
  stable/6.2: [71d05b9fa0bfc131a6e2250dea045a818ff25550]
