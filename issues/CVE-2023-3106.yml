description: |-
  A NULL pointer dereference vulnerability was found in netlink_dump. This
  issue can occur when the Netlink socket receives the message(sendmsg) for
  the XFRM_MSG_GETSA, XFRM_MSG_GETPOLICY type message, and the DUMP flag is
  set and can cause a denial of service or possibly another unspecified
  impact. Due to the nature of the flaw, privilege escalation cannot be fully
  ruled out, although it is unlikely.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3106
- https:/git.kernel.org/linus/1ba5bf993c6a3142e18e68ea6452b347f9cb5635
- https://bugzilla.redhat.com/show_bug.cgi?id=2221501
- https://github.com/torvalds/linux/commit/1ba5bf993c6a3142e18e68ea6452b347f9cb5635
- https://access.redhat.com/security/cve/CVE-2023-3106
comments:
  masami: |-
    This bug was introduced by commit d362309 ("ipsec: add support
    of limited SA dump") in 3.15-rc1 and fixed by commit 1ba5bf9
    ("xfrm: fix crash in XFRM_MSG_GETSA netlink handler") in
    4.8-rc7. So, It only affects cip/4.4, cip/4.4-rt, and
    cip/4.4-st. It was fixed in 4.4.223.
introduced-by:
  mainline: [d3623099d3509fa68fa28235366049dd3156c63a]
fixed-by:
  aosp/3.18: [36fb8dc78bbc19605ace4dc0fcdbd4041a39334b]
  cip/4.4: [0cbb0084fa2b444b7316a0967a0d93f5ae520216]
  cip/4.4-rt: [0cbb0084fa2b444b7316a0967a0d93f5ae520216]
  cip/4.4-st: [0cbb0084fa2b444b7316a0967a0d93f5ae520216]
  debian/buster-security: ['version:debian/4.8.5-1']
  debian/stretch-security: ['version:debian/4.8.5-1']
  mainline: [1ba5bf993c6a3142e18e68ea6452b347f9cb5635]
  stable/4.4: [0cbb0084fa2b444b7316a0967a0d93f5ae520216]
  ubuntu/focal: ['version:5.4.0-153.170']
  ubuntu/xenial: [17ed63ed2ee8d30baa2dc150ba971d247b499011]
