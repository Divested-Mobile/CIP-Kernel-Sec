description: 'BUG: general protection fault in hci_uart_tty_ioctl'
references:
- https://lore.kernel.org/all/CA+UBctC3p49aTgzbVgkSZ2+TQcqq4fPDO7yZitFT5uBPDeCO2g@mail.gmail.com/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31083
- https://bugzilla.redhat.com/show_bug.cgi?id=2213132
- https://bugzilla.suse.com/show_bug.cgi?id=1210780
- https://git.kernel.org/bluetooth/bluetooth-next/c/ff1b86784849
- https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=ff1b86784849f8e181641610f0acb4b77da7501d
- https://ubuntu.com/security/notices/USN-6439-1
- https://ubuntu.com/security/notices/USN-6440-1
- https://ubuntu.com/security/notices/USN-6440-2
- https://ubuntu.com/security/notices/USN-6439-2
- https://ubuntu.com/security/notices/USN-6440-3
- https://ubuntu.com/security/notices/USN-6462-1
- https://ubuntu.com/security/notices/USN-6464-1
- https://ubuntu.com/security/notices/USN-6465-1
- https://ubuntu.com/security/notices/USN-6466-1
- https://ubuntu.com/security/notices/USN-6465-2
- https://ubuntu.com/security/notices/USN-6462-2
- https://ubuntu.com/security/notices/USN-6465-3
- https://ubuntu.com/security/notices/USN-6516-1
- https://ubuntu.com/security/notices/USN-6520-1
- https://www.cve.org/CVERecord?id=CVE-2023-31083
comments:
  debian/bwh: 'Introduced in 2.6.26 by commit 04f378b198da "tty: BKL pushdown".'
  ubuntu/sbeattie: |-
    bluetooth-next commit is ff1b86784849 ("Bluetooth:
      hci_ldisc: check HCI_UART_PROTO_READY flag in HCIUARTGETPROTO")
    fix has not yet landed in linus' tree as of 2023.07.18
reporters:
- Yu Hao
- Weiteng Chen
fixed-by:
  cip/4.19: [aea24ef5e9b2bbc5d5d05e39b10573971b91241c]
  cip/4.19-rt: [aea24ef5e9b2bbc5d5d05e39b10573971b91241c]
  cip/6.1: [c06e7c45a743ac8222af2a348e5d9e26e31bfcc1]
  cip/6.1-rt: [c06e7c45a743ac8222af2a348e5d9e26e31bfcc1]
  mainline: [9c33663af9ad115f90c076a1828129a3fbadea98]
  stable/4.19: [aea24ef5e9b2bbc5d5d05e39b10573971b91241c]
  stable/5.10: [56b82e6ff3f55ed41d619bd181c2a684b5371e1d]
  stable/5.15: [c6a73b7469f096016a55065157cd11906d81e062]
  stable/5.4: [7732c54f2b41dac9a55e4e12de9691f6f93bf91a]
  stable/6.1: [c06e7c45a743ac8222af2a348e5d9e26e31bfcc1]
  ubuntu/focal: [fa2c9d65d8d6340345688b4d0d2bd8b65bac90f9]
