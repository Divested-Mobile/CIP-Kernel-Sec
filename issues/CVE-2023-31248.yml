description: nf_tables UAF when using nft_chain_lookup_byid
references:
- https://www.openwall.com/lists/oss-security/2023/07/05/2
- https://lore.kernel.org/netfilter-devel/20230705121627.GC19489@breakpoint.cc/T/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31248
- https://git.kernel.org/pub/scm/linux/kernel/git/netfilter/nf.git/commit/?id=515ad530795c118f012539ed76d02bacfd426d89
- https://www.zerodayinitiative.com/advisories/ZDI-23-899/
- https://ubuntu.com/security/notices/USN-6246-1
- https://ubuntu.com/security/notices/USN-6247-1
- https://ubuntu.com/security/notices/USN-6248-1
- https://ubuntu.com/security/notices/USN-6250-1
- https://ubuntu.com/security/notices/USN-6255-1
- https://ubuntu.com/security/notices/USN-6260-1
comments:
  debian/carnil: |-
    Issue introduced with 837830a4b439 ("netfilter: nf_tables: add
    NFTA_RULE_CHAIN_ID attribute") in 5.9-rc1.
    For 6.4.y fixed as well in 6.4.4.
  masami: |-
    Commit 837830a4b439 ("netfilter: nf_tables: add
    NFTA_RULE_CHAIN_ID attribute") is not backported to
    stable kernels. So, 4.4, 4.14, 4.19, and 5.4 are not
    affected.
  ubuntu/eslerm: |-
    reporter at Pwn2Own 2023 as ZDI-CAN-20717
    CWE-416
  ubuntu/sbeattie: |-
    requires CAP_NET_ADMIN in any namespace, not just the init
      namespace.
reporters:
- Mingi Cho
introduced-by:
  mainline: [837830a4b439bfeb86c70b0115c280377c84714b]
fixed-by:
  cip/6.1: [fc95c8b02c6160936f1f3d8d9d7f4f66f3c84b49]
  mainline: [515ad530795c118f012539ed76d02bacfd426d89]
  stable/5.10: [4ae2e501331aaa506eaf760339bb2f43e5769395]
  stable/5.15: [041e2ac88caef286b39064e83e825e3f53113d36]
  stable/6.1: [fc95c8b02c6160936f1f3d8d9d7f4f66f3c84b49]
  stable/6.4: [5e5e967e8505fbdabfb6497367ec1b808cadc356]
  ubuntu/focal: ['version:5.4.0-9.12']
