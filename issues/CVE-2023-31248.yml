description: nf_tables UAF when using nft_chain_lookup_byid
references:
- https://www.openwall.com/lists/oss-security/2023/07/05/2
- https://lore.kernel.org/netfilter-devel/20230705121627.GC19489@breakpoint.cc/T/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-31248
comments:
  debian/carnil: |-
    Issue introduced with 837830a4b439 ("netfilter: nf_tables: add
    NFTA_RULE_CHAIN_ID attribute") in 5.9-rc1.
  masami: |-
    Commit 837830a4b439 ("netfilter: nf_tables: add
    NFTA_RULE_CHAIN_ID attribute") is not backported to
    stable kernels. So, 4.4, 4.14, 4.19, and 5.4 are not
    affected.
introduced-by:
  mainline: [837830a4b439bfeb86c70b0115c280377c84714b]
