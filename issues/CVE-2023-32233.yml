description: 'netfilter: nf_tables: deactivate anonymous set from preparation phase'
references:
- https://www.openwall.com/lists/oss-security/2023/05/08/4
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32233
- https://github.com/torvalds/linux/commit/c1592a89942e9678f7d9c8030efa777c0d57edab
- https://www.openwall.com/lists/oss-security/2023/05/15/5
- https://ubuntu.com/security/notices/USN-6122-1
- https://ubuntu.com/security/notices/USN-6123-1
- https://ubuntu.com/security/notices/USN-6124-1
- https://ubuntu.com/security/notices/USN-6127-1
- https://ubuntu.com/security/notices/USN-6130-1
- https://ubuntu.com/security/notices/USN-6131-1
- https://ubuntu.com/security/notices/USN-6132-1
- https://ubuntu.com/security/notices/USN-6135-1
- https://ubuntu.com/security/notices/USN-6149-1
- https://ubuntu.com/security/notices/USN-6150-1
- https://ubuntu.com/security/notices/USN-6162-1
- https://ubuntu.com/security/notices/USN-6175-1
- https://ubuntu.com/security/notices/USN-6186-1
- https://ubuntu.com/security/notices/USN-6222-1
- https://ubuntu.com/security/notices/USN-6256-1
- https://www.cve.org/CVERecord?id=CVE-2023-32233
comments:
  masami: |-
    Introduced by commit 20a6934 ("netfilter: nf_tables: add netlink set API")
    in 3.13-rc1.
  ubuntu/cascardo: |-
    requires CAP_NET_ADMIN, however this can be done within a new
     user namespace and network namespace - so can be mitigated by disabling
     unprivileged user namespaces.
reporters:
- Patryk Sondej
- Piotr Krysiuk
introduced-by:
  mainline: [20a69341f2d00cd042e81c82289fba8a13c05a25]
fixed-by:
  cip/4.19: [c6989314fd809c5eaf4980d6fa474f19fc653d6c]
  cip/4.19-rt: [c6989314fd809c5eaf4980d6fa474f19fc653d6c]
  cip/5.10: [e044a24447189419c3a7ccc5fa6da7516036dc55]
  cip/5.10-rt: [e044a24447189419c3a7ccc5fa6da7516036dc55]
  cip/6.1: [4507918cd1f8b80f21a396fa0531d53e372bed66]
  cip/6.1-rt: [4507918cd1f8b80f21a396fa0531d53e372bed66]
  debian/buster-security: ['version:debian/4.19.289-1']
  mainline: [c1592a89942e9678f7d9c8030efa777c0d57edab]
  stable/4.19: [c6989314fd809c5eaf4980d6fa474f19fc653d6c]
  stable/5.10: [e044a24447189419c3a7ccc5fa6da7516036dc55]
  stable/5.15: [21c2a454486d5e9c1517ecca19266b3be3df73ca]
  stable/5.4: [c8b6063f13add68f89540aa5030ceee875f48aa2]
  stable/6.1: [4507918cd1f8b80f21a396fa0531d53e372bed66]
  stable/6.2: [6b0801dcc1aa4373d28ac8ee396788d2e715c495]
  stable/6.3: [f8486683ffa30456e0be4290282a44c4459a3287]
  ubuntu/bionic: [fab948a6193a102bf152cdfaa0144b0f939c3af8, e36f1862df7a4bf214d0553dff0c8316954d05e0,
    d0b03ebf70043039b48305630e933a0ee97edb8b, a758b374627407b4a79e210fa2e2f723ee1774ca,
    9505a1df9628e67a67554a6e8820ca29b87fc07e, a1ae8c46dd300df2923e88226ac29895f70b7f66,
    97cb26edfd2772ceabb1941e8825609f5d2fdd25, f732c2cc74953cf7e40d4fb3cc1719b9c97e9d97]
  ubuntu/focal: [da5e5af9c0469a0b609c294fa93ab868b896f58f]
