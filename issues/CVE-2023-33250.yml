description: a use-after-free bug was found in iopt_unmap_iova_range
references:
- https://groups.google.com/g/syzkaller/c/G6P9yecsTZ8/m/iiqFVOM9BwAJ
- https://lore.kernel.org/linux-iommu/ZDabT%2FuRl%2FjxFhm0%40ip-172-31-85-199.ec2.internal/T/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33250
- https://lore.kernel.org/linux-iommu/ZDabT%2FuRl%2FjxFhm0@ip-172-31-85-199.ec2.internal/T/
comments:
  debian/bwh: |-
    The use-after-free is the unlocked read of area->num_accesses,
    introduced in 6.2 by commit 8d40205f6093 "iommufd: Add kAPI
    toward external drivers for kernel access".
  debian/carnil: Fixed as well in 6.4.4 for 6.4.y.
  masami: |-
    It introduced by commit 51fe614 ("iommufd: Data structure to
    provide IOVA to PFN mapping") in 6.2-rc1. Before Linux 6.2 are not
    affected.
  ubuntu/cascardo: vulnerability requires access to /dev/iommu, which is limited to
    root
introduced-by:
  mainline: [51fe6141f0f64ae0bbc096a41a07572273e8c0ef]
fixed-by:
  mainline: [dbe245cdf5189e88d680379ed13901356628b650, 804ca14d04df09bf7924bacc5ad22a4bed80c94f]
  stable/6.4: [dbe65261fe1367dc307a89466a1a75c0d80b8233, 19d93648142a4cfe5bf36278f3beee582605cd01]
  ubuntu/focal: ['version:5.4.0-9.12']
