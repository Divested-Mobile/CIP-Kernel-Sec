description: |-
  An issue was discovered in set_con2fb_map in
  drivers/video/fbdev/core/fbcon.c in the Linux kernel before 6.2.12. Because
  an assignment occurs only for the first vc, the fbcon_registered_fb and
  fbcon_display arrays can be desynchronized in fbcon_mode_deleted (the
  con2fb_map points at the old fb_info).
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38409
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit?id=fffb0b52d5258554c645c966c6cbef7de50b851d
- https://cdn.kernel.org/pub/linux/kernel/v6.x/ChangeLog-6.2.12
- https://www.cve.org/CVERecord?id=CVE-2023-38409
comments:
  debian/carnil: |-
    Commit fixes d443d9386472 ("fbcon: move more common code into
    fb_open()") in 5.19-rc1.
  masami: |-
    Introduced by commit d443d93 ("fbcon: move more common code
    into nfb_open()") in 5.19-rc1. This patch is not backported
    to older stable kernels. so, before 5.19 kernels aren't
    affected.
introduced-by:
  mainline: [d443d93864726ad68c0a741d1e7b03934a9af143]
fixed-by:
  cip/6.1: [b15df140fe092c3ac28dab32c6b3acdda1a93c63]
  cip/6.1-rt: [b15df140fe092c3ac28dab32c6b3acdda1a93c63]
  mainline: [fffb0b52d5258554c645c966c6cbef7de50b851d]
  stable/6.1: [b15df140fe092c3ac28dab32c6b3acdda1a93c63]
  ubuntu/focal: ['version:5.4.0-9.12']
