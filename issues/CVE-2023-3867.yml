description: 'ksmbd: add missing compound request handing in some commands'
references:
- https://www.zerodayinitiative.com/advisories/ZDI-23-981/
- https://lore.kernel.org/all/20230624040141.16088-1-linkinjeon@kernel.org/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3867
- https://git.kernel.org/linus/7b7d709ef7cf285309157fb94c33f625dd22c5e1
- https://ubuntu.com/security/notices/USN-6464-1
- https://ubuntu.com/security/notices/USN-6466-1
- https://ubuntu.com/security/notices/USN-6520-1
- https://ubuntu.com/security/notices/USN-6725-1
- https://www.cve.org/CVERecord?id=CVE-2023-3867
comments:
  masami: |-
    This vulnerability was introduced by commit 7b7d709e("ksmbd: add
    missing compound request handing in some commands") in 6.5-rc1.
  ubuntu/rodrigo-zaiden: |-
    also known as ZDI-23-981, ZDI-CAN-21355
    needs ksmbd-tools installed to enable the service, which is
     not installed by default.
reporters:
- HexRabbit (@h3xr4bb1t)
- Pumpkin (@u1f383)
introduced-by:
  cip/6.1: [869ef4f2965bbb91157dad220133f76c16faba9b]
  cip/6.1-rt: [869ef4f2965bbb91157dad220133f76c16faba9b]
  mainline: [7b7d709ef7cf285309157fb94c33f625dd22c5e1]
  stable/5.15: [97f5c1e3086c8ba1473c265d9a5523cc9ef5579e]
  stable/6.1: [869ef4f2965bbb91157dad220133f76c16faba9b]
  stable/6.4: [ffaa0c85edd9245594a94918c09db9163b71767a]
fixed-by:
  cip/6.1: [869ef4f2965bbb91157dad220133f76c16faba9b]
  cip/6.1-rt: [869ef4f2965bbb91157dad220133f76c16faba9b]
  mainline: [7b7d709ef7cf285309157fb94c33f625dd22c5e1]
  stable/5.15: [97f5c1e3086c8ba1473c265d9a5523cc9ef5579e]
  stable/6.1: [869ef4f2965bbb91157dad220133f76c16faba9b]
  stable/6.4: [ffaa0c85edd9245594a94918c09db9163b71767a]
  ubuntu/focal: ['version:5.4.0-9.12']
