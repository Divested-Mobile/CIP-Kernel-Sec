description: '[netfilter: nf_tables: disallow rule addition to bound chain via NFTA_RULE_CHAIN_ID]'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3995
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0ebc1064e4874d5987722a2ddbc18f94aa53b211
- https://google.github.io/security-research/kernelctf/rules
- https://patchwork.ozlabs.org/project/netfilter-devel/patch/20230723144148.26231-1-pablo@netfilter.org/
- https://ubuntu.com/security/notices/USN-6315-1
- https://ubuntu.com/security/notices/USN-6316-1
- https://ubuntu.com/security/notices/USN-6318-1
- https://ubuntu.com/security/notices/USN-6321-1
- https://ubuntu.com/security/notices/USN-6325-1
- https://ubuntu.com/security/notices/USN-6328-1
- https://ubuntu.com/security/notices/USN-6330-1
- https://ubuntu.com/security/notices/USN-6332-1
- https://ubuntu.com/security/notices/USN-6348-1
- https://ubuntu.com/security/notices/USN-6385-1
- https://www.cve.org/CVERecord?id=CVE-2023-3995
comments:
  masami: |-
    This bug was introduced by commit d0e2c7d ("netfilter: nf_tables:
    add NFT_CHAIN_BINDING") in 5.9-rc1. Before 5.9 kernels are not
    affected.
  ubuntu/rodrigo-zaiden: |-
    Google kCTF submission
    same fix commit as CVE-2023-4147, one or the other will
     likely be marked as duplicated.
reporters:
- Kevin Rich
introduced-by:
  mainline: [d0e2c7de92c7f2b3d355ad76b0bb9fc43d1beb87]
fixed-by:
  cip/5.10: [308a43f1521d5b7220693d0865b23e8dad3ed137]
  cip/5.10-rt: [308a43f1521d5b7220693d0865b23e8dad3ed137]
  cip/6.1: [268cb07ef3ee17b5454a7c4b23376802c5b00c79]
  cip/6.1-rt: [268cb07ef3ee17b5454a7c4b23376802c5b00c79]
  mainline: [0ebc1064e4874d5987722a2ddbc18f94aa53b211]
  stable/5.10: [308a43f1521d5b7220693d0865b23e8dad3ed137]
  stable/5.15: [5bee91121ccea8d69cea51632e9a1dd348ee49a1]
  stable/6.1: [268cb07ef3ee17b5454a7c4b23376802c5b00c79]
  stable/6.4: [14448359681062bf51d9c67e0264869548b79853]
  ubuntu/focal: ['version:5.4.0-9.12']
