description: 'netfilter: nf_tables: skip immediate deactivate in _PREPARE_ERROR'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4015
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2
- https://google.github.io/security-research/kernelctf/rules
comments:
  masami: |-
    This bug was introduced by commit 4bedf9e ("netfilter: nf_tables:
    fix chain binding transaction logic") in 6.4. This patch was
    backported to 5.10, 5.15, and 6.1. So 4.4, 4.14, 4.19, and 5.4
    are not affected.
  ubuntu/rodrigo-zaiden: Google kCTF submission
reporters:
- Kevin Rich
introduced-by:
  cip/6.1: [891cd2edddc76c58e842706ad27e2ff96000bd5d]
  cip/6.1-rt: [891cd2edddc76c58e842706ad27e2ff96000bd5d]
  mainline: [4bedf9eee016286c835e3d8fa981ddece5338795]
  stable/5.10: [d53c295c1f43b7460d28ba0f0f98a602084fdcb6]
  stable/5.15: [314a8697d08092df6d00521450d44c352c602943]
  stable/6.1: [891cd2edddc76c58e842706ad27e2ff96000bd5d]
fixed-by:
  mainline: [0a771f7b266b02d262900c75f1e175c7fe76fec2]
  stable/5.15: [98bcfcaecc76c4be288278c213b47d36292f40fa]
  stable/6.1: [4237462a073e24f71c700f3e5929f07b6ee1bcaa]
  stable/6.4: [027d00132487bcf2a4ee7493bb8de9d6331d48e3]
  ubuntu/focal: ['version:5.4.0-9.12']
