description: 'netfilter: nf_tables: skip immediate deactivate in _PREPARE_ERROR'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4015
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0a771f7b266b02d262900c75f1e175c7fe76fec2
- https://google.github.io/security-research/kernelctf/rules
- https://patchwork.ozlabs.org/project/netfilter-devel/patch/20230723142446.13809-1-pablo@netfilter.org/
- https://ubuntu.com/security/notices/USN-6315-1
- https://ubuntu.com/security/notices/USN-6316-1
- https://ubuntu.com/security/notices/USN-6318-1
- https://ubuntu.com/security/notices/USN-6321-1
- https://ubuntu.com/security/notices/USN-6325-1
- https://ubuntu.com/security/notices/USN-6328-1
- https://ubuntu.com/security/notices/USN-6330-1
- https://ubuntu.com/security/notices/USN-6332-1
- https://ubuntu.com/security/CVE-2023-4015
- https://ubuntu.com/security/notices/USN-6348-1
- https://ubuntu.com/security/notices/USN-6385-1
- https://www.cve.org/CVERecord?id=CVE-2023-4015
comments:
  debian/carnil: |-
    Commit fixes 4bedf9eee016 ("netfilter: nf_tables: fix chain
    binding transaction logic") in 6.4 (but backported to 5.10.188,
    6.1.36, 6.3.10).
  masami: |-
    This bug was introduced by commit 4bedf9e ("netfilter: nf_tables:
    fix chain binding transaction logic") in 6.4. This patch was
    backported to 5.10, 5.15, and 6.1. So 4.4, 4.14, 4.19, and 5.4
    are not affected.
  ubuntu/rodrigo-zaiden: Google kCTF submission
reporters:
- Kevin Rich
introduced-by:
  cip/5.10: [d53c295c1f43b7460d28ba0f0f98a602084fdcb6]
  cip/5.10-rt: [d53c295c1f43b7460d28ba0f0f98a602084fdcb6]
  cip/6.1: [891cd2edddc76c58e842706ad27e2ff96000bd5d]
  cip/6.1-rt: [891cd2edddc76c58e842706ad27e2ff96000bd5d]
  mainline: [4bedf9eee016286c835e3d8fa981ddece5338795]
  stable/5.10: [d53c295c1f43b7460d28ba0f0f98a602084fdcb6]
  stable/5.15: [314a8697d08092df6d00521450d44c352c602943]
  stable/6.1: [891cd2edddc76c58e842706ad27e2ff96000bd5d]
fixed-by:
  cip/5.10: [ab5a97a94b57324df76d659686ac2d30494170e6]
  cip/5.10-rt: [ab5a97a94b57324df76d659686ac2d30494170e6]
  cip/6.1: [4237462a073e24f71c700f3e5929f07b6ee1bcaa]
  cip/6.1-rt: [4237462a073e24f71c700f3e5929f07b6ee1bcaa]
  mainline: [0a771f7b266b02d262900c75f1e175c7fe76fec2]
  stable/5.10: [ab5a97a94b57324df76d659686ac2d30494170e6]
  stable/5.15: [98bcfcaecc76c4be288278c213b47d36292f40fa]
  stable/6.1: [4237462a073e24f71c700f3e5929f07b6ee1bcaa]
  stable/6.4: [027d00132487bcf2a4ee7493bb8de9d6331d48e3]
  ubuntu/focal: ['version:5.4.0-9.12']
