description: 'net/sched: cls_route: No longer copy tcf_result on update to avoid use-after-free'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4206
- https://kernel.dance/b80b829e9e2c1b3f7aae34855e04d8f6ecaf13c8
- https://git.kernel.org/linus/b80b829e9e2c1b3f7aae34855e04d8f6ecaf13c8
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b80b829e9e2c1b3f7aae34855e04d8f6ecaf13c8
- https://bugzilla.redhat.com/show_bug.cgi?id=2237757
- https://bugzilla.suse.com/show_bug.cgi?id=1215110
- https://www.cve.org/CVERecord?id=CVE-2023-4206
comments:
  debian/carnil: |-
    CVE-2023-4206 is from Google CNA a subset of CVE-2023-4128
    assigned by RedHat CNA.
    For 6.4.y fixed in 6.4.10.
  masami: |-
    Introduced by commit 1109c00 ("net: sched: RCU cls_route")
    in 3.18-rc1.
  ubuntu/rodrigo-zaiden: |-
    fix commit also present in CVE-2023-4128, likely to be
     marked as duplicated.
reporters:
- Bing-Jhong Billy Jheng
introduced-by:
  mainline: [1109c00547fc66df45b9ff923544be4c1e1bec13]
fixed-by:
  cip/4.19: [ad8f36f96696a7f1d191da66637c415959bab6d8]
  cip/4.19-rt: [ad8f36f96696a7f1d191da66637c415959bab6d8]
  cip/4.4: [f13ddbb280791059443275cc349a4a4e83a47b25]
  cip/4.4-rt: [f13ddbb280791059443275cc349a4a4e83a47b25]
  cip/4.4-st: [f13ddbb280791059443275cc349a4a4e83a47b25]
  cip/5.10: [aaa71c4e8ad98828ed50dde3eec8e0d545a117f7]
  cip/5.10-rt: [aaa71c4e8ad98828ed50dde3eec8e0d545a117f7]
  cip/6.1: [d4d3b53a4c66004e8e864fea744b3a2b86a73b62]
  cip/6.1-rt: [d4d3b53a4c66004e8e864fea744b3a2b86a73b62]
  debian/buster-security: ['version:debian/4.19.304-1']
  mainline: [b80b829e9e2c1b3f7aae34855e04d8f6ecaf13c8]
  openela/4.14: [226d84d54a9339b7045aff36c8f56d6ee9270476]
  stable/4.14: [226d84d54a9339b7045aff36c8f56d6ee9270476]
  stable/4.19: [ad8f36f96696a7f1d191da66637c415959bab6d8]
  stable/5.10: [aaa71c4e8ad98828ed50dde3eec8e0d545a117f7]
  stable/5.15: [79c3d81c9ad140957b081c91908d7e2964dc603f]
  stable/5.4: [1c8262f31fd2d23d1cfd2539715d976c2a99e582]
  stable/6.1: [d4d3b53a4c66004e8e864fea744b3a2b86a73b62]
  stable/6.4: [a836184b670f59e24d3a0f7c07115ec6e6ce6900]
  ubuntu/focal: [3720637211499c50727d43a7c8a1ab4bea4cb0a6]
