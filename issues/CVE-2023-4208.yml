description: 'net/sched: cls_u32: No longer copy tcf_result on update to avoid use-after-free'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4208
- https://kernel.dance/3044b16e7c6fe5d24b1cdbcf1bd0a9d92d1ebd81
- https://git.kernel.org/linus/3044b16e7c6fe5d24b1cdbcf1bd0a9d92d1ebd81
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=3044b16e7c6fe5d24b1cdbcf1bd0a9d92d1ebd81
- https://bugzilla.redhat.com/show_bug.cgi?id=2237757
- https://bugzilla.suse.com/show_bug.cgi?id=1215114
- https://www.cve.org/CVERecord?id=CVE-2023-4208
comments:
  debian/carnil: |-
    CVE-2023-4208 is from Google CNA a subset of CVE-2023-4128
    assigned by RedHat CNA.
    For 6.4.y fixed in 6.4.10.
  masami: |-
    Introdcued by commit de5df63 ("net: sched: cls_u32 changes to
    knode must appear atomic to readers") in 3.18-rc1.
  ubuntu/rodrigo-zaiden: |-
    fix commit also present in CVE-2023-4128, likely to be
     marked as duplicated.
reporters:
- M A Ramdhan
introduced-by:
  mainline: [de5df63228fcfbd5bb7fd883774c18fec9e61f12]
fixed-by:
  cip/4.19: [4aae24015ecd70d824a953e2dc5b0ca2c4769243]
  cip/4.19-rt: [4aae24015ecd70d824a953e2dc5b0ca2c4769243]
  cip/4.4: [e11876eead5c0232289922cc6142992dd50692c7]
  cip/4.4-rt: [e11876eead5c0232289922cc6142992dd50692c7]
  cip/4.4-st: [e11876eead5c0232289922cc6142992dd50692c7]
  cip/5.10: [b4256c99a7116c9514224847e8aaee2ecf110a0a]
  cip/5.10-rt: [b4256c99a7116c9514224847e8aaee2ecf110a0a]
  cip/6.1: [aab2d095ce4dd8d01ca484c0cc641fb497bf74db]
  cip/6.1-rt: [aab2d095ce4dd8d01ca484c0cc641fb497bf74db]
  debian/buster-security: ['version:debian/4.19.304-1']
  mainline: [3044b16e7c6fe5d24b1cdbcf1bd0a9d92d1ebd81]
  openela/4.14: [f0f874147a5b00eae875c24281531f8de7900079]
  stable/4.14: [f0f874147a5b00eae875c24281531f8de7900079]
  stable/4.19: [4aae24015ecd70d824a953e2dc5b0ca2c4769243]
  stable/5.10: [b4256c99a7116c9514224847e8aaee2ecf110a0a]
  stable/5.15: [262430dfc618509246e07acd26211cb4cca79ecc]
  stable/5.4: [be785808db32b595728c4042d002c83d0dd4b66f]
  stable/6.1: [aab2d095ce4dd8d01ca484c0cc641fb497bf74db]
  stable/6.4: [4b717802428fa02cbcbb61209f638f65f9cd4710]
  ubuntu/focal: [2dab4f63f2866d1f40c32eec280fb0eb55fc77d0]
