description: |-
  A use-after-free vulnerability in the Linux kernel's netfilter: nf_tables
  component can be exploited to achieve local privilege escalation.
  Due to a race condition between nf_tables netlink control plane transaction
  and nft_set element garbage collection, it is possible to underflow the
  reference counter causing a use-after-free vulnerability.
  We recommend upgrading past commit
  3e91b0ebd994635df2346353322ac51ce84ce6d8.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4244
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=3e91b0ebd994635df2346353322ac51ce84ce6d8
- https://kernel.dance/3e91b0ebd994635df2346353322ac51ce84ce6d8
- https://bugzilla.redhat.com/show_bug.cgi?id=2237755
- https://bugzilla.redhat.com/show_bug.cgi?id=2235306
- https://lore.kernel.org/netdev/20230810070830.24064-1-pablo@netfilter.org/
- https://lore.kernel.org/netdev/20230815223011.7019-1-fw@strlen.de/
- https://bugzilla.suse.com/show_bug.cgi?id=1215420
comments:
  debian/carnil: |-
    Fixed as well in 6.4.12 for 6.4.y. Needs closer verification
    which commits are actually needed to fix the issue in stable
    series.
    As per 2023-08-30 23185c6aed1f ("netfilter: nft_dynset:
    disallow object maps") has been backported to all relevant
    stable series, in particular 4.19.293, 5.10.192, 6.1.47,
    6.4.12.
  masami: It may duplicate of CVE-2023-4563
  ubuntu/cascardo: Looks like a duplicate of CVE-2023-4563
  ubuntu/rodrigo-zaiden: CVE-2023-4563 was marked as duplicated of this.
reporters:
- Bien Pham
fixed-by:
  mainline: [5f68718b34a531a556f2f50300ead2862278da26, f6c383b8c31a93752a52697f8430a71dcbc46adf,
    c92db3030492b8ad1d0faace7a93bbcf53850d0c, a2dd0233cbc4d8a0abb5f64487487ffc9265beb5,
    24138933b97b055d486e8064b4a1721702442a9b, 6a33d8b73dfac0a41f3877894b38082bd0c9a5bc,
    02c6c24402bf1c1e986899c14ba22a10b510916b, 23185c6aed1ffb8fc44087880ba2767aba493779]
