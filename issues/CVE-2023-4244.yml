description: |-
  A use-after-free vulnerability in the Linux kernel's netfilter: nf_tables
  component can be exploited to achieve local privilege escalation.
  Due to a race condition between nf_tables netlink control plane transaction
  and nft_set element garbage collection, it is possible to underflow the
  reference counter causing a use-after-free vulnerability.
  We recommend upgrading past commit
  3e91b0ebd994635df2346353322ac51ce84ce6d8.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4244
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=3e91b0ebd994635df2346353322ac51ce84ce6d8
- https://kernel.dance/3e91b0ebd994635df2346353322ac51ce84ce6d8
- https://bugzilla.redhat.com/show_bug.cgi?id=2237755
- https://bugzilla.redhat.com/show_bug.cgi?id=2235306
- https://lore.kernel.org/netdev/20230810070830.24064-1-pablo@netfilter.org/
- https://lore.kernel.org/netdev/20230815223011.7019-1-fw@strlen.de/
- https://bugzilla.suse.com/show_bug.cgi?id=1215420
- https://ubuntu.com/security/notices/USN-6443-1
- https://ubuntu.com/security/notices/USN-6444-1
- https://ubuntu.com/security/notices/USN-6445-1
- https://ubuntu.com/security/notices/USN-6446-1
- https://ubuntu.com/security/notices/USN-6444-2
- https://ubuntu.com/security/notices/USN-6445-2
- https://ubuntu.com/security/notices/USN-6446-2
- https://ubuntu.com/security/notices/USN-6446-3
- https://ubuntu.com/security/notices/USN-6461-1
- https://ubuntu.com/security/notices/USN-6466-1
- https://ubuntu.com/security/notices/USN-6503-1
comments:
  debian/carnil: |-
    Fixed as well in 6.4.12 for 6.4.y. Needs closer verification
    which commits are actually needed to fix the issue in stable
    series.
    As per 2023-08-30 23185c6aed1f ("netfilter: nft_dynset:
    disallow object maps") has been backported to all relevant
    stable series, in particular 4.19.293, 5.10.192, 6.1.47,
    6.4.12.
  masami: It may duplicate of CVE-2023-4563
  ubuntu/cascardo: Looks like a duplicate of CVE-2023-4563
  ubuntu/rodrigo-zaiden: |-
    CVE-2023-4563 was marked as duplicated of this.
    USN-6443-1 was firstly announced fixing this CVE for
     linux-oem-6.1 in version 6.1.0-1024.24, but one of the fix commits was
     missing in that version. The complete fix in linux-oem-6.1 is available
     in version 6.1.0-1025.25.
reporters:
- Bien Pham
fixed-by:
  cip/5.10: [448be0774882f95a74fa5eb7519761152add601b, 146c76866795553dbc19998f36718d7986ad302b,
    77046cb00850e35ba935944b5100996b2ce34bba, 911dd3cdf1083f4c2e7df72aaab486a1d6dbcc0a,
    b15ea4017af82011dd55225ce77cce3d4dfc169c, 4046f2b56e5a7ba7e123ff961dd51187b8d59e78,
    dc0b1f019554e601f57e78d8f5c70e59d77e49a5, a7653eaea0a59a6993c62d3653af5c880ce28533]
  mainline: [5f68718b34a531a556f2f50300ead2862278da26, f6c383b8c31a93752a52697f8430a71dcbc46adf,
    c92db3030492b8ad1d0faace7a93bbcf53850d0c, a2dd0233cbc4d8a0abb5f64487487ffc9265beb5,
    24138933b97b055d486e8064b4a1721702442a9b, 6a33d8b73dfac0a41f3877894b38082bd0c9a5bc,
    02c6c24402bf1c1e986899c14ba22a10b510916b, 23185c6aed1ffb8fc44087880ba2767aba493779]
  stable/4.19: [255bb7fd670589c00cb2f8a1353b721306135ca3]
  stable/5.10: [448be0774882f95a74fa5eb7519761152add601b, 146c76866795553dbc19998f36718d7986ad302b,
    77046cb00850e35ba935944b5100996b2ce34bba, 911dd3cdf1083f4c2e7df72aaab486a1d6dbcc0a,
    b15ea4017af82011dd55225ce77cce3d4dfc169c, 4046f2b56e5a7ba7e123ff961dd51187b8d59e78,
    dc0b1f019554e601f57e78d8f5c70e59d77e49a5, a7653eaea0a59a6993c62d3653af5c880ce28533]
  stable/6.1: [7148bca63b212fc8e5c2e8374e14cd62b1c8441c, 59dab3bf0b8fc08eb802721c0532f13dd89209b8,
    ea3eb9f2192e4fc33b795673e56c97a21987f868, df650d6a4bf47248261b61ef6b174d7c54034d15,
    4ead4f74b3a9162b205f702d72d4a3421356dbc1, 0b9af4860a61f55cf716267b5ae5df34aacc4b39,
    41113aa5698ad7a82635bcb747d483e4458d518d, afa584c35065051a11ae3ea3cc105b634053fcd8]
