description: |-
  A flaw was found in btrfs_get_root_ref in fs/btrfs/disk-io.c in the btrfs
  filesystem in the Linux Kernel due to a double decrement of the reference
  count. This issue may allow a local attacker with user privilege to crash
  the system or may lead to leaked internal kernel information.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4389
- https://git.kernel.org/linus/168a2f776b9762f4021421008512dd7ab7474df1
- https://patchwork.kernel.org/project/linux-btrfs/patch/20220324134454.15192-1-baijiaju1990@gmail.com/
- https://access.redhat.com/security/cve/CVE-2023-4389
- https://bugzilla.redhat.com/show_bug.cgi?id=2219271
- https://bugzilla.suse.com/show_bug.cgi?id=CVE-2023-4389
comments:
  debian/carnil: |-
    Commit fixes bc44d7c4b2b1 ("btrfs: push btrfs_grab_fs_root into
    btrfs_get_fs_root") in 5.7-rc1.
introduced-by:
  mainline: [bc44d7c4b2b179c4b74fba208b9908e2ecbc1b4d]
fixed-by:
  cip/5.10: [1d2eda18f6ffbd9902594469c6e1a055014eb2ac]
  cip/5.10-rt: [1d2eda18f6ffbd9902594469c6e1a055014eb2ac]
  mainline: [168a2f776b9762f4021421008512dd7ab7474df1]
  stable/5.10: [1d2eda18f6ffbd9902594469c6e1a055014eb2ac]
  stable/5.15: [252db93fd0bd5ca07c9b933ed94e93a4a43e8901]
