description: '[ksmbd: fix wrong DataOffset validation of create context]'
references:
- https://www.cve.org/CVERecord?id=CVE-2023-4458
- https://git.kernel.org/linus/17d5b135bb720832364e8f55f6a887a3c7ec8fdb
- https://www.zerodayinitiative.com/advisories/ZDI-24-590/
comments:
  cip/masami: |-
    It looks as if this bug was introduced by commit 8f77150 ("ksmbd:
    add buffer validation for SMB2_CREATE_CONTEXT") in 5.15-rc4.
introduced-by:
  mainline: [8f77150c15f87796570125a43509f9a81a3d9e49]
fixed-by:
  cip/6.1: [7d8855fd849d9c3186a9e1d3085ea4aedc6e019f]
  cip/6.1-rt: [7d8855fd849d9c3186a9e1d3085ea4aedc6e019f]
  mainline: [17d5b135bb720832364e8f55f6a887a3c7ec8fdb]
  stable/5.15: [2e3f57f74c0af085a2519860eac42b33f7659600]
  stable/6.1: [7d8855fd849d9c3186a9e1d3085ea4aedc6e019f]
