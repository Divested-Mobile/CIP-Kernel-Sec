description: Use-after-free in nft_verdict_dump due to a race between set GC and transaction
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2235306
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4563
- https://lore.kernel.org/netdev/20230810070830.24064-1-pablo@netfilter.org/
- https://lore.kernel.org/netdev/20230815223011.7019-1-fw@strlen.de/
- https://access.redhat.com/security/cve/CVE-2023-4563
- https://bugzilla.suse.com/show_bug.cgi?id=1214727
comments:
  debian/carnil: |-
    Fixed as well in 6.4.12 for 6.4.y. Needs closer verification
    which commits are actually needed to fix the issue in stable
    series.
    As per 2023-08-30 23185c6aed1f ("netfilter: nft_dynset:
    disallow object maps") has been backported to all relevant
    stable series, in particular 4.19.293, 5.10.192, 6.1.47,
    6.4.12.
fixed-by:
  cip/5.10: [b15ea4017af82011dd55225ce77cce3d4dfc169c, 448be0774882f95a74fa5eb7519761152add601b,
    146c76866795553dbc19998f36718d7986ad302b, 77046cb00850e35ba935944b5100996b2ce34bba,
    911dd3cdf1083f4c2e7df72aaab486a1d6dbcc0a, 4046f2b56e5a7ba7e123ff961dd51187b8d59e78,
    dc0b1f019554e601f57e78d8f5c70e59d77e49a5, a7653eaea0a59a6993c62d3653af5c880ce28533]
  mainline: [24138933b97b055d486e8064b4a1721702442a9b, 5f68718b34a531a556f2f50300ead2862278da26,
    f6c383b8c31a93752a52697f8430a71dcbc46adf, c92db3030492b8ad1d0faace7a93bbcf53850d0c,
    a2dd0233cbc4d8a0abb5f64487487ffc9265beb5, 6a33d8b73dfac0a41f3877894b38082bd0c9a5bc,
    02c6c24402bf1c1e986899c14ba22a10b510916b, 23185c6aed1ffb8fc44087880ba2767aba493779]
  stable/5.10: [b15ea4017af82011dd55225ce77cce3d4dfc169c, 448be0774882f95a74fa5eb7519761152add601b,
    146c76866795553dbc19998f36718d7986ad302b, 77046cb00850e35ba935944b5100996b2ce34bba,
    911dd3cdf1083f4c2e7df72aaab486a1d6dbcc0a, 4046f2b56e5a7ba7e123ff961dd51187b8d59e78,
    dc0b1f019554e601f57e78d8f5c70e59d77e49a5, a7653eaea0a59a6993c62d3653af5c880ce28533]
