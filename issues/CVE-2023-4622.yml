description: 'af_unix: Fix null-ptr-deref in unix_stream_sendpage().'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4622
- https://kernel.dance/790c2f9d15b594350ae9bca7b236f2b1859de02c
- https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-6.1.y&id=790c2f9d15b594350ae9bca7b236f2b1859de02c
- https://bugzilla.redhat.com/show_bug.cgi?id=2237760
- https://bugzilla.suse.com/show_bug.cgi?id=1215117
- https://ubuntu.com/security/notices/USN-6415-1
- https://ubuntu.com/security/notices/USN-6439-1
- https://ubuntu.com/security/notices/USN-6440-1
- https://ubuntu.com/security/notices/USN-6441-1
- https://ubuntu.com/security/notices/USN-6442-1
- https://ubuntu.com/security/notices/USN-6444-1
- https://ubuntu.com/security/notices/USN-6445-1
- https://ubuntu.com/security/notices/USN-6446-1
- https://ubuntu.com/security/notices/USN-6440-2
- https://ubuntu.com/security/notices/USN-6439-2
- https://ubuntu.com/security/notices/USN-6441-2
- https://ubuntu.com/security/notices/USN-6444-2
- https://ubuntu.com/security/notices/USN-6445-2
- https://ubuntu.com/security/notices/USN-6446-2
- https://ubuntu.com/security/notices/USN-6440-3
- https://ubuntu.com/security/notices/USN-6446-3
- https://ubuntu.com/security/notices/USN-6441-3
- https://ubuntu.com/security/notices/USN-6466-1
- https://www.cve.org/CVERecord?id=CVE-2023-4622
comments:
  debian/carnil: |-
    Consider the 57d44a354a43 ("unix: Convert
    unix_stream_sendpage() to use MSG_SPLICE_PAGES") commit, part
    of the sendpage refactoring the fixing commit.
    For 6.4.y fixed in 6.4.12.
  cip/masami: |-
    It seems to be fixed by commit 57d44a35 ("unix: Convert unix_stream_sendpage() 
    to use MSG_SPLICE_PAGES") in mainline(6.5-rc1.). However, stable kernels are 
    fixed by commit 790c2f9d1 ("af_unix: Fix null-ptr-deref in 
    unix_stream_sendpage().") in 6.1.47.
    This commit was backported to older stable kernels.
reporters:
- Bing-Jhong Billy Jheng
introduced-by:
  mainline: [869e7c62486ec0e170a9771acaa251d1a33b5871]
fixed-by:
  cip/4.19: [bd6303bef49970ac7f9278a94473b587e19d1ee2]
  cip/4.19-rt: [bd6303bef49970ac7f9278a94473b587e19d1ee2]
  cip/4.4.y: [3ac35d01c826f6c347abdb35ea6909de4d37c5c4]
  cip/4.4.y-rt: [3ac35d01c826f6c347abdb35ea6909de4d37c5c4]
  cip/4.4.y-st: [3ac35d01c826f6c347abdb35ea6909de4d37c5c4]
  cip/5.10: [c080cee930303124624fe64fc504f66c815ee6b9]
  cip/5.10-rt: [c080cee930303124624fe64fc504f66c815ee6b9]
  debian/buster-security: ['version:debian/4.19.304-1']
  mainline: [57d44a354a43edba4ef9963327d4657d12edbfbc]
  stable/4.19: [bd6303bef49970ac7f9278a94473b587e19d1ee2]
  stable/5.10: [c080cee930303124624fe64fc504f66c815ee6b9]
  stable/5.15: [d39fc9b94dc0719afa4bc8e58341a5eb41febef3]
  stable/5.4: [4821df2ffe38d629170edc266e65fa05970e0745]
  stable/6.1: [790c2f9d15b594350ae9bca7b236f2b1859de02c]
