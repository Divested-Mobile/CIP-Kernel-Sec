description: 'netfilter: nftables: exthdr: fix 4-byte stack OOB write'
references:
- https://bugzilla.redhat.com/show_bug.cgi?id=2238312
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4881
- https://lore.kernel.org/all/20230906162525.11079-2-fw@strlen.de/
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-21950/
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-21951/
- https://www.zerodayinitiative.com/advisories/ZDI-CAN-21961/
- https://git.kernel.org/linus/fd94d9dadee58e09b49075240fe83423eb1dcd36
- https://access.redhat.com/security/cve/CVE-2023-4881
- https://ubuntu.com/security/notices/USN-6439-1
- https://ubuntu.com/security/notices/USN-6440-1
- https://ubuntu.com/security/notices/USN-6441-1
- https://ubuntu.com/security/notices/USN-6442-1
- https://ubuntu.com/security/notices/USN-6443-1
- https://ubuntu.com/security/notices/USN-6444-1
- https://ubuntu.com/security/notices/USN-6445-1
- https://ubuntu.com/security/notices/USN-6446-1
- https://ubuntu.com/security/notices/USN-6440-2
- https://ubuntu.com/security/notices/USN-6439-2
- https://ubuntu.com/security/notices/USN-6441-2
- https://ubuntu.com/security/notices/USN-6444-2
- https://ubuntu.com/security/notices/USN-6445-2
- https://ubuntu.com/security/notices/USN-6446-2
- https://ubuntu.com/security/notices/USN-6440-3
- https://ubuntu.com/security/notices/USN-6446-3
- https://ubuntu.com/security/notices/USN-6454-1
comments:
  debian/carnil: For 6.5.y fixed as well in 6.5.4.
  masami: |-
    This fixes commit 49499c3 ("netfilter: nf_tables: switch registers
    to 32 bit addressing") in 4.1-rc1, 935b7f6 ("netfilter: nft_exthdr:
    add TCP option matching") in 4.11-rc1, 133dc20 ("netfilter:
    nft_exthdr: Support SCTP chunks") in 5.14-rc1, and dbb5281
    ("netfilter: nf_tables: add support for matching IPv4 options")
    in 5.3-rc1.
  ubuntu/rodrigo-zaiden: ZDI-CAN-21950, ZDI-CAN-21951, ZDI-CAN-21961.
reporters:
- Alex Birnberg
introduced-by:
  mainline: [49499c3e6e18b7677a63316f3ff54a16533dc28f, 935b7f643018878bd9d4193eea8b575aff736b9b,
    133dc203d77dff617d9c4673973ef3859be2c476, dbb5281a1f84b2f93032d4864c211ce8a20811a7]
  stable/5.10: [49499c3e6e18b7677a63316f3ff54a16533dc28f, 935b7f643018878bd9d4193eea8b575aff736b9b,
    af844ba799b56b5d866536cca21e35be8e2febaf, dbb5281a1f84b2f93032d4864c211ce8a20811a7]
fixed-by:
  cip/6.1: [d9ebfc0f21377690837ebbd119e679243e0099cc]
  cip/6.1-rt: [d9ebfc0f21377690837ebbd119e679243e0099cc]
  mainline: [fd94d9dadee58e09b49075240fe83423eb1dcd36]
  stable/5.10: [a7d86a77c33ba1c357a7504341172cc1507f0698]
  stable/5.15: [1ad7b189cc1411048434e8595ffcbe7873b71082]
  stable/6.1: [d9ebfc0f21377690837ebbd119e679243e0099cc]
  stable/6.5: [c8f292322ff16b9a2272a67de396c09a50e09dce]
  ubuntu/focal: [92049c1bc8c1b27d42c3f56efe58ed59a5f79891]
