description: 'net: sched: sch_qfq: Fix UAF in qfq_dequeue()'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4921
- https://kernel.dance/#8fc134fee27f2263988ae38920bc03da416b03d8
- https://lore.kernel.org/all/20230901162237.11525-1-jhs@mojatatu.com/
- https://bugzilla.suse.com/show_bug.cgi?id=1215275
- https://ubuntu.com/security/notices/USN-6439-1
- https://ubuntu.com/security/notices/USN-6440-1
- https://ubuntu.com/security/notices/USN-6441-1
- https://ubuntu.com/security/notices/USN-6442-1
- https://ubuntu.com/security/notices/USN-6444-1
- https://ubuntu.com/security/notices/USN-6445-1
- https://ubuntu.com/security/notices/USN-6446-1
- https://ubuntu.com/security/notices/USN-6440-2
- https://ubuntu.com/security/notices/USN-6439-2
- https://ubuntu.com/security/notices/USN-6441-2
- https://ubuntu.com/security/notices/USN-6444-2
- https://ubuntu.com/security/notices/USN-6445-2
- https://ubuntu.com/security/notices/USN-6446-2
- https://ubuntu.com/security/notices/USN-6440-3
- https://ubuntu.com/security/notices/USN-6446-3
- https://ubuntu.com/security/notices/USN-6454-1
- https://ubuntu.com/security/notices/USN-6441-3
- https://ubuntu.com/security/notices/USN-6454-2
- https://ubuntu.com/security/notices/USN-6461-1
- https://ubuntu.com/security/notices/USN-6466-1
- https://ubuntu.com/security/notices/USN-6454-3
- https://ubuntu.com/security/notices/USN-6454-4
- https://ubuntu.com/security/notices/USN-6479-1
- https://ubuntu.com/security/notices/USN-6699-1
- https://www.cve.org/CVERecord?id=CVE-2023-4921
comments:
  debian/carnil: |-
    Commit fixes 462dbc9101ac ("pkt_sched: QFQ Plus: fair-queueing
    service at DRR cost") in 3.8-rc1.
    For 6.5.y fixed as well in 6.5.4.
  ubuntu/rodrigo-zaiden: reported by Google kCTF
introduced-by:
  mainline: [462dbc9101acd38e92eda93c0726857517a24bbd]
fixed-by:
  cip/4.19: [7ea1faa59c75336d86893378838ed1e6f20c0520]
  cip/4.19-rt: [7ea1faa59c75336d86893378838ed1e6f20c0520]
  cip/4.4: [d95876cf108ee00f27707cf634311f9f52c9b6b6]
  cip/4.4-rt: [d95876cf108ee00f27707cf634311f9f52c9b6b6]
  cip/4.4-st: [d95876cf108ee00f27707cf634311f9f52c9b6b6]
  cip/5.10: [746a8df5e4d235059b1adf02e8456e7ec132d2d8]
  cip/5.10-rt: [746a8df5e4d235059b1adf02e8456e7ec132d2d8]
  cip/6.1: [a18349dc8d916a64d7c93f05da98953e3386d8e9]
  cip/6.1-rt: [a18349dc8d916a64d7c93f05da98953e3386d8e9]
  debian/buster-security: ['version:debian/4.19.304-1']
  mainline: [8fc134fee27f2263988ae38920bc03da416b03d8]
  stable/4.14: [d9f43fc5a78d1505733d3621cd4c044eaf71a02f]
  stable/4.19: [7ea1faa59c75336d86893378838ed1e6f20c0520]
  stable/5.10: [746a8df5e4d235059b1adf02e8456e7ec132d2d8]
  stable/5.15: [6ea277b2c6263931798234e2eed892ecfbb85596]
  stable/5.4: [a6d11571b91d34fd7ce8451c2dfd112194c79ae2]
  stable/6.1: [a18349dc8d916a64d7c93f05da98953e3386d8e9]
  stable/6.5: [e5471b82c36396e809817cb988dfc4bce0a688cb]
  ubuntu/focal: [2952be84052473bfe7750ad8940a008eb279cc0e]
