description: 'netfilter: nft_set_rbtree: skip sync GC for new elements in this transaction'
references:
- https://lore.kernel.org/linux-cve-announce/2024022058-outsell-equator-e1c5@gregkh/
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52433
- https://git.kernel.org/linus/2ee52ae94baabf7ee09cf2a8d854b990dac5d0e4
- https://git.kernel.org/stable/c/e3213ff99a355cda811b41e8dbb3472d13167a3a
- https://git.kernel.org/stable/c/2ee52ae94baabf7ee09cf2a8d854b990dac5d0e4
- https://git.kernel.org/stable/c/03caf75da1059f0460666c826e9f50e13dfd0017
- https://git.kernel.org/stable/c/c323ed65f66e5387ee0a73452118d49f1dae81b8
- https://git.kernel.org/stable/c/9af7dfb3c9d7985172a240f85e684c5cd33e29ce
- https://git.kernel.org/stable/c/9a8c544158f68f656d1734eb5ba00c4f817b76b1
- https://www.cve.org/CVERecord?id=CVE-2023-52433
- https://git.kernel.org/stable/c/9db9feb841f7449772f9393c16b9ef4536d8c127
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit f6c383b ("netfilter: nf_tables: adapt set backend to use GC transaction API") in v6.5-rc6.
    Fixed in v5.4.262.
  debian/carnil: |-
    Introduced with f6c383b8c31a ("netfilter: nf_tables: adapt set
    backend to use GC transaction API") in 6.5-rc5 which got
    backported to 5.10.198, 6.1.56 and 6.4.11. But for 5.10.y and
    6.1.y fixed in the same upstream version along.
  masami: "This bug was introduced by commit f6c383b (\"netfilter:\nnf_tables: adapt\
    \ set backend to use GC transaction API\")\nin 6.5-rc6. This patch is not backported\
    \ to 4.x kernels. \nTherefore, 4.19, 4.14, and 4.4 are not affcted."
  ubuntu/rodrigo-zaiden: |-
    the commit 2ee52ae94baabf7ee09cf2a8d854b990dac5d0e4 was
     considered one of the fix commits for CVE-2023-4244, as a follow up commit.
introduced-by:
  cip/4.19: [cb4d00b563675ba8ff6ef94b077f58d816f68ba3]
  cip/4.19-rt: [cb4d00b563675ba8ff6ef94b077f58d816f68ba3]
  cip/5.10: [146c76866795553dbc19998f36718d7986ad302b]
  cip/5.10-rt: [146c76866795553dbc19998f36718d7986ad302b]
  cip/6.1: [df650d6a4bf47248261b61ef6b174d7c54034d15]
  cip/6.1-rt: [df650d6a4bf47248261b61ef6b174d7c54034d15]
  mainline: [f6c383b8c31a93752a52697f8430a71dcbc46adf]
  stable/4.19: [cb4d00b563675ba8ff6ef94b077f58d816f68ba3]
  stable/5.10: [146c76866795553dbc19998f36718d7986ad302b]
  stable/5.15: [479a2cf5259347d6a1f658b0f791d27a34908e91]
  stable/5.4: [c357648929c8dff891502349769aafb8f0452bc2]
  stable/6.1: [df650d6a4bf47248261b61ef6b174d7c54034d15]
  ubuntu/focal: [0ad69ad1f0db2e0895e6da0f408c8060116321ab]
fixed-by:
  cip/4.19: [9db9feb841f7449772f9393c16b9ef4536d8c127]
  cip/4.19-rt: [9db9feb841f7449772f9393c16b9ef4536d8c127]
  cip/5.10: [c323ed65f66e5387ee0a73452118d49f1dae81b8]
  cip/5.10-rt: [c323ed65f66e5387ee0a73452118d49f1dae81b8]
  cip/6.1: [9a8c544158f68f656d1734eb5ba00c4f817b76b1]
  cip/6.1-rt: [9a8c544158f68f656d1734eb5ba00c4f817b76b1]
  mainline: [2ee52ae94baabf7ee09cf2a8d854b990dac5d0e4]
  stable/4.19: [9db9feb841f7449772f9393c16b9ef4536d8c127]
  stable/5.10: [c323ed65f66e5387ee0a73452118d49f1dae81b8]
  stable/5.15: [9af7dfb3c9d7985172a240f85e684c5cd33e29ce]
  stable/5.4: [03caf75da1059f0460666c826e9f50e13dfd0017]
  stable/6.1: [9a8c544158f68f656d1734eb5ba00c4f817b76b1]
  ubuntu/focal: [504d8f991334200e7814b0f0f6618244b931d7fc]
