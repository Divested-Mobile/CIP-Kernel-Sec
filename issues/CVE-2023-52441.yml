description: |-
  In the Linux kernel, the following vulnerability has been resolved:
  ksmbd: fix out of bounds in init_smb2_rsp_hdr()
  If client send smb2 negotiate request and then send smb1 negotiate
  request, init_smb2_rsp_hdr is called for smb1 negotiate request since
  need_neg is set to false. This patch ignore smb1 packets after ->need_neg
  is set to false.
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52441
- https://git.kernel.org/linus/536bb492d39bb6c080c92f31e8a55fe9934f452b
- https://git.kernel.org/stable/c/5c0df9d30c289d6b9d7d44e2a450de2f8e3cf40b
- https://git.kernel.org/stable/c/330d900620dfc9893011d725b3620cd2ee0bc2bc
- https://git.kernel.org/stable/c/aa669ef229ae8dd779da9caa24e254964545895f
- https://git.kernel.org/stable/c/536bb492d39bb6c080c92f31e8a55fe9934f452b
- https://lore.kernel.org/linux-cve-announce/2024022129-gently-activity-ca7d@gregkh/T/#u
- https://bugzilla.suse.com/show_bug.cgi?id=1220183
comments:
  masami: ksmbd was introduced in 5.15.
  ubuntu/sbeattie: ZDI-CAN-21541
introduced-by:
  mainline: [e2f34481b24db2fd634b5edb0a5bd0e4d38cc6e9]
fixed-by:
  cip/6.1: [330d900620dfc9893011d725b3620cd2ee0bc2bc]
  cip/6.1-rt: [330d900620dfc9893011d725b3620cd2ee0bc2bc]
  mainline: [536bb492d39bb6c080c92f31e8a55fe9934f452b]
  stable/5.15: [5c0df9d30c289d6b9d7d44e2a450de2f8e3cf40b]
  stable/6.1: [330d900620dfc9893011d725b3620cd2ee0bc2bc]
