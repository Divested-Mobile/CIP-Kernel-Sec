description: 'bpf: Defer the free of inner map when necessary'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52447
- https://git.kernel.org/stable/c/62fca83303d608ad4fec3f7428c8685680bb01b0
- https://git.kernel.org/stable/c/f91cd728b10c51f6d4a39957ccd56d1e802fc8ee
- https://git.kernel.org/stable/c/bfd9b20c4862f41d4590fde11d70a5eeae53dcc5
- https://git.kernel.org/stable/c/876673364161da50eed6b472d746ef88242b2368
- https://lore.kernel.org/linux-cve-announce/2024022255-CVE-2023-52447-e074@gregkh/
- https://ubuntu.com/security/notices/USN-6688-1
comments:
  debian/carnil: |-
    Introduced in bba1dc0b55ac ("bpf: Remove redundant synchronize_rcu.")
    638e4b825d52 ("bpf: Allows per-cpu maps and map-in-map in sleepable programs").
    Vulnerable versions: 5.9-rc1 5.12-rc1.
  masami: "Introduced by commit 638e4b8 (\"bpf: Allows per-cpu maps and \nmap-in-map\
    \ in sleepable programs\") in 5.12-rc1-dontuse.\nThis commit is not backported\
    \ to older kernels.\nFixed in 6.8-rc1."
introduced-by:
  mainline: [bba1dc0b55ac462d24ed1228ad49800c238cd6d7, 638e4b825d523bed7a55e776c153049fb7716466]
fixed-by:
  cip/6.1: [62fca83303d608ad4fec3f7428c8685680bb01b0]
  cip/6.1-rt: [62fca83303d608ad4fec3f7428c8685680bb01b0]
  mainline: [876673364161da50eed6b472d746ef88242b2368]
  stable/5.10: [90c445799fd1dc214d7c6279c144e33a35e29ef2]
  stable/5.15: [37d98fb9c3144c0fddf7f6e99aece9927ac8dce6]
  stable/6.1: [62fca83303d608ad4fec3f7428c8685680bb01b0]
  stable/6.6: [f91cd728b10c51f6d4a39957ccd56d1e802fc8ee]
  stable/6.7: [bfd9b20c4862f41d4590fde11d70a5eeae53dcc5]
