description: 'media: mtk-jpeg: Fix use after free bug due to error path handling in
  mtk_jpeg_dec_device_run'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52491
- https://lore.kernel.org/linux-cve-announce/20240229155245.1571576-32-lee@kernel.org/T/#u
comments:
  debian/carnil: |-
    Introduced in b2f0d2724ba4 ("[media] vcodec: mediatek: Add Mediatek JPEG
    Decoder Driver"). Vulnerable versions: 4.12-rc1.
  masami: |-
    Introduced by commit b2f0d27 ("[media] vcodec: mediatek: Add Mediatek JPEG Decoder Driver") 
    in 4.12-rc1. This commit is not backported to older stable kernels. Fixed in 6.8-rc1.
introduced-by:
  mainline: [b2f0d2724ba477d326e9d654d4db1c93e98f8b93]
fixed-by:
  cip/6.1: [9fec4db7fff54d9b0306a332bab31eac47eeb5f6]
  mainline: [206c857dd17d4d026de85866f1b5f0969f2a109e]
  stable/5.10: [43872f44eee6c6781fea1348b38885d8e78face9]
  stable/5.15: [1b1036c60a37a30caf6759a90fe5ecd06ec35590]
  stable/6.1: [9fec4db7fff54d9b0306a332bab31eac47eeb5f6]
  stable/6.6: [8254d54d00eb6cdb8367399c7f912eb8d354ecd7]
  stable/6.7: [6e2f37022f0fc0893da4d85a0500c9d547fffd4c]
