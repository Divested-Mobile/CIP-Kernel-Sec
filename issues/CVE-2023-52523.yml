description: 'bpf, sockmap: Reject sk_msg egress redirects to non-TCP sockets'
references:
- https://lore.kernel.org/linux-cve-announce/2024030253-CVE-2023-52523-5ae2@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52523
- https://git.kernel.org/stable/c/bc8b89b6963803a123f64aa9494155a037b3d728
- https://git.kernel.org/stable/c/b8f97e47b6fb84fcf2f5a22e725eefb6cf5070c2
- https://git.kernel.org/stable/c/ded6e448028f0f91b6af35985afca01fa02a9089
- https://git.kernel.org/stable/c/b80e31baa43614e086a9d29dc1151932b1bd7fc5
- https://git.kernel.org/linus/b80e31baa43614e086a9d29dc1151932b1bd7fc5
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 122e6c7 ("sock_map: Update sock type checks for UDP") in v5.13-rc1.
    Fixed in v6.6-rc5.
  debian/carnil: |-
    Introduced in 122e6c79efe1 ("sock_map: Update sock type checks for UDP").
    Vulnerable versions: 5.13-rc1.
introduced-by:
  mainline: [122e6c79efe1c25816118aca9cfabe54e99c2432]
fixed-by:
  cip/6.1: [b8f97e47b6fb84fcf2f5a22e725eefb6cf5070c2]
  cip/6.1-rt: [b8f97e47b6fb84fcf2f5a22e725eefb6cf5070c2]
  mainline: [b80e31baa43614e086a9d29dc1151932b1bd7fc5]
  stable/5.15: [bc8b89b6963803a123f64aa9494155a037b3d728]
  stable/6.1: [b8f97e47b6fb84fcf2f5a22e725eefb6cf5070c2]
