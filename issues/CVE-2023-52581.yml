description: 'netfilter: nf_tables: fix memleak when more than 255 elements expired'
references:
- https://lore.kernel.org/linux-cve-announce/2024030258-CVE-2023-52581-2165@gregkh/T/#u
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52581
- https://git.kernel.org/stable/c/4aea243b6853d06c1d160a9955b759189aa02b14
- https://git.kernel.org/stable/c/cf5000a7787cbc10341091d37245a42c119d26c5
- https://git.kernel.org/linus/cf5000a7787cbc10341091d37245a42c119d26c5
- https://git.kernel.org/stable/c/a995a68e8a3b48533e47c856865d109a1f1a9d01
- https://git.kernel.org/stable/c/09c85f2d21ab6b5acba31a037985b13e8e6565b8
- https://git.kernel.org/stable/c/ef99506eaf1dc31feff1adfcfd68bc5535a22171
- https://git.kernel.org/stable/c/7e5d732e6902eb6a37b35480796838a145ae5f07
- https://www.cve.org/CVERecord?id=CVE-2023-52581
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 5f68718 ("netfilter: nf_tables: GC transaction API to avoid race with control plane") in v6.5-rc6.
    Fixed in v6.6-rc3.
  debian/carnil: |-
    Introduced in 5f68718b34a5 ("netfilter: nf_tables: GC transaction API to avoid
    race with control plane"). Vulnerable versions: 5.4.262 5.10.198 5.15.134
    6.1.56 6.4.11 6.5-rc6.
introduced-by:
  cip/5.10: [448be0774882f95a74fa5eb7519761152add601b]
  cip/5.10-rt: [448be0774882f95a74fa5eb7519761152add601b]
  cip/6.1: [ea3eb9f2192e4fc33b795673e56c97a21987f868]
  cip/6.1-rt: [ea3eb9f2192e4fc33b795673e56c97a21987f868]
  mainline: [5f68718b34a531a556f2f50300ead2862278da26]
  stable/4.19: [8da1b048f9a501d3d7d38c188ba09d7d0d5b8c27]
  stable/5.10: [448be0774882f95a74fa5eb7519761152add601b]
  stable/5.15: [d19e8bf3ea4114dd21fc35da21f398203d7f7df1]
  stable/5.4: [bbdb3b65aa91aa0a32b212f27780b28987f2d94f]
  stable/6.1: [ea3eb9f2192e4fc33b795673e56c97a21987f868]
  ubuntu/focal: [470c3b74a218dfc1076fdb8dace5de49ae14fb81]
fixed-by:
  cip/5.10: [09c85f2d21ab6b5acba31a037985b13e8e6565b8]
  cip/5.10-rt: [09c85f2d21ab6b5acba31a037985b13e8e6565b8]
  cip/6.1: [7e5d732e6902eb6a37b35480796838a145ae5f07]
  cip/6.1-rt: [7e5d732e6902eb6a37b35480796838a145ae5f07]
  mainline: [cf5000a7787cbc10341091d37245a42c119d26c5]
  stable/4.19: [7cf055b43756b10aa2b851c927c940f5ed652125]
  stable/5.10: [09c85f2d21ab6b5acba31a037985b13e8e6565b8]
  stable/5.15: [ef99506eaf1dc31feff1adfcfd68bc5535a22171]
  stable/5.4: [a995a68e8a3b48533e47c856865d109a1f1a9d01]
  stable/6.1: [7e5d732e6902eb6a37b35480796838a145ae5f07]
  ubuntu/focal: [94852bed97380da4bc72b99b7d2044dcb5c5d4b8]
