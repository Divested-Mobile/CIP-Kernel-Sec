description: 'netfilter: nftables: exthdr: fix 4-byte stack OOB write'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-52628
- https://git.kernel.org/stable/c/a7d86a77c33ba1c357a7504341172cc1507f0698
- https://git.kernel.org/stable/c/1ad7b189cc1411048434e8595ffcbe7873b71082
- https://git.kernel.org/stable/c/d9ebfc0f21377690837ebbd119e679243e0099cc
- https://git.kernel.org/stable/c/c8f292322ff16b9a2272a67de396c09a50e09dce
- https://git.kernel.org/stable/c/fd94d9dadee58e09b49075240fe83423eb1dcd36
- https://lore.kernel.org/linux-cve-announce/2024032850-CVE-2023-52628-14fb@gregkh/
- https://www.zerodayinitiative.com/advisories/ZDI-24-298/
- https://www.zerodayinitiative.com/advisories/ZDI-24-299/
- https://www.zerodayinitiative.com/advisories/ZDI-24-297/
- https://git.kernel.org/linus/fd94d9dadee58e09b49075240fe83423eb1dcd36
- https://www.cve.org/CVERecord?id=CVE-2023-52628
- https://git.kernel.org/stable/c/28a97c43c9e32f437ebb8d6126f9bb7f3ca9521a
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 49499c3 ("netfilter: nf_tables: switch registers to 32 bit addressing") in v4.1-rc1.
    Introduced by commit 935b7f6 ("netfilter: nft_exthdr: add TCP option matching") in v4.11-rc1.
    Introduced by commit 133dc20 ("netfilter: nft_exthdr: Support SCTP chunks") in v5.14-rc1.
    Introduced by commit dbb5281 ("netfilter: nf_tables: add support for matching IPv4 options") in v5.3-rc1.
    Fixed in v6.6-rc1.
  debian/carnil: |-
    Introduced in 49499c3e6e18 ("netfilter: nf_tables: switch registers to 32 bit
    addressing")
    935b7f643018 ("netfilter: nft_exthdr: add TCP option matching")
    133dc203d77d ("netfilter: nft_exthdr: Support SCTP chunks")
    dbb5281a1f84 ("netfilter: nf_tables: add support for matching IPv4 options").
    Vulnerable versions: 4.1-rc1 4.11-rc1 5.3-rc1 5.10.198 5.14-rc1.
introduced-by:
  cip/5.10: [49499c3e6e18b7677a63316f3ff54a16533dc28f, 935b7f643018878bd9d4193eea8b575aff736b9b,
    af844ba799b56b5d866536cca21e35be8e2febaf, dbb5281a1f84b2f93032d4864c211ce8a20811a7]
  cip/5.10-rt: [49499c3e6e18b7677a63316f3ff54a16533dc28f, 935b7f643018878bd9d4193eea8b575aff736b9b,
    af844ba799b56b5d866536cca21e35be8e2febaf, dbb5281a1f84b2f93032d4864c211ce8a20811a7]
  mainline: [49499c3e6e18b7677a63316f3ff54a16533dc28f, 935b7f643018878bd9d4193eea8b575aff736b9b,
    133dc203d77dff617d9c4673973ef3859be2c476, dbb5281a1f84b2f93032d4864c211ce8a20811a7]
  stable/5.10: [49499c3e6e18b7677a63316f3ff54a16533dc28f, 935b7f643018878bd9d4193eea8b575aff736b9b,
    af844ba799b56b5d866536cca21e35be8e2febaf, dbb5281a1f84b2f93032d4864c211ce8a20811a7]
fixed-by:
  cip/4.19: [28a97c43c9e32f437ebb8d6126f9bb7f3ca9521a]
  cip/5.10: [a7d86a77c33ba1c357a7504341172cc1507f0698]
  cip/5.10-rt: [a7d86a77c33ba1c357a7504341172cc1507f0698]
  cip/6.1: [d9ebfc0f21377690837ebbd119e679243e0099cc]
  cip/6.1-rt: [d9ebfc0f21377690837ebbd119e679243e0099cc]
  debian/buster-security: ['version:debian/4.19.316-1']
  mainline: [fd94d9dadee58e09b49075240fe83423eb1dcd36]
  stable/4.19: [28a97c43c9e32f437ebb8d6126f9bb7f3ca9521a]
  stable/5.10: [a7d86a77c33ba1c357a7504341172cc1507f0698]
  stable/5.15: [1ad7b189cc1411048434e8595ffcbe7873b71082]
  stable/5.4: [cf39c4f77a773a547ac2bcf30ecdd303bb0c80cb]
  stable/6.1: [d9ebfc0f21377690837ebbd119e679243e0099cc]
  ubuntu/focal: [94df263801b3648b3646a5a82da02e0cd20e9a1a]
