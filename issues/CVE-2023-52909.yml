description: 'nfsd: fix handling of cached open files in nfsd4_open codepath'
references:
- https://www.cve.org/CVERecord?id=CVE-2023-52909
- https://git.kernel.org/stable/c/45c08a752982116f3287afcd1bd9c50f4fab0c28
- https://git.kernel.org/stable/c/0b778361998d6c6356b8d2fc7ddf025fb3224654
- https://git.kernel.org/stable/c/973acfdfe90c8a4e58ade97ff0653a498531ff2e
- https://git.kernel.org/stable/c/0b3a551fa58b4da941efeb209b3770868e2eddd7
- https://lore.kernel.org/linux-cve-announce/2024082114-CVE-2023-52909-f80d@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit fb70bf1 ("NFSD: Instantiate a struct file when creating a regular NFSv4 file") in v5.19-rc1.
    Fixed in v5.15.154.
  debian/carnil: |-
    Introduced in fb70bf124b05 ("NFSD: Instantiate a struct file when creating a
    regular NFSv4 file"). Vulnerable versions: 5.10.220 5.15.154 5.19-rc1.
introduced-by:
  cip/5.10: [c20097329d2c196b818c4666c7820c1378d69d61]
  cip/5.10-rt: [c20097329d2c196b818c4666c7820c1378d69d61]
  mainline: [fb70bf124b051d4ded4ce57511dfec6d3ebf2b43]
  stable/5.10: [c20097329d2c196b818c4666c7820c1378d69d61]
  stable/5.15: [106331a12b0fa5afa6995b1f9ebb03ddcaac6915]
fixed-by:
  mainline: [0b778361998d6c6356b8d2fc7ddf025fb3224654]
  stable/5.10: [45c08a752982116f3287afcd1bd9c50f4fab0c28]
  stable/6.1: [45c08a752982116f3287afcd1bd9c50f4fab0c28]
