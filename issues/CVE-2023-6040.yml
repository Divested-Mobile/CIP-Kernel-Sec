description: |-
  An out-of-bounds access vulnerability involving netfilter was reported and
  fixed as: f1082dd31fe4 (netfilter: nf_tables: Reject tables of unsupported
  family); While creating a new netfilter table, lack of a safeguard against
  invalid nf_tables family (pf) values within `nf_tables_newtable` function
  enables an attacker to achieve out-of-bounds access.
references:
- https://www.openwall.com/lists/oss-security/2024/01/12/1
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6040
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=f1082dd31fe461d482d69da2a8eccfeb7bf07ac2
- https://ubuntu.com/security/notices/USN-6605-1
- https://ubuntu.com/security/notices/USN-6607-1
- https://ubuntu.com/security/notices/USN-6609-1
- https://ubuntu.com/security/notices/USN-6605-2
- https://ubuntu.com/security/notices/USN-6609-2
- https://ubuntu.com/security/notices/USN-6609-3
- https://ubuntu.com/security/notices/USN-6628-1
- https://ubuntu.com/security/notices/USN-6628-2
- https://www.cve.org/CVERecord?id=CVE-2023-6040
comments:
  masmai: |-
    Fixed by commit f1082dd (" netfilter: nf_tables: Reject tables
    of unsupported family") in 5.18-rc1.
  ubuntu/eslerm: CWE-125
reporters:
- Lin Ma from Ant Security Light-Year Lab & ZJU
introduced-by:
  mainline: [98319cb9089844d76e65a6cce5bfbd165e698735]
fixed-by:
  cip/4.19: [087d38ae0fd5a9a41b949e97601b4b0d09336f19]
  cip/4.19-rt: [087d38ae0fd5a9a41b949e97601b4b0d09336f19]
  cip/5.10: [25d1e7be85cf0a5afca5555f90e4609c40480ece]
  cip/5.10-rt: [25d1e7be85cf0a5afca5555f90e4609c40480ece]
  mainline: [f1082dd31fe461d482d69da2a8eccfeb7bf07ac2]
  stable/4.19: [087d38ae0fd5a9a41b949e97601b4b0d09336f19]
  stable/5.10: [25d1e7be85cf0a5afca5555f90e4609c40480ece]
  stable/5.15: [ab3a3aadb373b47a1f401c7626608b1b214cec9e]
  stable/5.4: [8711fa0c06d49ad3a45b60cc10ae72980df89b00]
  ubuntu/focal: [c04596ae6d5a6db4cac9d157799c917606fb70d7]
