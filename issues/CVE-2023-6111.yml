description: 'netfilter: nf_tables: remove catchall element in GC sync path'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6111
- https://kernel.dance/93995bf4af2c5a99e2a87f0cd5ce547d31eb7630
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=93995bf4af2c5a99e2a87f0cd5ce547d31eb7630
- https://patchwork.ozlabs.org/project/netfilter-devel/patch/20231106113447.14290-1-pablo@netfilter.org/
- https://bugzilla.redhat.com/show_bug.cgi?id=2250105
- https://bugzilla.suse.com/show_bug.cgi?id=1217164
- https://ubuntu.com/security/notices/USN-6576-1
- https://www.cve.org/CVERecord?id=CVE-2023-6111
comments:
  debian/carnil: |-
    Introduced in 4a9e12ea7e70 ("netfilter: nft_set_pipapo: call
    nft_trans_gc_queue_sync() in catchall GC") in 6.6-rc3 (which
    got backported to 6.5.6, 6.1.56, 5.15.134).
    Fixed as well in 6.6.3 for 6.6.y and in 6.5.13 for 6.5.y.
    We did backport the commit as well in 6.1.55-1.
  ubuntu/rodrigo-zaiden: |-
    Google kCTF submission
    for 5.15 kernels, there was never a release with the commit
     that introduces the issue. in version 5.15.0-94.104 for the
     generic kernel, and for the kernels that derivate from that
     version, both the break and the fix commit were added, but
     still, there is no vulnerable version released. hence,
     Ubuntu 5.15 kernels are not-affected.
reporters:
- Lonial Con
introduced-by:
  cip/6.1: [8c643a8e040d4ab4e705087bd7442bee7fc262a2]
  cip/6.1-rt: [8c643a8e040d4ab4e705087bd7442bee7fc262a2]
  mainline: [4a9e12ea7e70223555ec010bec9f711089ce96f6]
  stable/5.15: [949369f9f0d9e3710bf9fce1d0158fdda93a7f9c]
  stable/6.1: [8c643a8e040d4ab4e705087bd7442bee7fc262a2]
  stable/6.5: [1e478aa1bfec17e4e5365f8d6b21dc614656e269]
fixed-by:
  cip/6.1: [13e2d49647a7f137ebc063a4a9702dda80371b2e]
  cip/6.1-rt: [13e2d49647a7f137ebc063a4a9702dda80371b2e]
  mainline: [93995bf4af2c5a99e2a87f0cd5ce547d31eb7630]
  stable/5.15: [0d9506c766c9601fe22d15584a99c704d7941ef6]
  stable/6.1: [13e2d49647a7f137ebc063a4a9702dda80371b2e]
  stable/6.5: [e3e68e617bfa8dfc8625d5e728b0fe4b4fb83876]
  stable/6.6: [80d6a9236ab6d2c0fd241514d1af2e325d16a210]
  ubuntu/focal: ['version:5.4.0-9.12']
