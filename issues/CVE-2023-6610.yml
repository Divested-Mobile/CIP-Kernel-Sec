description: OOB Access in smb2_dump_detail
references:
- https://bugzilla.kernel.org/show_bug.cgi?id=218219
- https://bugzilla.redhat.com/show_bug.cgi?id=2253614
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6610
- https://access.redhat.com/security/cve/CVE-2023-6610
- https://bugzilla.suse.com/show_bug.cgi?id=1217946
- https://ubuntu.com/security/notices/USN-6688-1
- https://ubuntu.com/security/notices/USN-6724-1
comments:
  debian/bwh: |-
    Introduced in 3.6 by commit 093b2bdad322 "CIFS: Make
    demultiplex_thread work with SMB2 code".  We don't enable
    CONFIG_CIFS_DEBUG2 so only custom kernels are affected.
  debian/carnil: For 6.6.y fixed as well in 6.6.13.
  ubuntu/cascardo: requires CONFIG_CIFS_DEBUG2
  ubuntu/sbeattie: |-
    while it's true that smb2_dump_detail() only does anything if
      CONFIG_CIFS_DEBUG2 is set and a cursory examination of Ubuntu kernel
      configs does not show that to be enabled anywhere, part of the fix
      also re-orders a message header check in smb2_check_message() which
      is called from smb2_check_message(), so there *may* be some impact
      here even when CONFIG_CIFS_DEBUG2 is not enabled.
fixed-by:
  cip/6.1: [5411e3292792be7dafd1fe948a87e3ca29c1f550]
  cip/6.1-rt: [5411e3292792be7dafd1fe948a87e3ca29c1f550]
  mainline: [567320c46a60a3c39b69aa1df802d753817a3f86]
  stable/6.1: [5411e3292792be7dafd1fe948a87e3ca29c1f550]
  stable/6.6: [c5e0ed716c52fddea5e625668e75658c3b81d3fc]
