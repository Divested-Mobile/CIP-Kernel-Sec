description: 'netfilter: nf_tables: check if catch-all set element is active in next
  generation'
references:
- https://kernel.dance/b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1085
- https://git.kernel.org/linus/b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7
- https://bugzilla.redhat.com/show_bug.cgi?id=2262127
- https://bugzilla.suse.com/show_bug.cgi?id=1219429
- https://ubuntu.com/security/notices/USN-6688-1
- https://ubuntu.com/security/notices/USN-6704-1
- https://ubuntu.com/security/notices/USN-6705-1
- https://ubuntu.com/security/notices/USN-6707-1
- https://ubuntu.com/security/notices/USN-6704-2
- https://ubuntu.com/security/notices/USN-6707-2
- https://ubuntu.com/security/notices/USN-6704-3
- https://ubuntu.com/security/notices/USN-6707-3
- https://ubuntu.com/security/notices/USN-6704-4
- https://ubuntu.com/security/notices/USN-6707-4
comments:
  debian/carnil: |-
    Fixed for 6.7.y in 6.7.2 and for 6.6.y in 6.6.14.
    Commit fixes aaa31047a6d2 ("netfilter: nftables: add catch-all
    set element support") in 5.13-rc1.
  masami: |-
    This bug was introduced by commit aaa3104 ("netfilter: nftables:
    add catch-all set element support") in 5.13-rc1.
    The commit aaa3104 is not backported to before 5.13 so that
    5.10, 5.4, and 4.x are not affected.
  ubuntu/rodrigo-zaiden: from Google kCTF.
reporters:
- Lonial Con
introduced-by:
  mainline: [aaa31047a6d25da0fa101da1ed544e1247949b40]
fixed-by:
  cip/6.1: [a372f1d01bc11aa85773a02353cd01aaf16dc18e]
  cip/6.1-rt: [a372f1d01bc11aa85773a02353cd01aaf16dc18e]
  mainline: [b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7]
  stable/5.15: [c9ed30eea4f7bfa2441235ce23abd339ee671f50]
  stable/6.1: [a372f1d01bc11aa85773a02353cd01aaf16dc18e]
  stable/6.6: [7baa33837ee2473eb0afd9755e29a25cd3771eac]
  stable/6.7: [7e0f5f8ae3e5f17e367f7040ade7a467f1f0e3b9]
  ubuntu/focal: ['version:5.4.0-9.12']
