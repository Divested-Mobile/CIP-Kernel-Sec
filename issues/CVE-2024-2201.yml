description: Mitigations for the native BHI hardware vulnerabilty
references:
- https://vusec.net/projects/native-bhi
- https://download.vusec.net/papers/inspectre_sec24.pdf
- https://github.com/vusec/inspectre-gadget
- https://vusec.github.io/inspectre-gadget/
- https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/branch-history-injection.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2201
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=2bb69f5fc72183e1c62547d900f560d0e9334925
- https://www.vusec.net/projects/native-bhi/
- https://lists.xenproject.org/archives/html/xen-announce/2024-04/msg00004.html
- 'NOTE: https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/branch-history-injection.html'
- https://www.cve.org/CVERecord?id=CVE-2024-2201
- https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/admin-guide/kernel-parameters.txt?id=2bb69f5fc72183e1c62547d900f560d0e9334925#n6066
- https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Native-BHI
- https://ubuntu.com/security/notices/USN-6765-1
- https://ubuntu.com/security/notices/USN-6766-1
- https://ubuntu.com/security/notices/USN-6766-2
- https://ubuntu.com/security/notices/USN-6774-1
- https://ubuntu.com/security/notices/USN-6766-3
- https://ubuntu.com/security/notices/USN-6795-1
- https://ubuntu.com/security/notices/USN-6828-1
comments:
  ubuntu/rodrigo-zaiden: |-
    USN-6765-1 for linux-oem-6.5 wrongly stated that this CVE
     was fixed in version 6.5.0-1022.23. The mentioned notice was revoked and
     the state of the fix for linux-oem-6.5 was recovered to the previous
     state.
  ubuntu/sbeattie: |-
    in the short term, Ubuntu 6.6 based kernels (Ubuntu 23.10
      LTS and Ubuntu 22.04 HWE kernels) have backported the first round of
      native_bhi mitigations, but are defaulting to spectre_bhi=auto. The
      kernel commandline parameter can be changed to spectre_bhi=on if
      desired; see the kernel parameters documentation linked to in the
      references section.  This default will change to match the upstream
      kernel's default to "on" in a subsequent update.
reporters:
- Sander Wiebing
- Alvise de Faveri Tron
- Herbert Bos
- Cristiano Giuffrida
fixed-by:
  cip/6.1: [fd52c0397b53ebcd4931981b3bc38f3b760b74df, 74fcb181772e5b8a8f1244c7393c56ae6d03c330,
    07dbb10f153f483e8249acebdffedf922e2ec2e1, 29c50bb6fbe4598d313ddb7ddb183e8b3d7bdf80,
    42196bdec0824900b02bc21e02e9bb139197ca14, bb8384b6dfbc49be230071d1e844a8741982b1ec,
    43704e993ae54b8caf821501229dd2534ecb0e56, 3e4283b77107d1105a378859eb196e3ba5661270]
  cip/6.1-rt: [fd52c0397b53ebcd4931981b3bc38f3b760b74df, 74fcb181772e5b8a8f1244c7393c56ae6d03c330,
    07dbb10f153f483e8249acebdffedf922e2ec2e1, 29c50bb6fbe4598d313ddb7ddb183e8b3d7bdf80,
    42196bdec0824900b02bc21e02e9bb139197ca14, bb8384b6dfbc49be230071d1e844a8741982b1ec,
    43704e993ae54b8caf821501229dd2534ecb0e56, 3e4283b77107d1105a378859eb196e3ba5661270]
  mainline: [0cd01ac5dcb1e18eb18df0f0d05b5de76522a437, 1e3ad78334a69b36e107232e337f9d693dcc9df2,
    7390db8aea0d64e9deb28b8e1ce716f5020c7ee5, 0f4a837615ff925ba62648d280a861adf1582df7,
    be482ff9500999f56093738f9219bbabc729d163, ec9404e40e8f36421a2b66ecb76dc2209fe7f3ef,
    95a6ccbdc7199a14b71ad8901cb788ba7fb5167b, ed2e8d49b54d677f3123668a21a57822d679651f]
  stable/5.15: [276fb9a658d0f44bc2e11b5f838cbe4e5759a223, 55516b355b0c6c747fa89edc53f10cf4b03441ef,
    bd53ec80f21839cfd4d852a6088279d602d67e5b, a9ca0e34a406b5e122ad1e9b7e12a4281fccfca1,
    aa6247c9da2571afafd2bf7c709b0535f66d3900, f825494f2c6fab421c5c59b5def321775c825818,
    c2b9e038896f01ba4bec87cfc97573b7f1b736d6, a976b129dc868561f6cbb5e2dafe2345f32450e8]
  stable/6.1: [fd52c0397b53ebcd4931981b3bc38f3b760b74df, 74fcb181772e5b8a8f1244c7393c56ae6d03c330,
    07dbb10f153f483e8249acebdffedf922e2ec2e1, 29c50bb6fbe4598d313ddb7ddb183e8b3d7bdf80,
    42196bdec0824900b02bc21e02e9bb139197ca14, bb8384b6dfbc49be230071d1e844a8741982b1ec,
    43704e993ae54b8caf821501229dd2534ecb0e56, 3e4283b77107d1105a378859eb196e3ba5661270,
    e21838dfd0844b093a92d4cdd4db836b473c912d]
  stable/6.6: [108feca9e47df1bed26ac7b04306587d9ebccda3, eb0f175b34287f886019b86ac2f410df331d2c34,
    eb36b0dce2138581bc6b5e39d0273cb4c96ded81, c6e3d590d0514612d96c572cba66ae0cb4b505a2,
    118794d0a572c7a8514dc774e68b59d41857b81c, d414b401f9539858574a19af4ffc0fc0d53bfb8f,
    1c42ff893a8fb802dd90ca06af928826fdf0d16b, cb238e95ee72a64e53a4f93181aae634cc0d3be6,
    6d9ef0c36980ef051cb55aeefb6438429e37268a]
  stable/6.8: [36264ae643789d014a81bc9427797a5af607150e, 33257e28bf6d8691a040b7f1f5cd13997539f717,
    8f51637712e4da5be410a1666f8aee0d86eef898, aec26bd00ed73c21f8f98b3e1667bc4cf016a9cf,
    a96b54b4b839536b8ffa81ec0b831d3106243a23, a39bfa52671beb750fa2e1c7400469cde9c8ff9f,
    2bf604dc494f9f747eee62e7d46b2c179aa243dc, 15d6de3746ed724b93aca6c16e1ada68d379cb48]
