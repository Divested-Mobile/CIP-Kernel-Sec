description: NULL pointer dereference bug was found in bluetooth device driver in
  {min,max}_key_size_set()
references:
- https://bugzilla.openanolis.cn/show_bug.cgi?id=8151
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-24860
- https://bugzilla.suse.com/show_bug.cgi?id=1219608
- https://ubuntu.com/security/notices/USN-6688-1
- https://ubuntu.com/security/notices/USN-6725-1
- https://www.cve.org/CVERecord?id=CVE-2024-24860
- https://ubuntu.com/security/notices/USN-6725-2
- https://ubuntu.com/security/notices/USN-6765-1
- https://ubuntu.com/security/notices/USN-6818-1
- https://ubuntu.com/security/notices/USN-6819-1
comments:
  debian/carnil: |-
    Introduced by 18f81241b74f ("Bluetooth: Move {min,max}_key_size
    debugfs ...") in 5.6-rc1.
  masami: "It looks like commit da9065caa (\"Bluetooth: Fix atomicity\nviolation in\
    \ {min,max}_key_size_set\") fixes this vulnerability\nbut accessing to the bugzilla\
    \ \n(https://bugzilla.openanolis.cn/show_bug.cgi?id=8151) is\nrestricted now so\
    \ we need to wait for sometime."
  ubuntu/rodrigo-zaiden: |-
    USN-6765-1 for linux-oem-6.5 wrongly stated that this CVE
     was fixed in version 6.5.0-1022.23. The mentioned notice was revoked and
     the state of the fix for linux-oem-6.5 was recovered to the previous
     state.
  ubuntu/sbeattie: |-
    fix commit references 18f81241b74f ("Bluetooth: Move
     {min,max}_key_size debugfs ...")  but the race condition looks to
     have existed since the introduction of le_min_key_size_write()
     and le_max_key_size_write() which were later renamed to
     {min,max}_key_size_set().
introduced-by:
  mainline: [18f81241b74fb49d576c83fbbab9a0b6e3bb20d4]
fixed-by:
  cip/5.10: [394c6c0b6d9bdd7d6ebca35ca9cfbabf44c0c257]
  cip/5.10-rt: [394c6c0b6d9bdd7d6ebca35ca9cfbabf44c0c257]
  cip/6.1: [96860d9ad462db61f4eeb09934235c38eab655c4]
  cip/6.1-rt: [96860d9ad462db61f4eeb09934235c38eab655c4]
  mainline: [da9065caa594d19b26e1a030fd0cc27bd365d685]
  stable/5.10: [394c6c0b6d9bdd7d6ebca35ca9cfbabf44c0c257]
  stable/5.15: [4c71c01df8ef209e7fe22b58666cd2cf3dbafb44]
  stable/6.1: [96860d9ad462db61f4eeb09934235c38eab655c4]
  stable/6.6: [f56e715ef1c19c42c6aa6cb9280947dea13aab2e]
  stable/6.7: [d1c6a77d6d48215ba723f910eaabdb6e60d21a37]
