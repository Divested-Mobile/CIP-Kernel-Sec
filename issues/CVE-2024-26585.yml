description: 'tls: fix race between tx work scheduling and socket close'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26585
- https://lore.kernel.org/linux-cve-announce/2024022150-fancy-numerate-94ab@gregkh/T/#u
- 'carnil> Introduced with a42055e8d2c3 ("net/tls: Add support for async'
- carnil> encryption of records for performance") in 4.20-rc1.
- https://git.kernel.org/linus/e01e3934a1b2d122919f73bc6ddbe1cdafc4bbdb
- https://git.kernel.org/stable/c/e01e3934a1b2d122919f73bc6ddbe1cdafc4bbdb
- carnil> For 6.6.y fixed in 6.6.18. For 6.7.y in 6.7.6.
- https://git.kernel.org/stable/c/6db22d6c7a6dc914b12c0469b94eb639b6a8a146
- https://git.kernel.org/stable/c/e327ed60bff4a991cd7a709c47c4f0c5b4a4fd57
- https://git.kernel.org/stable/c/196f198ca6fce04ba6ce262f5a0e4d567d7d219d
- https://www.cve.org/CVERecord?id=CVE-2024-26585
- https://ubuntu.com/security/notices/USN-6765-1
- https://ubuntu.com/security/notices/USN-6818-1
- https://ubuntu.com/security/notices/USN-6819-1
- https://ubuntu.com/security/notices/USN-6820-1
- https://ubuntu.com/security/notices/USN-6821-1
- https://ubuntu.com/security/notices/USN-6818-2
- https://ubuntu.com/security/notices/USN-6821-2
- https://ubuntu.com/security/notices/USN-6828-1
- https://ubuntu.com/security/notices/USN-6820-2
- https://ubuntu.com/security/notices/USN-6821-3
- https://ubuntu.com/security/notices/USN-6819-2
- https://ubuntu.com/security/notices/USN-6819-3
- https://ubuntu.com/security/notices/USN-6818-3
- https://ubuntu.com/security/notices/USN-6821-4
- https://ubuntu.com/security/notices/USN-6818-4
comments:
  debian/carnil: |-
    Introduced in a42055e8d2c3 ("net/tls: Add support for async encryption of
    records for performance"). Vulnerable versions: 4.20-rc1.
  masami: "This bug was introduced by commit a42055e (\"net/tls: Add support \nfor\
    \ async encryption of records for performance\")\nin 4.20-rc1. Linux 4.19, and\
    \ 4.4 are not affected."
  ubuntu/rodrigo-zaiden: |-
    USN-6765-1 for linux-oem-6.5 wrongly stated that this CVE
     was fixed in version 6.5.0-1022.23. The mentioned notice was revoked and
     the state of the fix for linux-oem-6.5 was recovered to the previous
     state.
introduced-by:
  mainline: [a42055e8d2c30d4decfc13ce943d09c7b9dad221]
fixed-by:
  cip/6.1: [196f198ca6fce04ba6ce262f5a0e4d567d7d219d]
  cip/6.1-rt: [196f198ca6fce04ba6ce262f5a0e4d567d7d219d]
  mainline: [e01e3934a1b2d122919f73bc6ddbe1cdafc4bbdb]
  stable/6.1: [196f198ca6fce04ba6ce262f5a0e4d567d7d219d]
  stable/6.6: [6db22d6c7a6dc914b12c0469b94eb639b6a8a146]
  stable/6.7: [e327ed60bff4a991cd7a709c47c4f0c5b4a4fd57]
