description: 'bpf: Reject variable offset alu on PTR_TO_FLOW_KEYS'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26589
- https://git.kernel.org/stable/c/29ffa63f21bcdcef3e36b03cccf9d0cd031f6ab0
- https://git.kernel.org/stable/c/4108b86e324da42f7ed425bd71632fd844300dc8
- https://git.kernel.org/stable/c/e8d3872b617c21100c5ee4f64e513997a68c2e3d
- https://git.kernel.org/stable/c/1b500d5d6cecf98dd6ca88bc9e7ae1783c83e6d3
- https://git.kernel.org/stable/c/22c7fa171a02d310e3a3f6ed46a698ca8a0060ed
- https://lore.kernel.org/linux-cve-announce/2024022257-CVE-2024-26589-0ee1@gregkh/T/#u
- https://ubuntu.com/security/notices/USN-6688-1
- https://ubuntu.com/security/notices/USN-6725-1
- https://www.cve.org/CVERecord?id=CVE-2024-26589
comments:
  debian/carnil: |-
    Introduced in d58e468b1112 ("flow_dissector: implements flow dissector BPF
    hook"). Vulnerable versions: 4.20-rc1.
  masami: |-
    Introduced by commit d58e468 ("flow_dissector: implements
    flow dissector BPF hook") in 4.20-rc1.
    This commit is not backported to older stable kernels.
    Fixed in 6.8-rc1.
introduced-by:
  mainline: [d58e468b1112dcd1d5193c0a89ff9f98b5a3e8b9]
fixed-by:
  cip/6.1: [4108b86e324da42f7ed425bd71632fd844300dc8]
  cip/6.1-rt: [4108b86e324da42f7ed425bd71632fd844300dc8]
  mainline: [22c7fa171a02d310e3a3f6ed46a698ca8a0060ed]
  stable/5.15: [29ffa63f21bcdcef3e36b03cccf9d0cd031f6ab0]
  stable/6.1: [4108b86e324da42f7ed425bd71632fd844300dc8]
  stable/6.6: [e8d3872b617c21100c5ee4f64e513997a68c2e3d]
  stable/6.7: [1b500d5d6cecf98dd6ca88bc9e7ae1783c83e6d3]
  ubuntu/focal: [d579c4c00d08764cbaee9152324f6346364f962e]
