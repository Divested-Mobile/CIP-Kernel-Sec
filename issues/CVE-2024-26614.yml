description: 'tcp: make sure init the accept_queue''s spinlocks once'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26614
- https://lore.kernel.org/linux-cve-announce/20240229155245.1571576-46-lee@kernel.org/T/#u
- https://git.kernel.org/stable/c/bc99dcedd2f422d602516762b96c8ef1ae6b2882
- https://git.kernel.org/stable/c/d86cc6ab33b085eaef27ea88b78fc8e2375c0ef3
- https://git.kernel.org/stable/c/b1e0a68a0cd2a83259c444f638b417a8fffc6855
- https://git.kernel.org/stable/c/168e7e599860654876c2a1102a82610285c02f02
- https://git.kernel.org/stable/c/3982fe726a63fb3de6005e534e2ac8ca7e0aca2a
- https://git.kernel.org/stable/c/198bc90e0e734e5f98c3d2833e8390cac3df61b2
- https://git.kernel.org/linus/198bc90e0e734e5f98c3d2833e8390cac3df61b2
- https://www.cve.org/CVERecord?id=CVE-2024-26614
- https://ubuntu.com/security/notices/USN-6765-1
- https://ubuntu.com/security/notices/USN-6766-1
- https://ubuntu.com/security/notices/USN-6766-2
- https://ubuntu.com/security/notices/USN-6774-1
- https://ubuntu.com/security/notices/USN-6776-1
- https://ubuntu.com/security/notices/USN-6777-1
- https://ubuntu.com/security/notices/USN-6778-1
- https://ubuntu.com/security/notices/USN-6766-3
- https://ubuntu.com/security/notices/USN-6777-2
- https://ubuntu.com/security/notices/USN-6777-3
- https://ubuntu.com/security/notices/USN-6777-4
- https://ubuntu.com/security/notices/USN-6795-1
comments:
  debian/carnil: |-
    Introduced in fff1f3001cc5 ("tcp: add a spinlock to protect struct
    request_sock_queue")
    168a8f58059a ("tcp: TCP Fast Open Server - main code path"). Vulnerable
    versions: 3.7-rc1 4.4-rc1 4.19.207 5.4.148 5.10.67 5.13.19 5.14.6.
  masami: "Introduced by commit fff1f30 (\"tcp: add a spinlock to protect struct \n\
    request_sock_queue\") in 4.4-rc1 and 168a8f5 (\"tcp: TCP Fast Open Server - \n\
    main code path\") in 3.7-rc1. Fixed in 6.8-rc2."
  ubuntu/rodrigo-zaiden: |-
    USN-6765-1 for linux-oem-6.5 wrongly stated that this CVE
     was fixed in version 6.5.0-1022.23. The mentioned notice was revoked and
     the state of the fix for linux-oem-6.5 was recovered to the previous
     state.
introduced-by:
  mainline: [fff1f3001cc58b5064a0f1154a7ac09b76f29c44, 168a8f58059a22feb9e9a2dcc1b8053dbbbc12ef]
fixed-by:
  cip/5.10: [bc99dcedd2f422d602516762b96c8ef1ae6b2882]
  cip/5.10-rt: [bc99dcedd2f422d602516762b96c8ef1ae6b2882]
  cip/6.1: [b1e0a68a0cd2a83259c444f638b417a8fffc6855]
  cip/6.1-rt: [b1e0a68a0cd2a83259c444f638b417a8fffc6855]
  mainline: [198bc90e0e734e5f98c3d2833e8390cac3df61b2]
  stable/5.10: [bc99dcedd2f422d602516762b96c8ef1ae6b2882]
  stable/5.15: [d86cc6ab33b085eaef27ea88b78fc8e2375c0ef3]
  stable/6.1: [b1e0a68a0cd2a83259c444f638b417a8fffc6855]
  stable/6.6: [168e7e599860654876c2a1102a82610285c02f02]
  stable/6.7: [3982fe726a63fb3de6005e534e2ac8ca7e0aca2a]
  ubuntu/focal: [a2bdb18fc373e0fb925bd2f0b780490e24ad7460]
