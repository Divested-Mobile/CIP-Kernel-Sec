description: 'arm64/sme: Always exit sme_alloc() early with existing storage'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26618
- https://lore.kernel.org/linux-cve-announce/20240229155245.1571576-50-lee@kernel.org/T/#u
- https://git.kernel.org/stable/c/569156e4fa347237f8fa2a7e935d860109c55ac4
- https://git.kernel.org/stable/c/814af6b4e6000e574e74d92197190edf07cc3680
- https://git.kernel.org/stable/c/dc7eb8755797ed41a0d1b5c0c39df3c8f401b3d9
- https://git.kernel.org/linus/dc7eb8755797ed41a0d1b5c0c39df3c8f401b3d9
- https://www.cve.org/CVERecord?id=CVE-2024-26618
- https://ubuntu.com/security/notices/USN-6765-1
- https://ubuntu.com/security/notices/USN-6818-1
- https://ubuntu.com/security/notices/USN-6819-1
- https://ubuntu.com/security/notices/USN-6818-2
- https://ubuntu.com/security/notices/USN-6819-2
- https://ubuntu.com/security/notices/USN-6819-3
- https://ubuntu.com/security/notices/USN-6818-3
- https://ubuntu.com/security/notices/USN-6818-4
- https://ubuntu.com/security/notices/USN-6819-4
comments:
  debian/carnil: |-
    Introduced in 5d0a8d2fba50 ("arm64/ptrace: Ensure that SME is set up for target
    when writing SSVE state"). Vulnerable versions: 6.1.47 6.4.12 6.5-rc7.
  masami: "Introduced by commit 5d0a8d2 (\"arm64/ptrace: Ensure that SME is set up\
    \ for \ntarget when writing SSVE state\") in 6.5-rc7. This commit is backported\
    \ to \n6.1. Linux 5.x and 4.x are not affected. Fixed in 6.8-rc1."
  ubuntu/rodrigo-zaiden: |-
    USN-6765-1 for linux-oem-6.5 wrongly stated that this CVE
     was fixed in version 6.5.0-1022.23. The mentioned notice was revoked and
     the state of the fix for linux-oem-6.5 was recovered to the previous
     state.
introduced-by:
  cip/6.1: [21614ba60883eb93b99a7ee4b41cb927f93b39ae]
  cip/6.1-rt: [21614ba60883eb93b99a7ee4b41cb927f93b39ae]
  mainline: [5d0a8d2fba50e9c07cde4aad7fba28c008b07a5b]
  stable/6.1: [21614ba60883eb93b99a7ee4b41cb927f93b39ae]
fixed-by:
  mainline: [dc7eb8755797ed41a0d1b5c0c39df3c8f401b3d9]
  stable/6.6: [569156e4fa347237f8fa2a7e935d860109c55ac4]
  stable/6.7: [814af6b4e6000e574e74d92197190edf07cc3680]
  ubuntu/focal: ['version:5.4.0-9.12']
