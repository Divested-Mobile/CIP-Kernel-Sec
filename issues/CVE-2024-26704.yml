description: 'ext4: fix double-free of blocks due to wrong extents moved_len'
references:
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-26704
- https://git.kernel.org/stable/c/b4fbb89d722cbb16beaaea234b7230faaaf68c71
- https://git.kernel.org/stable/c/afbcad9ae7d6d11608399188f03a837451b6b3a1
- https://git.kernel.org/stable/c/d033a555d9a1cf53dbf3301af7199cc4a4c8f537
- https://git.kernel.org/stable/c/afba9d11320dad5ce222ac8964caf64b7b4bedb1
- https://git.kernel.org/stable/c/185eab30486ba3e7bf8b9c2e049c79a06ffd2bc1
- https://git.kernel.org/stable/c/2883940b19c38d5884c8626483811acf4d7e148f
- https://git.kernel.org/stable/c/559ddacb90da1d8786dd8ec4fd76bbfa404eaef6
- https://git.kernel.org/stable/c/55583e899a5357308274601364741a83e78d6ac4
- https://lore.kernel.org/linux-cve-announce/2024040340-CVE-2024-26704-a082@gregkh/
- https://git.kernel.org/linus/55583e899a5357308274601364741a83e78d6ac4
- https://www.cve.org/CVERecord?id=CVE-2024-26704
- https://ubuntu.com/security/notices/USN-6766-1
- https://ubuntu.com/security/notices/USN-6767-1
- https://ubuntu.com/security/notices/USN-6767-2
- https://ubuntu.com/security/notices/USN-6766-2
- https://ubuntu.com/security/notices/USN-6774-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit fcf6b1b ("ext4: refactor ext4_move_extents code base") in v3.18-rc2.
    Fixed in v6.8-rc3.
  debian/carnil: |-
    Introduced in fcf6b1b729bc ("ext4: refactor ext4_move_extents code base").
    Vulnerable versions: 3.18-rc2.
introduced-by:
  mainline: [fcf6b1b729bcd23f2b49a84fb33ffbb44712ee6a]
fixed-by:
  cip/4.19: [b4fbb89d722cbb16beaaea234b7230faaaf68c71]
  cip/4.4: [052905e830d7a5f7bf023f09a028cc7546b38339]
  cip/4.4-rt: [052905e830d7a5f7bf023f09a028cc7546b38339]
  cip/4.4-st: [052905e830d7a5f7bf023f09a028cc7546b38339]
  cip/5.10: [d033a555d9a1cf53dbf3301af7199cc4a4c8f537]
  cip/5.10-rt: [d033a555d9a1cf53dbf3301af7199cc4a4c8f537]
  cip/6.1: [185eab30486ba3e7bf8b9c2e049c79a06ffd2bc1]
  cip/6.1-rt: [185eab30486ba3e7bf8b9c2e049c79a06ffd2bc1]
  mainline: [55583e899a5357308274601364741a83e78d6ac4]
  stable/4.19: [b4fbb89d722cbb16beaaea234b7230faaaf68c71]
  stable/5.10: [d033a555d9a1cf53dbf3301af7199cc4a4c8f537]
  stable/5.15: [afba9d11320dad5ce222ac8964caf64b7b4bedb1]
  stable/5.4: [afbcad9ae7d6d11608399188f03a837451b6b3a1]
  stable/6.1: [185eab30486ba3e7bf8b9c2e049c79a06ffd2bc1]
  stable/6.6: [2883940b19c38d5884c8626483811acf4d7e148f]
  stable/6.7: [559ddacb90da1d8786dd8ec4fd76bbfa404eaef6]
  ubuntu/focal: [8ec8e308186b73099e9cd73d471c968eb39dd4e5]
