description: 'mm: swap: fix race between free_swap_and_cache() and swapoff()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-26960
- https://git.kernel.org/stable/c/d85c11c97ecf92d47a4b29e3faca714dc1f18d0d
- https://git.kernel.org/stable/c/2da5568ee222ce0541bfe446a07998f92ed1643e
- https://git.kernel.org/stable/c/1ede7f1d7eed1738d1b9333fd1e152ccb450b86a
- https://git.kernel.org/stable/c/0f98f6d2fb5fad00f8299b84b85b6bc1b6d7d19a
- https://git.kernel.org/stable/c/3ce4c4c653e4e478ecb15d3c88e690f12cbf6b39
- https://git.kernel.org/stable/c/363d17e7f7907c8e27a9e86968af0eaa2301787b
- https://git.kernel.org/stable/c/82b1c07a0af603e3c47b906c8e991dc96f01688e
- https://lore.kernel.org/linux-cve-announce/2024050129-CVE-2024-26960-ad6b@gregkh/
- https://git.kernel.org/linus/82b1c07a0af603e3c47b906c8e991dc96f01688e
- https://ubuntu.com/security/notices/USN-6816-1
- https://ubuntu.com/security/notices/USN-6817-1
- https://ubuntu.com/security/notices/USN-6817-2
- https://ubuntu.com/security/notices/USN-6817-3
- https://ubuntu.com/security/notices/USN-6878-1
- https://ubuntu.com/security/notices/USN-6898-1
- https://ubuntu.com/security/notices/USN-6898-2
- https://ubuntu.com/security/notices/USN-6898-3
- https://ubuntu.com/security/notices/USN-6898-4
- https://ubuntu.com/security/notices/USN-6917-1
- https://ubuntu.com/security/notices/USN-6919-1
- https://ubuntu.com/security/notices/USN-6927-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 7c00baf ("mm/swap: free swap slots in batch") in v4.11-rc1.
    Fixed in v6.9-rc1.
  debian/carnil: |-
    Introduced in 7c00bafee87c ("mm/swap: free swap slots in batch"). Vulnerable
    versions: 4.11-rc1.
  ubuntu/bjamison: increse priority to high - UAF write
introduced-by:
  mainline: [7c00bafee87c7bac7ed9eced7c161f8e5332cb4e]
fixed-by:
  cip/5.10: [d85c11c97ecf92d47a4b29e3faca714dc1f18d0d]
  cip/5.10-rt: [d85c11c97ecf92d47a4b29e3faca714dc1f18d0d]
  cip/6.1: [1ede7f1d7eed1738d1b9333fd1e152ccb450b86a]
  cip/6.1-rt: [1ede7f1d7eed1738d1b9333fd1e152ccb450b86a]
  mainline: [82b1c07a0af603e3c47b906c8e991dc96f01688e]
  stable/5.10: [d85c11c97ecf92d47a4b29e3faca714dc1f18d0d]
  stable/5.15: [2da5568ee222ce0541bfe446a07998f92ed1643e]
  stable/6.1: [1ede7f1d7eed1738d1b9333fd1e152ccb450b86a]
  stable/6.6: [0f98f6d2fb5fad00f8299b84b85b6bc1b6d7d19a]
  stable/6.8: [363d17e7f7907c8e27a9e86968af0eaa2301787b]
  ubuntu/focal: [36961e76a5c101e93fc65ec17c88629feeb41fb3]
