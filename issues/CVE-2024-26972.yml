description: 'ubifs: ubifs_symlink: Fix memleak of inode->i_link in error path'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-26972
- https://git.kernel.org/stable/c/62b5ae00c2b835639002ce898ccb5d82c51073ae
- https://git.kernel.org/stable/c/6379b44cdcd67f5f5d986b73953e99700591edfa
- https://lore.kernel.org/linux-cve-announce/2024050132-CVE-2024-26972-bf6c@gregkh/
- https://git.kernel.org/linus/6379b44cdcd67f5f5d986b73953e99700591edfa
- https://ubuntu.com/security/notices/USN-6816-1
- https://ubuntu.com/security/notices/USN-6817-1
- https://ubuntu.com/security/notices/USN-6817-2
- https://ubuntu.com/security/notices/USN-6817-3
- https://ubuntu.com/security/notices/USN-6878-1
- https://git.kernel.org/stable/c/3faea7810e2b3e9a9a92ef42d7e5feaeb8ff7133
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 2c58d54 ("fscrypt: cache decrypted symlink target in ->i_link") in v5.2-rc1.
    Fixed in v6.9-rc1.
  debian/carnil: |-
    Introduced in 2c58d548f570 ("fscrypt: cache decrypted symlink target in
    ->i_link"). Vulnerable versions: 5.2-rc1.
  ubuntu/cache-use-only: |-
    The fix commit is applied twice, 1e022216dcd2 and
     6379b44cdcd6, and the upstream has decided to revert the latter one keep the
     first one. So use the first one instead of the second one.
introduced-by:
  mainline: [2c58d548f5706d085c4b009f6abb945220460632]
fixed-by:
  mainline: [6379b44cdcd67f5f5d986b73953e99700591edfa]
  stable/6.6: [b9077897329384b92435f9cafd7ee3c11a3eaa70]
  stable/6.8: [62b5ae00c2b835639002ce898ccb5d82c51073ae]
  ubuntu/focal: ['version:5.4.0-181.201']
