description: 'netfilter: nf_tables: restore set elements when delete set fails'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-27012
- https://git.kernel.org/stable/c/86658fc7414d4b9e25c2699d751034537503d637
- https://git.kernel.org/stable/c/e79b47a8615d42c68aaeb68971593333667382ed
- https://lore.kernel.org/linux-cve-announce/2024050148-CVE-2024-27012-5564@gregkh/
- https://git.kernel.org/linus/e79b47a8615d42c68aaeb68971593333667382ed
- https://ubuntu.com/security/notices/USN-6893-1
- https://ubuntu.com/security/notices/USN-6893-2
- https://ubuntu.com/security/notices/USN-6893-3
- https://ubuntu.com/security/notices/USN-6918-1
- https://ubuntu.com/security/notices/USN-7021-1
- https://ubuntu.com/security/notices/USN-7022-1
- https://ubuntu.com/security/notices/USN-7021-2
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 628bd3e ("netfilter: nf_tables: drop map element references from preparation phase") in v6.4.
    Fixed in v6.9-rc5.
  debian/carnil: |-
    Introduced in 628bd3e49cba ("netfilter: nf_tables: drop map element references
    from preparation phase"). Vulnerable versions: 5.4.262 5.10.188 5.15.121 6.1.36
    6.3.10 6.4.
introduced-by:
  cip/4.19: [bc9f791d2593f17e39f87c6e2b3a36549a3705b1]
  cip/4.19-rt: [bc9f791d2593f17e39f87c6e2b3a36549a3705b1]
  cip/5.10: [a136b7942ad2a50de708f76ea299ccb45ac7a7f9]
  cip/5.10-rt: [a136b7942ad2a50de708f76ea299ccb45ac7a7f9]
  cip/6.1: [d60be2da67d172aecf866302c91ea11533eca4d9]
  cip/6.1-rt: [d60be2da67d172aecf866302c91ea11533eca4d9]
  mainline: [628bd3e49cba1c066228e23d71a852c23e26da73]
  stable/4.19: [bc9f791d2593f17e39f87c6e2b3a36549a3705b1]
  stable/5.10: [a136b7942ad2a50de708f76ea299ccb45ac7a7f9]
  stable/5.15: [25aa2ad37c2162be1c0bc4fe6397f7e4c13f00f8]
  stable/5.4: [3c7ec098e3b588434a8b07ea9b5b36f04cef1f50]
  stable/6.1: [d60be2da67d172aecf866302c91ea11533eca4d9]
  ubuntu/focal: [ed451c5e45d6286bab6008b3f70acde3ce8fc057]
fixed-by:
  mainline: [e79b47a8615d42c68aaeb68971593333667382ed]
  stable/6.8: [86658fc7414d4b9e25c2699d751034537503d637]
  ubuntu/focal: [11370c531a98c80e23b081ef80cb500d0d052479]
