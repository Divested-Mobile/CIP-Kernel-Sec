description: 'Bluetooth: hci_event: Fix handling of HCI_EV_IO_CAPA_REQUEST'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-27416
- https://git.kernel.org/stable/c/afec8f772296dd8e5a2a6f83bbf99db1b9ca877f
- https://git.kernel.org/stable/c/79820a7e1e057120c49be07cbe10643d0706b259
- https://git.kernel.org/stable/c/df193568d61234c81de7ed4d540c01975de60277
- https://git.kernel.org/stable/c/c3df637266df29edee85e94cab5fd7041e5753ba
- https://git.kernel.org/stable/c/30a5e812f78e3d1cced90e1ed750bf027599205f
- https://git.kernel.org/stable/c/fba268ac36ab19f9763ff90d276cde0ce6cd5f31
- https://git.kernel.org/stable/c/8e2758cc25891d2b76717aaf89b40ed215de188c
- https://git.kernel.org/stable/c/7e74aa53a68bf60f6019bd5d9a9a1406ec4d4865
- https://lore.kernel.org/linux-cve-announce/2024051703-CVE-2024-27416-f368@gregkh/
- https://git.kernel.org/linus/7e74aa53a68bf60f6019bd5d9a9a1406ec4d4865
- https://ubuntu.com/security/notices/USN-6820-1
- https://ubuntu.com/security/notices/USN-6821-1
- https://ubuntu.com/security/notices/USN-6821-2
- https://ubuntu.com/security/notices/USN-6828-1
- https://ubuntu.com/security/notices/USN-6820-2
- https://ubuntu.com/security/notices/USN-6821-3
- https://ubuntu.com/security/notices/USN-6831-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c7f5946 ("Bluetooth: Fix a refcnt underflow problem for hci_conn") in v6.6-rc7.
    Fixed in v6.8-rc7.
  debian/carnil: |-
    Introduced in c7f59461f5a7 ("Bluetooth: Fix a refcnt underflow problem for
    hci_conn"). Vulnerable versions: 4.14.328 4.19.297 5.4.259 5.10.199 5.15.137
    6.1.60 6.5.9 6.6-rc7.
introduced-by:
  cip/4.19: [ccb8618c972f941ebc6b2b9db491025b3369efcb]
  cip/4.19-rt: [ccb8618c972f941ebc6b2b9db491025b3369efcb]
  cip/4.4: [ab797514106f0a69bce6af19b8c916c6267677d9]
  cip/4.4-rt: [ab797514106f0a69bce6af19b8c916c6267677d9]
  cip/4.4-st: [ab797514106f0a69bce6af19b8c916c6267677d9]
  cip/5.10: [40a33a129d99639921ce00d274cca44ba282f1ac]
  cip/5.10-rt: [40a33a129d99639921ce00d274cca44ba282f1ac]
  cip/6.1: [25e5d2883002e235f3378b8592aad14aeeef898c]
  cip/6.1-rt: [25e5d2883002e235f3378b8592aad14aeeef898c]
  mainline: [c7f59461f5a78994613afc112cdd73688aef9076]
  stable/4.19: [ccb8618c972f941ebc6b2b9db491025b3369efcb]
  stable/5.10: [40a33a129d99639921ce00d274cca44ba282f1ac]
  stable/5.15: [1ef071526848cc3109ade63268854cd7c20ece0c]
  stable/5.4: [1769ac55dbf3114d5bf79f11bd5dca80ee263f9c]
  stable/6.1: [25e5d2883002e235f3378b8592aad14aeeef898c]
  ubuntu/focal: [a6ab98652a72e8cf37ebcfcf0f5372015c28d419]
fixed-by:
  cip/4.19: [afec8f772296dd8e5a2a6f83bbf99db1b9ca877f]
  cip/4.19-rt: [afec8f772296dd8e5a2a6f83bbf99db1b9ca877f]
  cip/4.4: [8d756eeb85e8aed412ab3f6682771d0d4e3f6726]
  cip/4.4-rt: [8d756eeb85e8aed412ab3f6682771d0d4e3f6726]
  cip/4.4-st: [8d756eeb85e8aed412ab3f6682771d0d4e3f6726]
  cip/5.10: [df193568d61234c81de7ed4d540c01975de60277]
  cip/5.10-rt: [df193568d61234c81de7ed4d540c01975de60277]
  cip/6.1: [30a5e812f78e3d1cced90e1ed750bf027599205f]
  cip/6.1-rt: [30a5e812f78e3d1cced90e1ed750bf027599205f]
  mainline: [7e74aa53a68bf60f6019bd5d9a9a1406ec4d4865]
  stable/4.19: [afec8f772296dd8e5a2a6f83bbf99db1b9ca877f]
  stable/5.10: [df193568d61234c81de7ed4d540c01975de60277]
  stable/5.15: [c3df637266df29edee85e94cab5fd7041e5753ba]
  stable/5.4: [79820a7e1e057120c49be07cbe10643d0706b259]
  stable/6.1: [30a5e812f78e3d1cced90e1ed750bf027599205f]
  stable/6.6: [fba268ac36ab19f9763ff90d276cde0ce6cd5f31]
  ubuntu/focal: [a81d57b169611730ba19b6651f4f33949702e0e0]
