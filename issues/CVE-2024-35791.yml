description: 'KVM: SVM: Flush pages under kvm->lock to fix UAF in svm_register_enc_region()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35791
- https://git.kernel.org/stable/c/2d13b79640b147bd77c34a5998533b2021a4122d
- https://git.kernel.org/stable/c/e126b508ed2e616d679d85fca2fbe77bb48bbdd7
- https://git.kernel.org/stable/c/4868c0ecdb6cfde7c70cf478c46e06bb9c7e5865
- https://git.kernel.org/stable/c/12f8e32a5a389a5d58afc67728c76e61beee1ad4
- https://git.kernel.org/stable/c/f6d53d8a2617dd58c89171a6b9610c470ebda38a
- https://git.kernel.org/stable/c/5ef1d8c1ddbf696e47b226e11888eaf8d9e8e807
- https://lore.kernel.org/linux-cve-announce/2024051708-CVE-2024-35791-65ad@gregkh/
- https://git.kernel.org/linus/5ef1d8c1ddbf696e47b226e11888eaf8d9e8e807
- https://ubuntu.com/security/notices/USN-6898-1
- https://ubuntu.com/security/notices/USN-6898-2
- https://ubuntu.com/security/notices/USN-6898-3
- https://ubuntu.com/security/notices/USN-6898-4
- https://ubuntu.com/security/notices/USN-6917-1
- https://ubuntu.com/security/notices/USN-6919-1
- https://ubuntu.com/security/notices/USN-6927-1
- https://ubuntu.com/security/notices/USN-7019-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 19a23da ("Fix unsynchronized access to sev members through svm_register_enc_region") in v5.11-rc7.
    Fixed in v6.8.
  debian/carnil: |-
    Introduced in 19a23da53932 ("Fix unsynchronized access to sev members through
    svm_register_enc_region"). Vulnerable versions: 4.19.176 5.4.98 5.10.15
    5.11-rc7.
introduced-by:
  cip/4.19: [f1ecde00ce1694597f923f0d25f7a797c5243d99]
  cip/4.19-rt: [f1ecde00ce1694597f923f0d25f7a797c5243d99]
  cip/5.10: [4f627ecde7329e476a077bb0590db8f27bb8f912]
  cip/5.10-rt: [4f627ecde7329e476a077bb0590db8f27bb8f912]
  mainline: [19a23da53932bc8011220bd8c410cb76012de004]
  stable/4.19: [f1ecde00ce1694597f923f0d25f7a797c5243d99]
  stable/5.10: [4f627ecde7329e476a077bb0590db8f27bb8f912]
  stable/5.4: [848bcb0a1d96f67d075465667d3a1ad4af56311e]
  ubuntu/focal: [4ce33668de430e1262a5d35a8e6768c3ca6e7788]
  ubuntu/groovy: [b79ffc12e277bbe3c6255cc9d56679e0d3fe24fe]
fixed-by:
  cip/5.10: [2d13b79640b147bd77c34a5998533b2021a4122d]
  cip/5.10-rt: [2d13b79640b147bd77c34a5998533b2021a4122d]
  cip/6.1: [4868c0ecdb6cfde7c70cf478c46e06bb9c7e5865]
  cip/6.1-rt: [4868c0ecdb6cfde7c70cf478c46e06bb9c7e5865]
  mainline: [5ef1d8c1ddbf696e47b226e11888eaf8d9e8e807]
  stable/5.10: [2d13b79640b147bd77c34a5998533b2021a4122d]
  stable/5.15: [e126b508ed2e616d679d85fca2fbe77bb48bbdd7]
  stable/6.1: [4868c0ecdb6cfde7c70cf478c46e06bb9c7e5865]
  stable/6.6: [12f8e32a5a389a5d58afc67728c76e61beee1ad4]
