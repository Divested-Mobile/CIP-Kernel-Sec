description: 'fs/aio: Check IOCB_AIO_RW before the struct aio_kiocb conversion'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35815
- https://git.kernel.org/stable/c/10ca82aff58434e122c7c757cf0497c335f993f3
- https://git.kernel.org/stable/c/396dbbc18963648e9d1a4edbb55cfe08fa374d50
- https://git.kernel.org/stable/c/94eb0293703ced580f05dfbe5a57da5931e9aee2
- https://git.kernel.org/stable/c/a71cba07783abc76b547568b6452cd1dd9981410
- https://git.kernel.org/stable/c/18d5fc3c16cc317bd0e5f5dabe0660df415cadb7
- https://git.kernel.org/stable/c/c01ed748847fe8b810d86efc229b9e6c7fafa01e
- https://git.kernel.org/stable/c/5c43d0041e3a05c6c41c318b759fff16d2384596
- https://git.kernel.org/stable/c/961ebd120565cb60cebe21cb634fbc456022db4a
- https://lore.kernel.org/linux-cve-announce/2024051742-CVE-2024-35815-c819@gregkh/
comments:
  cip/masami: |-
    Introduced by commit b820de7 ("fs/aio: Restrict kiocb_set_cancel_fn()
    to I/O submitted via libaio") in 6.8-rc6. Fixed in 6.8.
  debian/carnil: |-
    Introduced in b820de741ae4 ("fs/aio: Restrict kiocb_set_cancel_fn() to I/O
    submitted via libaio"). Vulnerable versions: 4.19.308 5.4.270 5.10.211 5.15.150
    6.1.80 6.6.19 6.7.7 6.8-rc6.
introduced-by:
  cip/4.19: [337b543e274fe7a8f47df3c8293cc6686ffa620f]
  cip/5.10: [ea1cd64d59f22d6d13f367d62ec6e27b9344695f]
  cip/5.10-rt: [ea1cd64d59f22d6d13f367d62ec6e27b9344695f]
  cip/6.1: [18f614369def2a11a52f569fe0f910b199d13487]
  cip/6.1-rt: [18f614369def2a11a52f569fe0f910b199d13487]
  mainline: [b820de741ae48ccf50dd95e297889c286ff4f760]
  stable/4.19: [337b543e274fe7a8f47df3c8293cc6686ffa620f]
  stable/5.10: [ea1cd64d59f22d6d13f367d62ec6e27b9344695f]
  stable/5.15: [d7b6fa97ec894edd02f64b83e5e72e1aa352f353]
  stable/5.4: [b4eea7a05ee0ab5ab0514421e6ba8c5d249cf942]
  stable/6.1: [18f614369def2a11a52f569fe0f910b199d13487]
  stable/6.6: [e7e23fc5d5fe422827c9a43ecb579448f73876c7]
  ubuntu/focal: [09d05c01e0e05d6137f92d4c2e6565e8b4f92eef]
fixed-by:
  cip/4.19: [10ca82aff58434e122c7c757cf0497c335f993f3]
  cip/5.10: [94eb0293703ced580f05dfbe5a57da5931e9aee2]
  cip/6.1: [18d5fc3c16cc317bd0e5f5dabe0660df415cadb7]
  cip/6.1-rt: [18d5fc3c16cc317bd0e5f5dabe0660df415cadb7]
  mainline: [961ebd120565cb60cebe21cb634fbc456022db4a]
  stable/4.19: [10ca82aff58434e122c7c757cf0497c335f993f3]
  stable/5.10: [94eb0293703ced580f05dfbe5a57da5931e9aee2]
  stable/5.15: [a71cba07783abc76b547568b6452cd1dd9981410]
  stable/5.4: [396dbbc18963648e9d1a4edbb55cfe08fa374d50]
  stable/6.1: [18d5fc3c16cc317bd0e5f5dabe0660df415cadb7]
  stable/6.6: [c01ed748847fe8b810d86efc229b9e6c7fafa01e]
