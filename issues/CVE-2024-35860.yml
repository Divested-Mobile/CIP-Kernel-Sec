description: 'bpf: support deferring bpf_link dealloc to after RCU grace period'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35860
- https://git.kernel.org/stable/c/876941f533e7b47fc69977fc4551c02f2d18af97
- https://git.kernel.org/stable/c/5d8d447777564b35f67000e7838e7ccb64d525c8
- https://git.kernel.org/stable/c/1a80dbcb2dbaf6e4c216e62e30fa7d3daa8001ce
- https://lore.kernel.org/linux-cve-announce/2024051935-CVE-2024-35860-04fd@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 0dcac27 ("bpf: Add multi kprobe link") in v5.18-rc1.
    Introduced by commit 89ae89f ("bpf: Add multi uprobe link") in v6.6-rc1.
    Fixed in v6.9-rc3.
  debian/carnil: |-
    Introduced in 0dcac2725406 ("bpf: Add multi kprobe link")
    89ae89f53d20 ("bpf: Add multi uprobe link"). Vulnerable versions: 5.18-rc1.
introduced-by:
  mainline: [0dcac272540613d41c05e89679e4ddb978b612f1, 89ae89f53d201143560f1e9ed4bfa62eee34f88e]
fixed-by:
  mainline: [1a80dbcb2dbaf6e4c216e62e30fa7d3daa8001ce]
  stable/6.6: [876941f533e7b47fc69977fc4551c02f2d18af97]
  stable/6.8: [5d8d447777564b35f67000e7838e7ccb64d525c8]
