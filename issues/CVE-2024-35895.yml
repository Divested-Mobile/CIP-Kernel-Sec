description: 'bpf, sockmap: Prevent lock inversion deadlock in map delete elem'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35895
- https://git.kernel.org/stable/c/f7990498b05ac41f7d6a190dc0418ef1d21bf058
- https://git.kernel.org/stable/c/dd54b48db0c822ae7b520bc80751f0a0a173ef75
- https://git.kernel.org/stable/c/d1e73fb19a4c872d7a399ad3c66e8ca30e0875ec
- https://git.kernel.org/stable/c/a44770fed86515eedb5a7c00b787f847ebb134a5
- https://git.kernel.org/stable/c/668b3074aa14829e2ac2759799537a93b60fef86
- https://git.kernel.org/stable/c/6af057ccdd8e7619960aca1f0428339f213b31cd
- https://git.kernel.org/stable/c/ff91059932401894e6c86341915615c5eb0eca48
- https://lore.kernel.org/linux-cve-announce/2024051950-CVE-2024-35895-cb33@gregkh/
- https://git.kernel.org/linus/ff91059932401894e6c86341915615c5eb0eca48
- https://ubuntu.com/security/notices/USN-6893-1
- https://ubuntu.com/security/notices/USN-6896-1
- https://ubuntu.com/security/notices/USN-6898-1
- https://ubuntu.com/security/notices/USN-6893-2
- https://ubuntu.com/security/notices/USN-6896-2
- https://ubuntu.com/security/notices/USN-6898-2
- https://ubuntu.com/security/notices/USN-6896-3
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 604326b ("bpf, sockmap: convert to generic sk_msg interface") in v4.20-rc1.
    Fixed in v6.9-rc3.
  debian/carnil: |-
    Introduced in 604326b41a6f ("bpf, sockmap: convert to generic sk_msg
    interface"). Vulnerable versions: 4.20-rc1.
introduced-by:
  mainline: [604326b41a6fb9b4a78b6179335decee0365cd8c]
fixed-by:
  cip/5.10: [dd54b48db0c822ae7b520bc80751f0a0a173ef75]
  cip/5.10-rt: [dd54b48db0c822ae7b520bc80751f0a0a173ef75]
  cip/6.1: [a44770fed86515eedb5a7c00b787f847ebb134a5]
  cip/6.1-rt: [a44770fed86515eedb5a7c00b787f847ebb134a5]
  mainline: [ff91059932401894e6c86341915615c5eb0eca48]
  stable/5.10: [dd54b48db0c822ae7b520bc80751f0a0a173ef75]
  stable/5.15: [d1e73fb19a4c872d7a399ad3c66e8ca30e0875ec]
  stable/5.4: [f7990498b05ac41f7d6a190dc0418ef1d21bf058]
  stable/6.1: [a44770fed86515eedb5a7c00b787f847ebb134a5]
  stable/6.6: [668b3074aa14829e2ac2759799537a93b60fef86]
  stable/6.8: [6af057ccdd8e7619960aca1f0428339f213b31cd]
  ubuntu/focal: [5737a1c125e7e821d8752e66017263b6b66f883b]
