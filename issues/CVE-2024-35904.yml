description: 'selinux: avoid dereference of garbage after mount failure'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35904
- https://git.kernel.org/stable/c/477ed6789eb9f3f4d3568bb977f90c863c12724e
- https://git.kernel.org/stable/c/68784a5d01b8868ff85a7926676b6729715fff3c
- https://git.kernel.org/stable/c/37801a36b4d68892ce807264f784d818f8d0d39b
- https://lore.kernel.org/linux-cve-announce/2024051953-CVE-2024-35904-7f85@gregkh/
- https://git.kernel.org/linus/37801a36b4d68892ce807264f784d818f8d0d39b
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 0619f0f ("selinux: wrap selinuxfs state") in v4.17-rc1.
    Fixed in v6.9-rc3.
  debian/carnil: |-
    Introduced in 0619f0f5e36f ("selinux: wrap selinuxfs state"). Vulnerable
    versions: 4.17-rc1.
introduced-by:
  mainline: [0619f0f5e36f12e100ef294f5980cfe7c93ff23e]
fixed-by:
  mainline: [37801a36b4d68892ce807264f784d818f8d0d39b]
  stable/6.6: [477ed6789eb9f3f4d3568bb977f90c863c12724e]
  stable/6.8: [68784a5d01b8868ff85a7926676b6729715fff3c]
