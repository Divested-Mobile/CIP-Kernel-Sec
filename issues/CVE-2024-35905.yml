description: 'bpf: Protect against int overflow for stack access size'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35905
- https://git.kernel.org/stable/c/9970e059af471478455f9534e8c3db82f8c5496d
- https://git.kernel.org/stable/c/37dc1718dc0c4392dbfcb9adec22a776e745dd69
- https://git.kernel.org/stable/c/98cdac206b112bec63852e94802791e316acc2c1
- https://git.kernel.org/stable/c/3f0784b2f1eb9147973d8c43ba085c5fdf44ff69
- https://git.kernel.org/stable/c/203a68151e8eeb331d4a64ab78303f3a15faf103
- https://git.kernel.org/stable/c/ecc6a2101840177e57c925c102d2d29f260d37c8
- https://lore.kernel.org/linux-cve-announce/2024051954-CVE-2024-35905-d079@gregkh/
- https://git.kernel.org/linus/ecc6a2101840177e57c925c102d2d29f260d37c8
- https://ubuntu.com/security/notices/USN-6893-1
- https://ubuntu.com/security/notices/USN-6898-1
- https://ubuntu.com/security/notices/USN-6893-2
- https://ubuntu.com/security/notices/USN-6898-2
- https://ubuntu.com/security/notices/USN-6898-3
- https://ubuntu.com/security/notices/USN-6893-3
- https://ubuntu.com/security/notices/USN-6898-4
- https://ubuntu.com/security/notices/USN-6917-1
- https://ubuntu.com/security/notices/USN-6919-1
- https://ubuntu.com/security/notices/USN-6918-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit a833a17 ("bpf: Fix verification of indirect var-off stack access") in v6.8-rc1.
    Fixed in v6.9-rc2.
  debian/carnil: |-
    Introduced in a833a17aeac7 ("bpf: Fix verification of indirect var-off stack
    access"). Vulnerable versions: 5.10.209 5.15.148 6.1.75 6.6.14 6.7.2 6.8-rc1.
introduced-by:
  cip/5.10: [afea95d319ccb4ad2060dece9ac5e2e364dec543]
  cip/5.10-rt: [afea95d319ccb4ad2060dece9ac5e2e364dec543]
  cip/6.1: [b1d4d54d32ce6342f5faffe71bae736540ce7cb5]
  cip/6.1-rt: [b1d4d54d32ce6342f5faffe71bae736540ce7cb5]
  mainline: [a833a17aeac73b33f79433d7cee68d5cafd71e4f]
  stable/5.10: [afea95d319ccb4ad2060dece9ac5e2e364dec543]
  stable/5.15: [02962684258eb53f414a8a59854767be526e6abb]
  stable/6.1: [b1d4d54d32ce6342f5faffe71bae736540ce7cb5]
  stable/6.6: [08b91babccbb168353f8d43fea0ed28a4cad568c]
fixed-by:
  cip/5.10: [9970e059af471478455f9534e8c3db82f8c5496d]
  cip/5.10-rt: [9970e059af471478455f9534e8c3db82f8c5496d]
  cip/6.1: [98cdac206b112bec63852e94802791e316acc2c1]
  cip/6.1-rt: [98cdac206b112bec63852e94802791e316acc2c1]
  mainline: [ecc6a2101840177e57c925c102d2d29f260d37c8]
  stable/5.10: [9970e059af471478455f9534e8c3db82f8c5496d]
  stable/5.15: [37dc1718dc0c4392dbfcb9adec22a776e745dd69]
  stable/6.1: [98cdac206b112bec63852e94802791e316acc2c1]
  stable/6.6: [3f0784b2f1eb9147973d8c43ba085c5fdf44ff69]
  stable/6.8: [203a68151e8eeb331d4a64ab78303f3a15faf103]
  ubuntu/focal: ['version:5.4.0-9.12']
