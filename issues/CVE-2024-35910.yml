description: 'tcp: properly terminate timers for kernel sockets'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35910
- https://git.kernel.org/stable/c/93f0133b9d589cc6e865f254ad9be3e9d8133f50
- https://git.kernel.org/stable/c/44e62f5d35678686734afd47c6a421ad30772e7f
- https://git.kernel.org/stable/c/e3e27d2b446deb1f643758a0c4731f5c22492810
- https://git.kernel.org/stable/c/2e43d8eba6edd1cf05a3a20fdd77688fa7ec16a4
- https://git.kernel.org/stable/c/91b243de910a9ac8476d40238ab3dbfeedd5b7de
- https://git.kernel.org/stable/c/c1ae4d1e76eacddaacb958b67cd942082f800c87
- https://git.kernel.org/stable/c/899265c1389fe022802aae73dbf13ee08837a35a
- https://git.kernel.org/stable/c/151c9c724d05d5b0dd8acd3e11cb69ef1f2dbada
- https://lore.kernel.org/linux-cve-announce/2024051955-CVE-2024-35910-5f95@gregkh/
- https://git.kernel.org/linus/151c9c724d05d5b0dd8acd3e11cb69ef1f2dbada
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 26abe14 ("net: Modify sk_alloc to not reference count the netns of kernel sockets.") in v4.2-rc1.
    Introduced by commit 8a68173 ("net: sk_clone_lock() should only do get_net() if the parent is not a kernel socket") in v4.2-rc5.
    Fixed in v6.9-rc2.
  debian/carnil: |-
    Introduced in 26abe14379f8 ("net: Modify sk_alloc to not reference count the
    netns of kernel sockets.")
    8a68173691f0 ("net: sk_clone_lock() should only do get_net() if the parent is
    not a kernel socket"). Vulnerable versions: 4.2-rc1.
introduced-by:
  mainline: [26abe14379f8e2fa3fd1bcf97c9a7ad9364886fe, 8a68173691f036613e3d4e6bf8dc129d4a7bf383]
fixed-by:
  cip/4.19: [93f0133b9d589cc6e865f254ad9be3e9d8133f50]
  cip/4.19-rt: [93f0133b9d589cc6e865f254ad9be3e9d8133f50]
  cip/5.10: [e3e27d2b446deb1f643758a0c4731f5c22492810]
  cip/5.10-rt: [e3e27d2b446deb1f643758a0c4731f5c22492810]
  cip/6.1: [91b243de910a9ac8476d40238ab3dbfeedd5b7de]
  cip/6.1-rt: [91b243de910a9ac8476d40238ab3dbfeedd5b7de]
  mainline: [151c9c724d05d5b0dd8acd3e11cb69ef1f2dbada]
  stable/4.19: [93f0133b9d589cc6e865f254ad9be3e9d8133f50]
  stable/5.10: [e3e27d2b446deb1f643758a0c4731f5c22492810]
  stable/5.15: [2e43d8eba6edd1cf05a3a20fdd77688fa7ec16a4]
  stable/5.4: [44e62f5d35678686734afd47c6a421ad30772e7f]
  stable/6.1: [91b243de910a9ac8476d40238ab3dbfeedd5b7de]
  stable/6.6: [c1ae4d1e76eacddaacb958b67cd942082f800c87]
  stable/6.8: [899265c1389fe022802aae73dbf13ee08837a35a]
  ubuntu/focal: [9182e5c77986dc2942ab1eea310ef209b7a99f55]
