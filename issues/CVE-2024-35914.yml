description: 'nfsd: Fix error cleanup path in nfsd_rename()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35914
- https://git.kernel.org/stable/c/331e125e02c08ffaecc1074af78a988a278039bd
- https://git.kernel.org/stable/c/9fe6e9e7b58944037714442384075c17cfde1c56
- https://lore.kernel.org/linux-cve-announce/2024051957-CVE-2024-35914-3194@gregkh/
- https://git.kernel.org/linus/9fe6e9e7b58944037714442384075c17cfde1c56
- https://ubuntu.com/security/notices/USN-6893-1
- https://ubuntu.com/security/notices/USN-6893-2
- https://ubuntu.com/security/notices/USN-6893-3
- https://ubuntu.com/security/notices/USN-6918-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit a8b0026 ("rename(): avoid a deadlock in the case of parents having no common ancestor") in v6.8-rc1.
    Fixed in v6.9-rc2.
  debian/carnil: |-
    Introduced in a8b0026847b8 ("rename(): avoid a deadlock in the case of parents
    having no common ancestor"). Vulnerable versions: 6.8-rc1.
introduced-by:
  mainline: [a8b0026847b8c43445c921ad2c85521c92eb175f]
fixed-by:
  mainline: [9fe6e9e7b58944037714442384075c17cfde1c56]
  stable/6.8: [331e125e02c08ffaecc1074af78a988a278039bd]
  ubuntu/focal: ['version:5.4.0-9.12']
