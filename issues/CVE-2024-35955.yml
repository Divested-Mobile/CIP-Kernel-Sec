description: 'kprobes: Fix possible use-after-free issue on kprobe registration'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35955
- https://git.kernel.org/stable/c/b5808d40093403334d939e2c3c417144d12a6f33
- https://git.kernel.org/stable/c/93eb31e7c3399e326259f2caa17be1e821f5a412
- https://git.kernel.org/stable/c/5062d1f4f07facbdade0f402d9a04a788f52e26d
- https://git.kernel.org/stable/c/2df2dd27066cdba8041e46a64362325626bdfb2e
- https://git.kernel.org/stable/c/62029bc9ff2c17a4e3a2478d83418ec575413808
- https://git.kernel.org/stable/c/d15023fb407337028a654237d8968fefdcf87c2f
- https://git.kernel.org/stable/c/36b57c7d2f8b7de224980f1a284432846ad71ca0
- https://git.kernel.org/stable/c/325f3fb551f8cd672dbbfc4cf58b14f9ee3fc9e8
- https://lore.kernel.org/linux-cve-announce/2024052018-CVE-2024-35955-2555@gregkh/
- https://git.kernel.org/linus/325f3fb551f8cd672dbbfc4cf58b14f9ee3fc9e8
- https://ubuntu.com/security/notices/USN-6893-1
- https://ubuntu.com/security/notices/USN-6896-1
- https://ubuntu.com/security/notices/USN-6898-1
- https://ubuntu.com/security/notices/USN-6893-2
- https://ubuntu.com/security/notices/USN-6896-2
- https://ubuntu.com/security/notices/USN-6898-2
- https://ubuntu.com/security/notices/USN-6896-3
- https://ubuntu.com/security/notices/USN-6898-3
- https://ubuntu.com/security/notices/USN-6896-4
- https://ubuntu.com/security/notices/USN-6896-5
- https://ubuntu.com/security/notices/USN-6893-3
- https://ubuntu.com/security/notices/USN-6898-4
- https://ubuntu.com/security/notices/USN-6917-1
- https://ubuntu.com/security/notices/USN-6919-1
- https://ubuntu.com/security/notices/USN-6918-1
- https://ubuntu.com/security/notices/USN-6927-1
- https://ubuntu.com/security/notices/USN-6972-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 28f6c37 ("kprobes: Forbid probing on trampoline and BPF code areas") in v6.0-rc1.
    Fixed in v6.9-rc4.
  debian/carnil: |-
    Introduced in 28f6c37a2910 ("kprobes: Forbid probing on trampoline and BPF code
    areas"). Vulnerable versions: 4.14.291 4.19.256 5.4.211 5.10.137 5.15.61
    5.18.18 5.19.2 6.0-rc1.
introduced-by:
  cip/4.19: [1c836bad43f3e2ff71cc397a6e6ccb4e7bd116f8]
  cip/4.19-rt: [1c836bad43f3e2ff71cc397a6e6ccb4e7bd116f8]
  cip/5.10: [2a49b025c36ae749cee7ccc4b7e456e02539cdc3]
  cip/5.10-rt: [2a49b025c36ae749cee7ccc4b7e456e02539cdc3]
  mainline: [28f6c37a2910f565b4f5960df52b2eccae28c891]
  openela/4.14: [4262b6eb057d86c7829168c541654fe0d48fdac8]
  stable/4.14: [4262b6eb057d86c7829168c541654fe0d48fdac8]
  stable/4.19: [1c836bad43f3e2ff71cc397a6e6ccb4e7bd116f8]
  stable/5.10: [2a49b025c36ae749cee7ccc4b7e456e02539cdc3]
  stable/5.15: [a1edb85e60fdab1e14db63ae8af8db3f0d798fb6]
  stable/5.4: [6a119c1a584aa7a2c6216458f1f272bf1bc93a93]
  ubuntu/bionic: [0bbd0ff3af430b5cc02bfbe3da4482dbc16045b3]
  ubuntu/focal: [25344e89d2403bcf874a1e2c687585081a29027e]
fixed-by:
  cip/4.19: [b5808d40093403334d939e2c3c417144d12a6f33]
  cip/4.19-rt: [b5808d40093403334d939e2c3c417144d12a6f33]
  cip/5.10: [5062d1f4f07facbdade0f402d9a04a788f52e26d]
  cip/5.10-rt: [5062d1f4f07facbdade0f402d9a04a788f52e26d]
  cip/6.1: [62029bc9ff2c17a4e3a2478d83418ec575413808]
  cip/6.1-rt: [62029bc9ff2c17a4e3a2478d83418ec575413808]
  debian/buster-security: ['version:debian/4.19.316-1']
  mainline: [325f3fb551f8cd672dbbfc4cf58b14f9ee3fc9e8]
  openela/4.14: [b13c030fd2b3a061d1659003a770b3986c24f7b5]
  stable/4.19: [b5808d40093403334d939e2c3c417144d12a6f33]
  stable/5.10: [5062d1f4f07facbdade0f402d9a04a788f52e26d]
  stable/5.15: [2df2dd27066cdba8041e46a64362325626bdfb2e]
  stable/5.4: [93eb31e7c3399e326259f2caa17be1e821f5a412]
  stable/6.1: [62029bc9ff2c17a4e3a2478d83418ec575413808]
  stable/6.6: [d15023fb407337028a654237d8968fefdcf87c2f]
  stable/6.8: [36b57c7d2f8b7de224980f1a284432846ad71ca0]
  ubuntu/focal: [166a449002a19ea25a7038b59e8e3e89608b7477]
