description: 'Bluetooth: L2CAP: Fix not validating setsockopt user input'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35965
- https://git.kernel.org/stable/c/9d42f373391211c7c8af66a3a316533a32b8a607
- https://git.kernel.org/stable/c/8ee0c132a61df9723813c40e742dc5321824daa9
- https://git.kernel.org/stable/c/4f3951242ace5efc7131932e2e01e6ac6baed846
- https://lore.kernel.org/linux-cve-announce/2024052021-CVE-2024-35965-19f1@gregkh/
- https://git.kernel.org/linus/4f3951242ace5efc7131932e2e01e6ac6baed846
- https://ubuntu.com/security/notices/USN-6893-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 33575df ("Bluetooth: move l2cap_sock_setsockopt() to l2cap_sock.c") in v2.6.39-rc1.
    Introduced by commit 3ee7b7c ("Bluetooth: Add BT_MODE socket option") in v5.8-rc1.
    Fixed in v6.9-rc4.
  debian/carnil: |-
    Introduced in 33575df7be67 ("Bluetooth: move l2cap_sock_setsockopt() to
    l2cap_sock.c")
    3ee7b7cd8390 ("Bluetooth: Add BT_MODE socket option"). Vulnerable versions:
    2.6.39-rc1.
introduced-by:
  mainline: [33575df7be6748292f88453f29319af6d639c5c8, 3ee7b7cd83900bb711efadbf16fa096a615a1566]
fixed-by:
  cip/6.1: [9d42f373391211c7c8af66a3a316533a32b8a607]
  cip/6.1-rt: [9d42f373391211c7c8af66a3a316533a32b8a607]
  mainline: [4f3951242ace5efc7131932e2e01e6ac6baed846]
  stable/6.1: [9d42f373391211c7c8af66a3a316533a32b8a607]
  stable/6.8: [8ee0c132a61df9723813c40e742dc5321824daa9]
