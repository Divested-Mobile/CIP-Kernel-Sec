description: 'Bluetooth: RFCOMM: Fix not validating setsockopt user input'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35966
- https://git.kernel.org/stable/c/c3f787a3eafe519c93df9abbb0ca5145861c8d0f
- https://git.kernel.org/stable/c/a97de7bff13b1cc825c1b1344eaed8d6c2d3e695
- https://lore.kernel.org/linux-cve-announce/2024052021-CVE-2024-35966-e107@gregkh/
- https://git.kernel.org/linus/a97de7bff13b1cc825c1b1344eaed8d6c2d3e695
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 9f2c8a0 ("Bluetooth: Replace RFCOMM link mode with security level") in v2.6.30-rc1.
    Introduced by commit bb23c0a ("Bluetooth: Add support for deferring RFCOMM connection setup") in v2.6.30-rc1.
    Fixed in v6.9-rc4.
  debian/carnil: |-
    Introduced in 9f2c8a03fbb3 ("Bluetooth: Replace RFCOMM link mode with security
    level")
    bb23c0ab8246 ("Bluetooth: Add support for deferring RFCOMM connection setup").
    Vulnerable versions: 2.6.30-rc1.
introduced-by:
  mainline: [9f2c8a03fbb3048cf38b158f87aa0c3c09bca084, bb23c0ab824653be4aa7dfca15b07b3059717004]
fixed-by:
  mainline: [a97de7bff13b1cc825c1b1344eaed8d6c2d3e695]
  stable/6.8: [c3f787a3eafe519c93df9abbb0ca5145861c8d0f]
