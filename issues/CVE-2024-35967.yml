description: 'Bluetooth: SCO: Fix not validating setsockopt user input'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-35967
- https://git.kernel.org/stable/c/b0e30c37695b614bee69187f86eaf250e36606ce
- https://git.kernel.org/stable/c/7bc65d23ba20dcd7ecc094a12c181e594e5eb315
- https://git.kernel.org/stable/c/72473db90900da970a16ee50ad23c2c38d107d8c
- https://git.kernel.org/stable/c/419a0ffca7010216f0fc265b08558d7394fa0ba7
- https://git.kernel.org/stable/c/51eda36d33e43201e7a4fd35232e069b2c850b01
- https://lore.kernel.org/linux-cve-announce/2024052022-CVE-2024-35967-d111@gregkh/
- https://git.kernel.org/linus/51eda36d33e43201e7a4fd35232e069b2c850b01
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit ad10b1a ("Bluetooth: Add Bluetooth socket voice option") in v3.12-rc1.
    Introduced by commit b96e9c6 ("Bluetooth: Add BT_DEFER_SETUP option to sco socket") in v3.8-rc1.
    Introduced by commit 00398e1 ("Bluetooth: Add support for BT_PKT_STATUS CMSG data for SCO connections") in v5.9-rc1.
    Introduced by commit f687340 ("Bluetooth: Allow setting of codec for HFP offload use case") in v5.16-rc1.
    Fixed in v6.9-rc4.
  debian/carnil: |-
    Introduced in ad10b1a48754 ("Bluetooth: Add Bluetooth socket voice option")
    b96e9c671b05 ("Bluetooth: Add BT_DEFER_SETUP option to sco socket")
    00398e1d5183 ("Bluetooth: Add support for BT_PKT_STATUS CMSG data for SCO
    connections")
    f6873401a608 ("Bluetooth: Allow setting of codec for HFP offload use case").
    Vulnerable versions: 3.8-rc1.
introduced-by:
  mainline: [ad10b1a48754b1381582d96f070a39832e41382d, b96e9c671b05f95126753a22145d4509d45ca197,
    00398e1d518309328e8ba7dff00881538ac22c6a, f6873401a60865702069fb2e3f67671fff9c082c]
fixed-by:
  cip/5.10: [b0e30c37695b614bee69187f86eaf250e36606ce]
  cip/5.10-rt: [b0e30c37695b614bee69187f86eaf250e36606ce]
  cip/6.1: [7bc65d23ba20dcd7ecc094a12c181e594e5eb315]
  cip/6.1-rt: [7bc65d23ba20dcd7ecc094a12c181e594e5eb315]
  mainline: [51eda36d33e43201e7a4fd35232e069b2c850b01]
  stable/5.10: [b0e30c37695b614bee69187f86eaf250e36606ce]
  stable/6.1: [7bc65d23ba20dcd7ecc094a12c181e594e5eb315]
  stable/6.6: [72473db90900da970a16ee50ad23c2c38d107d8c]
  stable/6.8: [419a0ffca7010216f0fc265b08558d7394fa0ba7]
