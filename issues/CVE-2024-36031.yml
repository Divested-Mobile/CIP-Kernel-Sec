description: 'keys: Fix overwrite of key expiration on instantiation'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-36031
- https://git.kernel.org/stable/c/ad2011ea787928b2accb5134f1e423b11fe80a8a
- https://git.kernel.org/stable/c/ed79b93f725cd0da39a265dc23d77add1527b9be
- https://git.kernel.org/stable/c/e4519a016650e952ad9eb27937f8c447d5a4e06d
- https://git.kernel.org/stable/c/25777f3f4e1f371d16a594925f31e37ce07b6ec7
- https://git.kernel.org/stable/c/939a08bcd4334bad4b201e60bd0ae1f278d71d41
- https://git.kernel.org/stable/c/cc219cb8afbc40ec100c0de941047bb29373126a
- https://git.kernel.org/stable/c/9da27fb65a14c18efd4473e2e82b76b53ba60252
- https://lore.kernel.org/linux-cve-announce/2024053000-CVE-2024-36031-46f2@gregkh/
- https://git.kernel.org/linus/9da27fb65a14c18efd4473e2e82b76b53ba60252
- https://ubuntu.com/security/notices/USN-6898-1
- https://ubuntu.com/security/notices/USN-6898-3
- https://ubuntu.com/security/notices/USN-6917-1
- https://ubuntu.com/security/notices/USN-6949-1
- https://ubuntu.com/security/notices/USN-6950-1
- https://ubuntu.com/security/notices/USN-6952-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 39299bd ("keys, dns: Allow key types (eg. DNS) to be reclaimed immediately on expiry") in v6.7-rc7.
    Fixed in v6.10-rc1.
  debian/carnil: |-
    Introduced in 39299bdd2546 ("keys, dns: Allow key types (eg. DNS) to be
    reclaimed immediately on expiry"). Vulnerable versions: 5.10.206 5.15.146
    6.1.70 6.6.9 6.7-rc7.
introduced-by:
  cip/5.10: [97be1e865e70e5a0ad0a5b5f5dca5031ca0b53ac]
  cip/5.10-rt: [97be1e865e70e5a0ad0a5b5f5dca5031ca0b53ac]
  cip/6.1: [791d5409cdb974c31a1bc7a903ea729ddc7d83df]
  cip/6.1-rt: [791d5409cdb974c31a1bc7a903ea729ddc7d83df]
  mainline: [39299bdd2546688d92ed9db4948f6219ca1b9542]
  stable/5.10: [97be1e865e70e5a0ad0a5b5f5dca5031ca0b53ac]
  stable/5.15: [2552b32b0b349df160a509fe49f5f308cb922f2b]
  stable/6.1: [791d5409cdb974c31a1bc7a903ea729ddc7d83df]
  stable/6.6: [afc360e8a1256acb7579a6f5b6f2c30b85b39301]
fixed-by:
  cip/5.10: [ad2011ea787928b2accb5134f1e423b11fe80a8a]
  cip/5.10-rt: [ad2011ea787928b2accb5134f1e423b11fe80a8a]
  cip/6.1: [e4519a016650e952ad9eb27937f8c447d5a4e06d]
  cip/6.1-rt: [e4519a016650e952ad9eb27937f8c447d5a4e06d]
  mainline: [9da27fb65a14c18efd4473e2e82b76b53ba60252]
  stable/5.10: [ad2011ea787928b2accb5134f1e423b11fe80a8a]
  stable/5.15: [ed79b93f725cd0da39a265dc23d77add1527b9be]
  stable/6.1: [e4519a016650e952ad9eb27937f8c447d5a4e06d]
  stable/6.6: [25777f3f4e1f371d16a594925f31e37ce07b6ec7]
  stable/6.9: [cc219cb8afbc40ec100c0de941047bb29373126a]
  ubuntu/focal: ['version:5.4.0-9.12']
