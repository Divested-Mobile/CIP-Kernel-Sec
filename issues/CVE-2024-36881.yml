description: 'mm/userfaultfd: reset ptes when close() for wr-protected ones'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-36881
- https://git.kernel.org/stable/c/377f3a9a3d032a52325a5b110379a25dd1ab1931
- https://git.kernel.org/stable/c/8d8b68a5b0c9fb23d37df06bb273ead38fd5a29d
- https://git.kernel.org/stable/c/c88033efe9a391e72ba6b5df4b01d6e628f4e734
- https://lore.kernel.org/linux-cve-announce/2024053032-CVE-2024-36881-24d0@gregkh/
- https://git.kernel.org/linus/c88033efe9a391e72ba6b5df4b01d6e628f4e734
- https://ubuntu.com/security/notices/USN-6949-1
- https://ubuntu.com/security/notices/USN-6952-1
- https://ubuntu.com/security/notices/USN-6955-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit f369b07 ("mm/uffd: reset write protection when unregister with wp-mode") in v6.0-rc3.
    Fixed in v6.9.
  debian/carnil: |-
    Introduced in f369b07c8614 ("mm/uffd: reset write protection when unregister
    with wp-mode"). Vulnerable versions: 5.19.6 6.0-rc3.
introduced-by:
  mainline: [f369b07c861435bd812a9d14493f71b34132ed6f]
fixed-by:
  mainline: [c88033efe9a391e72ba6b5df4b01d6e628f4e734]
  stable/6.6: [377f3a9a3d032a52325a5b110379a25dd1ab1931]
  ubuntu/focal: ['version:5.4.0-9.12']
