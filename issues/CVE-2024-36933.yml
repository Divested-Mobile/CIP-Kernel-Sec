description: 'nsh: Restore skb->{protocol,data,mac_header} for outer header in nsh_gso_segment().'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-36933
- https://git.kernel.org/stable/c/a7c2c3c1caabcb4a3d6c47284c397507aaf54fe9
- https://git.kernel.org/stable/c/46134031c20fd313d03b90169d64b2e05ca6b65c
- https://git.kernel.org/stable/c/bbccf0caef2fa917d6d0692385a06ce3c262a216
- https://git.kernel.org/stable/c/5a4603fbc285752d19e4b415466db18ef3617e4a
- https://git.kernel.org/stable/c/37ed6f244ec5bda2e90b085084e322ea55d0aaa2
- https://git.kernel.org/stable/c/696d18bb59727a2e0526c0802a812620be1c9340
- https://git.kernel.org/stable/c/29a07f2ee4d273760c2acbfc756e29eccd82470a
- https://git.kernel.org/stable/c/4b911a9690d72641879ea6d13cce1de31d346d79
- https://lore.kernel.org/linux-cve-announce/2024053042-CVE-2024-36933-444e@gregkh/
- https://git.kernel.org/linus/4b911a9690d72641879ea6d13cce1de31d346d79
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c411ed8 ("nsh: add GSO support") in v4.14-rc1.
    Fixed in v6.9-rc7.
  debian/carnil: |-
    Introduced in c411ed854584 ("nsh: add GSO support"). Vulnerable versions:
    4.14-rc1.
introduced-by:
  mainline: [c411ed854584a71b0e86ac3019b60e4789d88086]
fixed-by:
  cip/4.19: [a7c2c3c1caabcb4a3d6c47284c397507aaf54fe9]
  cip/5.10: [bbccf0caef2fa917d6d0692385a06ce3c262a216]
  cip/5.10-rt: [bbccf0caef2fa917d6d0692385a06ce3c262a216]
  cip/6.1: [37ed6f244ec5bda2e90b085084e322ea55d0aaa2]
  cip/6.1-rt: [37ed6f244ec5bda2e90b085084e322ea55d0aaa2]
  mainline: [4b911a9690d72641879ea6d13cce1de31d346d79]
  stable/4.19: [a7c2c3c1caabcb4a3d6c47284c397507aaf54fe9]
  stable/5.10: [bbccf0caef2fa917d6d0692385a06ce3c262a216]
  stable/5.15: [5a4603fbc285752d19e4b415466db18ef3617e4a]
  stable/5.4: [46134031c20fd313d03b90169d64b2e05ca6b65c]
  stable/6.1: [37ed6f244ec5bda2e90b085084e322ea55d0aaa2]
  stable/6.6: [696d18bb59727a2e0526c0802a812620be1c9340]
  ubuntu/focal: [bdeb6d02250b168c958a4357909944630d5dda87]
