description: 'KEYS: trusted: Fix memory leak in tpm2_key_encode()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-36967
- https://git.kernel.org/stable/c/1e6914fa8e7798bcf3ce4a5b96ea4ac1d5571cdf
- https://git.kernel.org/stable/c/5d91238b590bd883c86ba7707c5c9096469c08b7
- https://git.kernel.org/stable/c/e62835264d0352be6086975f18fdfed2b5520b13
- https://git.kernel.org/stable/c/189c768932d435045b1fae12bf63e53866f06a28
- https://git.kernel.org/stable/c/cf26a92f560eed5d6ddc3d441cc645950cbabc56
- https://git.kernel.org/stable/c/ffcaa2172cc1a85ddb8b783de96d38ca8855e248
- https://lore.kernel.org/linux-cve-announce/2024060804-CVE-2024-36967-b73d@gregkh/
- https://git.kernel.org/linus/ffcaa2172cc1a85ddb8b783de96d38ca8855e248
- https://ubuntu.com/security/notices/USN-6949-1
- https://ubuntu.com/security/notices/USN-6950-1
- https://ubuntu.com/security/notices/USN-6952-1
- https://ubuntu.com/security/notices/USN-6955-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit f221974 ("security: keys: trusted: use ASN.1 TPM2 key format for the blobs") in v5.13-rc1.
    Fixed in v6.10-rc1.
  debian/carnil: |-
    Introduced in f2219745250f ("security: keys: trusted: use ASN.1 TPM2 key format
    for the blobs"). Vulnerable versions: 5.13-rc1.
introduced-by:
  mainline: [f2219745250f388edacabe6cca73654131c67d0a]
fixed-by:
  cip/6.1: [5d91238b590bd883c86ba7707c5c9096469c08b7]
  cip/6.1-rt: [5d91238b590bd883c86ba7707c5c9096469c08b7]
  mainline: [ffcaa2172cc1a85ddb8b783de96d38ca8855e248]
  stable/5.15: [1e6914fa8e7798bcf3ce4a5b96ea4ac1d5571cdf]
  stable/6.1: [5d91238b590bd883c86ba7707c5c9096469c08b7]
  stable/6.6: [e62835264d0352be6086975f18fdfed2b5520b13]
  stable/6.9: [cf26a92f560eed5d6ddc3d441cc645950cbabc56]
  ubuntu/focal: ['version:5.4.0-9.12']
