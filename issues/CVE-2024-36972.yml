description: 'af_unix: Update unix_sk(sk)->oob_skb under sk_receive_queue lock.'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-36972
- https://git.kernel.org/stable/c/9841991a446c87f90f66f4b9fee6fe934c1336a2
- https://lore.kernel.org/linux-cve-announce/20240610145748.1497527-2-lee@kernel.org/
- https://git.kernel.org/linus/9841991a446c87f90f66f4b9fee6fe934c1336a2
- https://git.kernel.org/stable/c/518a994aa0b87d96f1bc6678a7035df5d1fcd7a1
- https://git.kernel.org/stable/c/4bf6964451c3cb411fbaa1ae8b214b3d97a59bf1
- https://git.kernel.org/stable/c/d59ae9314b97e01c76a4171472441e55721ba636
- https://git.kernel.org/stable/c/4708f49add84a57ce0ccc7bf9a6269845c631cc3
comments:
  cip/masami: |-
    Introduced by commit 2aab4b9 ("af_unix: fix struct pid leaks in OOB
    support") in 6.3-rc2. Fixed in 6.3-rc2. Bug introduced commit was
    backported to 5.15 and 6.1.
  debian/carnil: |-
    Introduced in 1279f9d9dec2 ("af_unix: Call kfree_skb() for dead
    unix_(sk)->oob_skb in GC."). Vulnerable versions: 5.15.149 6.1.78 6.6.17 6.7.5
    6.8-rc4.
introduced-by:
  cip/6.1: [ac1968ac399205fda9ee3b18f7de7416cb3a5d0d]
  cip/6.1-rt: [ac1968ac399205fda9ee3b18f7de7416cb3a5d0d]
  mainline: [2aab4b96900272885bc157f8b236abf1cdc02e08]
  stable/5.15: [f3969427fb06a2c3cd6efd7faab63505cfa76e76]
  stable/6.1: [ac1968ac399205fda9ee3b18f7de7416cb3a5d0d]
fixed-by:
  mainline: [9841991a446c87f90f66f4b9fee6fe934c1336a2]
  stable/5.15: [518a994aa0b87d96f1bc6678a7035df5d1fcd7a1]
  stable/6.1: [4bf6964451c3cb411fbaa1ae8b214b3d97a59bf1]
  stable/6.6: [d59ae9314b97e01c76a4171472441e55721ba636]
  stable/6.9: [4708f49add84a57ce0ccc7bf9a6269845c631cc3]
