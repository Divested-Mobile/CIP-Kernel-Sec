description: 'bpf: Fix verifier assumptions about socket->sk'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-38566
- https://git.kernel.org/stable/c/39f8a29330f433000e716eefc4b9abda05b71a82
- https://git.kernel.org/stable/c/6f5ae91172a93abac9720ba94edf3ec8f4d7f24f
- https://git.kernel.org/stable/c/c58ccdd2483a1d990748cdaf94206b5d5986a001
- https://git.kernel.org/stable/c/0db63c0b86e981a1e97d2596d64ceceba1a5470e
- https://lore.kernel.org/linux-cve-announce/2024061955-CVE-2024-38566-0ac6@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 6fcd486 ("bpf: Refactor RCU enforcement in the verifier.") in v6.4-rc1.
    Fixed in v6.10-rc1.
  debian/carnil: |-
    Introduced in 6fcd486b3a0a ("bpf: Refactor RCU enforcement in the verifier.").
    Vulnerable versions: 6.4-rc1.
introduced-by:
  mainline: [6fcd486b3a0a628c41f12b3a7329a18a2c74b351]
fixed-by:
  mainline: [0db63c0b86e981a1e97d2596d64ceceba1a5470e]
  stable/6.6: [39f8a29330f433000e716eefc4b9abda05b71a82]
  stable/6.9: [c58ccdd2483a1d990748cdaf94206b5d5986a001]
