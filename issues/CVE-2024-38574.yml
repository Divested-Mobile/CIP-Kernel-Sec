description: 'libbpf: Prevent null-pointer dereference when prog to load has no BTF'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-38574
- https://git.kernel.org/stable/c/ef80b59acfa4dee4b5eaccb15572b69248831104
- https://git.kernel.org/stable/c/1fd91360a75833b7110af9834ae26c977e1273e0
- https://git.kernel.org/stable/c/9bf48fa19a4b1d186e08b20bf7e5de26a15644fb
- https://lore.kernel.org/linux-cve-announce/2024061958-CVE-2024-38574-d9a9@gregkh/
- https://git.kernel.org/linus/9bf48fa19a4b1d186e08b20bf7e5de26a15644fb
- https://ubuntu.com/security/notices/USN-6949-1
- https://ubuntu.com/security/notices/USN-6952-1
- https://ubuntu.com/security/notices/USN-6955-1
- https://ubuntu.com/security/notices/USN-6949-2
- https://ubuntu.com/security/notices/USN-6952-2
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit df7c3f7 ("libbpf: make uniform use of btf__fd() accessor inside libbpf") in v6.8-rc1.
    Fixed in v6.10-rc1.
  debian/carnil: |-
    Introduced in df7c3f7d3a3d ("libbpf: make uniform use of btf__fd() accessor
    inside libbpf"). Vulnerable versions: 6.8-rc1.
introduced-by:
  mainline: [df7c3f7d3a3ddab31ca8cfa9b86a8729ec43fd2e]
fixed-by:
  mainline: [9bf48fa19a4b1d186e08b20bf7e5de26a15644fb]
  stable/6.9: [1fd91360a75833b7110af9834ae26c977e1273e0]
  ubuntu/focal: ['version:5.4.0-9.12']
