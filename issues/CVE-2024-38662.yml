description: 'bpf: Allow delete from sockmap/sockhash only if update is allowed'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-38662
- https://git.kernel.org/stable/c/29467edc23818dc5a33042ffb4920b49b090e63d
- https://git.kernel.org/stable/c/11e8ecc5b86037fec43d07b1c162e233e131b1d9
- https://git.kernel.org/stable/c/6693b172f008846811f48a099f33effc26068e1e
- https://git.kernel.org/stable/c/000a65bf1dc04fb2b65e2abf116f0bc0fc2ee7b1
- https://git.kernel.org/stable/c/b81e1c5a3c70398cf76631ede63a03616ed1ba3c
- https://git.kernel.org/stable/c/98e948fb60d41447fd8d2d0c3b8637fc6b6dc26d
- https://lore.kernel.org/linux-cve-announce/2024062117-CVE-2024-38662-8e3e@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit ff91059 ("bpf, sockmap: Prevent lock inversion deadlock in map delete elem") in v6.9-rc3.
    Fixed in v6.10-rc2.
  debian/carnil: |-
    Introduced in ff9105993240 ("bpf, sockmap: Prevent lock inversion deadlock in
    map delete elem"). Vulnerable versions: 5.4.274 5.10.215 5.15.154 6.1.85 6.6.26
    6.8.5 6.9-rc3.
introduced-by:
  mainline: [ff91059932401894e6c86341915615c5eb0eca48]
fixed-by:
  cip/6.1: [6693b172f008846811f48a099f33effc26068e1e]
  mainline: [98e948fb60d41447fd8d2d0c3b8637fc6b6dc26d]
  stable/5.10: [29467edc23818dc5a33042ffb4920b49b090e63d]
  stable/5.15: [11e8ecc5b86037fec43d07b1c162e233e131b1d9]
  stable/6.1: [6693b172f008846811f48a099f33effc26068e1e]
  stable/6.6: [000a65bf1dc04fb2b65e2abf116f0bc0fc2ee7b1]
  stable/6.9: [b81e1c5a3c70398cf76631ede63a03616ed1ba3c]
