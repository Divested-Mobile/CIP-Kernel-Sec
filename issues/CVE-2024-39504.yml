description: 'netfilter: nft_inner: validate mandatory meta and payload'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-39504
- https://git.kernel.org/stable/c/b30669fdea0ca03aa22995e6c99f7e7d9dee89ff
- https://git.kernel.org/stable/c/39323f54cad29602917848346c71b087da92a19d
- https://git.kernel.org/stable/c/c4ab9da85b9df3692f861512fe6c9812f38b7471
- https://lore.kernel.org/linux-cve-announce/2024071204-CVE-2024-39504-1223@gregkh/
- https://git.kernel.org/linus/c4ab9da85b9df3692f861512fe6c9812f38b7471
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit a150d12 ("netfilter: nft_meta: add inner match support") in v6.2-rc1.
    Introduced by commit 3a07327 ("netfilter: nft_inner: support for inner tunnel header matching") in v6.2-rc1.
    Fixed in v6.10-rc4.
  debian/carnil: |-
    Introduced in a150d122b6bd ("netfilter: nft_meta: add inner match support")
    3a07327d10a0 ("netfilter: nft_inner: support for inner tunnel header
    matching"). Vulnerable versions: 6.2-rc1.
introduced-by:
  mainline: [a150d122b6bdb84df532057aa3b2faf8c6485792, 3a07327d10a09379315c844c63f27941f5081e0a]
fixed-by:
  mainline: [c4ab9da85b9df3692f861512fe6c9812f38b7471]
  stable/6.6: [b30669fdea0ca03aa22995e6c99f7e7d9dee89ff]
  stable/6.9: [39323f54cad29602917848346c71b087da92a19d]
  ubuntu/focal: ['version:5.4.0-9.12']
