description: 'cachefiles: fix slab-use-after-free in cachefiles_ondemand_get_fd()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40899
- https://git.kernel.org/stable/c/99e9c5bd27ddefa0f9db88625bf5e31c1e833d62
- https://git.kernel.org/stable/c/a6de82765e12fb1201ab607f0d3ffe3309b30fc0
- https://git.kernel.org/stable/c/1d902d9a3aa4f2a8bda698294e34be788be012fc
- https://git.kernel.org/stable/c/de3e26f9e5b76fc628077578c001c4a51bf54d06
- https://lore.kernel.org/linux-cve-announce/2024071207-CVE-2024-40899-a342@gregkh/
- https://git.kernel.org/linus/de3e26f9e5b76fc628077578c001c4a51bf54d06
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit e73fa11 ("cachefiles: add restore command to recover inflight ondemand read requests") in v6.8-rc1.
    Fixed in v6.6.35.
  debian/carnil: |-
    Introduced in e73fa11a356c ("cachefiles: add restore command to recover
    inflight ondemand read requests"). Vulnerable versions: 6.1.95 6.6.35 6.8-rc1.
introduced-by:
  cip/6.1: [a0cc87f86698174aacc083c4652d2606007dd902]
  cip/6.1-rt: [a0cc87f86698174aacc083c4652d2606007dd902]
  mainline: [e73fa11a356ca0905c3cc648eaacc6f0f2d2c8b3]
  stable/6.1: [a0cc87f86698174aacc083c4652d2606007dd902]
  stable/6.6: [9f5fa40f0924e9de85b16c6d1aea80327ce647d8]
fixed-by:
  mainline: [a6de82765e12fb1201ab607f0d3ffe3309b30fc0]
  stable/6.1: [99e9c5bd27ddefa0f9db88625bf5e31c1e833d62]
  stable/6.6: [a6de82765e12fb1201ab607f0d3ffe3309b30fc0]
  stable/6.9: [99e9c5bd27ddefa0f9db88625bf5e31c1e833d62]
