description: 'usb: typec: tcpm: fix use-after-free case in tcpm_register_source_caps'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40903
- https://git.kernel.org/stable/c/4053696594d7235f3638d49a00cf0f289e4b36a3
- https://git.kernel.org/stable/c/04c05d50fa79a41582f7bde8a1fd4377ae4a39e5
- https://git.kernel.org/stable/c/6b67b652849faf108a09647c7fde9b179ef24e2b
- https://git.kernel.org/stable/c/e7e921918d905544500ca7a95889f898121ba886
- https://lore.kernel.org/linux-cve-announce/2024071208-CVE-2024-40903-8fd1@gregkh/
- https://git.kernel.org/linus/e7e921918d905544500ca7a95889f898121ba886
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 230ecdf ("usb: typec: tcpm: unregister existing source caps before re-registration") in v6.9-rc7.
    Fixed in v6.10-rc4.
  debian/carnil: |-
    Introduced in 230ecdf71a64 ("usb: typec: tcpm: unregister existing source caps
    before re-registration"). Vulnerable versions: 6.1.91 6.6.31 6.8.10 6.9-rc7.
introduced-by:
  cip/6.1: [cfcd544a9974c6b6fb37ca385146e4796dcaf66d]
  cip/6.1-rt: [cfcd544a9974c6b6fb37ca385146e4796dcaf66d]
  mainline: [230ecdf71a644c9c73e0e6735b33173074ae3f94]
  stable/6.1: [cfcd544a9974c6b6fb37ca385146e4796dcaf66d]
  stable/6.6: [b16abab1fb645c4b7a86c357dc83a48cf21c2795]
fixed-by:
  cip/6.1: [4053696594d7235f3638d49a00cf0f289e4b36a3]
  cip/6.1-rt: [4053696594d7235f3638d49a00cf0f289e4b36a3]
  mainline: [e7e921918d905544500ca7a95889f898121ba886]
  stable/6.1: [4053696594d7235f3638d49a00cf0f289e4b36a3]
  stable/6.6: [04c05d50fa79a41582f7bde8a1fd4377ae4a39e5]
  stable/6.9: [6b67b652849faf108a09647c7fde9b179ef24e2b]
