description: 'bpf: Fix a potential use-after-free in bpf_link_free()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40909
- https://git.kernel.org/stable/c/91cff53136daeff50816b0baeafd38a6976f6209
- https://git.kernel.org/stable/c/fa97b8fed9896f1e89cb657513e483a152d4c382
- https://git.kernel.org/stable/c/2884dc7d08d98a89d8d65121524bb7533183a63a
- https://lore.kernel.org/linux-cve-announce/2024071210-CVE-2024-40909-1706@gregkh/
- https://git.kernel.org/linus/2884dc7d08d98a89d8d65121524bb7533183a63a
- https://ubuntu.com/security/notices/USN-6999-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 1a80dbc ("bpf: support deferring bpf_link dealloc to after RCU grace period") in v6.9-rc3.
    Fixed in v6.10-rc3.
  debian/carnil: |-
    Introduced in 1a80dbcb2dba ("bpf: support deferring bpf_link dealloc to after
    RCU grace period"). Vulnerable versions: 6.6.26 6.8.5 6.9-rc3.
introduced-by:
  mainline: [1a80dbcb2dbaf6e4c216e62e30fa7d3daa8001ce]
  stable/6.6: [876941f533e7b47fc69977fc4551c02f2d18af97]
fixed-by:
  mainline: [2884dc7d08d98a89d8d65121524bb7533183a63a]
  stable/6.6: [91cff53136daeff50816b0baeafd38a6976f6209]
  stable/6.9: [fa97b8fed9896f1e89cb657513e483a152d4c382]
  ubuntu/focal: ['version:5.4.0-9.12']
