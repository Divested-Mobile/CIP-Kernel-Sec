description: 'cachefiles: defer exposing anon_fd until after copy_to_user() succeeds'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40913
- https://git.kernel.org/stable/c/eac51d9daacd61dcc93333ff6a890cf3efc8c1c0
- https://git.kernel.org/stable/c/d2d3eb377a5d081bf2bed177d354a4f59b74da88
- https://git.kernel.org/stable/c/b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32
- https://git.kernel.org/stable/c/4b4391e77a6bf24cba2ef1590e113d9b73b11039
- https://lore.kernel.org/linux-cve-announce/2024071210-CVE-2024-40913-5952@gregkh/
- https://git.kernel.org/linus/4b4391e77a6bf24cba2ef1590e113d9b73b11039
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c838305 ("cachefiles: notify the user daemon when looking up cookie") in v5.19-rc1.
    Fixed in v6.10-rc4.
  debian/carnil: |-
    Introduced in c8383054506c ("cachefiles: notify the user daemon when looking up
    cookie"). Vulnerable versions: 5.19-rc1.
introduced-by:
  mainline: [c8383054506c77b814489c09877b5db83fd4abf2]
fixed-by:
  cip/6.1: [eac51d9daacd61dcc93333ff6a890cf3efc8c1c0]
  cip/6.1-rt: [eac51d9daacd61dcc93333ff6a890cf3efc8c1c0]
  mainline: [4b4391e77a6bf24cba2ef1590e113d9b73b11039]
  stable/6.1: [eac51d9daacd61dcc93333ff6a890cf3efc8c1c0]
  stable/6.6: [d2d3eb377a5d081bf2bed177d354a4f59b74da88]
  stable/6.9: [b9f58cdae6a364a3270fd6b6a46e0fd4f7f8ce32]
