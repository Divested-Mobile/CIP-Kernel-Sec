description: 'net: bridge: mst: fix suspicious rcu usage in br_mst_set_state'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40920
- https://git.kernel.org/stable/c/caaa2129784a04dcade0ea92c12e6ff90bbd23d8
- https://git.kernel.org/stable/c/7caefa2771722e65496d85b62e1dc4442b7d1345
- https://git.kernel.org/stable/c/406bfc04b01ee47e4c626f77ecc7d9f85135b166
- https://git.kernel.org/stable/c/546ceb1dfdac866648ec959cbc71d9525bd73462
- https://lore.kernel.org/linux-cve-announce/2024071212-CVE-2024-40920-c766@gregkh/
- https://git.kernel.org/linus/546ceb1dfdac866648ec959cbc71d9525bd73462
- https://ubuntu.com/security/notices/USN-6999-1
- https://ubuntu.com/security/notices/USN-7004-1
- https://ubuntu.com/security/notices/USN-7005-1
- https://ubuntu.com/security/notices/USN-7008-1
- https://ubuntu.com/security/notices/USN-7005-2
- https://ubuntu.com/security/notices/USN-6999-2
- https://ubuntu.com/security/notices/USN-7029-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 3a7c166 ("net: bridge: mst: fix vlan use-after-free") in v6.10-rc1.
    Fixed in v6.10-rc4.
  debian/carnil: |-
    Introduced in 3a7c1661ae13 ("net: bridge: mst: fix vlan use-after-free").
    Vulnerable versions: 6.1.93 6.6.33 6.8.12 6.9.3 6.10-rc1.
introduced-by:
  cip/6.1: [8ca9a750fc711911ef616ceb627d07357b04545e]
  cip/6.1-rt: [8ca9a750fc711911ef616ceb627d07357b04545e]
  mainline: [3a7c1661ae1383364cd6092d851f5e5da64d476b]
  stable/6.1: [8ca9a750fc711911ef616ceb627d07357b04545e]
  stable/6.6: [4488617e5e995a09abe4d81add5fb165674edb59]
  stable/6.9: [e43dd2b1ec746e105b7db5f9ad6ef14685a615a4]
fixed-by:
  cip/6.1: [caaa2129784a04dcade0ea92c12e6ff90bbd23d8]
  cip/6.1-rt: [caaa2129784a04dcade0ea92c12e6ff90bbd23d8]
  mainline: [546ceb1dfdac866648ec959cbc71d9525bd73462]
  stable/6.1: [caaa2129784a04dcade0ea92c12e6ff90bbd23d8]
  stable/6.6: [7caefa2771722e65496d85b62e1dc4442b7d1345]
  stable/6.9: [406bfc04b01ee47e4c626f77ecc7d9f85135b166]
  ubuntu/focal: ['version:5.4.0-9.12']
