description: 'io_uring/rsrc: don''t lock while !TASK_RUNNING'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40922
- https://git.kernel.org/stable/c/0c9df3df0c888d9ec8d11a68474a4aa04d371cff
- https://git.kernel.org/stable/c/4429c6c77e176a4c5aa7a3bbd1632f9fc0582518
- https://git.kernel.org/stable/c/54559642b96116b45e4b5ca7fd9f7835b8561272
- https://lore.kernel.org/linux-cve-announce/2024071213-CVE-2024-40922-461c@gregkh/
- https://git.kernel.org/linus/54559642b96116b45e4b5ca7fd9f7835b8561272
- https://ubuntu.com/security/notices/USN-6999-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 4ea15b5 ("io_uring/rsrc: use wq for quiescing") in v6.4-rc1.
    Fixed in v6.10-rc4.
  debian/carnil: |-
    Introduced in 4ea15b56f0810 ("io_uring/rsrc: use wq for quiescing"). Vulnerable
    versions: 6.4-rc1.
introduced-by:
  mainline: [4ea15b56f0810f0d8795d475db1bb74b3a7c1b2f]
fixed-by:
  mainline: [54559642b96116b45e4b5ca7fd9f7835b8561272]
  stable/6.6: [0c9df3df0c888d9ec8d11a68474a4aa04d371cff]
  stable/6.9: [4429c6c77e176a4c5aa7a3bbd1632f9fc0582518]
  ubuntu/focal: ['version:5.4.0-9.12']
