description: 'xhci: Handle TD clearing for multiple streams case'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40927
- https://git.kernel.org/stable/c/26460c1afa311524f588e288a4941432f0de6228
- https://git.kernel.org/stable/c/633f72cb6124ecda97b641fbc119340bd88d51a9
- https://git.kernel.org/stable/c/949be4ec5835e0ccb3e2a8ab0e46179cb5512518
- https://git.kernel.org/stable/c/61593dc413c3655e4328a351555235bc3089486a
- https://git.kernel.org/stable/c/5ceac4402f5d975e5a01c806438eb4e554771577
- https://lore.kernel.org/linux-cve-announce/2024071214-CVE-2024-40927-3dcb@gregkh/
- https://git.kernel.org/linus/5ceac4402f5d975e5a01c806438eb4e554771577
- https://ubuntu.com/security/notices/USN-6999-1
- https://ubuntu.com/security/notices/USN-7004-1
- https://ubuntu.com/security/notices/USN-7005-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit e9df17e ("USB: xhci: Correct assumptions about number of rings per endpoint.") in v2.6.35-rc1.
    Introduced by commit 94f3391 ("xhci: Fix failure to give back some cached cancelled URBs.") in v5.15-rc1.
    Introduced by commit 674f843 ("xhci: split handling halted endpoints into two steps") in v5.12-rc1.
    Fixed in v6.10-rc4.
  debian/carnil: |-
    Introduced in e9df17eb1408 ("USB: xhci: Correct assumptions about number of
    rings per endpoint.")
    94f339147fc3 ("xhci: Fix failure to give back some cached cancelled URBs.")
    674f8438c121 ("xhci: split handling halted endpoints into two steps").
    Vulnerable versions: 2.6.35-rc1.
introduced-by:
  mainline: [e9df17eb1408cfafa3d1844bfc7f22c7237b31b8, 94f339147fc3eb9edef7ee4ef6e39c569c073753,
    674f8438c12125d6b4fe51d44b9316bb02b286b5]
fixed-by:
  cip/6.1: [633f72cb6124ecda97b641fbc119340bd88d51a9]
  cip/6.1-rt: [633f72cb6124ecda97b641fbc119340bd88d51a9]
  mainline: [5ceac4402f5d975e5a01c806438eb4e554771577]
  stable/5.15: [26460c1afa311524f588e288a4941432f0de6228]
  stable/6.1: [633f72cb6124ecda97b641fbc119340bd88d51a9]
  stable/6.6: [949be4ec5835e0ccb3e2a8ab0e46179cb5512518]
  stable/6.9: [61593dc413c3655e4328a351555235bc3089486a]
