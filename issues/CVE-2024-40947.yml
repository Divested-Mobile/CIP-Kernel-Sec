description: 'ima: Avoid blocking in RCU read-side critical section'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40947
- https://git.kernel.org/stable/c/9c3906c3738562b1fedc6f1cfc81756a7cfefff0
- https://git.kernel.org/stable/c/28d0ecc52f6c927d0e9ba70a4f2c1ea15453ee88
- https://git.kernel.org/stable/c/58275455893066149e9f4df2223ab2fdbdc59f9c
- https://git.kernel.org/stable/c/9a95c5bfbf02a0a7f5983280fe284a0ff0836c34
- https://lore.kernel.org/linux-cve-announce/2024071221-CVE-2024-40947-4782@gregkh/
- https://git.kernel.org/linus/9a95c5bfbf02a0a7f5983280fe284a0ff0836c34
- https://ubuntu.com/security/notices/USN-6999-1
- https://ubuntu.com/security/notices/USN-7004-1
- https://ubuntu.com/security/notices/USN-7005-1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c7423db ("ima: Handle -ESTALE returned by ima_filter_rule_match()") in v6.2-rc1.
    Fixed in v6.10-rc5.
  debian/carnil: |-
    Introduced in c7423dbdbc9e ("ima: Handle -ESTALE returned by
    ima_filter_rule_match()"). Vulnerable versions: 5.4.229 5.10.163 5.15.86 6.0.16
    6.1.2 6.2-rc1.
introduced-by:
  cip/5.10: [c4b035b1f036ddd53fbfced49046e586c5ad8a3e]
  cip/5.10-rt: [c4b035b1f036ddd53fbfced49046e586c5ad8a3e]
  cip/6.1: [8008f1691c15f353f5a53dc5d450b8262cb57421]
  cip/6.1-rt: [8008f1691c15f353f5a53dc5d450b8262cb57421]
  mainline: [c7423dbdbc9ecef7fff5239d144cad4b9887f4de]
  stable/5.10: [c4b035b1f036ddd53fbfced49046e586c5ad8a3e]
  stable/5.15: [2d4bc60693c4206c64723e94ae5f7a04c0b8f18f]
  stable/5.4: [38d48fd224036717fcb3437e7af1314f6ebcd2d0]
  stable/6.1: [8008f1691c15f353f5a53dc5d450b8262cb57421]
  ubuntu/focal: [76c3b30f573b1bc109ec5a4d56e9252b9e4a5a08]
fixed-by:
  cip/5.10: [a6176a802c4bfb83bf7524591aa75f44a639a853]
  cip/5.10-rt: [a6176a802c4bfb83bf7524591aa75f44a639a853]
  cip/6.1: [9c3906c3738562b1fedc6f1cfc81756a7cfefff0]
  cip/6.1-rt: [9c3906c3738562b1fedc6f1cfc81756a7cfefff0]
  mainline: [9a95c5bfbf02a0a7f5983280fe284a0ff0836c34]
  stable/5.10: [a6176a802c4bfb83bf7524591aa75f44a639a853]
  stable/5.15: [a38e02265c681b51997a264aaf743095e2ee400a]
  stable/6.1: [9c3906c3738562b1fedc6f1cfc81756a7cfefff0]
  stable/6.6: [28d0ecc52f6c927d0e9ba70a4f2c1ea15453ee88]
  stable/6.9: [58275455893066149e9f4df2223ab2fdbdc59f9c]
