description: 'KVM: Fix a data race on last_boosted_vcpu in kvm_vcpu_on_spin()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40953
- https://git.kernel.org/stable/c/92c77807d938145c7c3350c944ef9f39d7f6017c
- https://git.kernel.org/stable/c/a937ef951bba72f48d2402451419d725d70dba20
- https://git.kernel.org/stable/c/95c8dd79f3a14df96b3820b35b8399bd91b2be60
- https://git.kernel.org/stable/c/49f683b41f28918df3e51ddc0d928cb2e934ccdb
- https://lore.kernel.org/linux-cve-announce/2024071223-CVE-2024-40953-8685@gregkh/
- https://git.kernel.org/linus/49f683b41f28918df3e51ddc0d928cb2e934ccdb
- https://ubuntu.com/security/notices/USN-6999-1
- https://ubuntu.com/security/notices/USN-7004-1
- https://ubuntu.com/security/notices/USN-7005-1
- https://ubuntu.com/security/notices/USN-7008-1
- https://ubuntu.com/security/notices/USN-7005-2
- https://ubuntu.com/security/notices/USN-6999-2
- https://ubuntu.com/security/notices/USN-7029-1
- https://git.kernel.org/stable/c/11a772d5376aa6d3e2e69b5b5c585f79b60c0e17
- https://git.kernel.org/stable/c/4c141136a28421b78f34969b25a4fa32e06e2180
- https://git.kernel.org/stable/c/71fbc3af3dacb26c3aa2f30bb3ab05c44d082c84
- https://git.kernel.org/stable/c/82bd728a06e55f5b5f93d10ce67f4fe7e689853a
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 217ece6 ("KVM: use yield_to instead of sleep in kvm_vcpu_on_spin") in v2.6.39-rc1.
    Fixed in v6.10-rc5.
  debian/carnil: |-
    Introduced in 217ece6129f2 ("KVM: use yield_to instead of sleep in
    kvm_vcpu_on_spin"). Vulnerable versions: 2.6.39-rc1.
introduced-by:
  mainline: [217ece6129f2d3b4fdd18d9e79be9e43d8d14a42]
fixed-by:
  cip/4.19: [11a772d5376aa6d3e2e69b5b5c585f79b60c0e17]
  cip/5.10: [71fbc3af3dacb26c3aa2f30bb3ab05c44d082c84]
  cip/6.1: [92c77807d938145c7c3350c944ef9f39d7f6017c]
  cip/6.1-rt: [92c77807d938145c7c3350c944ef9f39d7f6017c]
  mainline: [49f683b41f28918df3e51ddc0d928cb2e934ccdb]
  stable/4.19: [11a772d5376aa6d3e2e69b5b5c585f79b60c0e17]
  stable/5.10: [71fbc3af3dacb26c3aa2f30bb3ab05c44d082c84]
  stable/5.15: [82bd728a06e55f5b5f93d10ce67f4fe7e689853a]
  stable/5.4: [4c141136a28421b78f34969b25a4fa32e06e2180]
  stable/6.1: [92c77807d938145c7c3350c944ef9f39d7f6017c]
  stable/6.6: [a937ef951bba72f48d2402451419d725d70dba20]
  stable/6.9: [95c8dd79f3a14df96b3820b35b8399bd91b2be60]
  ubuntu/focal: [f750e69c011e17817f6ef7bcb971b89d13493fd2]
