description: 'KVM: Fix a data race on last_boosted_vcpu in kvm_vcpu_on_spin()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40953
- https://git.kernel.org/stable/c/92c77807d938145c7c3350c944ef9f39d7f6017c
- https://git.kernel.org/stable/c/a937ef951bba72f48d2402451419d725d70dba20
- https://git.kernel.org/stable/c/95c8dd79f3a14df96b3820b35b8399bd91b2be60
- https://git.kernel.org/stable/c/49f683b41f28918df3e51ddc0d928cb2e934ccdb
- https://lore.kernel.org/linux-cve-announce/2024071223-CVE-2024-40953-8685@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 217ece6 ("KVM: use yield_to instead of sleep in kvm_vcpu_on_spin") in v2.6.39-rc1.
    Fixed in v6.10-rc5.
  debian/carnil: |-
    Introduced in 217ece6129f2 ("KVM: use yield_to instead of sleep in
    kvm_vcpu_on_spin"). Vulnerable versions: 2.6.39-rc1.
introduced-by:
  mainline: [217ece6129f2d3b4fdd18d9e79be9e43d8d14a42]
fixed-by:
  cip/6.1: [92c77807d938145c7c3350c944ef9f39d7f6017c]
  cip/6.1-rt: [92c77807d938145c7c3350c944ef9f39d7f6017c]
  mainline: [49f683b41f28918df3e51ddc0d928cb2e934ccdb]
  stable/6.1: [92c77807d938145c7c3350c944ef9f39d7f6017c]
  stable/6.6: [a937ef951bba72f48d2402451419d725d70dba20]
  stable/6.9: [95c8dd79f3a14df96b3820b35b8399bd91b2be60]
