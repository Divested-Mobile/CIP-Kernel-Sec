description: 'net: do not leave a dangling sk pointer, when socket creation fails'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40954
- https://git.kernel.org/stable/c/78e4aa528a7b1204219d808310524344f627d069
- https://git.kernel.org/stable/c/893eeba94c40d513cd0fe6539330ebdaea208c0e
- https://git.kernel.org/stable/c/454c454ed645fed051216b79622f7cb69c1638f5
- https://git.kernel.org/stable/c/5dfe2408fd7dc4d2e7ac38a116ff0a37b1cfd3b9
- https://git.kernel.org/stable/c/6cd4a78d962bebbaf8beb7d2ead3f34120e3f7b2
- https://lore.kernel.org/linux-cve-announce/2024071223-CVE-2024-40954-093b@gregkh/
- https://git.kernel.org/linus/6cd4a78d962bebbaf8beb7d2ead3f34120e3f7b2
- https://ubuntu.com/security/notices/USN-6999-1
- https://ubuntu.com/security/notices/USN-7004-1
- https://ubuntu.com/security/notices/USN-7005-1
- https://ubuntu.com/security/notices/USN-7007-1
- https://ubuntu.com/security/notices/USN-7008-1
- https://ubuntu.com/security/notices/USN-7005-2
- https://ubuntu.com/security/notices/USN-7009-1
- https://ubuntu.com/security/notices/USN-7019-1
- https://ubuntu.com/security/notices/USN-7007-2
- https://ubuntu.com/security/notices/USN-6999-2
- https://ubuntu.com/security/notices/USN-7007-3
- https://ubuntu.com/security/notices/USN-7029-1
- https://ubuntu.com/security/notices/USN-7009-2
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c5dbb89 ("bpf: Expose bpf_get_socket_cookie to tracing programs") in v5.12-rc1.
    Fixed in v6.10-rc5.
  debian/carnil: |-
    Introduced in c5dbb89fc2ac ("bpf: Expose bpf_get_socket_cookie to tracing
    programs"). Vulnerable versions: 5.12-rc1.
introduced-by:
  mainline: [c5dbb89fc2ac013afe67b9e4fcb3743c02b567cd]
fixed-by:
  cip/6.1: [893eeba94c40d513cd0fe6539330ebdaea208c0e]
  cip/6.1-rt: [893eeba94c40d513cd0fe6539330ebdaea208c0e]
  mainline: [6cd4a78d962bebbaf8beb7d2ead3f34120e3f7b2]
  stable/5.15: [78e4aa528a7b1204219d808310524344f627d069]
  stable/6.1: [893eeba94c40d513cd0fe6539330ebdaea208c0e]
  stable/6.6: [454c454ed645fed051216b79622f7cb69c1638f5]
  stable/6.9: [5dfe2408fd7dc4d2e7ac38a116ff0a37b1cfd3b9]
  ubuntu/focal: ['version:5.4.0-9.12']
