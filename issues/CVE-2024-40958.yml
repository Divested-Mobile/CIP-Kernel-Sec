description: 'netns: Make get_net_ns() handle zero refcount net'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40958
- https://git.kernel.org/stable/c/3a6cd326ead7c8bb1f64486789a01974a9f1ad55
- https://git.kernel.org/stable/c/2b82028a1f5ee3a8e04090776b10c534144ae77b
- https://git.kernel.org/stable/c/cb7f811f638a14590ff98f53c6dd1fb54627d940
- https://git.kernel.org/stable/c/1b631bffcb2c09551888f3c723f4365c91fe05ef
- https://git.kernel.org/stable/c/ef0394ca25953ea0eddcc82feae1f750451f1876
- https://git.kernel.org/stable/c/3af28df0d883e8c89a29ac31bc65f9023485743b
- https://git.kernel.org/stable/c/ff960f9d3edbe08a736b5a224d91a305ccc946b0
- https://lore.kernel.org/linux-cve-announce/2024071225-CVE-2024-40958-8ed5@gregkh/
- https://git.kernel.org/linus/ff960f9d3edbe08a736b5a224d91a305ccc946b0
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 0c3e0e3 ("tun: Add ioctl() TUNGETDEVNETNS cmd to allow obtaining real net ns of tun device") in v5.2-rc1.
    Fixed in v6.10-rc5.
  debian/carnil: |-
    Introduced in 0c3e0e3bb623 ("tun: Add ioctl() TUNGETDEVNETNS cmd to allow
    obtaining real net ns of tun device"). Vulnerable versions: 5.2-rc1.
introduced-by:
  mainline: [0c3e0e3bb623c3735b8c9ab8aa8332f944f83a9f]
fixed-by:
  cip/5.10: [2b82028a1f5ee3a8e04090776b10c534144ae77b]
  cip/5.10-rt: [2b82028a1f5ee3a8e04090776b10c534144ae77b]
  cip/6.1: [1b631bffcb2c09551888f3c723f4365c91fe05ef]
  cip/6.1-rt: [1b631bffcb2c09551888f3c723f4365c91fe05ef]
  mainline: [ff960f9d3edbe08a736b5a224d91a305ccc946b0]
  stable/5.10: [2b82028a1f5ee3a8e04090776b10c534144ae77b]
  stable/5.15: [cb7f811f638a14590ff98f53c6dd1fb54627d940]
  stable/5.4: [3a6cd326ead7c8bb1f64486789a01974a9f1ad55]
  stable/6.1: [1b631bffcb2c09551888f3c723f4365c91fe05ef]
  stable/6.6: [ef0394ca25953ea0eddcc82feae1f750451f1876]
  stable/6.9: [3af28df0d883e8c89a29ac31bc65f9023485743b]
  ubuntu/focal: [17e69bccf4b1464660032c4d636689ac47dd490f]
