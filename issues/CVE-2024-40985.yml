description: 'net/tcp_ao: Don''t leak ao_info on error-path'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40985
- https://git.kernel.org/stable/c/ebaa7d3c26332330a48f9a15f8e518d526cc0f21
- https://git.kernel.org/stable/c/f9ae848904289ddb16c7c9e4553ed4c64300de49
- https://lore.kernel.org/linux-cve-announce/2024071248-CVE-2024-40985-875b@gregkh/
- https://git.kernel.org/linus/f9ae848904289ddb16c7c9e4553ed4c64300de49
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 0aadc73 ("net/tcp: Prevent TCP-MD5 with TCP-AO being set") in v6.7-rc1.
    Fixed in v6.10-rc5.
  debian/carnil: |-
    Introduced in 0aadc73995d0 ("net/tcp: Prevent TCP-MD5 with TCP-AO being set").
    Vulnerable versions: 6.7-rc1.
introduced-by:
  mainline: [0aadc73995d08f6b0dc061c14a564ffa46f5914e]
fixed-by:
  mainline: [f9ae848904289ddb16c7c9e4553ed4c64300de49]
  stable/6.9: [ebaa7d3c26332330a48f9a15f8e518d526cc0f21]
  ubuntu/focal: ['version:5.4.0-9.12']
