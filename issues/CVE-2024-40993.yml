description: 'netfilter: ipset: Fix suspicious rcu_dereference_protected()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-40993
- https://git.kernel.org/stable/c/3799d02ae4208af08e81310770d8754863a246a1
- https://git.kernel.org/stable/c/72d9611968867cc4c5509e7708b1507d692b797a
- https://git.kernel.org/stable/c/523bed6489e089dd8040e72453fb79da47b144c2
- https://git.kernel.org/stable/c/788d585e62f487bc4536d454937f737b70d39a33
- https://git.kernel.org/stable/c/94dd411c18d7fff9e411555d5c662d29416501e4
- https://git.kernel.org/stable/c/3fc09e1ca854bc234e007a56e0f7431f5e2defb5
- https://git.kernel.org/stable/c/8ecd06277a7664f4ef018abae3abd3451d64e7a6
- https://lore.kernel.org/linux-cve-announce/2024071250-CVE-2024-40993-ee08@gregkh/
- https://git.kernel.org/linus/8ecd06277a7664f4ef018abae3abd3451d64e7a6
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 4e7aaa6 ("netfilter: ipset: Fix race between namespace cleanup and gc in the list:set type") in v6.10-rc4.
    Fixed in v6.1.96.
  debian/carnil: |-
    Introduced in 4e7aaa6b82d6 ("netfilter: ipset: Fix race between namespace
    cleanup and gc in the list:set type"). Vulnerable versions: 5.4.279 5.10.221
    5.15.162 6.1.95 6.6.35 6.9.6 6.10-rc4.
introduced-by:
  cip/5.10: [93b53c202b51a69e42ca57f5a183f7e008e19f83]
  cip/6.1: [390b353d1a1da3e9c6c0fd14fe650d69063c95d6]
  cip/6.1-rt: [390b353d1a1da3e9c6c0fd14fe650d69063c95d6]
  mainline: [4e7aaa6b82d63e8ddcbfb56b4fd3d014ca586f10]
  stable/5.10: [93b53c202b51a69e42ca57f5a183f7e008e19f83]
  stable/5.15: [0f1bb77c6d837c9513943bc7c08f04c5cc5c6568]
  stable/5.4: [c0761d1f1ce1d5b85b5e82bbb714df12de1aa8c3]
  stable/6.1: [390b353d1a1da3e9c6c0fd14fe650d69063c95d6]
  stable/6.6: [2ba35b37f780c6410bb4bba9c3072596d8576702]
  stable/6.9: [90ae20d47de602198eb69e6cd7a3db3420abfc08]
fixed-by:
  mainline: [788d585e62f487bc4536d454937f737b70d39a33]
  stable/5.10: [72d9611968867cc4c5509e7708b1507d692b797a]
  stable/6.1: [3799d02ae4208af08e81310770d8754863a246a1]
  stable/6.6: [72d9611968867cc4c5509e7708b1507d692b797a]
  stable/6.9: [523bed6489e089dd8040e72453fb79da47b144c2]
  ubuntu/focal: ['version:5.4.0-9.12']
