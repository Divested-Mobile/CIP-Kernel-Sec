description: 'filelock: Remove locks reliably when fcntl/close race is detected'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-41012
- https://git.kernel.org/stable/c/b6d223942c34057fdfd8f149e763fa823731b224
- https://git.kernel.org/stable/c/3cad1bc010416c6dd780643476bc59ed742436b9
- https://lore.kernel.org/linux-cve-announce/2024072314-CVE-2024-41012-a1cf@gregkh/
- https://git.kernel.org/linus/3cad1bc010416c6dd780643476bc59ed742436b9
- https://ubuntu.com/security/notices/USN-7088-1
- https://ubuntu.com/security/notices/USN-7089-1
- https://ubuntu.com/security/notices/USN-7090-1
- https://ubuntu.com/security/notices/USN-7088-2
- https://ubuntu.com/security/notices/USN-7089-2
- https://ubuntu.com/security/notices/USN-7088-3
- https://ubuntu.com/security/notices/USN-7089-3
- https://ubuntu.com/security/notices/USN-7095-1
- https://ubuntu.com/security/notices/USN-7088-4
- https://ubuntu.com/security/notices/USN-7100-1
- https://ubuntu.com/security/notices/USN-7100-2
- https://ubuntu.com/security/notices/USN-7089-4
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit c293621 ("[PATCH] stale POSIX lock handling") in v2.6.13.4.
    Fixed in v6.10-rc7.
  debian/carnil: |-
    Introduced in c293621bbf67 ("[PATCH] stale POSIX lock handling"). Vulnerable
    versions: 2.6.13-rc4.
introduced-by:
  mainline: [c293621bbf678a3d85e3ed721c3921c8a670610d]
fixed-by:
  cip/4.19: [d30ff33040834c3b9eee29740acd92f9c7ba2250]
  cip/4.19-rt: [d30ff33040834c3b9eee29740acd92f9c7ba2250]
  cip/4.4: [f45b899adc6bf0c737310c6703f3cd83e2c00ab6]
  cip/4.4-rt: [f45b899adc6bf0c737310c6703f3cd83e2c00ab6]
  cip/4.4-st: [f45b899adc6bf0c737310c6703f3cd83e2c00ab6]
  cip/5.10: [5661b9c7ec189406c2dde00837aaa4672efb6240]
  cip/5.10-rt: [5661b9c7ec189406c2dde00837aaa4672efb6240]
  cip/6.1: [ef8fc41cd6f95f9a4a3470f085aecf350569a0b3]
  cip/6.1-rt: [ef8fc41cd6f95f9a4a3470f085aecf350569a0b3]
  mainline: [3cad1bc010416c6dd780643476bc59ed742436b9]
  stable/4.19: [d30ff33040834c3b9eee29740acd92f9c7ba2250]
  stable/5.10: [5661b9c7ec189406c2dde00837aaa4672efb6240]
  stable/5.15: [52c87ab18c76c14d7209646ccb3283b3f5d87b22]
  stable/5.4: [dc2ce1dfceaa0767211a9d963ddb029ab21c4235]
  stable/6.1: [ef8fc41cd6f95f9a4a3470f085aecf350569a0b3]
  stable/6.6: [5f5d0799eb0a01d550c21b7894e26b2d9db55763]
  stable/6.9: [b6d223942c34057fdfd8f149e763fa823731b224]
  ubuntu/focal: [bdbd2a8d65c5adff432899dfa8abcd3e6caefbce]
