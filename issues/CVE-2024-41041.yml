description: 'udp: Set SOCK_RCU_FREE earlier in udp_lib_get_port().'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-41041
- https://git.kernel.org/stable/c/7a67c4e47626e6daccda62888f8b096abb5d3940
- https://git.kernel.org/stable/c/9f965684c57c3117cfd2f754dd3270383c529fba
- https://git.kernel.org/stable/c/ddf516e50bf8a7bc9b3bd8a9831f9c7a8131a32a
- https://git.kernel.org/stable/c/a6db0d3ea6536e7120871e5448b3032570152ec6
- https://git.kernel.org/stable/c/c5fd77ca13d657c6e99bf04f0917445e6a80231e
- https://git.kernel.org/stable/c/20ceae10623c3b29fdf7609690849475bcdebdb0
- https://git.kernel.org/stable/c/5c0b485a8c6116516f33925b9ce5b6104a6eadfd
- https://lore.kernel.org/linux-cve-announce/2024072924-CVE-2024-41041-ae0c@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 6acc9b4 ("bpf: Add helper to retrieve socket in BPF") in v4.20-rc1.
    Fixed in v6.10.
  debian/carnil: |-
    Introduced in 6acc9b432e67 ("bpf: Add helper to retrieve socket in BPF").
    Vulnerable versions: 4.20-rc1.
introduced-by:
  mainline: [6acc9b432e6714d72d7d77ec7c27f6f8358d0c71]
fixed-by:
  cip/6.1: [a6db0d3ea6536e7120871e5448b3032570152ec6]
  mainline: [5c0b485a8c6116516f33925b9ce5b6104a6eadfd]
  stable/5.10: [9f965684c57c3117cfd2f754dd3270383c529fba]
  stable/5.15: [ddf516e50bf8a7bc9b3bd8a9831f9c7a8131a32a]
  stable/5.4: [7a67c4e47626e6daccda62888f8b096abb5d3940]
  stable/6.1: [a6db0d3ea6536e7120871e5448b3032570152ec6]
  stable/6.10: [5c0b485a8c6116516f33925b9ce5b6104a6eadfd]
  stable/6.6: [c5fd77ca13d657c6e99bf04f0917445e6a80231e]
