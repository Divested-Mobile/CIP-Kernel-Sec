description: 'btrfs: always do the basic checks for btrfs_qgroup_inherit structure'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-42111
- https://git.kernel.org/stable/c/ebe5ea02577b2c527958af1b76ac472c7ab53a56
- https://git.kernel.org/stable/c/724d8042cef84496ddb4492dc120291f997ae26b
- https://lore.kernel.org/linux-cve-announce/2024073021-CVE-2024-42111-034c@gregkh/
- https://git.kernel.org/linus/724d8042cef84496ddb4492dc120291f997ae26b
- https://ubuntu.com/security/notices/USN-7089-1
- https://ubuntu.com/security/notices/USN-7090-1
- https://ubuntu.com/security/notices/USN-7089-2
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit b5357cb ("btrfs: qgroup: do not check qgroup inherit if qgroup is disabled") in v6.9.
    Fixed in v6.10-rc7.
  debian/carnil: |-
    Introduced in b5357cb268c4 ("btrfs: qgroup: do not check qgroup inherit if
    qgroup is disabled"). Vulnerable versions: 6.8.10 6.9.
introduced-by:
  mainline: [b5357cb268c41b4e2b7383d2759fc562f5b58c33]
fixed-by:
  mainline: [724d8042cef84496ddb4492dc120291f997ae26b]
  ubuntu/focal: ['version:5.4.0-9.12']
