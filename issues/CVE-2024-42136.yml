description: 'cdrom: rearrange last_media_change check to avoid unintentional overflow'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-42136
- https://git.kernel.org/stable/c/0c97527e916054acc4a46ffb02842988acb2e92b
- https://git.kernel.org/stable/c/3ee21e14c8c329168a0b66bab00ecd18f5d0dee3
- https://git.kernel.org/stable/c/e809bc112712da8f7e15822674c6562da6cdf24c
- https://git.kernel.org/stable/c/efb905aeb44b0e99c0e6b07865b1885ae0471ebf
- https://lore.kernel.org/linux-cve-announce/2024073029-CVE-2024-42136-5f6e@gregkh/
- https://git.kernel.org/linus/efb905aeb44b0e99c0e6b07865b1885ae0471ebf
- https://ubuntu.com/security/notices/USN-7089-1
- https://ubuntu.com/security/notices/USN-7090-1
- https://ubuntu.com/security/notices/USN-7089-2
- https://ubuntu.com/security/notices/USN-7089-3
- https://ubuntu.com/security/notices/USN-7095-1
- https://ubuntu.com/security/notices/USN-7089-4
comments:
  cip/cip-kernel-sec: There is no mention of the commit that introduced the bug in
    the CVE announcement.Fixed in v6.10-rc1.
  cip/masami: |-
    It seems as if this bug was introduced by commit 67f1e027c2 ("drivers/cdrom:
    improved ioctl for media change detection") in 5.16-rc1.
  debian/carnil: First introducing commit could not be determined.
introduced-by:
  mainline: [67f1e027c27054e641584655020a417eaac9cb3a]
fixed-by:
  cip/6.1: [0c97527e916054acc4a46ffb02842988acb2e92b]
  cip/6.1-rt: [0c97527e916054acc4a46ffb02842988acb2e92b]
  mainline: [efb905aeb44b0e99c0e6b07865b1885ae0471ebf]
  stable/6.1: [0c97527e916054acc4a46ffb02842988acb2e92b]
  stable/6.6: [3ee21e14c8c329168a0b66bab00ecd18f5d0dee3]
  ubuntu/focal: ['version:5.4.0-9.12']
