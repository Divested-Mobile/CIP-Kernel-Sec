description: 'x86/bhi: Avoid warning in #DB handler due to BHI mitigation'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-42240
- https://git.kernel.org/stable/c/db56615e96c439e13783d7715330e824b4fd4b84
- https://git.kernel.org/stable/c/a765679defe1dc1b8fa01928a6ad6361e72a1364
- https://git.kernel.org/stable/c/dae3543db8f0cf8ac1a198c3bb4b6e3c24d576cf
- https://git.kernel.org/stable/c/08518d48e5b744620524f0acd7c26c19bda7f513
- https://git.kernel.org/stable/c/ac8b270b61d48fcc61f052097777e3b5e11591e0
- https://lore.kernel.org/linux-cve-announce/2024080741-CVE-2024-42240-3d04@gregkh/
- https://git.kernel.org/linus/ac8b270b61d48fcc61f052097777e3b5e11591e0
- https://ubuntu.com/security/notices/USN-7007-1
- https://ubuntu.com/security/notices/USN-7009-1
- https://ubuntu.com/security/notices/USN-7019-1
- https://ubuntu.com/security/notices/USN-7007-2
- https://ubuntu.com/security/notices/USN-7007-3
- https://ubuntu.com/security/notices/USN-7009-2
- https://ubuntu.com/security/notices/USN-7089-1
- https://ubuntu.com/security/notices/USN-7090-1
- https://ubuntu.com/security/notices/USN-7089-2
- https://ubuntu.com/security/notices/USN-7089-3
- https://ubuntu.com/security/notices/USN-7095-1
- https://ubuntu.com/security/notices/USN-7089-4
- https://ubuntu.com/security/notices/USN-7089-5
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 7390db8 ("x86/bhi: Add support for clearing branch history at syscall entry") in v6.9-rc4.
    Fixed in v6.10.
  debian/carnil: |-
    Introduced in 7390db8aea0d ("x86/bhi: Add support for clearing branch history
    at syscall entry"). Vulnerable versions: 5.15.154 6.1.85 6.6.26 6.8.5 6.9-rc4.
introduced-by:
  cip/6.1: [07dbb10f153f483e8249acebdffedf922e2ec2e1]
  cip/6.1-rt: [07dbb10f153f483e8249acebdffedf922e2ec2e1]
  mainline: [7390db8aea0d64e9deb28b8e1ce716f5020c7ee5]
  stable/5.15: [bd53ec80f21839cfd4d852a6088279d602d67e5b]
  stable/6.1: [07dbb10f153f483e8249acebdffedf922e2ec2e1]
  stable/6.6: [eb36b0dce2138581bc6b5e39d0273cb4c96ded81]
  ubuntu/focal: [d7ec8b94b6151bcf1ccccaa58fed0c1c7b9be743]
fixed-by:
  cip/6.1: [a765679defe1dc1b8fa01928a6ad6361e72a1364]
  cip/6.1-rt: [a765679defe1dc1b8fa01928a6ad6361e72a1364]
  mainline: [ac8b270b61d48fcc61f052097777e3b5e11591e0]
  stable/5.15: [db56615e96c439e13783d7715330e824b4fd4b84]
  stable/6.1: [a765679defe1dc1b8fa01928a6ad6361e72a1364]
  stable/6.6: [dae3543db8f0cf8ac1a198c3bb4b6e3c24d576cf]
  ubuntu/focal: [e7a18d32a5bbad47b2f7884995abf93456d2afca]
