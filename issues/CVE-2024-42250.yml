description: 'cachefiles: add missing lock protection when polling'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-42250
- https://git.kernel.org/stable/c/97cfd5e20ddc2e33e16ce369626ce76c9a475fd7
- https://git.kernel.org/stable/c/6bb6bd3dd6f382dfd36220d4b210a0c77c066651
- https://git.kernel.org/stable/c/8eadcab7f3dd809edbe5ae20533ff843dfea3a07
- https://git.kernel.org/stable/c/cf5bb09e742a9cf6349127e868329a8f69b7a014
- https://lore.kernel.org/linux-cve-announce/2024080743-CVE-2024-42250-9580@gregkh/
- https://git.kernel.org/linus/cf5bb09e742a9cf6349127e868329a8f69b7a014
- https://ubuntu.com/security/notices/USN-7089-1
- https://ubuntu.com/security/notices/USN-7090-1
- https://ubuntu.com/security/notices/USN-7089-2
- https://ubuntu.com/security/notices/USN-7089-3
- https://ubuntu.com/security/notices/USN-7095-1
- https://ubuntu.com/security/notices/USN-7089-4
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit b817e22 ("cachefiles: narrow the scope of triggering EPOLLIN events in ondemand mode") in v6.8-rc1.
    Fixed in v6.6.41.
  debian/carnil: |-
    Introduced in b817e22b2e91 ("cachefiles: narrow the scope of triggering EPOLLIN
    events in ondemand mode"). Vulnerable versions: 6.1.100 6.6.41 6.8-rc1.
introduced-by:
  cip/6.1: [0e19a18f998dcabe8be590e0b39660a1f230209b]
  cip/6.1-rt: [0e19a18f998dcabe8be590e0b39660a1f230209b]
  mainline: [b817e22b2e91257ace32a6768c3c003faeaa1c5c]
  stable/6.1: [0e19a18f998dcabe8be590e0b39660a1f230209b]
  stable/6.6: [18943864342705fa18dd4e6b8d608491fec81f6e]
fixed-by:
  mainline: [6bb6bd3dd6f382dfd36220d4b210a0c77c066651]
  stable/6.1: [97cfd5e20ddc2e33e16ce369626ce76c9a475fd7]
  stable/6.6: [6bb6bd3dd6f382dfd36220d4b210a0c77c066651]
  ubuntu/focal: ['version:5.4.0-9.12']
