description: 'btrfs: fix double inode unlock for direct IO sync writes'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-43885
- https://git.kernel.org/stable/c/1a607d22dea4f60438747705495ec4d0af2ec451
- https://git.kernel.org/stable/c/8bd4c9220416111500c275546c69c63d42185793
- https://git.kernel.org/stable/c/7ba27f14161fc20c4fc0051658a22ddd832eb0aa
- https://git.kernel.org/stable/c/d924a0be2f218501588cf463d70f1c71afea06d9
- https://git.kernel.org/stable/c/e0391e92f9ab4fb3dbdeb139c967dcfa7ac4b115
- https://lore.kernel.org/linux-cve-announce/2024082652-CVE-2024-43885-3500@gregkh/
- https://git.kernel.org/linus/e0391e92f9ab4fb3dbdeb139c967dcfa7ac4b115
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 939b656 ("btrfs: fix corruption after buffer fault in during direct IO append write") in v6.11-rc2.
    Fixed in v5.15.165.
  debian/carnil: |-
    Introduced in 939b656bc8ab ("btrfs: fix corruption after buffer fault in during
    direct IO append write"). Vulnerable versions: 5.15.165 6.1.105 6.6.46 6.10.5
    6.11-rc2.
introduced-by:
  mainline: [939b656bc8ab203fdbde26ccac22bcb7f0985be5]
  stable/5.15: [4e17707035a65f6e5b2a4d987a308cf8ed8c5ad1]
  stable/6.1: [6cae8d04d8b3d1ecfadcaa989e673f6f73349ed5]
  stable/6.10: [3831170f740685fddc8f6aa57a83ad0fef4711bf]
  stable/6.6: [0a108bde616a7017653385b5a12111015051a294]
fixed-by:
  mainline: [1a607d22dea4f60438747705495ec4d0af2ec451]
  stable/6.1: [8bd4c9220416111500c275546c69c63d42185793]
  stable/6.10: [d924a0be2f218501588cf463d70f1c71afea06d9]
  stable/6.6: [7ba27f14161fc20c4fc0051658a22ddd832eb0aa]
