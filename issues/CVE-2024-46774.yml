description: |-
  In the Linux kernel, the following vulnerability has been resolved:
  powerpc/rtas: Prevent Spectre v1 gadget construction in sys_rtas()
  Smatch warns:
    arch/powerpc/kernel/rtas.c:1932 __do_sys_rtas() warn: potential
    spectre issue 'args.args' [r] (local cap)
  The 'nargs' and 'nret' locals come directly from a user-supplied
  buffer and are used as indexes into a small stack-based array and as
  inputs to copy_to_user() after they are subject to bounds checks.
  Use array_index_nospec() after the bounds checks to clamp these values
  for speculative execution.
references:
- https://www.cve.org/CVERecord?id=CVE-2024-46774
- https://git.kernel.org/linus/0974d03eb479384466d828d65637814bee6b26d7
- https://git.kernel.org/stable/c/68d8156480940b79227d58865ec5d2947b9384a8
- https://git.kernel.org/stable/c/0974d03eb479384466d828d65637814bee6b26d7
fixed-by:
  mainline: [0974d03eb479384466d828d65637814bee6b26d7]
  stable/6.10: [68d8156480940b79227d58865ec5d2947b9384a8]
