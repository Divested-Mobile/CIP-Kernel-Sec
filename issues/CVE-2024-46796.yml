description: 'smb: client: fix double put of @cfile in smb2_set_path_size()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-46796
- https://git.kernel.org/stable/c/5a72d1edb0843e4c927a4096f81e631031c25c28
- https://git.kernel.org/stable/c/762099898309218b4a7954f3d49e985dc4dfd638
- https://git.kernel.org/stable/c/f9c169b51b6ce20394594ef674d6b10efba31220
- https://lore.kernel.org/linux-cve-announce/2024091855-CVE-2024-46796-41c4@gregkh/
- https://git.kernel.org/linus/f9c169b51b6ce20394594ef674d6b10efba31220
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 71f15c9 ("smb: client: retry compound request without reusing lease") in v6.9-rc1.
    Fixed in v6.11-rc7.
  debian/carnil: |-
    Introduced in 71f15c90e785 ("smb: client: retry compound request without
    reusing lease"). Vulnerable versions: 6.6.32 6.9-rc1.
introduced-by:
  mainline: [71f15c90e785d1de4bcd65a279e7256684c25c0d]
  stable/6.6: [1e60bc0e954389af82f1d9a85f13a63f6572350f]
fixed-by:
  mainline: [f9c169b51b6ce20394594ef674d6b10efba31220]
  stable/6.10: [762099898309218b4a7954f3d49e985dc4dfd638]
  stable/6.6: [5a72d1edb0843e4c927a4096f81e631031c25c28]
  ubuntu/focal: ['version:5.4.0-9.12']
