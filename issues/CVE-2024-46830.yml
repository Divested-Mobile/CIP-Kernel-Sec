description: 'KVM: x86: Acquire kvm->srcu when handling KVM_SET_VCPU_EVENTS'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-46830
- https://git.kernel.org/stable/c/fa297c33faefe51e10244e8a378837fca4963228
- https://git.kernel.org/stable/c/939375737b5a0b1bf9b1e75129054e11bc9ca65e
- https://git.kernel.org/stable/c/ecdbe8ac86fb5538ccc623a41f88ec96c7168ab9
- https://git.kernel.org/stable/c/4bcdd831d9d01e0fb64faea50732b59b2ee88da1
- https://lore.kernel.org/linux-cve-announce/2024092751-CVE-2024-46830-deac@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit f7e5707 ("KVM: x86: Forcibly leave nested virt when SMM state is toggled") in v5.17-rc2.
    Fixed in v6.11-rc7.
  debian/carnil: |-
    Introduced in f7e570780efc ("KVM: x86: Forcibly leave nested virt when SMM
    state is toggled"). Vulnerable versions: 5.10.97 5.15.19 5.16.5 5.17-rc2.
introduced-by:
  cip/5.10: [080dbe7e9b86a0392d8dffc00d9971792afc121f]
  cip/5.10-rt: [080dbe7e9b86a0392d8dffc00d9971792afc121f]
  mainline: [f7e570780efc5cec9b2ed1e0472a7da14e864fdb]
  stable/5.10: [080dbe7e9b86a0392d8dffc00d9971792afc121f]
  stable/5.15: [e302786233e6bc512986d007c96458ccf5ca21c7]
fixed-by:
  cip/6.1: [fa297c33faefe51e10244e8a378837fca4963228]
  mainline: [4bcdd831d9d01e0fb64faea50732b59b2ee88da1]
  stable/6.1: [fa297c33faefe51e10244e8a378837fca4963228]
  stable/6.10: [ecdbe8ac86fb5538ccc623a41f88ec96c7168ab9]
  stable/6.6: [939375737b5a0b1bf9b1e75129054e11bc9ca65e]
