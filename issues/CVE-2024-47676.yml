description: 'mm/hugetlb.c: fix UAF of vma in hugetlb fault pathway'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-47676
- https://git.kernel.org/stable/c/e897d184a8dd4a4e1f39c8c495598e4d9472776c
- https://git.kernel.org/stable/c/d59ebc99dee0a2687a26df94b901eb8216dbf876
- https://git.kernel.org/stable/c/98b74bb4d7e96b4da5ef3126511febe55b76b807
- https://lore.kernel.org/linux-cve-announce/2024102105-CVE-2024-47676-016b@gregkh/
- https://git.kernel.org/linus/98b74bb4d7e96b4da5ef3126511febe55b76b807
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 9acad7b ("hugetlb: use vmf_anon_prepare() instead of anon_vma_prepare()") in v6.9-rc1.
    Fixed in v6.12-rc1.
  debian/carnil: |-
    Introduced in 9acad7ba3e25 ("hugetlb: use vmf_anon_prepare() instead of
    anon_vma_prepare()"). Vulnerable versions: 6.9-rc1.
introduced-by:
  mainline: [9acad7ba3e25d11f4c96df1b7312ae89e6faca5c]
fixed-by:
  mainline: [98b74bb4d7e96b4da5ef3126511febe55b76b807]
  stable/6.11: [d59ebc99dee0a2687a26df94b901eb8216dbf876]
