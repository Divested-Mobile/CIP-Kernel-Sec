description: 'sock_map: Add a cond_resched() in sock_hash_free()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-47710
- https://git.kernel.org/stable/c/1a11a1a53255ddab8a903cdae01b9d3eb2c1a47b
- https://git.kernel.org/stable/c/984648aac87a6a1c8fd61663bec3f7b61eafad5e
- https://git.kernel.org/stable/c/04f62c012e0e4683e572b30baf6004ca0a3f6772
- https://git.kernel.org/stable/c/80bd490ac0a3b662a489e17d8eedeb1e905a3d40
- https://git.kernel.org/stable/c/ae8c1b3e7353ad240b829eabac7ba2584b2c6bdc
- https://git.kernel.org/stable/c/cd10abf41bae55c9d2b93f34a516dbf52626bcb7
- https://git.kernel.org/stable/c/b1339be951ad31947ae19bc25cb08769bf255100
- https://lore.kernel.org/linux-cve-announce/2024102118-CVE-2024-47710-3882@gregkh/
- https://git.kernel.org/linus/b1339be951ad31947ae19bc25cb08769bf255100
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 75e68e5 ("bpf, sockhash: Synchronize delete from bucket list on map free") in v5.8-rc1.
    Fixed in v6.12-rc1.
  debian/carnil: |-
    Introduced in 75e68e5bf2c7 ("bpf, sockhash: Synchronize delete from bucket list
    on map free"). Vulnerable versions: 5.4.49 5.7.6 5.8-rc1.
introduced-by:
  mainline: [75e68e5bf2c7fa9d3e874099139df03d5952a3e1]
  stable/5.4: [5bed77b0a2a0e6b6bc0ae8e851cafb38ef0374df]
  ubuntu/focal: [0ed1923ada778170ac96bf836cc7ea6d2ba00107]
fixed-by:
  cip/6.1: [04f62c012e0e4683e572b30baf6004ca0a3f6772]
  mainline: [b1339be951ad31947ae19bc25cb08769bf255100]
  stable/5.10: [1a11a1a53255ddab8a903cdae01b9d3eb2c1a47b]
  stable/5.15: [984648aac87a6a1c8fd61663bec3f7b61eafad5e]
  stable/6.1: [04f62c012e0e4683e572b30baf6004ca0a3f6772]
  stable/6.11: [cd10abf41bae55c9d2b93f34a516dbf52626bcb7]
  stable/6.6: [80bd490ac0a3b662a489e17d8eedeb1e905a3d40]
