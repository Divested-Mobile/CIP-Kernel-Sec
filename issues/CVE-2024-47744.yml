description: 'KVM: Use dedicated mutex to protect kvm_usage_count to avoid deadlock'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-47744
- https://git.kernel.org/stable/c/4777225ec89f52bb9ca16a33cfb44c189f1b7b47
- https://git.kernel.org/stable/c/a2764afce521fd9fd7a5ff6ed52ac2095873128a
- https://git.kernel.org/stable/c/760a196e6dcb29580e468b44b5400171dae184d8
- https://git.kernel.org/stable/c/44d17459626052a2390457e550a12cb973506b2f
- https://lore.kernel.org/linux-cve-announce/2024102111-CVE-2024-47744-7571@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 0bf5049 ("KVM: Drop kvm_count_lock and instead protect kvm_usage_count with kvm_lock") in v6.3-rc1.
    Fixed in v6.12-rc1.
  debian/carnil: |-
    Introduced in 0bf50497f03b ("KVM: Drop kvm_count_lock and instead protect
    kvm_usage_count with kvm_lock"). Vulnerable versions: 6.3-rc1.
introduced-by:
  mainline: [0bf50497f03b3d892c470c7d1a10a3e9c3c95821]
fixed-by:
  mainline: [44d17459626052a2390457e550a12cb973506b2f]
  stable/6.11: [760a196e6dcb29580e468b44b5400171dae184d8]
  stable/6.6: [4777225ec89f52bb9ca16a33cfb44c189f1b7b47]
