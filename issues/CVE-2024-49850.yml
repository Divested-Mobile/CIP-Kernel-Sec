description: 'bpf: correctly handle malformed BPF_CORE_TYPE_ID_LOCAL relos'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-49850
- https://git.kernel.org/stable/c/dc7ce14f00bcd50641f2110b7a32aa6552e0780f
- https://git.kernel.org/stable/c/2288b54b96dcb55bedebcef3572bb8821fc5e708
- https://git.kernel.org/stable/c/584cd3ff792e1edbea20b2a7df55897159b0be3e
- https://git.kernel.org/stable/c/e7e9c5b2dda29067332df2a85b0141a92b41f218
- https://git.kernel.org/stable/c/3d2786d65aaa954ebd3fcc033ada433e10da21c4
- https://lore.kernel.org/linux-cve-announce/2024102151-CVE-2024-49850-4cc6@gregkh/
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 74753e1 ("libbpf: Replace btf__type_by_id() with btf_type_by_id().") in v5.17-rc1.
    Fixed in v6.12-rc1.
  debian/carnil: |-
    Introduced in 74753e1462e7 ("libbpf: Replace btf__type_by_id() with
    btf_type_by_id()."). Vulnerable versions: 5.17-rc1.
introduced-by:
  mainline: [74753e1462e77349525daf9eb60ea21ed92d3a97]
fixed-by:
  mainline: [3d2786d65aaa954ebd3fcc033ada433e10da21c4]
  stable/6.1: [dc7ce14f00bcd50641f2110b7a32aa6552e0780f]
  stable/6.11: [e7e9c5b2dda29067332df2a85b0141a92b41f218]
  stable/6.6: [2288b54b96dcb55bedebcef3572bb8821fc5e708]
