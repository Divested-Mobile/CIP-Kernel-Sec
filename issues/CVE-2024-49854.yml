description: 'block, bfq: fix uaf for accessing waker_bfqq after splitting'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-49854
- https://git.kernel.org/stable/c/63a07379fdb6c72450cb05294461c6016b8b7726
- https://git.kernel.org/stable/c/de0456460f2abf921e356ed2bd8da87a376680bd
- https://git.kernel.org/stable/c/0780451f03bf518bc032a7c584de8f92e2d39d7f
- https://git.kernel.org/stable/c/0b8bda0ff17156cd3f60944527c9d8c9f99f1583
- https://git.kernel.org/stable/c/cae58d19121a70329cf971359e2518c93fec04fe
- https://git.kernel.org/stable/c/1ba0403ac6447f2d63914fb760c44a3b19c44eaf
- https://lore.kernel.org/linux-cve-announce/2024102153-CVE-2024-49854-1ba5@gregkh/
comments:
  cip/masami: |-
    Introduced by commit 42c306ed ("block, bfq: don't break merge chain in
    bfq_split_bfqq()") in 6.12-rc1.
  debian/carnil: |-
    Introduced in 42c306ed7233 ("block, bfq: don't break merge chain in
    bfq_split_bfqq()"). Vulnerable versions: 5.10.227 5.15.168 6.1.113 6.6.54
    6.10.13 6.11.2 6.12-rc1.
introduced-by:
  mainline: [42c306ed723321af4003b2a41bb73728cab54f85]
fixed-by:
  mainline: [1ba0403ac6447f2d63914fb760c44a3b19c44eaf]
  stable/5.15: [63a07379fdb6c72450cb05294461c6016b8b7726]
  stable/6.1: [de0456460f2abf921e356ed2bd8da87a376680bd]
  stable/6.11: [cae58d19121a70329cf971359e2518c93fec04fe]
  stable/6.6: [0780451f03bf518bc032a7c584de8f92e2d39d7f]
