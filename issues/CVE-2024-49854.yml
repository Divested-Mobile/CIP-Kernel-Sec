description: 'block, bfq: fix uaf for accessing waker_bfqq after splitting'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-49854
- https://git.kernel.org/stable/c/63a07379fdb6c72450cb05294461c6016b8b7726
- https://git.kernel.org/stable/c/de0456460f2abf921e356ed2bd8da87a376680bd
- https://git.kernel.org/stable/c/0780451f03bf518bc032a7c584de8f92e2d39d7f
- https://git.kernel.org/stable/c/0b8bda0ff17156cd3f60944527c9d8c9f99f1583
- https://git.kernel.org/stable/c/cae58d19121a70329cf971359e2518c93fec04fe
- https://git.kernel.org/stable/c/1ba0403ac6447f2d63914fb760c44a3b19c44eaf
- https://lore.kernel.org/linux-cve-announce/2024102153-CVE-2024-49854-1ba5@gregkh/
- https://git.kernel.org/linus/1ba0403ac6447f2d63914fb760c44a3b19c44eaf
comments:
  cip/masami: |-
    Introduced by commit 42c306ed ("block, bfq: don't break merge chain in
    bfq_split_bfqq()") in 6.12-rc1.
  debian/carnil: |-
    Introduced in 42c306ed7233 ("block, bfq: don't break merge chain in
    bfq_split_bfqq()"). Vulnerable versions: 5.10.227 5.15.168 6.1.113 6.6.54
    6.10.13 6.11.2 6.12-rc1.
introduced-by:
  cip/4.19: [9e813033594b141f61ff0ef0cfaaef292564b041]
  cip/5.10: [3630a18846c7853aa326d3b42fd0a855af7b41bc]
  cip/6.1: [de6c5e3a456019d2182e345730e59721714fa0b5]
  mainline: [42c306ed723321af4003b2a41bb73728cab54f85]
  stable/4.19: [9e813033594b141f61ff0ef0cfaaef292564b041]
  stable/5.10: [3630a18846c7853aa326d3b42fd0a855af7b41bc]
  stable/5.15: [e0c20d88b7dce85d2703bb6ba77bf359959675cd]
  stable/5.4: [3a5f45a4ad4e1fd36b0a998eef03d76a4f02a2a8]
  stable/6.1: [de6c5e3a456019d2182e345730e59721714fa0b5]
  stable/6.11: [4780f50ea50cfe8e89fc3747bf3dd155488433bb]
  stable/6.6: [19f3bec2ac4be329b9bd12b18a989b867618d2d8]
  ubuntu/focal: [991abb2420e15254501fce452e767dbad32b4c58]
fixed-by:
  cip/6.1: [de0456460f2abf921e356ed2bd8da87a376680bd]
  mainline: [1ba0403ac6447f2d63914fb760c44a3b19c44eaf]
  stable/5.15: [63a07379fdb6c72450cb05294461c6016b8b7726]
  stable/6.1: [de0456460f2abf921e356ed2bd8da87a376680bd]
  stable/6.11: [cae58d19121a70329cf971359e2518c93fec04fe]
  stable/6.6: [0780451f03bf518bc032a7c584de8f92e2d39d7f]
  ubuntu/focal: ['version:5.4.0-9.12']
