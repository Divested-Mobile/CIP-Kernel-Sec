description: 'nbd: fix race between timeout and normal completion'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-49855
- https://git.kernel.org/stable/c/9c25faf72d780a9c71081710cd48759d61ff6e9b
- https://git.kernel.org/stable/c/6e73b946a379a1dfbb62626af93843bdfb53753d
- https://git.kernel.org/stable/c/5236ada8ebbd9e7461f17477357582f5be4f46f7
- https://git.kernel.org/stable/c/9a74c3e6c0d686c26ba2aab66d15ddb89dc139cc
- https://git.kernel.org/stable/c/c9ea57c91f03bcad415e1a20113bdb2077bcf990
- https://lore.kernel.org/linux-cve-announce/2024102153-CVE-2024-49855-8997@gregkh/
- https://git.kernel.org/linus/c9ea57c91f03bcad415e1a20113bdb2077bcf990
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 2895f18 ("nbd: don't clear 'NBD_CMD_INFLIGHT' flag if request is not completed") in v5.19-rc1.
    Fixed in v6.12-rc1.
  debian/carnil: |-
    Introduced in 2895f1831e91 ("nbd: don't clear 'NBD_CMD_INFLIGHT' flag if
    request is not completed"). Vulnerable versions: 5.17.15 5.18.4 5.19-rc1.
introduced-by:
  mainline: [2895f1831e911ca87d4efdf43e35eb72a0c7e66e]
  ubuntu/focal: [991f3e66704a39b44b5a38af7d6e8025604df1bd]
fixed-by:
  mainline: [c9ea57c91f03bcad415e1a20113bdb2077bcf990]
  stable/6.1: [9c25faf72d780a9c71081710cd48759d61ff6e9b]
  stable/6.11: [9a74c3e6c0d686c26ba2aab66d15ddb89dc139cc]
  stable/6.6: [6e73b946a379a1dfbb62626af93843bdfb53753d]
