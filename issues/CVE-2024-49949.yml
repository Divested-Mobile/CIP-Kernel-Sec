description: 'net: avoid potential underflow in qdisc_pkt_len_init() with UFO'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-49949
- https://git.kernel.org/stable/c/ba26060a29d3ca1bfc737aa79f7125128f35147c
- https://git.kernel.org/stable/c/939c88cbdc668dadd8cfa7a35d9066331239041c
- https://git.kernel.org/stable/c/d6114993e0a89fde84a60a60a8329a571580b174
- https://git.kernel.org/stable/c/25ab0b87dbd89cecef8a9c60a02bb97832e471d1
- https://git.kernel.org/stable/c/f959cce8a2a04ce776aa8b78e83ce339e0d7fbac
- https://git.kernel.org/stable/c/81fd007dcd47c34471766249853e4d4bce8eea4b
- https://git.kernel.org/stable/c/c20029db28399ecc50e556964eaba75c43b1e2f1
- https://lore.kernel.org/linux-cve-announce/2024102129-CVE-2024-49949-c792@gregkh/
- https://git.kernel.org/linus/c20029db28399ecc50e556964eaba75c43b1e2f1
- https://git.kernel.org/stable/c/d70ca7598943572d5e384227bd268acb5109bf72
- https://git.kernel.org/stable/c/1598d70ad9c7d0a4d9d54b82094e9f45908fda6d
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit cf9acc9 ("net: virtio_net_hdr_to_skb: count transport header in UFO") in v5.16-rc2.
    Fixed in v6.12-rc2.
  debian/carnil: |-
    Introduced in cf9acc90c80ec ("net: virtio_net_hdr_to_skb: count transport
    header in UFO"). Vulnerable versions: 4.14.256 4.19.218 5.4.162 5.10.82 5.15.5
    5.16-rc2.
introduced-by:
  cip/4.19: [960b360ca7463921c1a6b72e7066a706d6406223]
  cip/4.19-rt: [960b360ca7463921c1a6b72e7066a706d6406223]
  cip/5.10: [8e6bae950da9dc2d2c6c18b1c6b206dc00dc8772]
  cip/5.10-rt: [8e6bae950da9dc2d2c6c18b1c6b206dc00dc8772]
  mainline: [cf9acc90c80ecbee00334aa85d92f4e74014bcff]
  stable/4.19: [960b360ca7463921c1a6b72e7066a706d6406223]
  stable/5.10: [8e6bae950da9dc2d2c6c18b1c6b206dc00dc8772]
  stable/5.15: [0f810d06b507aa40fef8d1ac0a88e6d0590dbfc3]
  stable/5.4: [fb2dbc124a7f800cd0e4f901a1bbb769a017104c]
  ubuntu/bionic: [3f74e1a90aec75f2af1439777dee30c9c764ffa9]
  ubuntu/focal: [5e1db8c5ad5127b1299e57a8425318192015dc1e]
fixed-by:
  cip/4.19: [d70ca7598943572d5e384227bd268acb5109bf72]
  cip/5.10: [ba26060a29d3ca1bfc737aa79f7125128f35147c]
  cip/6.1: [d6114993e0a89fde84a60a60a8329a571580b174]
  mainline: [c20029db28399ecc50e556964eaba75c43b1e2f1]
  stable/4.19: [d70ca7598943572d5e384227bd268acb5109bf72]
  stable/5.10: [ba26060a29d3ca1bfc737aa79f7125128f35147c]
  stable/5.15: [939c88cbdc668dadd8cfa7a35d9066331239041c]
  stable/5.4: [1598d70ad9c7d0a4d9d54b82094e9f45908fda6d]
  stable/6.1: [d6114993e0a89fde84a60a60a8329a571580b174]
  stable/6.11: [81fd007dcd47c34471766249853e4d4bce8eea4b]
  stable/6.6: [25ab0b87dbd89cecef8a9c60a02bb97832e471d1]
