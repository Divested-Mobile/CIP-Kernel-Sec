description: 'mm/mremap: fix move_normal_pmd/retract_page_tables race'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-50066
- https://git.kernel.org/stable/c/17396e32f975130b3e6251f024c8807d192e4c3e
- https://git.kernel.org/stable/c/1552ce9ce8af47c0fe911682e5e1855e25851ca9
- https://git.kernel.org/stable/c/6fa1066fc5d00cb9f1b0e83b7ff6ef98d26ba2aa
- https://lore.kernel.org/linux-cve-announce/2024102340-CVE-2024-50066-7803@gregkh/
- https://git.kernel.org/linus/6fa1066fc5d00cb9f1b0e83b7ff6ef98d26ba2aa
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 1d65b77 ("mm/khugepaged: retract_page_tables() without mmap or vma lock") in v6.6-rc1.
    Fixed in v6.12-rc4.
  debian/carnil: |-
    Introduced in 1d65b771bc08 ("mm/khugepaged: retract_page_tables() without mmap
    or vma lock"). Vulnerable versions: 6.6-rc1.
introduced-by:
  mainline: [1d65b771bc08cd054cf6d3766a72e113dc46d62f]
fixed-by:
  mainline: [6fa1066fc5d00cb9f1b0e83b7ff6ef98d26ba2aa]
  stable/6.11: [1552ce9ce8af47c0fe911682e5e1855e25851ca9]
  stable/6.6: [17396e32f975130b3e6251f024c8807d192e4c3e]
