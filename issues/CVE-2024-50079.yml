description: 'io_uring/sqpoll: ensure task state is TASK_RUNNING when running task_work'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-50079
- https://git.kernel.org/stable/c/887ba598d9cfb537bdb3dfd95f087ff8a08cb74d
- https://git.kernel.org/stable/c/8f7033aa4089fbaf7a33995f0f2ee6c9d7b9ca1b
- https://lore.kernel.org/linux-cve-announce/2024102936-CVE-2024-50079-47af@gregkh/
- https://git.kernel.org/linus/8f7033aa4089fbaf7a33995f0f2ee6c9d7b9ca1b
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit af5d68f ("io_uring/sqpoll: manage task_work privately") in v6.9-rc1.
    Fixed in v6.12-rc4.
  debian/carnil: |-
    Introduced in af5d68f8892f ("io_uring/sqpoll: manage task_work privately").
    Vulnerable versions: 6.9-rc1.
introduced-by:
  mainline: [af5d68f8892f8ee8f137648b79ceb2abc153a19b]
fixed-by:
  mainline: [8f7033aa4089fbaf7a33995f0f2ee6c9d7b9ca1b]
  stable/6.11: [887ba598d9cfb537bdb3dfd95f087ff8a08cb74d]
