description: |-
  In the Linux kernel, the following vulnerability has been resolved:
  blk-mq: setup queue ->tag_set before initializing hctx
  Commit 7b815817aa58 ("blk-mq: add helper for checking if one CPU is mapped
  to specified hctx")
  needs to check queue mapping via tag set in hctx's cpuhp handler.
  However, q->tag_set may not be setup yet when the cpuhp handler is
  enabled, then kernel oops is triggered.
  Fix the issue by setup queue tag_set before initializing hctx.
references:
- https://www.cve.org/CVERecord?id=CVE-2024-50081
- https://git.kernel.org/linus/c25c0c9035bb8b28c844dfddeda7b8bdbcfcae95
- https://git.kernel.org/stable/c/d28b256db525d9432bc3eb2c8d83f7d3f5e1cc87
- https://git.kernel.org/stable/c/c25c0c9035bb8b28c844dfddeda7b8bdbcfcae95
introduced-by:
  mainline: [7b815817aa58d2e2101feb2fcf64c60cae0b2695]
fixed-by:
  mainline: [c25c0c9035bb8b28c844dfddeda7b8bdbcfcae95]
  stable/6.11: [d28b256db525d9432bc3eb2c8d83f7d3f5e1cc87]
