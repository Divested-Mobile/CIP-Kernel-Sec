description: 'mptcp: pm: fix UaF read in mptcp_pm_nl_rm_addr_or_subflow'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-50085
- https://git.kernel.org/stable/c/35301636439138b821f1f6169bd00d348ebd388a
- https://git.kernel.org/stable/c/da3343bc0839b180fd9af9c27fa456d8231409f9
- https://git.kernel.org/stable/c/7b2e478abab0b3a33515433a6af563aebba773c1
- https://git.kernel.org/stable/c/a8c36ea4ef9a350816f6556c5c5b63810f84b538
- https://git.kernel.org/stable/c/7decd1f5904a489d3ccdcf131972f94645681689
- https://lore.kernel.org/linux-cve-announce/2024102938-CVE-2024-50085-7800@gregkh/
- https://git.kernel.org/linus/7decd1f5904a489d3ccdcf131972f94645681689
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 1c1f721 ("mptcp: pm: only decrement add_addr_accepted for MPJ req") in v6.11-rc5.
    Fixed in v6.12-rc4.
  debian/carnil: |-
    Introduced in 1c1f72137598 ("mptcp: pm: only decrement add_addr_accepted for
    MPJ req"). Vulnerable versions: 5.15.167 6.1.107 6.6.48 6.10.7 6.11-rc5.
introduced-by:
  cip/6.1: [85b866e4c4e63a1d7afb58f1e24273caad03d0b7]
  cip/6.1-rt: [85b866e4c4e63a1d7afb58f1e24273caad03d0b7]
  mainline: [1c1f721375989579e46741f59523e39ec9b2a9bd]
  stable/5.15: [35b31f5549ede4070566b949781e83495906b43d]
  stable/6.1: [85b866e4c4e63a1d7afb58f1e24273caad03d0b7]
  stable/6.6: [d20bf2c96d7ffd171299b32f562f70e5bf5dc608]
fixed-by:
  mainline: [7decd1f5904a489d3ccdcf131972f94645681689]
  stable/5.15: [35301636439138b821f1f6169bd00d348ebd388a]
  stable/6.1: [da3343bc0839b180fd9af9c27fa456d8231409f9]
  stable/6.11: [a8c36ea4ef9a350816f6556c5c5b63810f84b538]
  stable/6.6: [7b2e478abab0b3a33515433a6af563aebba773c1]
  ubuntu/focal: ['version:5.4.0-9.12']
