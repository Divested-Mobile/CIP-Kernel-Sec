description: 'nfsd: cancel nfsd_shrinker_work using sync mode in nfs4_state_shutdown_net'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-50121
- https://git.kernel.org/stable/c/f965dc0f099a54fca100acf6909abe52d0c85328
- https://git.kernel.org/stable/c/add1df5eba163a3a6ece11cb85890e2e410baaea
- https://git.kernel.org/stable/c/d5ff2fb2e7167e9483846e34148e60c0c016a1f6
- https://lore.kernel.org/linux-cve-announce/2024110556-CVE-2024-50121-2a0a@gregkh/
- https://git.kernel.org/linus/d5ff2fb2e7167e9483846e34148e60c0c016a1f6
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 7c24fa2 ("NFSD: replace delayed_work with work_struct for nfsd_client_shrinker") in v6.2-rc5.
    Fixed in v6.12-rc5.
  debian/carnil: |-
    Introduced in 7c24fa225081 ("NFSD: replace delayed_work with work_struct for
    nfsd_client_shrinker"). Vulnerable versions: 5.10.220 5.15.154 6.1.81 6.2-rc5.
introduced-by:
  cip/5.10: [2bbf10861d51dae76c6da7113516d0071c782653]
  cip/5.10-rt: [2bbf10861d51dae76c6da7113516d0071c782653]
  cip/6.1: [f3ea5ec83d1a827f074b2b660749817e0bf2b23e]
  cip/6.1-rt: [f3ea5ec83d1a827f074b2b660749817e0bf2b23e]
  mainline: [7c24fa225081f31bc6da6a355c1ba801889ab29a]
  stable/5.10: [2bbf10861d51dae76c6da7113516d0071c782653]
  stable/5.15: [958294a3eb82026fcfff20b0287a90e9c854785e]
  stable/6.1: [f3ea5ec83d1a827f074b2b660749817e0bf2b23e]
fixed-by:
  mainline: [d5ff2fb2e7167e9483846e34148e60c0c016a1f6]
  stable/6.11: [add1df5eba163a3a6ece11cb85890e2e410baaea]
  stable/6.6: [f965dc0f099a54fca100acf6909abe52d0c85328]
