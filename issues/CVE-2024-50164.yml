description: 'bpf: Fix overloading of MEM_UNINIT''s meaning'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-50164
- https://git.kernel.org/stable/c/48068ccaea957469f1adf78dfd2c1c9a7e18f0fe
- https://git.kernel.org/stable/c/54bc31682660810af1bed7ca7a19f182df8d3df8
- https://git.kernel.org/stable/c/8ea607330a39184f51737c6ae706db7fdca7628e
- https://lore.kernel.org/linux-cve-announce/2024110748-CVE-2024-50164-b109@gregkh/
- https://git.kernel.org/linus/8ea607330a39184f51737c6ae706db7fdca7628e
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 7b3552d ("bpf: Reject writes for PTR_TO_MAP_KEY in check_helper_mem_access") in v5.19-rc1.
    Introduced by commit 97e6d7d ("bpf: Check PTR_TO_MEM | MEM_RDONLY in check_helper_mem_access") in v5.19-rc1.
    Introduced by commit 15baa55 ("bpf/verifier: allow all functions to read user provided context") in v6.1-rc1.
    Fixed in v6.12-rc5.
  debian/carnil: |-
    Introduced in 7b3552d3f9f6 ("bpf: Reject writes for PTR_TO_MAP_KEY in
    check_helper_mem_access")
    97e6d7dab1ca ("bpf: Check PTR_TO_MEM | MEM_RDONLY in check_helper_mem_access")
    15baa55ff5b0 ("bpf/verifier: allow all functions to read user provided
    context"). Vulnerable versions: 5.15.45 5.17.13 5.18.2 5.19-rc1.
introduced-by:
  mainline: [7b3552d3f9f6897851fc453b5131a967167e43c2, 97e6d7dab1ca4648821c790a2b7913d6d5d549db,
    15baa55ff5b00b81bcd9874b89cb8e0b0daaa13d]
fixed-by:
  mainline: [8ea607330a39184f51737c6ae706db7fdca7628e]
  stable/6.11: [54bc31682660810af1bed7ca7a19f182df8d3df8]
  stable/6.6: [48068ccaea957469f1adf78dfd2c1c9a7e18f0fe]
