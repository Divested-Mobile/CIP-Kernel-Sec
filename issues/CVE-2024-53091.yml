description: 'bpf: Add sk_is_inet and IS_ICSK check in tls_sw_has_ctx_tx/rx'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-53091
- https://git.kernel.org/stable/c/a078a480ff3f43d74d8a024ae10c3c7daf6db149
- https://git.kernel.org/stable/c/6781cfa93a6a1b7f5be6819a5a2dd8f30f47ca26
- https://git.kernel.org/stable/c/44d0469f79bd3d0b3433732877358df7dc6b17b1
- https://lore.kernel.org/linux-cve-announce/2024112151-CVE-2024-53091-7f61@gregkh/
- https://git.kernel.org/linus/44d0469f79bd3d0b3433732877358df7dc6b17b1
comments:
  cip/cip-kernel-sec: |-
    Introduced by commit 634f1a7 ("vsock: support sockmap") in v6.4-rc1.
    Introduced by commit 94531cf ("af_unix: Add unix_stream_proto for sockmap") in v5.15-rc1.
    Fixed in v6.12.
  debian/carnil: |-
    Introduced in 634f1a7110b4 ("vsock: support sockmap")
    94531cfcbe79 ("af_unix: Add unix_stream_proto for sockmap"). Vulnerable
    versions: 5.15-rc1.
introduced-by:
  mainline: [634f1a7110b439c65fd8a809171c1d2d28bcea6f, 94531cfcbe79c3598acf96806627b2137ca32eb9]
fixed-by:
  mainline: [44d0469f79bd3d0b3433732877358df7dc6b17b1]
  stable/6.11: [6781cfa93a6a1b7f5be6819a5a2dd8f30f47ca26]
  stable/6.6: [a078a480ff3f43d74d8a024ae10c3c7daf6db149]
