description: 'bpf: Check validity of link->type in bpf_link_show_fdinfo()'
references:
- https://www.cve.org/CVERecord?id=CVE-2024-53099
- https://git.kernel.org/stable/c/d5092b0a1aaf35d77ebd8d33384d7930bec5cb5d
- https://git.kernel.org/stable/c/b3eb1b6a9f745d6941b345f0fae014dc8bb06d36
- https://git.kernel.org/stable/c/8421d4c8762bd022cb491f2f0f7019ef51b4f0a7
- https://lore.kernel.org/linux-cve-announce/2024112506-CVE-2024-53099-e454@gregkh/
comments:
  cip/cip-kernel-sec: There is no mention of the commit that introduced the bug in
    the CVE announcement.Fixed in v6.12-rc5.
  cip/masami: |-
    It looks as if this bug was introdcued by commit f2e10bf ("bpf: Add support for
    BPF_OBJ_GET_INFO_BY_FD for bpf_link") in 5.8-rc1.
introduced-by:
  mainline: [f2e10bff16a0fdd41ba278c84da9813700e356af]
fixed-by:
  mainline: [8421d4c8762bd022cb491f2f0f7019ef51b4f0a7]
  stable/6.11: [b3eb1b6a9f745d6941b345f0fae014dc8bb06d36]
  stable/6.6: [d5092b0a1aaf35d77ebd8d33384d7930bec5cb5d]
